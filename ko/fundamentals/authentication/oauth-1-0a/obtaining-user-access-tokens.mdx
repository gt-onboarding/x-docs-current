---
title: 3-legged OAuth 플로우를 사용하여 액세스 토큰 발급받기
sidebarTitle: 사용자 액세스 토큰(3-legged OAuth 플로우)
keywords: ["3-legged OAuth 플로우", "사용자 액세스 토큰", "OAuth 플로우", "액세스 토큰 발급", "OAuth 1.0a 플로우", "액세스 토큰 발급"]
---

import { Button } from "/snippets/ko/button.mdx";

<div id="obtaining-access-tokens-using-3-legged-oauth-flow">
  ### 3-legged OAuth 플로우를 사용하여 액세스 토큰 획득하기
</div>

다른 사용자를 대신해 작업을 수행하려면 해당 사용자의 액세스 토큰을 획득해야 합니다. 액세스 토큰은 요청이 어느 X 계정을 대신해 수행되는지를 지정하므로, 이를 얻으려면 먼저 해당 사용자가 애플리케이션에 대한 액세스를 허용해야 합니다. 이러한 토큰은 만료되지 않지만 사용자가 언제든지 토큰을 취소(무효화)할 수 있습니다.

X에서는 3-legged OAuth 플로우를 통해 사용자 액세스 토큰을 획득할 수 있습니다. 이 플로우에서는 사용자를 X로 리디렉션한 뒤, 사용자가 애플리케이션을 승인하면 애플리케이션이 **액세스 토큰(access token)** 및 access token secret을 획득합니다. 이 플로우는 [Log in with X 구현](/ko/resources/fundamentals/authentication/guides/log-in-with-x)에서 설명된 플로우와 거의 동일하지만, 두 가지 차이점이 있습니다:

* [GET oauth/authorize](/ko/resources/fundamentals/authentication/api-reference#get-oauth-authorize) 엔드포인트가 [GET oauth/authenticate](/ko/resources/fundamentals/authentication/api-reference#get-oauth-authenticate) 대신 사용됩니다.
* 사용자가 이전에 액세스를 허용한 적이 있더라도 애플리케이션에 대한 액세스를 승인하라는 프롬프트가 **항상** 표시됩니다.
   

시작하기 전에 [애플리케이션](/ko/resources/fundamentals/developer-apps)의 권한을 확인하고 consumer key와 callback URL을 파악해야 합니다. callback URL이나 공개적으로 접근 가능한 UI가 없다면, [PIN 기반 인증](/ko/resources/fundamentals/authentication/oauth-1-0a/pin-based-oauth) 사용을 고려하십시오. 이는 인증 후 사용자를 리디렉션하기 위해 웹 브라우저에 접근하거나 웹 브라우저를 임베드할 수 없는 애플리케이션을 위한 방식입니다. 

3-legged 로그인 상호작용의 가능한 상태는 아래 플로차트에 나와 있습니다:

![](https://cdn.cms-twdigitalassets.com/content/dam/developer-twitter/docs/obtaining-access-tokens.png.twimg.1920.png)

<div id="overview-of-the-process">
  #### 프로세스 개요
</div>

개괄적으로, 3-legged OAuth 프로세스는 다음을 수행합니다.

1. 컨슈머 애플리케이션이 요청 토큰을 발급받을 수 있도록 요청을 생성합니다.
2. 사용자를 인증하고 컨슈머 애플리케이션에 요청 토큰을 전송합니다.
3. 요청 토큰을 실제로 사용할 수 있는 사용자 액세스 토큰으로 변환합니다.

**용어 정리**

아래 가이드에서는 같은 개념을 가리키는 서로 다른 용어들이 등장할 수 있습니다.

**클라이언트 자격 증명:**

* App Key === API Key === Consumer API Key === Consumer Key === Customer Key === `oauth_consumer_key`
* App Key Secret === API Secret Key === Consumer Secret === Consumer Key === Customer Key === `oauth_consumer_secret`
* Callback URL === `oauth_callback`
   

**임시 자격 증명:**

* Request Token === `oauth_token`
* Request Token Secret === `oauth_token_secret`
* oauth&#95;verifier
   

**토큰 자격 증명:**

* Access token === Token === resulting `oauth_token`
* Access token secret === Token Secret === resulting `oauth_token_secret`

<div id="walkthrough-steps">
  #### 단계별 안내
</div>

**1단계: [POST oauth/request&#95;token](/ko/resources/fundamentals/authentication/api-reference#post-oauth-request-token)**

소비자 앱이 request token을 얻을 수 있도록 요청을 생성합니다.

이 요청에서 유일한 고유 파라미터는 `oauth_callback`이며, 이는 사용자가 2단계를 완료했을 때 리디렉션되기를 원하는 URL을 [URL 인코딩된](/ko/resources/fundamentals/authentication/oauth-1-0a/percent-encoding-parameters) 버전으로 지정해야 합니다. 나머지 파라미터는 OAuth 서명 과정에서 추가됩니다.

참고: [POST oauth/request&#95;token](/ko/resources/fundamentals/authentication/api-reference#post-oauth-request-token) 엔드포인트에서 사용하는 모든 callback URL은 developer portal의 앱 상세 페이지에 있는 [developer App](/ko/resources/fundamentals/developer-apps) 설정에서 구성되어 있어야 합니다.
 

**요청에 포함되는 항목:**

`oauth_callback="https%3A%2F%2FyourCallbackUrl.com"`

`oauth_consumer_key="cChZNFj6T5R0TigYB9yd1w" `

앱은 응답의 HTTP 상태 코드를 확인해야 합니다. 200이 아닌 모든 값은 실패를 의미합니다. 응답 본문에는 `oauth_token`, `oauth_token_secret`, `oauth_callback_confirmed` 파라미터가 포함됩니다. 앱은 `oauth_callback_confirmed`가 true인지 확인하고, 나머지 두 값을 다음 단계에서 사용할 수 있도록 저장해야 합니다.
 

**응답에 포함되는 항목**

`oauth_token=NPcudxy0yU5T3tBzho7iCotZ3cnetKwcTIRlX0iwRl0`

`oauth_token_secret=veNRnAWe6inFuo8o2u8SLLZLjolYDmDP7SzL0YfYI`

`oauth_callback_confirmed=true`

**2단계: [GET oauth/authorize](/ko/resources/fundamentals/authentication/api-reference#get-oauth-authorize)**

사용자가 인증을 수행하도록 하고, 소비자 앱에 request token을 전송합니다.
 

**사용자를 리디렉션할 예시 URL:**

`https://api.x.com/oauth/authorize?oauth_token=NPcudxy0yU5T3tBzho7iCotZ3cnetKwcTIRlX0iwRl0`

인증이 성공하면, `callback_url`은 `oauth_token` 및 `oauth_verifier` 파라미터를 포함한 요청을 받게 됩니다. 애플리케이션은 해당 토큰이 1단계에서 수신한 request token과 일치하는지 확인해야 합니다.
 

**클라이언트 리디렉션에서의 요청:**

`https://yourCallbackUrl.com?oauth_token=NPcudxy0yU5T3tBzho7iCotZ3cnetKwcTIRlX0iwRl0&oauth_verifier=uw7NjWHT6OJ1MpJOXsHfNxoAhPKpgI8BlYDhxEjIBY`

**3단계: [POST oauth/access&#95;token](/ko/resources/fundamentals/authentication/api-reference#post-oauth-access-token)**

request token을 사용 가능한 액세스 토큰으로 변환합니다.

request token을 사용 가능한 액세스 토큰으로 변환하려면, 애플리케이션이 2단계에서 얻은 `oauth_verifier` 값을 포함하여 [POST oauth/access&#95;token](/ko/resources/fundamentals/authentication/api-reference#post-oauth-access-token) 엔드포인트에 요청을 보내야 합니다. request token은 헤더의 `oauth_token` 부분으로도 전달되며, 이는 서명 과정에서 자동으로 추가됩니다.
 

**요청에 포함되는 항목:**

`POST /oauth/access_token`

`oauth_consumer_key=cChZNFj6T5R0TigYB9yd1w`

`oauth_token=NPcudxy0yU5T3tBzho7iCotZ3cnetKwcTIRlX0iwRl0`

`oauth_verifier=uw7NjWHT6OJ1MpJOXsHfNxoAhPKpgI8BlYDhxEjIBY`

성공 응답에는 `oauth_token`, `oauth_token_secret` 파라미터가 포함됩니다. 토큰과 토큰 시크릿은 저장해 두었다가, 이후 X API에 대한 인증된 요청에 사용해야 합니다. 사용자의 신원을 확인하려면 [GET account/verify&#95;credentials](/ko/resources/fundamentals/authentication/api-reference)를 사용합니다.
 

**응답에 포함되는 항목:**

`oauth_token=7588892-kagSNqWge8gB1WwE3plnFsJHAZVfxWD7Vb57p0b4`

`oauth_token_secret=PbKfYqSryyeKDWz4ebtY3o5ogNLG11WJuZBc9fQrQo`

**이 자격 증명을 OAuth 1.0a(애플리케이션-사용자) 방식이 필요한 요청에 사용하기**

이제 사용자 액세스 토큰을 발급받았으므로, 이를 사용해 [POST statuses/update](/ko/x-api/posts/manage-tweets/introduction)와 같은 특정 API를 호출하여 사용자를 대신해 트윗을 생성할 수 있습니다.
 

**요청에는 다음이 포함됩니다:**

`POST statuses/update.json`

`oauth_consumer_key=cChZNFj6T5R0TigYB9yd1w`

`oauth_token=7588892-kagSNqWge8gB1WwE3plnFsJHAZVfxWD7Vb57p0b4`

<div id="sample-use-case">
  #### 샘플 사용 사례
</div>

표준 플로우는 웹 기반이며 3-legged OAuth 인가 플로우를 사용합니다. 여기 제시된 스크린샷은 [https://github.com/xdevplatform/twauth-web](https://github.com/xdevplatform/twauth-web)에서 소스를 확인할 수 있는 샘플의 일부입니다.

애플리케이션 플로우 중 어느 시점에서는 애플리케이션을 인가받기 위해 X로 리디렉션해야 합니다.

<Frame>
  <img src="/images/twauth-web-2.png" alt="" />
</Frame>

요청 토큰을 포함해 X로 리디렉션하면, 사용자에게 애플리케이션을 인가하라는 화면이 표시됩니다.

<Frame>
  <img src="/images/twauth-web-3.png" alt="" />
</Frame>

사용자가 애플리케이션을 인가하면, 요청 토큰을 생성할 때 제공한 콜백 URL로 리디렉션됩니다. 이를 사용하여 해당 사용자의 영구 액세스 토큰을 얻고, 이를 로컬에 저장합니다.

<Frame>
  <img src="/images/twauth-web-4.png" alt="" />
</Frame>