---
title: 스트리밍
sidebarTitle: 스트리밍
---

X API는 [Filtered Stream Endpoint](https://docs.x.com/x-api/posts/filtered-stream/introduction)와 같은 엔드포인트를 통해 실시간 데이터 전송을 지원하며, 게시물이 발생하는 즉시 일치하는 게시물을 전달합니다. 이를 위해서는 지속적인 HTTP 연결을 유지해야 합니다.

<div id="setup-and-basic-streaming">
  ## 설정 및 기본 스트리밍
</div>

<div id="synchronous">
  ### 동기
</div>

```python
from xdk import Client
# Client 초기화
client = Client(bearer_token="your_bearer_token")
# 게시물 스트리밍 (먼저 규칙을 설정해야 합니다)
for post_response in client.stream.posts():
    data = post_response.model_dump() if hasattr(post_response, 'model_dump') else dict(post_response)
    if 'data' in data and data['data']:
        tweet = data['data']
        post_text = tweet.get('text', '') if isinstance(tweet, dict) else (tweet.text if hasattr(tweet, 'text') else '')
        print(f"Post: {post_text}")
```


<div id="async">
  ### 비동기
</div>

```python
import asyncio
from asyncio import Queue
import threading
from xdk import Client
async def stream_posts_async(client: Client):
    queue = Queue()
    loop = asyncio.get_event_loop()
    stop = threading.Event()
    def run_stream():
        for post in client.stream.posts():
            if stop.is_set():
                break
            asyncio.run_coroutine_threadsafe(queue.put(post), loop)
        asyncio.run_coroutine_threadsafe(queue.put(None), loop)
    threading.Thread(target=run_stream, daemon=True).start()
    while True:
        post = await queue.get()
        if post is None:
            break
        data = post.model_dump()
        if 'data' in data and data['data']:
            print(f"게시물: {data['data'].get('text', '')}")
    stop.set()
async def main():
    client = Client(bearer_token="your_bearer_token")
    await stream_posts_async(client)
asyncio.run(main())
```


<div id="rule-management">
  ## 규칙 관리
</div>

규칙은 원하는 특정 데이터(예: 키워드, 사용자 등)를 찾을 때 사용할 필터를 정의합니다. 규칙 작성 방법은 [이 가이드](https://docs.x.com/x-api/posts/filtered-stream/integrate/build-a-rule)를 참고하세요.
**규칙 추가**:

```python
from xdk.stream.models import UpdateRulesRequest
# 규칙 추가
add_rules = {
    "add": [
        {"value": "from:xdevelopers", "tag": "official_updates"}
    ]
}
request_body = UpdateRulesRequest(**add_rules)
response = client.stream.update_rules(body=request_body)
```

**규칙 삭제**:

```python
from xdk.stream.models import UpdateRulesRequest
delete_rules = {
    "delete": {
        "ids": ["rule_id_1", "rule_id_2"]
    }
}
request_body = UpdateRulesRequest(**delete_rules)
response = client.stream.update_rules(body=request_body)
```

**규칙 목록**:

```python
# get_rules는 Iterator를 반환하므로 이를 반복 처리합니다
for page in client.stream.get_rules():
    if page.data:
        for rule in page.data:
            # 규칙 속성 접근 - Pydantic 모델은 속성 및 딕셔너리 접근을 모두 지원합니다
            rule_id = rule.id if hasattr(rule, 'id') else rule.get('id', '')
            rule_value = rule.value if hasattr(rule, 'value') else rule.get('value', '')
            rule_tag = rule.tag if hasattr(rule, 'tag') else rule.get('tag', '')
            print(f"ID: {rule_id}, Value: {rule_value}, Tag: {rule_tag}")
    break  # 모든 페이지를 가져오려면 break를 제거하세요
```

규칙 구문 전체는 [X Streaming Rules 문서](https://developer.x.com/en/docs/twitter-api/tweets/filtered-stream/integrate/build-a-rule)에서 확인하세요.


<div id="troubleshooting">
  ## 문제 해결
</div>

- **403 Forbidden**: 인증이 잘못되었거나 권한이 부족합니다.
- **420 Enhance Your Calm**: 요청이 rate limit에 도달했습니다. 잠시 대기한 뒤 다시 시도하세요.
- **No Data**: `get_rules()`로 규칙을 확인하고, 해당 규칙과 일치하는 게시물이 실제로 존재하는지 확인하세요.
Python XDK를 사용한 자세한 코드 예제는 [code samples GitHub 리포지토리](https://github.com/xdevplatform/samples/tree/main/python)를 참고하세요.
추가 예제와 API 레퍼런스는 인라인 docstring(예: `help(client.tweets.search_recent)`)이나 소스에 포함된 자동 생성 스텁을 참조하세요. 의견은 [GitHub 리포지토리](https://github.com/xdevplatform/xdk/tree/main/xdk/python)를 통해 보내주세요.