---
title: R과 X API v2 시작하기
mode: wide
keywords: ["R 프로그래밍", "R 튜토리얼", "R API", "통계 분석", "데이터 분석", "R 언어", "R 연동"]
---

<div id="introduction">
  ## Introduction
</div>

이 튜토리얼에서는 R 프로그래밍 언어와 X API v2를 사용해 시작하는 데 필요한 사항을 단계별로 살펴봅니다. R을 사용해
[user lookup](/ko/x-api/users/lookup/introduction) 엔드포인트에 연결하면서 X API가 반환하는
JSON을 어떻게 다루는지 보여드리겠습니다. user lookup은 GET 메서드로, user ID 또는
username으로 지정된 하나의 사용자 또는 여러 사용자에 대한 정보를 반환합니다.

R에 익숙하지 않다면 알아두세요. R은 시계열 분석, 모델링, 시각화, 기타 데이터
분석과 같은 일반적인 데이터 사이언스 작업에 가장 널리 사용되는 언어 중 하나이며, 종종 X API와 함께 사용됩니다. user
lookup 엔드포인트를 사용하면
[user object](/ko/x-api/fundamentals/data-dictionary#user)를 활용해
한 사람이 보유한 팔로워 수와 그 사람의 프로필 소개(bio)의 감성 점수 간 상관관계를 파악할 수 있습니다. user object는 또한 프로필에 공개적으로 표시된
위치 정보를 기준으로 계정 그룹을 매핑하는 데에도 사용할 수 있습니다.

<div id="getting-started-with-the-x-api">
  ### X API 시작하기
</div>

X API v2를 사용하기 전에 먼저
[가입](https://developer.x.com/en/portal/petition/essential/basic-info)을 통해
개발자 계정을 신청해야 합니다.

개발자 계정 승인을 받은 후에는 먼저
[프로젝트](/ko/resources/fundamentals/projects)를 생성해야 합니다. 프로젝트를 사용하면
X API 사용 방식에 따라 작업을 구성할 수 있으므로, API 액세스를 효과적으로 관리하고
사용량을 모니터링할 수 있습니다.

각 프로젝트에는 X API 사용에 필요한 자격 증명을 생성할 수 있는
[앱](/ko/resources/fundamentals/developer-apps)이 포함되어 있습니다. X API 사용을
시작하는 방법에 대해 더 알아보려면, 문서의
[시작하기](/ko/x-api/getting-started/about-x-api) 섹션을 참고하세요.

<div id="getting-your-r-environment-set-up">
  ### R 환경 설정하기
</div>

먼저 [R을 다운로드](https://cloud.r-project.org/)해야 하며,
이는 [CRAN 웹사이트](https://cran.r-project.org/)에서 진행할 수 있습니다.

그다음 R로 작업할 환경을 설정하기 위해
[RStudio](https://www.rstudio.com/),
[Visual Studio Code](https://marketplace.visualstudio.com/items?itemName=Ikuyadeu.r-pack)의 R 확장 팩,
또는 Python을 주로 사용해 왔다면
[Jupyter Notebook](https://docs.anaconda.com/anaconda/navigator/tutorials/r-lang/)을 사용할 수 있습니다.

<div id="setting-up-your-environment-variable">
  ### 환경 변수 설정하기
</div>

오늘 보여드릴 코드 예제에서는 Bearer Token을 위한 환경 변수를 생성해야 합니다. Bearer Token은 X API에 인증하고 요청을 보내기 시작할 수 있게 해 줍니다. 먼저 “your-bearer-token”을 developer portal의 App 내 키와 토큰 섹션에서 얻을 수 있는 본인의 Bearer Token으로 교체하세요. 스크립트를 작성하기 시작하기 전에 콘솔에서 이 코드 한 줄을 실행해야 합니다.

```r
Sys.setenv(BEARER_TOKEN = "your-bearer-token")
```

<div id="making-your-request">
  ### 요청 보내기
</div>

패키지
[httr](https://cran.r-project.org/web/packages/httr/index.html)를 사용해 X API로 HTTP
요청을 보낼 수 있습니다. 아직 설치하지 않았다면 콘솔에서 이 패키지를
설치해 주세요. 또한 JSON 객체를 처리하기 위해
[jsonlite](https://cran.r-project.org/web/packages/jsonlite/index.html) 패키지와
데이터 처리/가공을 위해 [dplyr](https://dplyr.tidyverse.org/) 패키지도 설치해야 합니다.

```r
install.packages("httr")
install.packages("jsonlite")
install.packages("dplyr")
```

이제 API에 연결하기 위한 R 스크립트를 작성할 수 있습니다. 파일 맨 위에서
httr, jsonlite, dplyr 패키지를 불러오십시오.

```r
require(httr)
require(jsonlite)
require(dplyr)
```

코드 샘플의 첫 번째 단계는 X API에 인증할 수 있도록 환경을 설정하는 것입니다.
앱에서 가져온
[Bearer Token](/ko/resources/fundamentals/authentication#using-and-generating-an-app-only-bearer-token)을 준비한 뒤, 인증을 위해 그 토큰을 헤더에 포함합니다. 아래 예제에서
$BEARER&#95;TOKEN을 자신의 토큰으로 바꾸세요.

```r
bearer_token <- Sys.getenv("$BEARER_TOKEN")
headers <- c(`Authorization` = sprintf('Bearer %s', bearer_token))
```

인증 설정을 마쳤다면, 요청의 매개변수를 정의합니다.
기본적으로 응답에는 조회한 각 사용자의 id, name, username이 포함됩니다.
추가 [필드](/ko/x-api/fundamentals/fields)와
[expansions](/ko/x-api/fundamentals/expansions)를 지정해 이 페이로드를 조정할 수 있습니다.
이 예제에서는 user.fields=description을 사용해 사용자의 프로필 소개(bio)를 요청하고,
사용자의 고정된 게시물을 포함하도록 하는 expansion도 함께 요청합니다.

```r
params <- list(`user.fields` = 'description', `expansions` = 'pinned_tweet_id')
```

이제 더 많은 정보를 얻고자 하는 X 핸들(계정)을 URL에 포함하도록 구성할 준비가 되었습니다. 이 샘플을 재사용할 수 있도록 `readline` 메서드를 사용하세요. 조회하려는 핸들을 입력한 후, `$USERNAME`을 원하는 X 핸들로 교체하여 해당 핸들이 포함되도록 URL을 구성합니다.

```r
handle <- readline('$USERNAME')
url_handle <- sprintf('https://api.x.com/2/users/by?usernames=%s', handle)
```

이제 httr 패키지를 사용해 방금 생성한 URL로 GET 요청을 보내고,
헤더에 인증 자격 증명을 포함한 뒤, 앞에서 정의한 파라미터를 전달합니다.
응답은 텍스트 객체로 만들어 변수 obj에 저장한 다음, 이를 출력해 수행한 요청의
결과를 확인할 수 있습니다.

```r
response <-
  httr::GET(url = url_handle,
    httr::add_headers(.headers = headers),
    query = params)
obj <- httr::content(response, as = "text")
print(obj)
```

<div id="working-with-our-json-payload">
  ### JSON 페이로드 다루기
</div>

JSON을 다루는 제가 가장 선호하는 방법 중 하나는 데이터 프레임을 사용하는 것입니다. 데이터 프레임을 사용하면 복잡하게 중첩된 데이터에도 쉽게 접근할 수 있습니다. 이를 위해 jsonlite 패키지의 fromJSON 메서드를 사용해 파일을 평탄화하여 필드가 하나의 객체 안에 포함되도록 합니다. 그런 다음 그 객체를 데이터 프레임으로 변환합니다. 이제 이 데이터 프레임을 확인할 준비가 되었습니다.

```
json_data <- fromJSON(obj, flatten = TRUE) %>% as.data.frame View(json_data)
```

데이터 프레임에서 데이터의 필드에 접근한 다음, 핸들, 사용자 이름, 소개(bio)를 포함하는 문자열에 넣을 수 있습니다.

```r
final <-
  sprintf(
    "핸들: %s\n소개: %s\n고정된 게시물: %s",
    json_data$data.username,
    json_data$data.description,
    json_data$includes.tweets.text
  )
```

가져오는 각 필드를 줄바꿈으로 구분해 객체를 확인하려면 `print` 대신 `cat`을 사용하세요.

```r
cat(final)
```

여러 개의 handle에 대해 요청을 보냈다면, 각 데이터 프레임 요소에 접근하기 위해
손쉽게 루프를 돌릴 수 있습니다.

<div id="conclusion">
  ### 결론
</div>

이 튜토리얼이 R과 X API를 함께 사용하는 작업을 시작하는 데 도움이 되었기를 바랍니다.
다음 단계로는, 최근 검색, 게시물 조회, 사용자 조회를 위한 R 샘플을
[v2 샘플 코드](https://github.com/xdevplatform)에서 살펴보시기 바랍니다.
진행 중에 문제가 발생하면 언제든지
[포럼](https://devcommunity.x.com/)에서 알려주시거나,
이 튜토리얼이 무언가를 만들도록 영감을 주었다면 [@XDevelopers](https://x.com/XDevelopers)에
게시물을 남겨 주세요.