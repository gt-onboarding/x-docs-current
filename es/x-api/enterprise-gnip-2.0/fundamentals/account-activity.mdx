---
title: "API de actividad de la cuenta: Enterprise"
keywords: ["enterprise Account Activity API", "enterprise AAA", "Account Activity enterprise", "enterprise webhooks", "enterprise activity"]
---

<Note>
  Este endpoint se ha actualizado para incluir metadatos de edición de Publicaciones. Obtén más información sobre estos metadatos en la [página de fundamentos &quot;Editar Publicaciones&quot;](/es/x-api/enterprise-gnip-2.0/fundamentals/edit-tweets). 

  Este endpoint se utiliza a menudo con los endpoints de Mensajes directos. Hemos lanzado nuevos [endpoints v2 de Mensajes directos](/es/x-api/direct-messages/manage/introduction). Ten en cuenta que las APIs de actividad de cuenta Enterprise y Premium son compatibles con los mensajes uno a uno de v2, pero aún no son compatibles con las conversaciones de grupo.   
</Note>

Descripción general

`Enterprise`

La Account Activity API te permite suscribirte a actividades en tiempo real relacionadas con una cuenta de usuario mediante webhooks. Esto significa que puedes recibir Publicaciones en tiempo real, Mensajes directos y otros eventos de cuenta de una o más de tus cuentas propias o suscritas a través de una única conexión.

Recibirás todas las actividades relacionadas que se indican a continuación para cada suscripción de usuario en el registro de tu webhook:

| Tipos de actividad |     |
| :--- | :--- |
| * Publicaciones (del usuario)  <br />    <br />* Eliminaciones de Publicaciones (del usuario)<br />* @menciones (al usuario)<br />* Respuestas (al usuario o del usuario)<br />* Retweets (del usuario o sobre el usuario)<br />* Publicaciones citadas (del usuario o sobre el usuario)<br />* Retweets de Publicaciones citadas (del usuario o sobre el usuario)<br />* Me gusta (del usuario o sobre el usuario)<br />* Follows (del usuario o hacia el usuario)  <br />    <br />* Unfollows (del usuario) | * Bloqueos (del usuario)<br />* Desbloqueos (del usuario)<br />* Acciones de silenciar (del usuario)<br />* Acciones de dejar de silenciar (del usuario)<br />* Mensajes directos enviados (del usuario)<br />* Mensajes directos recibidos (del usuario)<br />* Indicadores de escritura (al usuario)<br />* Confirmaciones de lectura (al usuario)<br />* Revocaciones de suscripción (del usuario) |

**Ten en cuenta** - No entregamos datos de la cronología de inicio a través de la Account Activity API. Utiliza [GET statuses/home&#95;timeline](https://developer.x.com/en/docs/x-api/v1/tweets/timelines/overview) para obtener estos datos.
 

<div id="video-series">
  #### Serie de videos
</div>

Consulta nuestra [serie de videos en cuatro partes](https://www.youtube.com/watch?v=otPxejFhyy8\&index=0\&list=PLFKjcMIU2WshGG6Yj940XM7Z6BFs1zfBg) sobre la API Account Activity para ponerte al día.

<iframe src="https://platform.x.com/embed/Tweet.html?dnt=false&embedId=twitter-widget-0&features=eyJ0ZndfdGltZWxpbmVfbGlzdCI6eyJidWNrZXQiOltdLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X2ZvbGxvd2VyX2NvdW50X3N1bnNldCI6eyJidWNrZXQiOnRydWUsInZlcnNpb24iOm51bGx9LCJ0ZndfdHdlZXRfZWRpdF9iYWNrZW5kIjp7ImJ1Y2tldCI6Im9uIiwidmVyc2lvbiI6bnVsbH0sInRmd19yZWZzcmNfc2Vzc2lvbiI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9LCJ0ZndfZm9zbnJfc29mdF9pbnRlcnZlbnRpb25zX2VuYWJsZWQiOnsiYnVja2V0Ijoib24iLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X21peGVkX21lZGlhXzE1ODk3Ijp7ImJ1Y2tldCI6InRyZWF0bWVudCIsInZlcnNpb24iOm51bGx9LCJ0ZndfZXhwZXJpbWVudHNfY29va2llX2V4cGlyYXRpb24iOnsiYnVja2V0IjoxMjA5NjAwLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X3Nob3dfYmlyZHdhdGNoX3Bpdm90c19lbmFibGVkIjp7ImJ1Y2tldCI6Im9uIiwidmVyc2lvbiI6bnVsbH0sInRmd19kdXBsaWNhdGVfc2NyaWJlc190b19zZXR0aW5ncyI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9LCJ0ZndfdXNlX3Byb2ZpbGVfaW1hZ2Vfc2hhcGVfZW5hYmxlZCI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9LCJ0ZndfdmlkZW9faGxzX2R5bmFtaWNfbWFuaWZlc3RzXzE1MDgyIjp7ImJ1Y2tldCI6InRydWVfYml0cmF0ZSIsInZlcnNpb24iOm51bGx9LCJ0ZndfbGVnYWN5X3RpbWVsaW5lX3N1bnNldCI6eyJidWNrZXQiOnRydWUsInZlcnNpb24iOm51bGx9LCJ0ZndfdHdlZXRfZWRpdF9mcm9udGVuZCI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9fQ%3D%3D&frame=false&hideCard=false&hideThread=false&id=996790447048613888&lang=en&origin=https%3A%2F%2Fdeveloper.x.com%2Fen%2Fdocs%2Fx-api%2Fenterprise%2Faccount-activity-api%2Foverview&sessionId=81f4a0339cbd7bd77b669faa00bd3a7224bc4418&theme=light&widgetsVersion=2615f7e52b7e0%3A1702314776716&width=550px" height="400px" />

<div id="feature-summary">
  ### Resumen de características
</div>

| Nivel | Precio | Número de suscripciones únicas | Número de webhooks | Confiabilidad y recuperación de actividad |
| :--- | :--- | :--- | :--- | :--- |
| Enterprise | [Contactar al equipo de ventas](/es/x-api/enterprise-gnip-2.0/enterprise-gnip) | Hasta 500+ | 3+  | [Reintentos](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#retries) y [Replay](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-replay-api) |

* ¿Tienes preguntas? ¿Te estás topando con errores?
  * Lee nuestras [preguntas frecuentes](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#frequently-asked-questions) o la [guía de solución de errores](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#frequently-asked-questions).

* Explora nuestro código de ejemplo:
  * [Enterprise Account Activity API dashboard](https://github.com/xdevplatform/account-activity-dashboard-enterprise), una aplicación web en Node.js que muestra eventos de webhook usando el nivel Enterprise de la API Account Activity e incluye funcionalidad de [Replay](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-replay-api).
  * El [SnowBot chatbot](https://github.com/xdevplatform/SnowBotDev), una aplicación web en Ruby creada sobre las APIs Enterprise Account Activity y Direct Message.

<div id="manage-webhooks-and-subscribed-users">
  ## Administrar webhooks y usuarios suscritos
</div>

**⏱ Lectura de 10 minutos**

La Account Activity API de nivel Enterprise proporciona mensajes JSON basados en webhooks cada vez que se producen eventos asociados a cuentas de X suscritas a tu servicio. X envía esas actividades a tu webhook registrado. En los siguientes pasos, aprenderás cómo administrar webhooks y usuarios suscritos.

Aprenderás cómo registrar, ver y eliminar tanto webhooks como usuarios suscritos. Usaremos comandos cURL sencillos para realizar solicitudes a los distintos endpoints de la API. cURL es una herramienta de línea de comandos para enviar o recibir solicitudes utilizando la sintaxis de URL.

Vas a necesitar:

* Una aplicación de X registrada - *[regístrate aquí](https://developer.x.com/content/developer-twitter/en/apps)*
* Un Bearer Token - *[más información](/es/resources/fundamentals/authentication#using-and-generating-an-app-only-bearer-token)*
* Un webhook que supere una comprobación de Challenge-Response (CRC) - *[más información](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#securing-webhooks)*
* Una cuenta Enterprise - *[solicítala aquí](https://developer.x.com/en/products/x-api/enterprise)*

*Antes de comenzar, te recomendamos que revises nuestro [repositorio de GitHub](https://github.com/xdevplatform/account-activity-dashboard), que proporciona una aplicación web de ejemplo y scripts de ayuda para empezar a trabajar con la Account Activity API de X.*

<div id="managing-a-webhook">
  #### Administración de un webhook:
</div>

Usar un webhook te permite suscribirte a actividades en tiempo real relacionadas con una cuenta de usuario a través de una única conexión. 

<Tabs>
  <Tab title="Añadir un webhook">
    Vamos a comenzar registrando una nueva URL de webhook para la aplicación correspondiente.

    La URL se validará mediante una solicitud CRC antes de guardarse. Una vez que hayas registrado un webhook, asegúrate de documentar el ID del webhook, ya que lo necesitarás más adelante.

    Copia la siguiente solicitud cURL en tu línea de comandos tras realizar los siguientes cambios:

    * **URL** `<URL>` por ejemplo, `https://yourdomain.com/webhooks/twitter/`

    * **Consumer key** `<CONSUMER_KEY>` por ejemplo, `xvz1evFS4wEEPTGEFPHBog`

    * **Access token** `<ACCESS_TOKEN>` por ejemplo,  `370773112-GmHxMAgYyLbNEtIKZeRNFsMKPR9EyMZeS9weJAEb`

      ```
      curl --request POST --url 'https://api.x.com/1.1/account_activity/webhooks.json?url=<URL>' --header 'authorization: OAuth oauth_consumer_key="<CONSUMER_KEY>", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="<ACCESS_TOKEN>", oauth_version="1.0"'
      ```
  </Tab>

  <Tab title="Ver un webhook">
    Ejecutaremos el siguiente comando para obtener todas las URLs de webhook registradas y sus estados para la aplicación indicada.

    Copia la siguiente solicitud cURL en tu línea de comandos tras realizar los siguientes cambios:

    * **Bearer Token** `<BEARER_TOKEN>` por ejemplo, `AAAAAAAAAAAA0%2EUifi76ZC9Ub0wn...`

      ```curl --request GET --url https://api.x.com/1.1/account_activity/webhooks.json --header 'authorization: Bearer <BEARER_TOKEN>'
      ```
  </Tab>

  <Tab title="Eliminar un webhook">
    Para eliminar un webhook de la configuración de la aplicación proporcionada, copia la siguiente solicitud cURL en tu línea de comandos tras realizar los siguientes cambios:

    * **Webhook ID** `<:WEBHOOK_ID>` por ejemplo, `1234567890`

    * **Consumer key** `<CONSUMER_KEY>` por ejemplo, `xvz1evFS4wEEPTGEFPHBog`

    * **Access token** `<ACCESS_TOKEN>` por ejemplo,  `370773112-GmHxMAgYyLbNEtIKZeRNFsMKPR9EyMZeS9weJAEb`

      ```curl --request DELETE --url https://api.x.com/1.1/account_activity/webhooks/<:WEBHOOK_ID>.json --header 'authorization: OAuth oauth_consumer_key="<CONSUMER_KEY>", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="<ACCESS_TOKEN>", oauth_version="1.0"'
      ```
  </Tab>
</Tabs>

<div id="managing-subscribed-users">
  #### Gestión de usuarios suscritos:
</div>

Una vez que hayas registrado un webhook, puedes añadir un usuario suscrito a la Account Activity API para empezar a recibir la actividad de su cuenta.

<Tabs>
  <Tab title="Agregar una suscripción">
    Comenzaremos suscribiendo a un usuario para que recibas todos los tipos de evento.

    Copia la siguiente solicitud de cURL en tu línea de comandos, tras actualizar lo siguiente:

    * **Webhook ID** `<:WEBHOOK_ID>` por ejemplo, `1234567890`

    * **Nombre de la consumer key** `<CONSUMER_KEY>` por ejemplo, `xvz1evFS4wEEPTGEFPHBog`

    * **Token de acceso del usuario que se suscribe** `<SUBSCRIBING_USER'S_ACCESS_TOKEN>` por ejemplo, `370773112-GmHxMAgYyLbNEtIKZeRNFsMKPR9EyMZeS9weJAEb`

      ```
      curl --request POST --url https://api.x.com/1.1/account_activity/webhooks/<:WEBHOOK_ID>/subscriptions/all.json --header 'authorization: OAuth oauth_consumer_key="<CONSUMER_KEY>", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="<SUBSCRIBING_USER'S_ACCESS_TOKEN>", oauth_version="1.0"'
      ```
  </Tab>

  <Tab title="Ver suscripciones">
    Para ver una lista de todas las suscripciones de tipos de actividad para un webhook específico, copia la siguiente solicitud de cURL en tu línea de comandos, tras actualizar lo siguiente:

    * **Webhook ID** `<:WEBHOOK_ID>` por ejemplo, `1234567890`

    * **Bearer Token** `<BEARER_TOKEN>` por ejemplo, `AAAAAAAAAAAA0%2EUifi76ZC9Ub0wn...`

      ```
      curl --request GET --url https://api.x.com/1.1/account_activity/webhooks/<:WEBHOOK_ID>/subscriptions/all/list.json --header 'authorization: Bearer <BEARER_TOKEN>'
      ```
  </Tab>

  <Tab title="Eliminar una suscripción">
    Tras la desactivación, todos los eventos del usuario solicitante dejarán de enviarse a la URL del webhook.

    Para desactivar una suscripción desde el contexto de usuario y la aplicación proporcionados, copia la siguiente solicitud de cURL en tu línea de comandos, tras actualizar lo siguiente:

    * **Webhook ID** `<:WEBHOOK_ID>` por ejemplo, `1234567890`

    * **Consumer key** `<CONSUMER_KEY>` por ejemplo, `xvz1evFS4wEEPTGEFPHBog`

    * **Token de acceso del usuario que se suscribe** `<SUBSCRIBING_USER'S_ACCESS_TOKEN>` por ejemplo, `370773112-GmHxMAgYyLbNEtIKZeRNFsMKPR9EyMZeS9weJAEb`

      ```
      curl --request DELETE --url https://api.x.com/1.1/account_activity/webhooks/:WEBHOOK_ID/subscriptions/all.json --header 'authorization: OAuth oauth_consumer_key="CONSUMER_KEY", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="SUBSCRIBED_USER'S_ACCESS_TOKEN", oauth_version="1.0"'
      ```
  </Tab>
</Tabs>

¡Buen trabajo! Ahora deberías poder gestionar tus webhooks y usuarios suscritos.

<div id="referenced-articles">
  #### Artículos relacionados
</div>

* [Descripción general de la verificación Challenge-Response (CRC)](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#securing-webhooks)
* [Tipos de datos de Account Activity](/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-data-object-structure
* [Administración de webhooks y suscripciones](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#managing-webhooks-and-subscriptions)

<div id="a-video-walkthrough-of-the-account-activity-api">
  ## Un recorrido en video de la Account Activity API
</div>

En este recorrido en video, aprenderás sobre las capacidades de los niveles premium y Enterprise de la Account Activity API.

Al final de este video, habrás aprendido lo siguiente:

* Registrar un webhook
* Añadir una suscripción de usuario
* Eliminar una suscripción de usuario
* Recibir actividades de cuenta
* Reproducir actividades de cuenta

<iframe src="https://platform.x.com/embed/Tweet.html?dnt=false&embedId=twitter-widget-0&features=eyJ0ZndfdGltZWxpbmVfbGlzdCI6eyJidWNrZXQiOltdLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X2ZvbGxvd2VyX2NvdW50X3N1bnNldCI6eyJidWNrZXQiOnRydWUsInZlcnNpb24iOm51bGx9LCJ0ZndfdHdlZXRfZWRpdF9iYWNrZW5kIjp7ImJ1Y2tldCI6Im9uIiwidmVyc2lvbiI6bnVsbH0sInRmd19yZWZzcmNfc2Vzc2lvbiI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9LCJ0ZndfZm9zbnJfc29mdF9pbnRlcnZlbnRpb25zX2VuYWJsZWQiOnsiYnVja2V0Ijoib24iLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X21peGVkX21lZGlhXzE1ODk3Ijp7ImJ1Y2tldCI6InRyZWF0bWVudCIsInZlcnNpb24iOm51bGx9LCJ0ZndfZXhwZXJpbWVudHNfY29va2llX2V4cGlyYXRpb24iOnsiYnVja2V0IjoxMjA5NjAwLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X3Nob3dfYmlyZHdhdGNoX3Bpdm90c19lbmFibGVkIjp7ImJ1Y2tldCI6Im9uIiwidmVyc2lvbiI6bnVsbH0sInRmd19kdXBsaWNhdGVfc2NyaWJlc190b19zZXR0aW5ncyI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9LCJ0ZndfdXNlX3Byb2ZpbGVfaW1hZ2Vfc2hhcGVfZW5hYmxlZCI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9LCJ0ZndfdmlkZW9faGxzX2R5bmFtaWNfbWFuaWZlc3RzXzE1MDgyIjp7ImJ1Y2tldCI6InRydWVfYml0cmF0ZSIsInZlcnNpb24iOm51bGx9LCJ0ZndfbGVnYWN5X3RpbWVsaW5lX3N1bnNldCI6eyJidWNrZXQiOnRydWUsInZlcnNpb24iOm51bGx9LCJ0ZndfdHdlZXRfZWRpdF9mcm9udGVuZCI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9fQ%3D%3D&frame=false&hideCard=false&hideThread=false&id=1204084171334832128&lang=en&origin=https%3A%2F%2Fdeveloper.x.com%2Fen%2Fdocs%2Fx-api%2Fenterprise%2Faccount-activity-api%2Fquick-start%2Fa-visual-walkthrough-of-the-account-activity-api&sessionId=b5b8e259a4c6287be2413de9059093170036fb30&theme=light&widgetsVersion=2615f7e52b7e0%3A1702314776716&width=550px" />

* ¿Tienes preguntas? ¿Te aparecen errores?
  * Lee nuestras [preguntas frecuentes](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#frequently-asked-questions) o la [guía de solución de errores](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#frequently-asked-questions).

* Explora nuestro código de ejemplo:
  * [Enterprise Account Activity API dashboard](https://github.com/xdevplatform/account-activity-dashboard-enterprise), una aplicación web en Node.js que muestra eventos de webhooks usando el nivel Enterprise de la Account Activity API e incluye funcionalidad de [Replay](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-replay-api).
  * El [SnowBot chatbot](https://github.com/xdevplatform/SnowBotDev), una aplicación web en Ruby basada en las APIs Enterprise Account Activity y Direct Message.

**Enterprise**

<div id="getting-started-with-webhooks">
  ## Introducción a los webhooks
</div>

La Account Activity API es una API basada en webhooks que envía eventos de cuenta a una aplicación web que desarrollas, despliegas y alojas. 

Hay varios detalles de infraestructura que requieren atención antes de que puedas empezar a recibir eventos de webhook en tu aplicación que consume eventos. Como se describe a continuación, deberás crear una aplicación de X, obtener acceso a la Account Activity API y desarrollar una aplicación web que consuma eventos de webhook. 

<div id="1-create-a-x-app">
  ### 1. Crea una aplicación de X.
</div>

* Crea una [aplicación de X](/es/resources/fundamentals/developer-apps) con una cuenta de desarrollador aprobada en el [portal para desarrolladores](/es/resources/fundamentals/developer-portal). Si estás creando la aplicación en nombre de tu empresa, se recomienda que la crees con una cuenta corporativa de X. Para solicitar una cuenta de desarrollador, [haz clic aquí](/es/resources/fundamentals/developer-apps).
* Habilita la opción “Read, Write and Access Direct Messages” en la pestaña de [permisos](/es/resources/fundamentals/developer-apps#oauth-1-0a-app-permissions) de la página de tu aplicación.
* En la pestaña &quot;Keys and Access Tokens&quot;, toma nota del Consumer Key (API Key) y del Consumer Token (API Secret) de tu aplicación.
* En la misma pestaña, genera el [Access Token y Access Token Secret](/es/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow) de tu aplicación. Necesitarás estos tokens de acceso para registrar la URL de tu webhook, que es donde X enviará los eventos de la cuenta.
* Si no estás familiarizado con [X Sign-in](/es/resources/fundamentals/authentication#log-in-with-x) y con cómo funcionan los contextos de usuario con la X API, revisa [Obtaining Access Tokens](https://dev.x.com/webhooks/access-tokens). A medida que añadas cuentas para recibir eventos, las suscribirás usando los tokens de acceso de esa cuenta.
* Toma nota del ID numérico de tu aplicación, tal como aparece en la página [&quot;Apps&quot;](/es/resources/fundamentals/developer-apps) del [portal para desarrolladores](/es/resources/fundamentals/developer-portal). Cuando solicites acceso a la Account Activity API, necesitarás este ID de la aplicación.
   

<div id="2-get-account-activity-api-access">
  ### 2. Obtener acceso a la Account Activity API
</div>

Después de crear una aplicación de X, el siguiente paso es solicitar acceso a la Account Activity API. 

La Account Activity API solo está disponible para Enterprise, por lo que deberás presentar una solicitud mediante el siguiente enlace.

<Button href="https://developer.x.com/en/enterprise-application.html">
  Solicitar acceso a Enterprise
</Button>

<div id="3-develop-webhook-consumer-app">
  ### 3. Desarrollar la aplicación consumidora de webhooks
</div>

Una vez que hayas recibido acceso a la Account Activity API, debes desarrollar, implementar y alojar una aplicación web que reciba eventos de webhooks de X. 

* Crea una aplicación web con una URL para usar como tu webhook para recibir eventos. Este es el endpoint desplegado en tu servidor para escuchar eventos entrantes de webhooks de X. 
  * El *path* del URI depende completamente de ti. Este ejemplo sería válido: https://mydomain.com&#95;/service/listen&#95;

  * Si estás escuchando webhooks desde una variedad de orígenes, un patrón común es: https://mydomain.com/webhook/twitter

  * Ten en cuenta que la URL especificada no puede incluir una especificación de puerto (https://mydomain.com:5000/NoWorkie).

* Como se describe en nuestra guía de [Protección de webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#securing-webhooks), un primer paso es escribir código que reciba una solicitud GET de Challenge Response Check (CRC) de X y responda con una respuesta JSON con el formato correcto. 

* Registra la URL de tu webhook. Harás una solicitud POST al endpoint /webhooks.json?url=. Cuando hagas esta solicitud, X enviará una solicitud CRC a tu aplicación web. Cuando un webhook se registra correctamente, la respuesta incluirá un id de webhook. Este id de webhook se necesita más adelante al hacer algunas solicitudes a la Account Activity API. 

* X enviará eventos de webhook de cuenta a la URL que registraste. Asegúrate de que tu aplicación web admita solicitudes POST para eventos entrantes. Estos eventos estarán codificados en JSON. Consulta [AQUÍ](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-data-object-structure) para ver ejemplos de cargas útiles JSON de webhooks.

* Una vez que tu aplicación web esté lista, el siguiente paso es añadir cuentas para recibir su actividad. Al añadir (o eliminar) cuentas, harás solicitudes POST haciendo referencia al id de la cuenta (account id). Consulta nuestra [guía sobre cómo añadir suscripciones](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#managing-webhooks-and-subscriptions) para obtener más información.

<div id="4-validate-setup">
  ### 4. Validar la configuración
</div>

* Para validar que tu aplicación y webhook estén configurados correctamente, marca como favorita una Publicación realizada por una de las cuentas de X a las que tu aplicación esté suscrita. Deberías recibir un `favorite_events` mediante una solicitud POST a la URL de tu webhook por cada favorito que reciban tus suscriptores.
* Ten en cuenta que la entrega de eventos puede tardar hasta 10 segundos en comenzar después de que se haya agregado una suscripción.

**Notas importantes**

* Al registrar la URL de tu webhook, tu aplicación web debe autenticarse con su consumer token y secret *y con el token de acceso de usuario del propietario de la aplicación y su secret*. 

* Todos los Mensajes Directos entrantes se entregarán mediante webhooks. Todos los Mensajes Directos enviados mediante [POST direct&#95;messages/events/new (message&#95;create)](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/new-event) también se entregarán mediante webhooks. Esto es para que tu aplicación web pueda conocer los Mensajes Directos enviados mediante un cliente diferente.

* Ten en cuenta que cada evento de webhook incluye un for&#95;user&#95;id (user ID) que indica para qué suscripción se entregó el evento.

* Si tienes dos usuarios que usan tu aplicación web para Mensajes Directos en la misma conversación, tu webhook recibirá dos eventos duplicados (uno por cada usuario). Tu aplicación web debe tener esto en cuenta. 

* Si tienes más de una aplicación web que comparte la misma URL de webhook y el mismo usuario asignado a cada aplicación, el mismo evento se enviará a tu webhook varias veces (una por cada aplicación web).

* En algunos casos, tu webhook puede recibir eventos duplicados. Tu aplicación de webhook debe tolerar esto y eliminar duplicados por id de evento.

* No esperes que la respuesta de Quick Reply siga directamente a una solicitud. Un usuario puede ignorar una solicitud de Quick Reply y responder mediante un Mensaje Directo tradicional. El usuario también puede proporcionar una respuesta de Quick Reply a una solicitud a la que no haya respondido antes en el hilo de mensajes.

* Consulta el código de ejemplo:
  * [Enterprise Account Activity API dashboard](https://github.com/xdevplatform/account-activity-dashboard-enterprise), una aplicación web en Node.js que muestra eventos de webhook usando el nivel Enterprise de la Account Activity API e incluye funcionalidad de [Replay](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-replay-api).

  * El [chatbot SnowBot](https://github.com/xdevplatform/SnowBotDev), una aplicación web en Ruby creada sobre las APIs de Account Activity y Direct Message. Este código incluye un [script](https://github.com/xdevplatform/SnowBotDev/wiki/Account-Activity-API-setup-script) para ayudar a configurar los webhooks de la Account Activity API.

<div id="securing-webhooks">
  ## Asegurar los webhooks
</div>

Las API de X basadas en webhooks proporcionan dos métodos para confirmar la seguridad de tu servidor de webhooks:

1. Las comprobaciones de desafío-respuesta permiten que X confirme la propiedad de la aplicación web que recibe los eventos de webhook. 
2. El encabezado de firma en cada solicitud POST te permite confirmar que X es el remitente de los webhooks entrantes.
    

<div id="challenge-response-checks">
  ### Comprobaciones de desafío-respuesta
</div>

Para verificar que eres tanto el propietario de la aplicación como de la URL del webhook, X realizará una comprobación de desafío-respuesta (CRC), que no debe confundirse con una comprobación de redundancia cíclica. Cuando se envía un CRC, X hará una solicitud GET a tu aplicación web con un parámetro *`crc_token`*. Cuando se reciba esa solicitud, tu aplicación web debe generar un `response_token` cifrado basado en el parámetro *`crc_token`* y en el Consumer Secret de tu aplicación (detalles a continuación). El `response_token` debe estar codificado en JSON (ver el ejemplo a continuación) y devolverse en un plazo de tres segundos. Si tiene éxito, se devolverá un `id` de webhook. 

Se enviará un CRC cuando registres tu URL de webhook, por lo que implementar tu código de respuesta CRC es un primer paso fundamental. Una vez que tu webhook esté establecido, X activará un CRC aproximadamente cada 24 horas desde la última vez que se recibió una respuesta correcta. Tu aplicación también puede activar un CRC cuando sea necesario realizando una solicitud PUT con el `id` de tu webhook. Activar un CRC es útil mientras desarrollas tu aplicación de webhook, después de implementar nuevo código y reiniciar tu servicio. 

Debe asumirse que el *`crc_token`* cambiará en cada solicitud CRC entrante y debe utilizarse como el mensaje en el cálculo, donde tu Consumer Secret es la clave.

En caso de que la respuesta no se envíe en un plazo de 3 segundos o resulte no válida, se dejarán de enviar eventos al webhook registrado.

<div id="the-crc-request-will-occur">
  #### La solicitud CRC se producirá:
</div>

* Cuando se registre una URL de webhook.
* Aproximadamente *cada hora* para validar la URL de tu webhook.
* Puedes activar manualmente un CRC haciendo una solicitud PUT. A medida que desarrolles tu cliente de webhook, deberías planear activar manualmente el CRC mientras implementas tu respuesta CRC. 
   

<div id="response-requirements">
  #### Requisitos de la respuesta:
</div>

* Un hash HMAC SHA-256 codificado en Base64 creado a partir del `crc_token` y el Consumer Secret de tu aplicación.
* `response_token` válido y en formato JSON.
* Latencia menor a 3 segundos.
* Código de respuesta HTTP 200.
   

<div id="language-specific-hmac-libraries">
  #### Bibliotecas HMAC específicas de cada lenguaje:
</div>

* [Java/Scala](https://docs.oracle.com/javase/8/docs/api/index.html?javax/crypto/Mac.html)
* [Ruby](http://ruby-doc.org/stdlib-2.1.0/libdoc/openssl/rdoc/OpenSSL/HMAC.html)
* [Node.js](https://nodejs.org/api/crypto.html#crypto_class_hmac)
* [Python](https://docs.python.org/2/library/hmac.html)

<div id="example-response-token-generation-in-python">
  #### Ejemplo de generación de token de respuesta en Python:
</div>

Lo siguiente define una ruta en una aplicación web Flask en Python 2.7 que responderá correctamente a la verificación de challenge-response.

```
import base64
import hashlib
import hmac
import json


\# Defines a route for the GET request
@app.route('/webhooks/twitter', methods=\['GET'\])
def webhook_challenge():

  # crea un hash HMAC SHA-256 a partir del token entrante y tu clave secreta de consumidor
  sha256\_hash\_digest = hmac.new(TWITTER\_CONSUMER\_SECRET, msg=request.args.get('crc_token'), digestmod=hashlib.sha256).digest()

  # construye los datos de respuesta con el hash codificado en base64
  response = {
    'response\_token': 'sha256=' + base64.b64encode(sha256\_hash_digest)
  }

  # devuelve una respuesta JSON con el formato correcto
  return json.dumps(response)
```

<div id="example-json-response">
  #### Ejemplo de respuesta JSON:
</div>

Con la ruta definida como se muestra arriba, tu aplicación web debería devolver una respuesta similar a la siguiente cuando navegues a [https://your-app-domain/webhooks/twitter?crc&#95;token=foo](https://your-app-domain/webhooks/twitter?crc_token=foo) en tu navegador web.

```
{
  "response_token": "sha256=x0mYd8hz2goCTfcNAaMqENy2BFgJJfJOb4PdvTffpwg="
}
```

<div id="other-examples">
  #### Otros ejemplos:
</div>

* [AQUÍ](https://github.com/xdevplatform/account-activity-dashboard/blob/master/helpers/security.js) hay un ejemplo de método de respuesta CRC escrito en Node/JS.
* [AQUÍ](https://github.com/xdevplatform/SnowBotDev/blob/master/app/controllers/snow_bot_dev_app.rb) hay un ejemplo de método de respuesta CRC escrito en Ruby (consulta *generate&#95;crc&#95;response* y la ruta /GET que recibe eventos CRC).

<div id="optional-signature-header-validation">
  ### Validación opcional del encabezado de firma
</div>

Cuando se recibe una solicitud POST de X, se envía una solicitud GET para crear un webhook o se envía una solicitud GET para realizar un CRC manual, se incluirá una firma hash en los encabezados como x-twitter-webhooks-signature. Esta firma se puede usar para validar que la fuente de los datos es X. La firma hash de POST comienza con sha256=, lo que indica el uso de HMAC SHA-256 para cifrar tu Consumer Secret de la Aplicación de X y el payload. El hash de GET se calcula a partir de la cadena de parámetros de consulta crc&#95;token=$token&amp;nonce=$nonce. 

**Pasos para validar una solicitud**

1. Crea un hash usando tu consumer secret y el cuerpo del payload entrante.
2. Compara el hash creado con el valor x-twitter-webhooks-signature codificado en base64. Usa un método como [compare&#95;digest](https://docs.python.org/2/library/hmac.html) para reducir la vulnerabilidad a ataques de temporización.

<div id="additional-security-guidelines">
  ### Pautas de seguridad adicionales
</div>

A continuación se presentan pautas de seguridad adicionales que debes considerar para tu aplicación web. No implementar estas pautas no impedirá el funcionamiento de tu webhook, pero el equipo de Seguridad de la Información de X las recomienda encarecidamente. Si no estás familiarizado con las recomendaciones que se indican a continuación, consulta con el administrador de tu servidor.

<div id="x-aggregate-network-blocks">
  #### Bloques de red agregados de X
</div>

Para aumentar la seguridad, puedes agregar los siguientes bloques de red agregados a una lista de permitidos:

* 199.59.148.0/22

* 199.16.156.0/22

* 192.133.77.0/26

* 64.63.15.0/24

* 64.63.31.0/24

* 64.63.47.0/24

* 202.160.128.0/24

* 202.160.129.0/24

* 202.160.130.0/24

<div id="recommended-server-configurations">
  #### Configuraciones de servidor recomendadas
</div>

* Calificación &quot;A&quot; en la prueba de [ssllabs.com](http://ssllabs.com/)
* **Habilitar TLS 1.2**
* Habilitar Forward Secrecy
* Desactivar SSLv2
* Desactivar SSLv3 (debido a POODLE)
* Desactivar TLS 1.0
* Desactivar TLS 1.1
* Desactivar TLS Compression
* Desactivar Session Tickets a menos que roten las claves de Session Tickets.
* Establecer la opción “ssl&#95;prefer&#95;server&#95;ciphers” o “SSLHonorCipherOrder” en la configuración SSL en “on”.
* Asegurarse de que la lista de cifrados sea una lista moderna, como:
  `ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES128-SHA256:AES128-SHA:AES256-GCM-SHA384:AES256-SHA256:AES256-SHA:ECDHE-RSA-DES-CBC3-SHA:DES-CBC3-SHA`

<div id="managing-webhooks-and-subscriptions">
  ## Administrar webhooks y suscripciones
</div>

<div id="creating-changing-webhooks">
  ### Creación y modificación de webhooks
</div>

Para cambiar la URL de un webhook, debes eliminar el webhook existente y luego crear uno nuevo. Ten en cuenta que, cuando hagas esto, deberás volver a añadir las suscripciones de usuario al nuevo webhook.

<div id="webhook-configuration-management-endpoints">
  #### Endpoints para la administración de la configuración de webhooks:
</div>

|     |     |
| :--- | :--- |
| **Método** | Enterprise |
| Registra una URL de webhook / Genera un webhook&#95;id | [POST webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#enterprise-account-activity-api) |
| Devuelve todas las URL de webhook y sus estados | [GET webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks) |
| Elimina la configuración de webhook actual de la aplicación | [DELETE webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id) |
| Activa manualmente una solicitud CRC | [PUT webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#put-account-activity-webhooks-webhook-id) |

<div id="why-cant-i-just-update-the-webhook-url">
  #### ¿Por qué no puedo simplemente actualizar la URL del webhook?
</div>

¿Por qué las configuraciones de webhook son inmutables? X se toma la seguridad muy en serio. Si tu URL de webhook cambia, existe la posibilidad de que la consumer key y el consumer secret de tu aplicación se hayan visto comprometidos. Al exigirte crear una nueva configuración de webhook, también debes volver a suscribirte a los eventos de tu usuario. Esto requiere el uso de tokens de acceso, a los que es menos probable que una parte maliciosa tenga acceso. Como resultado, se reduce la probabilidad de que otra parte reciba la información privada de tu usuario.
 

<div id="adding-removing-user-subscriptions">
  ### Agregar y eliminar suscripciones de usuario
</div>

El soporte para miles de suscripciones está disponible con el nivel Enterprise. Si ya cuentas con un responsable de cuenta, comunícate con esa persona si tienes preguntas. Para solicitar acceso a las API Enterprise, [haz clic aquí](https://developer.x.com/en/products/x-api/enterprise). 

<div id="subscription-management-endpoints">
  #### Endpoints para la gestión de suscripciones
</div>

|     |     |
| :--- | :--- |
| Método | Enterprise |
| Agregar nueva suscripción de usuario | [POST webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks-webhook-id-subscriptions-all) |
| Obtener una suscripción de usuario | [GET webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all) |
| Devuelve una lista de todas las suscripciones activas | [GET webhooks/:webhook&#95;id/subscriptions/all/list](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-subscriptions-count) |
| Desactiva una suscripción de usuario usando OAuth solo de aplicación | [DELETE webhooks/:webhook&#95;id/subscriptions/:user&#95;id/all.json](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-user-id-all-json) |

Account Activity API: Enterprise

<Note>
  **Tenga en cuenta**: 

  X debe habilitar el acceso a la Account Activity API para su aplicación de desarrollador antes de que pueda comenzar a usar la API. Para ello, asegúrese de compartir el id de la App que piensa utilizar para fines de autenticación con su gestor de cuenta o equipo de soporte técnico.
</Note>

La [Account Activity API](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity) consta de un conjunto de endpoints que le permiten crear y gestionar suscripciones de usuario para recibir actividades de cuenta en tiempo real para todas sus cuentas suscritas a través de una única conexión. 

Hay dos métodos de autenticación disponibles con la Account Activity API ([OAuth 1.0a](/es/resources/fundamentals/authentication#oauth-1-0a-2) y [OAuth 2.0 Bearer Token](/es/resources/fundamentals/authentication#bearer-token-also-known-as-app-only)). El método de autenticación que debe usar dependerá de qué endpoint esté utilizando.

|     |     |     |     |
| :--- | :--- | :--- | :--- |
| **Descripción** | **Endpoint ** | OAuth 1.0a  <br />(contexto de usuario) | OAuth 2.0 Bearer Token (solo de aplicación) |
| Registrar una nueva URL de webhook para el contexto de aplicación indicado | [POST account&#95;activity/webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks) | ✓   |     |
| Devolver todas las URL y sus estados para la aplicación indicada | [GET account&#95;activity/webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks) |     | ✓   |
| Activar una comprobación de respuesta de desafío (CRC) para la URL de un webhook dado | [PUT account&#95;activity/webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#put-account-activity-webhooks-webhook-id) | ✓   |     |
| Suscribir la aplicación a los eventos de cuenta de un usuario | [POST account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks-webhook-id-subscriptions-all) | ✓ * |     |
| Devolver el número de suscripciones actualmente activas | [GET account&#95;activity/subscriptions/count](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-subscriptions-count) |     | ✓   |
| Comprobar si una configuración de webhook está suscrita a los eventos de un usuario | [GET account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all) | ✓ * |     |
| Devolver una lista de suscripciones actualmente activas | [GET account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all/list](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all-list) |     | ✓   |
| Eliminar un webhook | [DELETE account&#95;activity/webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id) | ✓   |     |
| [OBSOLETO] Desactivar una suscripción para el contexto de usuario y la aplicación indicados | [DELETE account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated) | ✓ * |     |
| Desactivar una suscripción usando OAuth solo de aplicación | [DELETE /account&#95;activity/webhooks/:webhook&#95;id/subscriptions/:user&#95;id/all.json](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-user-id-all-json) |     | ✓   |
| Reentregar las actividades a un webhook | [POST /1.1/account&#95;activity/replay/webhooks/:webhook&#95;id/subscriptions/all.json](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#replay-api) |     | ✓   |

*&#95; La autenticación requiere los tokens de acceso del usuario suscriptor. &#95;

Para aquellos endpoints que requieren autenticación con contexto de usuario de OAuth 1.0a, deberás proporcionar las siguientes credenciales para autenticar la solicitud: 

* Claves de consumidor (API Key y Secret)
* Tokens de acceso (Access Token y Secret)

En el caso de los tres endpoints siguientes, realizas acciones de escritura dentro del contexto de tu aplicación (no hay usuarios de X involucrados). Por lo tanto, los tokens de acceso que debes proporcionar son los que pertenecen a tu aplicación de desarrollador. Estos se pueden generar directamente desde el [portal para desarrolladores](https://developer.x.com/en/portal/projects-and-apps), en la pestaña “Keys and tokens” de tu App.  

* [POST account&#95;activity/webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks): Registrar una nueva URL de webhook para el contexto de aplicación indicado
* [PUT account&#95;activity/webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#put-account-activity-webhooks-webhook-id): Activar una verificación de respuesta de desafío (CRC) para la URL del webhook especificado
* [DELETE account&#95;activity/webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id): Eliminar un webhook

Por otro lado, en el caso de los tres endpoints siguientes, realizarás una solicitud que permite que tu aplicación acceda a datos protegidos en nombre de un usuario de X (por ejemplo, Mensajes Directos). Por lo tanto, debes proporcionar los tokens de acceso que pertenecen al usuario suscriptor en cuestión. Los tokens de acceso requeridos se pueden obtener utilizando el flujo OAuth de tres patas (consulta [OAuth 1.0a: how to obtain a user’s Access Tokens](/es/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow)). Estos endpoints se han marcado con un asterisco en la tabla anterior (*).

* [POST account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks-webhook-id-subscriptions-all): Suscribir la aplicación a los eventos de la cuenta de un usuario
* [GET account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all): Comprobar si una configuración de webhook está suscrita a los eventos de un usuario
* [DELETE account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated): Desactivar una suscripción para el contexto de usuario y la aplicación proporcionados [OBSOLETO]

<Note>
  **Please note**: 

  Asegúrate de que tu aplicación de desarrollador esté habilitada para &quot;Read, Write, and Direct Messages.&quot; Puedes cambiar esta configuración en la [sección Projects &amp; Apps](https://developer.x.com/en/portal/projects-and-apps) de tu cuenta de desarrollador, en “App permissions” para la aplicación de desarrollador seleccionada. Necesitarás regenerar las credenciales de tu aplicación después de cambiar la configuración de permisos.
</Note>

Puedes encontrar una lista de todos los endpoints disponibles en la Account Activity API, junto con la descripción asociada y ejemplos de solicitudes cURL con ejemplos de implementación de autenticación, en [la documentación de referencia de la API](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-api-reference-index).

Para obtener información adicional, consulta la [aplicación web de ejemplo y los scripts auxiliares](https://github.com/xdevplatform/account-activity-dashboard-enterprise) de XDev para empezar a usar la Enterprise Account Activity API.

<Note>
  **Please note**: 

  X debe habilitar el acceso a la Account Activity API para tu aplicación de desarrollador antes de que puedas empezar a usar la API. Para ello, asegúrate de compartir el App ID que pretendes utilizar para la autenticación con tu gestor de cuenta o con el equipo de soporte técnico.
</Note>

La [Account Activity API](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity) consta de un conjunto de endpoints que te permiten crear y administrar suscripciones de usuario para recibir en tiempo real actividades de cuenta de todas tus cuentas suscritas a través de una única conexión. 

Hay dos métodos de autenticación disponibles con la Account Activity API ([OAuth 1.0a](/es/resources/fundamentals/authentication#oauth-1-0a-2) y [OAuth 2.0 Bearer Token](/es/resources/fundamentals/authentication#oauth-2-0)). El método de autenticación que debes utilizar dependerá del endpoint que estés usando.

|     |     |     |     |
| :--- | :--- | :--- | :--- |
| **Descripción** | **Endpoint ** | OAuth 1.0a  <br />(contexto de usuario) | OAuth 2.0 Bearer Token (solo aplicación) |
| Registrar una nueva URL de webhook para el contexto de aplicación dado | [POST account&#95;activity/webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks) | ✓   |     |
| Devolver todas las URL y sus estados para la aplicación dada | [GET account&#95;activity/webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks) |     | ✓   |
| Activar una comprobación de respuesta de desafío (CRC) para la URL de un webhook dado | [PUT account&#95;activity/webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#put-account-activity-webhooks-webhook-id) | ✓   |     |
| Suscribir la aplicación a los eventos de cuenta de un usuario | [POST account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks-webhook-id-subscriptions-all) | ✓ * |     |
| Devolver el número de suscripciones activas actualmente | [GET account&#95;activity/subscriptions/count](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-subscriptions-count) |     | ✓   |
| Verificar si una configuración de webhook está suscrita a los eventos de un usuario | [GET account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all) | ✓ * |     |
| Devolver una lista de suscripciones activas actualmente | [GET account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all/list](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all-list) |     | ✓   |
| Eliminar un webhook | [DELETE account&#95;activity/webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id) | ✓   |     |
| [OBSOLETO] Desactivar una suscripción para el contexto de usuario y la aplicación proporcionados | [DELETE account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated) | ✓ * |     |
| Desactivar una suscripción usando OAuth solo de aplicación | [DELETE /account&#95;activity/webhooks/:webhook&#95;id/subscriptions/:user&#95;id/all.json](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-user-id-all-json) |     | ✓   |
| Volver a entregar actividades a un webhook | [POST /1.1/account&#95;activity/replay/webhooks/:webhook&#95;id/subscriptions/all.json](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#replay-api) |     | ✓   |

*&#95; La autenticación requiere los tokens de acceso del usuario que se está suscribiendo. &#95;

Para aquellos endpoints que requieren autenticación con Contexto de usuario de OAuth 1.0a, deberás proporcionar las siguientes credenciales para autenticar la solicitud: 

* Claves de consumidor (API Key y Secret)
* Tokens de acceso (Access Token y Secret)

En el caso de los siguientes tres endpoints, realizas acciones de escritura dentro del contexto de tu aplicación (no hay usuarios de X involucrados). Por lo tanto, los tokens de acceso que debes proporcionar son los que pertenecen a tu aplicación de desarrollador. Estos se pueden generar directamente desde el [portal para desarrolladores](https://developer.x.com/en/portal/projects-and-apps), en la pestaña “Keys and tokens” de tu App.  

* [POST account&#95;activity/webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks): Registrar una nueva URL de webhook para el contexto de la aplicación indicada
* [PUT account&#95;activity/webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#put-account-activity-webhooks-webhook-id): Ejecutar una verificación de Challenge Response Check (CRC) para la URL de un webhook determinado
* [DELETE account&#95;activity/webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id): Eliminar un webhook

Por otro lado, en el caso de los siguientes tres endpoints, estás realizando una solicitud que permite que tu aplicación acceda a datos protegidos en nombre de un usuario de X (por ejemplo, Mensajes Directos). Por lo tanto, debes proporcionar los tokens de acceso que pertenecen al usuario suscrito en cuestión. Los tokens de acceso necesarios se pueden obtener utilizando el flujo OAuth de tres patas (consulta [OAuth 1.0a: how to obtain a user’s Access Tokens](/es/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow)). Estos endpoints se han marcado con un asterisco en la tabla anterior (*).

* [POST account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks-webhook-id-subscriptions-all): Suscribir la aplicación a los eventos de la cuenta de un usuario
* [GET account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all): Verificar si una configuración de webhook está suscrita a los eventos de un usuario
* [DELETE account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated): Desactivar una suscripción para el contexto de usuario y la aplicación proporcionados [OBSOLETO]

<Note>
  **Ten en cuenta**: 

  Asegúrate de que tu aplicación de desarrollador esté habilitada para &quot;Read, Write, and Direct Messages&quot;. Puedes cambiar esta configuración en la [sección Projects &amp; Apps](https://developer.x.com/en/portal/projects-and-apps) de tu cuenta de desarrollador, en “App permissions” para la aplicación de desarrollador seleccionada. Deberás regenerar las credenciales de tu App después de cambiar la configuración de permisos.
</Note>

Puedes encontrar una lista de todos los endpoints disponibles con la API de Account Activity, incluida la descripción asociada y ejemplos de solicitudes cURL con ejemplos de implementación de autenticación, en [la documentación de referencia de la API](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-api-reference-index).

Para obtener información adicional, consulta la [aplicación web de ejemplo y los scripts auxiliares](https://github.com/xdevplatform/account-activity-dashboard-enterprise) de XDev para comenzar a usar la Enterprise Account Activity API.

<div id="retries">
  ## Reintentos
</div>

`Enterprise`

Uno de los beneficios del nivel Enterprise de la Account Activity API es un mecanismo de reintento para los eventos de webhook. Si no se recibe un código de respuesta HTTP 200 &quot;success&quot;, el servidor de X iniciará un mecanismo de reintento, reenviando el evento de webhook hasta tres veces durante un período de cinco minutos. Este servicio de reintento de eventos de webhook contribuye a proporcionar fiabilidad y recuperación de eventos cuando se producen problemas de red y durante interrupciones y despliegues del servicio en el lado del cliente.
 

<div id="what-are-retries">
  ### ¿Qué son los reintentos?
</div>

La Account Activity API proporciona una funcionalidad de reintento cuando la aplicación web del cliente no devuelve una respuesta 200 de éxito para un evento de webhook de actividad de cuenta. Cuando el cliente no confirma la recepción correcta de un evento, X asume que el evento no se recibió. Si se recibe una respuesta distinta de 200, no se recibe una respuesta en un plazo de tres segundos o no recibimos ninguna respuesta, volvemos a intentar la solicitud y mantenemos la conexión abierta durante tres segundos. Esto significa que tienes aproximadamente cinco segundos, en dos intentos, para responder y así recibir la actividad que intentamos enviar a tu URL de webhook. En el caso de que tu servidor no responda o devuelva un error transitorio, volveremos a intentarlo durante cinco minutos. Habrá un total de tres intentos de reintento para confirmar la validación. Esto proporciona redundancia y garantiza que recibas todos los eventos de webhook. Ten en cuenta que las suscripciones con reintentos recibirán eventos reintentados para cualquiera o todas las actividades de todos los usuarios suscritos en su webhook.

Si no confirmas la validación dentro de estos ocho intentos, la actividad ya no estará disponible a través de la Account Activity API. 

<div id="retry-timeline">
  ### Cronograma de reintentos
</div>

La Account Activity API intentará reenviar hasta tres veces en un período de cinco minutos, hasta que se reciba una respuesta 200. Consulta la tabla a continuación para obtener más detalles. Después de aproximadamente cinco minutos, la actividad no se puede reenviar a través de la Account Activity API. Deberás usar otros endpoints de X para recopilar los datos que falten. Por ejemplo, las [APIs de búsqueda](/es/x-api/enterprise-gnip-2.0/fundamentals/search-api) se pueden usar para recuperar Publicaciones, Retweets, Quote Tweets, menciones y respuestas relevantes. Los Mensajes Directos omitidos se pueden recuperar con [este endpoint](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/list-events).

<div id="retries-timeline">
  #### Secuencia de reintentos
</div>

|     |
| :--- |
| Actividad creada, se realiza una solicitud POST a la URL del webhook desde la Account Activity API y se agota el tiempo de espera en tres segundos. |
| Espera tres segundos después de que finalice el tiempo de espera anterior, luego se realiza una solicitud POST a la URL del webhook desde la Account Activity API y se agota el tiempo de espera en tres segundos. |
| Espera 27 segundos después de que finalice el tiempo de espera anterior, luego se realiza una solicitud POST a la URL del webhook desde la Account Activity API y se agota el tiempo de espera en tres segundos. |
| Espera 242 segundos después de que finalice el tiempo de espera anterior, luego se realiza una solicitud POST a la URL del webhook desde la Account Activity API y se agota el tiempo de espera en tres segundos. |
| La Account Activity API dejará de intentar realizar solicitudes POST después de esto. El cliente debe usar otros endpoints de X para recuperar los datos. |

<div id="account-activity-data-object-structure">
  ## Estructura del objeto de datos de Account Activity
</div>

| Objeto | Detalles |
| :--- | :--- |
| for&#95;user&#95;id | Identifica la suscripción de usuario con la que está asociado el evento. |
| is&#95;blocked&#95;by | (condicional) Se muestra solo cuando otro usuario menciona a tu usuario suscrito. Se incluye con el valor true únicamente para eventos de menciones de Publicaciones. |
| source | El usuario que está realizando la actividad. Por ejemplo, el usuario que está siguiendo, bloqueando o silenciando es el usuario de origen. |
| target | El usuario al que se aplica la actividad. Por ejemplo, el usuario que está siendo seguido, bloqueado o silenciado es el usuario de destino. |

**Actividades disponibles**

| Tipo de mensaje | Detalles |
| :--- | :--- |
| [tweet&#95;create&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#tweet-create-events-posts-retweets-replies-quotetweets) | Carga útil del estado de la Publicación cuando se realiza cualquiera de las siguientes acciones por o hacia el usuario de la suscripción: Publicaciones, Retweets, Respuestas, @menciones, QuoteTweets, Retweet de QuoteTweets. |
| [favorite&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#favorite-events) | Estado del evento de favorito (me gusta) con el usuario y el destino. |
| [follow&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#follow-events) | Evento de seguimiento con el usuario y el destino. |
| [unfollow&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#unfollow-events) | Evento de dejar de seguir con el usuario y el destino. |
| [block&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#block-events) | Evento de bloqueo con el usuario y el destino. |
| [unblock&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#unblock-events) | Evento de desbloqueo con el usuario y el destino. |
| [mute&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#mute-events) | Evento de silenciar con el usuario y el destino. |
| [unmute&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#unmute-events) | Evento de dejar de silenciar con el usuario y el destino. |
| [user&#95;event](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#user-event) | Eventos de revocación enviados cuando un usuario elimina la autorización de la aplicación y la suscripción se elimina automáticamente. |
| [direct&#95;message&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#direct-message-events) | Estado de mensaje directo con el usuario y el destino cuando se envía o recibe un mensaje directo. |
| [direct&#95;message&#95;indicate&#95;typing&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#direct-message-indicate-typing-events) | Evento de escritura de mensaje directo con el usuario y el destino. |
| [direct&#95;message&#95;mark&#95;read&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#direct-message-mark-read-events) | Evento de lectura de mensaje directo con el usuario y el destino. |
| [tweet&#95;delete&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#tweet-delete-events) | Aviso de Publicaciones eliminadas para facilitar el mantenimiento del cumplimiento normativo. |

**Ejemplos de cargas útiles**

Consulta los ejemplos de cargas útiles a continuación para cada evento de Account Activity descrito en la tabla anterior.

<div id="tweet_create_events-posts-retweets-replies-quotetweets">
  #### tweet&#95;create&#95;events (Publicaciones, Retweets, Respuestas, Citas de publicaciones)
</div>

```
{
	"for_user_id": "2244994945",
	"tweet_create_events": [
	  {
		<Tweet Object>
	  }
	]
}
```

<div id="tweet_create_events-mentions">
  #### tweet&#95;create&#95;events (@menciones)
</div>

```
{
	"for_user_id": "2244994945",
	"user_has_blocked": "false",
	"tweet_create_events": [
	  {
		<Tweet Object>
	  }
	]
}
```

<div id="favorite_events">
  #### favorite&#95;events
</div>

```
{
	"for_user_id": "2244994945",
	"favorite_events": [{
		"id": "a7ba59eab0bfcba386f7acedac279542",
		"created_at": "Mon Mar 26 16:33:26 +0000 2018",
		"timestamp_ms": 1522082006140,
		"favorited_status": {
			<Tweet Object>
		},
		"user": {
			<User Object>
		}
	}]
}
```

<div id="follow_events">
  #### follow&#95;events
</div>

```
{
	"for_user_id": "2244994945",
	"follow_events": [{
			"type": "follow",
			"created_timestamp": "1517588749178",
			"target": {
				<User Object >
			},
			"source": {
				< User Object >
			}
		]
	}
}
```

<div id="unfollow_events">
  #### unfollow&#95;events
</div>

```
{
	"for_user_id": "2244994945",
	"follow_events": [{
			"type": "unfollow",
			"created_timestamp": "1517588749178",
			"target": {
				<User Object >
			},
			"source": {
				< User Object >
			}
		]
	}
}
```

<div id="block_events">
  #### block&#95;events
</div>

```
{
	"for_user_id": "2244994945",
	"block_events": [{
		"type": "block",
		"created_timestamp": "1518127020304",
		"source": {
			<User Object>
		},
		"target": {
			<User Object>
		}
	}]
}
```

<div id="unblock_events">
  #### unblock&#95;events
</div>

```
{
	"for_user_id": "2244994945",
	"block_events": [{
		"type": "unblock",
		"created_timestamp": "1518127020304",
		"source": {
			<User Object>
		},
		"target": {
			<User Object>
		}
	}]
}
```

<div id="mute_events">
  #### mute&#95;events
</div>

```
{
	"for_user_id": "2244994945",
	"mute_events": [
		{
			"type": "mute",
		  	"created_timestamp": "1518127020304",
			"source": {
				<User Object>
			},
			"target": {
				<User Object>
			}
		}
	]
}
```

<div id="unmute_events">
  #### unmute&#95;events
</div>

```
{
	"for_user_id": "2244994945",
	"mute_events": [
		{
			"type": "unmute",
		  	"created_timestamp": "1518127020304",
			"source": {
				<User Object>
			},
			"target": {
				<User Object>
			}
		}
	]
}
```

<div id="user_event">
  #### user&#95;event
</div>

```
{
	"user_event": {
		"revoke": {
			"date_time": "2018-05-24T09:48:12+00:00",
			"target": {
				"app_id": "13090192"
			},
			"source": {
				"user_id": "63046977"
			}
		}
	}
}
```

<div id="direct_message_events">
  #### direct&#95;message&#95;events
</div>

```
{
  	"for_user_id": "4337869213",
	"direct_message_events": [{
		"type": "message_create",
		"id": "954491830116155396",
		"created_timestamp": "1516403560557",
		"message_create": {
			"target": {
				"recipient_id": "4337869213"
			},
			"sender_id": "3001969357",
			"source_app_id": "13090192",
			"message_data": {
				"text": "¡Hola Mundo!",
				"entities": {
					"hashtags": [],
					"symbols": [],
					"user_mentions": [],
					"urls": []
				}
			}
		}
	}],
	"apps": {
		"13090192": {
			"id": "13090192",
			"name": "FuriousCamperTestApp1",
			"url": "https://x.com/furiouscamper"
		},
		"users": {},
		"3001969357": {
			"id": "3001969357",
			"created_timestamp": "1422556069340",
			"name": "Jordan Brinks",
			"screen_name": "furiouscamper",
			"location": "Boulder, CO",
			"description": "Alter Ego - X PE opinions-are-my-own",
			"url": "https://t.co/SnxaA15ZuY",
			"protected": false,
			"verified": false,
			"followers_count": 22,
			"friends_count": 45,
			"statuses_count": 494,
			"profile_image_url": "null",
			"profile_image_url_https": "https://pbs.twimg.com/profile_images/851526626785480705/cW4WTi7C_normal.jpg"
		},
		"4337869213": {
			"id": "4337869213",
			"created_timestamp": "1448312972328",
			"name": "Harrison Test",
			"screen_name": "Harris_0ff",
			"location": "Burlington, MA",
			"protected": false,
			"verified": false,
			"followers_count": 8,
			"friends_count": 8,
			"profile_image_url": "null",
			"statuses_count": 240,
			"profile_image_url_https": "https://abs.twimg.com/sticky/default_profile_images/default_profile_normal.png"
		}
	}
}
```

<div id="direct_message_indicate_typing_events">
  #### direct&#95;message&#95;indicate&#95;typing&#95;events
</div>

```
{
	"for_user_id": "4337869213",
	"direct_message_indicate_typing_events": [{
		"created_timestamp": "1518127183443",
		"sender_id": "3284025577",
		"target": {
			"recipient_id": "3001969357"
		}
	}],
	"users": {
		"3001969357": {
			"id": "3001969357",
			"created_timestamp": "1422556069340",
			"name": "Jordan Brinks",
			"screen_name": "furiouscamper",
			"location": "Boulder, CO",
			"description": "Alter Ego - X PE las-opiniones-son-mías",
			"url": "https://t.co/SnxaA15ZuY",
			"protected": false,
			"verified": false,
			"followers_count": 23,
			"friends_count": 47,
			"statuses_count": 509,
			"profile_image_url": "null",
			"profile_image_url_https": "https://pbs.twimg.com/profile_images/851526626785480705/cW4WTi7C_normal.jpg"
		},
		"3284025577": {
			"id": "3284025577",
			"created_timestamp": "1437281176085",
			"name": "Bogus Bogart",
			"screen_name": "bogusbogart",
			"protected": true,
			"verified": false,
			"followers_count": 1,
			"friends_count": 4,
			"statuses_count": 35,
			"profile_image_url": "null",
			"profile_image_url_https": "https://pbs.twimg.com/profile_images/763383202857779200/ndvZ96mE_normal.jpg"
		}
	}
}
```

<div id="direct_message_mark_read_events">
  #### direct&#95;message&#95;mark&#95;read&#95;events
</div>

```
{
	"for_user_id": "4337869213",
	"direct_message_mark_read_events": [{
		"created_timestamp": "1518452444662",
		"sender_id": "199566737",
		"target": {
			"recipient_id": "3001969357"
		},
		"last_read_event_id": "963085315333238788"
	}],
	"users": {
		"199566737": {
			"id": "199566737",
			"created_timestamp": "1286429788000",
			"name": "Le Braat",
			"screen_name": "LeBraat",
			"location": "Denver, CO",
			"description": "data by day @X, design by dusk",
			"protected": false,
			"verified": false,
			"followers_count": 299,
			"friends_count": 336,
			"statuses_count": 752,
			"profile_image_url": "null",
			"profile_image_url_https": "https://pbs.twimg.com/profile_images/936652894371119105/YHEozVAg_normal.jpg"
		},
		"3001969357": {
			"id": "3001969357",
			"created_timestamp": "1422556069340",
			"name": "Jordan Brinks",
			"screen_name": "furiouscamper",
			"location": "Boulder, CO",
			"description": "Alter Ego - X PE opinions-are-my-own",
			"url": "https://t.co/SnxaA15ZuY",
			"protected": false,
			"verified": false,
			"followers_count": 23,
			"friends_count": 48,
			"statuses_count": 510,
			"profile_image_url": "null",
			"profile_image_url_https": "https://pbs.twimg.com/profile_images/851526626785480705/cW4WTi7C_normal.jpg"
		}
	}
}
```

<div id="tweet_delete_events">
  #### tweet&#95;delete&#95;events
</div>

```
{
    "for_user_id": "930524282358325248",
    "tweet_delete_events": [
{
        "status": {
            "id": "1045405559317569537",
            "user_id": "930524282358325248"
        },
        "timestamp_ms": "1432228155593"
    }
   ]
}
```

<div id="account-activity-replay-api">
  ## API de Replay de actividad de cuenta
</div>

`Enterprise`

La API de Replay de actividad de cuenta es una herramienta de recuperación de datos que te permite recuperar eventos de hasta cinco días atrás. Debe utilizarse para recuperar datos en escenarios en los que tu servidor de [webhook](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#enterprise-account-activity-api) pierde eventos, ya sea debido a desconexiones que duren más que la [ventana de reintentos](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#retries) o en aquellos escenarios de recuperación ante desastres en los que necesitas unos días para restaurar tu sistema a la normalidad.

La API de Replay de actividad de cuenta se desarrolló para cualquier escenario en el que no puedas ingerir [actividades](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity) durante un período de tiempo. Entrega las actividades al mismo webhook utilizado para la entrega original en tiempo real de las actividades. Este producto es una herramienta de recuperación y no de backfill, lo que significa que los eventos solo se reproducirán si se intentó una entrega previa de ellos. La API de Replay de actividad de cuenta no puede entregar eventos para un período de tiempo anterior al momento de creación de la suscripción.

<div id="using-account-activity-replay-api">
  ### Uso de la Account Activity Replay API
</div>

Si tu cuenta está configurada con la funcionalidad de Replay, puedes hacer solicitudes de forma similar a las solicitudes a la Account Activity API. Es importante tener en cuenta que tu solicitud debe especificar un parámetro webhook id para indicar las actividades de qué webhook te gustaría reproducir. En otras palabras, una solicitud de Replay le pide a la Account Activity Replay API que recupere eventos desde una fecha y hora de inicio hasta una fecha y hora de finalización basándose en el webhook id y el id de la aplicación.

Ten en cuenta que se espera la hora en UTC. Estas actividades se entregan a través del webhook registrado asociado con el id, a una velocidad de hasta 2.500 eventos por segundo. También ten en cuenta que solo puede ejecutarse una tarea de Replay por webhook a la vez, aunque todas las suscripciones que estuvieron activas durante la fecha y hora especificadas en ese webhook se reproducirán.

Los eventos se entregan comenzando por el primer (más antiguo) minuto del período de tiempo especificado y continúan en orden cronológico (en la medida de lo posible) hasta que se entregue el último minuto. En ese momento, Replay entregará un [evento de finalización de trabajo](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#job-completed-successfully-message) al webhook. Debido a que trabajamos de forma cronológica al entregar actividades, si hay pocos o ningún resultado coincidente cerca de la hora de inicio, probablemente habrá un período de tiempo antes de que se entreguen los primeros resultados.

<div id="limitations">
  ### Limitaciones
</div>

Replay está diseñado como una herramienta para recuperar fácilmente actividades de hasta cinco días atrás, pero no proporcionará eventos anteriores al momento de creación de una suscripción. Por ejemplo, si hace tres días agregaste una nueva suscripción y ejecutaste un trabajo de Replay con una ventana de cinco días anteriores a hoy, solo recibirías datos de los tres días en los que esta nueva suscripción estuvo activa.

<div id="data-availability-and-types">
  ### Disponibilidad y tipos de datos
</div>

Las actividades de la Account Activity Replay API están disponibles durante cinco días a partir del inicio de la solicitud, y los datos nuevos están disponibles aproximadamente 10 minutos después de que se crea una actividad determinada. Podrás realizar solicitudes especificando un intervalo de tiempo dentro de esta ventana de cinco días mediante los parámetros from&#95;date y to&#95;date en la solicitud. Los eventos que se entregaron originalmente antes de tener acceso a Replay no se pueden volver a reproducir. Por ejemplo, si se habilitó el acceso de tu cuenta a la Account Activity Replay API el 1 de junio de 2019 a las 3:30 p. m. UTC, no podrás usar Replay para recuperar ningún evento anterior a esa fecha y hora.

Continúa con la [referencia de la Account Activity Replay API](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated)

<div id="migration-introduction">
  ## Introducción a la migración
</div>

**Retiramos los productos Site Streams, User Streams y la versión beta estándar de Account Activity API - DM Only en 2018. Si has estado usando esos productos, asegúrate de migrar a la versión premium o Enterprise de la API Account Activity.**

**También retiramos los endpoints heredados de Mensajes Directos. Si has estado usando esos endpoints, asegúrate de migrar a los nuevos endpoints de DM o a la versión premium o Enterprise de la API Account Activity. **

**Consulta [este anuncio](https://devcommunity.x.com/t/details-and-what-to-expect-from-the-api-deprecations-this-week-on-august-16-2018/110746) para obtener más información.**

Estos son los endpoints que se verán afectados por estos cambios:

* User Streams
* Site Streams
* GET direct&#95;messages
* GET direct&#95;messages/sent
* GET direct&#95;messages/show
* POST direct&#95;messages/new
* POST direct&#95;messages/destroy
   

Disponemos de nuevos endpoints y servicios que proporcionan un acceso similar y, en el caso de los Mensajes Directos, funcionalidades adicionales:

* API Account Activity [Enterprise](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#enterprise-account-activity-api) y [premium](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-api-reference-index)
* [GET direct&#95;messages/events/list](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/list-events)
* [GET direct&#95;messages/events/show](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/get-event)
* [POST direct&#95;messages/events/new](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/new-event)
* [POST direct&#95;messages/events/destroy](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/delete-message-event)

Para ayudarte a realizar una migración fluida a estos nuevos endpoints y servicios, disponemos de dos guías de migración:

* [Guía de migración de API Account Activity](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#migration-guide-moving-from-user-streams-site-streams-to-account-activity-api) para quienes pasan de User Streams y Site Streams a nuestro nuevo servicio basado en webhooks
* [Guía de migración de Mensajes Directos](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/guides/direct-message-migration) para quienes migran entre endpoints REST de Mensajes Directos
   

Además, tenemos una [serie de videos](https://www.youtube.com/playlist?list=PLFKjcMIU2WshGG6Yj940XM7Z6BFs1zfBg) sobre la API Account Activity y cómo comenzar.

Y, por último, contamos con ejemplos de código para profundizar tu comprensión y ayudarte a comenzar rápidamente:

* El [Account Activity Dashboard](https://github.com/xdevplatform/Account-Activity-dashboard) es una aplicación web de ejemplo en Node.js con scripts auxiliares para comenzar a usar la API Account Activity.
* [SnowBot](https://github.com/xdevplatform/SnowBotDev) es un chatbot de ejemplo que utiliza la API Account Activity y los endpoints REST de Mensajes Directos. Está escrito en Ruby, usa el framework web Sinatra y está implementado en Heroku.

<div id="migration-guide-moving-from-user-streamssite-streams-to-account-activity-api">
  ## Guía de migración: pasar de User Streams/Site Streams a Account Activity API
</div>

**A partir del 23 de agosto de 2018, retiramos tanto Site Streams como User Streams. Asegúrate de migrar a Account Activity API.**

**Revisa [este anuncio](https://devcommunity.x.com/t/details-and-what-to-expect-from-the-api-deprecations-this-week-on-august-16-2018/110746) para obtener más información.**

Esta guía está diseñada para ayudarte a migrar de las APIs heredadas de User Streams y Site Streams a su sustituto, la Account Activity API. A continuación encontrarás un resumen de los cambios, una lista de las nuevas características, así como las diferencias y consideraciones clave para facilitar la transición. Para obtener orientación sobre la migración desde endpoints básicos de mensajes directos, consulta la [guía de migración de mensajes directos](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/guides/direct-message-migration).

<div id="summary-of-changes">
  ### Resumen de los cambios
</div>

La Account Activity API te proporcionará eventos de cuentas autenticadas y suscritas a través de webhooks, en lugar de mediante una conexión de streaming como en User Streams y Site Streams.

<div id="deprecated-apis">
  #### API obsoletas
</div>

GET user

GET site  (incluidos los flujos de control: GET site/c/:stream&#95;id,  GET site/c/:stream&#95;id/info.json,  GET site/c/:stream&#95;id/friends/ids.json,  POST site/c/:stream&#95;id/add&#95;user.json,  POST /site/c/:stream&#95;id/remove&#95;user.json)

<div id="replacement-apis">
  #### APIs de reemplazo
</div>

[Enterprise Account Activity API - Toda la actividad](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#enterprise-account-activity-api)

<div id="differences-migration-considerations">
  ### Diferencias y consideraciones de migración
</div>

**Formato de la API:** La nueva Account Activity API funciona de manera diferente a User Streams y Site Streams. Deberás modificar tu aplicación web para recibir datos mediante webhooks. Puedes encontrar más información sobre webhooks [aquí](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#getting-started-with-webhooks).

**Datos disponibles:** Otra diferencia clave que notarás es con respecto a los datos que se entregan. X ya no enviará eventos de las personas a las que sigues en X (es decir, tu cronología de inicio). Este fue un cambio intencional y no es algo que tengamos previsto modificar en el futuro.

**Confiabilidad:** A diferencia del streaming, los webhooks permiten la confirmación de entrega y ofrecen opciones para reintentar las actividades enviadas mediante POST que no se entregan a la URL del webhook. Esto brinda mayor garantía de que la aplicación está recibiendo todas las actividades correspondientes, incluso si hay breves desconexiones o períodos de inactividad.

<div id="new-features">
  ### Nuevas funcionalidades
</div>

La API de Account Activity ofrece muchas funcionalidades nuevas, entre ellas el hecho de que los datos ahora se entregan mediante webhooks en lugar de streaming. Los webhooks ofrecen muchas ventajas frente al streaming, pero las más destacadas son la velocidad y la fiabilidad. La API te enviará datos en forma de eventos JSON a medida que estén disponibles y ya no necesitarás mantener una conexión activa ni consultar periódicamente el endpoint. Esto reduce la necesidad de mecanismos de redundancia y aumenta la eficiencia en general. Puedes encontrar más información sobre webhooks en la [documentación técnica](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#getting-started-with-webhooks).

<div id="managing-user-subscriptions">
  ### Gestión de suscripciones de usuarios
</div>

La API Account Activity permite múltiples suscripciones para un único webhook registrado. Esto permite que la actividad de múltiples suscripciones de usuario se entregue en el mismo destino, de forma similar a la arquitectura de Site Streams, pero con webhooks. Esto significa que puedes hacer un seguimiento de las suscripciones, en relación con tus límites de suscripción, de forma independiente de la conexión del webhook. Esto también permite escalar desde solo una o unas pocas suscripciones hasta miles de suscripciones para un único webhook.

<div id="how-to-migrate">
  ### **Cómo migrar**
</div>

<div id="follow-the-steps-below-to-easily-migrate-from-the-site-streams-api-to-the-account-activity-api">
  ### **Sigue los pasos a continuación para migrar fácilmente de la Site Streams API a la Account Activity API**
</div>

**Paso 1: Elige un paquete**

Según cómo estés operando actualmente con User Streams o Site Streams, deberías considerar pasar a la versión Enterprise o Premium de la Account Activity API. Ten en cuenta la cantidad de aplicaciones o de usuarios autorizados que estás admitiendo actualmente y ajústalo al volumen y la fiabilidad que necesitas. Al decidir el paquete que mejor se adapta a tus necesidades, algunos aspectos que vale la pena considerar son:

* Número de webhooks necesarios
* Suscripciones/usuarios autorizados actuales/proyectados gestionados en tu aplicación
* Número actual de aplicaciones cliente de X
* El nivel de soporte que prefieres de X (soporte mediante foro o soporte Enterprise gestionado 1:1)
* Precio de cada paquete

**Paso 2:** **Comprueba la configuración de tu aplicación de X en el portal para desarrolladores**

La [aplicación de X](/es/resources/fundamentals/developer-apps) que se utiliza actualmente para User Streams o Site Streams aparecerá para el usuario propietario dentro del [portal para desarrolladores](/es/resources/fundamentals/developer-portal). Esta aplicación de X también se puede usar para Account Activity API y así conservar los usuarios autorizados de esa aplicación. También se puede crear una nueva aplicación y volver a autorizar a los usuarios para esta nueva aplicación si se desea. Si estás creando una nueva aplicación en nombre de una empresa, se recomienda que crees la aplicación con una cuenta corporativa de X @handle.

* Habilita “Read, Write and Access direct messages” en la pestaña [permissions](/es/resources/fundamentals/developer-apps#app-permissions) de la página de tu aplicación de X. 
  *Ten en cuenta que cambiar esta configuración no es retroactivo; cualquier usuario autorizado conservará la configuración de autorización del momento en que fue autorizado. Si un usuario aún no te ha concedido acceso de lectura, escritura y a mensajes directos, tendrás que hacer que ese usuario vuelva a autorizar tu aplicación.
* Si no estás familiarizado con [X Sign-in](/es/resources/fundamentals/authentication#log-in-with-x) y con cómo funcionan los contextos de usuario con la X API, revisa [Obtaining Access Tokens](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#getting-started-with-webhooks).
* Genera tokens de acceso para el propietario de la aplicación de X en la parte inferior de la pestaña “Keys and Tokens”. En esta misma pestaña, toma nota de tu Consumer Key, Consumer Secret, Access Token y Access Token Secret. Los necesitarás para usar la API.
* Genera un Bearer Token usando tu Consumer Key y Consumer Secret para métodos de API de [application-only](/es/resources/fundamentals/authentication#bearer-token-also-known-as-app-only).

**Paso 3: Configura tu webhook**

* Crea una aplicación web con un endpoint para usar como webhook para recibir eventos (por ejemplo, https://your&#95;domain.com/webhook/twitter o https://webhooks.your&#95;domain.com).

* Usa tu Consumer Key, Consumer Secret, Access Token y Access Token Secret cuando crees tu webhook. Ten en cuenta que tu endpoint debe devolver una respuesta JSON con un response&#95;token que sea un hash HMAC SHA-256 codificado en base64 creado a partir del crc&#95;token y tu Consumer Secret de la aplicación.

* Revisa la documentación [Securing Webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#securing-webhooks), prestando especial atención a los requisitos de Challenge Response Check (CRC).

* Asegúrate de que tu webhook admita solicitudes POST para eventos entrantes y solicitudes GET para el CRC.

* Asegúrate de que tu webhook tenga baja latencia (&lt;3 segundos para responder a las solicitudes POST).

**Paso 4: Valida la configuración de tu webhook**

* Las APIs de webhooks protegerán tus webhooks de dos maneras:

               - Requerir comprobaciones Challenge Response para validar que el propietario del webhook es el propietario de la aplicación web.

               - Un encabezado de firma en cada solicitud POST para que tu aplicación web valide el origen.

* Para verificar que eres tanto el propietario de la aplicación web como de la URL del webhook, X llevará a cabo un Challenge Response Check (CRC), que no debe confundirse con una verificación de redundancia cíclica.
* Se enviará una solicitud GET con un parámetro llamado crc&#95;token a la URL de tu webhook. Tu endpoint debe devolver una respuesta JSON con un response&#95;token que sea un hash HMAC SHA-256 codificado en base64 creado a partir del crc&#95;token y tu Consumer Secret de la aplicación.
* Se debe esperar que el crc&#95;token cambie en cada solicitud CRC entrante. El crc&#95;token debe usarse como mensaje en el cálculo, donde tu Consumer Secret es la clave.
* En caso de que la respuesta no sea válida, se dejarán de enviar eventos al webhook registrado.

**Paso 5: Crea suscripciones para cada usuario autorizado de User Stream o Site Streams**

Conversión de User Streams a Account Activity API:

* Obtén una lista de tus suscripciones de usuario actuales en User Streams
* Configura tus nuevas suscripciones de Account Activity API usando la solicitud:  *POST account&#95;activity/all/:env&#95;name/subscriptions*
* Confirma tus suscripciones de Account Activity API usando la solicitud:  &#95;GET account&#95;activity/all/:env&#95;name/subscriptions/list
   &#95;

Conversión a Account Activity API desde Site Streams: (usando streams de control):

* Obtén una lista de tus suscripciones actuales en Site Streams usando la solicitud:  *GET /1.1/site/c/:stream&#95;id/info.json*
* Configura tus nuevas suscripciones de Account Activity API usando la solicitud:  *POST account&#95;activity/all/:env&#95;name/subscriptions*
* Confirma tus suscripciones de Account Activity API usando la solicitud:  &#95;GET account&#95;activity/all/:env&#95;name/subscriptions/list
   &#95;

Registro de un webhook y creación de suscripciones (cuando no se migra desde Site Streams o User Streams)

* Registra la URL de tu webhook con tu aplicación usando [POST webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#enterprise-account-activity-api) y recibe un webhook&#95;id.
* Usa el webhook&#95;id devuelto para agregar suscripciones de usuario con [POST webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks-webhook-id-subscriptions-all).

<div id="the-account-activity-dashboard-sample-account-activity-api-application">
  ### El panel de Account Activity (aplicación de ejemplo de la Account Activity API)
</div>

Hemos creado una aplicación de ejemplo para que probar la Account Activity API sea un poco más rápido:   

* Descarga la aplicación de ejemplo Account Activity Dashboard [aquí](https://github.com/xdevplatform/Account-Activity-dashboard) (usa Node.js)
* Sigue las instrucciones del README para instalar e iniciar la aplicación
* Una vez que la aplicación esté en ejecución, puedes usar la interfaz de usuario (UI) para configurar fácilmente tu webhook y crear una nueva suscripción

<div id="available-activities">
  ### Actividades disponibles
</div>

| Tipo de mensaje | Detalles |
| :--- | :--- |
| [tweet&#95;create&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#tweet-create-events-posts-retweets-replies-quotetweets) | Carga útil del estado de la Publicación cuando cualquiera de las siguientes acciones es realizada por el usuario de la suscripción o dirigida a él: Publicaciones, Retweets, respuestas, @menciones, QuoteTweets |
| [favorite&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#favorite-events) | Estado del evento de favorito (Me gusta) entre el usuario y el destinatario. |
| [follow&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#follow-events) | Evento de seguir entre el usuario y el destinatario. |
| [block&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#block-events) | Evento de bloqueo entre el usuario y el destinatario. |
| [mute&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#mute-events) | Evento de silenciar entre el usuario y el destinatario. |
| [direct&#95;message&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#direct-message-events) | Estado del mensaje directo entre el usuario y el destinatario. |
| [direct&#95;message&#95;indicate&#95;typing&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#direct-message-indicate-typing-events) | Evento de escritura de mensaje directo entre el usuario y el destinatario. |
| [direct&#95;message&#95;mark&#95;read&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#direct-message-mark-read-events) | Evento de lectura de mensaje directo entre el usuario y el destinatario. |

<div id="deprecated-streaming-message-types">
  ### Tipos de mensajes de streaming obsoletos
</div>

|     |     |
| :--- | :--- |
| Líneas en blanco | Las líneas en blanco ya no se entregarán en la Account Activity API, ya que se utilizaban como mensajes de keep-alive en User Streams y Site Streams. |
| Avisos de límite | Los avisos de límite ya no se enviarán a un webhook determinado. En su lugar, los usuarios pueden llamar a la API para obtener el uso actual de los handles disponibles. Esto se incluirá en el portal para desarrolladores en algún momento en el futuro. |
| Mensajes de desconexión | Los avisos de desconexión ya no serán necesarios, ya que los webhooks no dependen de una conexión activa. |
| Advertencias de bloqueo | Las advertencias de bloqueo ya no serán necesarias, ya que los webhooks no dependen de una conexión activa capaz de manejar grandes volúmenes de mensajes entrantes. |
| Lista de amigos | Las listas de amigos ya no se enviarán automáticamente. Ahora habrá un endpoint REST para obtener esta información. |

<div id="deprecated-event-types">
  ### Tipos de eventos obsoletos
</div>

|     |     |     |     |     |
| :--- | :--- | :--- | :--- | :--- |
| **Descripción** | **Nombre del evento** | **Origen** | **Destino** | **Objeto de destino** |
| El usuario elimina una Publicación | delete | Usuario actual | Usuario actual | Publicación |
| Un usuario seguido elimina una Publicación | delete | Usuario seguido | Usuario seguido | Publicación |
| El usuario quita el Me gusta a una Publicación | unfavorite | Usuario actual | Autor de la Publicación | Publicación |
| Se quita el Me gusta de la Publicación del usuario | unfavorite | Usuario que quita el Me gusta | Usuario actual | Publicación |
| El usuario deja de seguir a alguien | unfollow | Usuario actual | Usuario seguido | Null |
| El usuario crea una Lista | list&#95;created | Usuario actual | Usuario actual | Lista |
| El usuario elimina una Lista | list&#95;destroyed | Usuario actual | Usuario actual | Lista |
| El usuario edita una Lista | list&#95;updated | Usuario actual | Usuario actual | Lista |
| El usuario añade a alguien a una Lista | list&#95;member&#95;added | Usuario actual | Usuario añadido | Lista |
| El usuario es añadido a una Lista | list&#95;member&#95;added | Usuario que añade | Usuario actual | Lista |
| El usuario elimina a alguien de una Lista | list&#95;member&#95;removed | Usuario actual | Usuario eliminado | Lista |
| El usuario es eliminado de una Lista | list&#95;member&#95;removed | Usuario que elimina | Usuario actual | Lista |
| El usuario se suscribe a una Lista | list&#95;user&#95;subscribed | Usuario actual | Propietario de la Lista | Lista |
| Alguien se suscribe a la Lista del usuario | list&#95;user&#95;subscribed | Usuario que se suscribe | Usuario actual | Lista |
| El usuario cancela la suscripción a una Lista | list&#95;user&#95;unsubscribed | Usuario actual | Propietario de la Lista | Lista |
| Alguien cancela la suscripción a la Lista del usuario | list&#95;user&#95;unsubscribed | Usuario que cancela la suscripción | Usuario actual | Lista |
| El usuario actualiza su perfil | user&#95;update | Usuario actual | Usuario actual | Null |
| El usuario actualiza su estado protegido | user&#95;update | Usuario actual | Usuario actual | Null |

<div id="direct-message-migration-guide">
  ## Guía de migración de Mensajes Directos
</div>

**El 17 de septiembre de 2018 retiramos los endpoints heredados de Mensajes Directos.
Si has estado usando esos endpoints, asegúrate de migrar a los nuevos endpoints de Mensajes Directos o a Account Activity API.**

**Consulta [este anuncio](https://devcommunity.x.com//t/details-and-what-to-expect-from-the-api-deprecations-this-week-on-august-16-2018/110746) para obtener más información.**

Esta guía está diseñada para ayudarte a migrar de las APIs REST heredadas de Mensajes Directos a sus reemplazos mejorados, que han pasado de la fase beta. A continuación encontrarás un resumen de los cambios, una lista de nuevas funciones y las diferencias y consideraciones clave para ayudarte con la transición. Los nuevos endpoints de Mensajes Directos ya están disponibles para todos los desarrolladores. Para obtener orientación sobre cómo migrar desde User Streams o Site Streams, consulta la [guía de migración a Account Activity API](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#migration-guide-moving-from-user-streams-site-streams-to-account-activity-api).

* [Resumen de cambios](#summary)
* [Nuevas funciones](#features)
* [Envío de Mensajes Directos](#sending)
* [Recepción de Mensajes Directos](#receiving)
* [Eliminación de Mensajes Directos](#deleting)

<div id="summary-of-changes">
  ### Resumen de los cambios
</div>

Si todavía estás utilizando los siguientes endpoints de MD, tendrás que migrar a los endpoints más nuevos. 

| Endpoint obsoleto | Nueva alternativa de migración |
| :--- | :--- |
| [POST direct&#95;messages/new](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/new-event) | [POST direct&#95;messages/events/new](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/new-event) |
| [GET direct&#95;messages/show](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/get-event) | [GET direct&#95;messages/events/show](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/get-event) |
| [GET direct&#95;messages](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/list-events) | [GET direct&#95;messages/events/list](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/list-events) |
| [GET direct&#95;messages/sent](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/get-event) | [GET direct&#95;messages/events/list](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/list-events) |
| [POST direct&#95;messages/destroy](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/delete-message-event) | [DELETE direct&#95;messages/events/destroy](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/delete-message-event "GET direct_messages/events/list") |

<div id="new-features">
  ### Nuevas funcionalidades
</div>

Los nuevos endpoints de la API de Mensajes Directos admiten varias funcionalidades nuevas y proporcionan un acceso mejorado a Mensajes Directos anteriores. Las nuevas funcionalidades incluyen:

* Compatibilidad con archivos adjuntos de contenido multimedia (imagen, GIF y video).
* Posibilidad de solicitar a los usuarios respuestas estructuradas con una lista de opciones predefinida.
* Hasta 30 días de acceso a Mensajes Directos anteriores.

Para ver la lista completa de las nuevas funcionalidades de Mensajes Directos y los nuevos endpoints de la API adicionales, consulta la [documentación técnica](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/overview).
 

<div id="differences-migration-considerations">
  ### Diferencias y consideraciones de migración
</div>

Los nuevos endpoints de la API se comportan de manera muy diferente a sus versiones anteriores. Simplemente actualizar las URL de los endpoints provocará errores en tu aplicación. Ten en cuenta lo siguiente al actualizar tu aplicación para la migración.

<div id="new-direct-message-object">
  #### Nuevo objeto de Mensaje Directo
</div>

Lo primero que probablemente notarás es la nueva estructura de objeto de los Mensajes Directos. Esta nueva estructura de objeto Message Create se ha introducido para admitir nuevas funcionalidades como [Quick Replies](https://developer.x.com/en/docs/x-api/v1/direct-messages/quick-replies/overview) y [Attachments](https://developer.x.com/en/docs/x-api/v1/direct-messages/message-attachments/overview). El nuevo objeto también contiene un objeto de usuario más pequeño y condensado. Será necesario actualizar tu aplicación para tener en cuenta esta nueva estructura de objeto al analizar los mensajes y, potencialmente, en los modelos de datos o el almacenamiento. Para obtener descripciones de cada propiedad, consulta la [documentación completa sobre el objeto Message Create](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/guides/message-create-object).

**Ejemplo de objeto Message Create**

```json
{
      "type": "message_create",
      "id": "1234858592",
      "created_timestamp": "1392078023603",
      "initiated_via": {
        "tweet_id": "123456",
        "welcome_message_id": "456789"
      },
      "message_create": {
        "target": {
          "recipient_id": "1234858592"
        },
        "sender_id": "3805104374",
        "source_app_id": "268278",
        "message_data": {
          "text": "Blue Bird",
          "entities": {
            "hashtags": [],
            "symbols": [],
            "urls": [],
            "user_mentions": [],
          },
          "quick_reply_response": {
            "type": "options",
            "metadata": "external_id_2"
          },
          "attachment": {
            "type": "media",
            "media": {
             ...
            }
          }
        }
      }
```

<div id="summary">
  #### Resumen
</div>

* Nueva estructura del objeto de Mensaje Directo.
* Objeto de usuario simplificado.
* Nueva información disponible (respuestas de respuesta rápida, archivos adjuntos, etc.).

<div id="sending-direct-messages">
  ### Envío de Mensajes Directos
</div>

[POST direct&#95;messages/events/new](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/new-event) es un sustituto directo para enviar Mensajes Directos. La diferencia más importante con este endpoint es que ahora toda la información se envía como JSON en el cuerpo de la solicitud POST, en lugar de parámetros POST individuales.

**Ejemplo de solicitud Twurl**

```bash
twurl -A 'Content-type: application/json' -X POST /1.1/direct\_messages/events/new.json -d '{"event": {"type": "message\_create", "message\_create": {"target": {"recipient\_id": "4534871"}, "message_data": {"text": "Hello World!"}}}}'
```

Ten en cuenta en la solicitud anterior que el encabezado Content-Type se establece en application/json en lugar de application/x-www-form-urlencoded. Además, si estás construyendo la firma OAuth 1.0a, ten en cuenta que el cuerpo JSON no se incluye en el cálculo de la firma. La mayoría de las bibliotecas OAuth ya tienen esto en cuenta. Si estás usando [twurl](https://github.com/twitter/twurl), asegúrate de estar usando al menos la versión 0.9.3.

<div id="summary">
  #### Resumen
</div>

* El mensaje se define en el cuerpo de la solicitud POST en formato JSON
* El encabezado Content-Type debe configurarse en application/json
* El cuerpo JSON no se incluye al generar la firma OAuth.
   

<div id="retrieving-direct-messages">
  ### Recuperar Mensajes Directos
</div>

La recuperación de Mensajes Directos anteriores ahora se realiza con un único endpoint de la API: [GET direct&#95;messages/events/list](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/list-events). La principal diferencia con este nuevo endpoint es que ahora devuelve tanto los mensajes enviados como los recibidos en orden cronológico inverso. Esto puede facilitar la reconstrucción de una conversación. Sin embargo, si solo estás buscando mensajes enviados o recibidos, tendrás que posprocesar la respuesta consultando la propiedad sender&#95;id.

La paginación ahora se basa en un valor de cursor en lugar del ID de un Mensaje Directo. En cada respuesta se devuelve una propiedad cursor. [GET direct&#95;messages/events/list](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/list-events) devolverá hasta 30 días de mensajes anteriores, independientemente de cuántos mensajes existan dentro de esos 30 días. Cuando no se devuelve un cursor, no hay más mensajes por devolver. El método para acceder a Mensajes Directos individuales con [GET direct&#95;messages/events/show](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/get-event) sigue siendo el mismo, aunque el objeto de Mensaje Directo devuelto tiene una estructura diferente, como se describió anteriormente.

Por último, el acceso en tiempo real a Mensajes Directos ahora se realizará mediante webhook con la [Account Activity API](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity). Para obtener orientación sobre cómo migrar desde User Streams o Site Streams, consulta la guía de migración a Account Activity API para obtener más información.

<div id="summary">
  #### Resumen
</div>

* Los mensajes enviados y recibidos ahora se devuelven en el mismo endpoint.
* Se pueden recuperar hasta 30 días de mensajes.
* Paginación basada en cursor.
* Acceso en tiempo real a los Mensajes Directos mediante webhooks.

<div id="deleting-direct-messages">
  ### Eliminación de Mensajes Directos
</div>

Ahora se pueden eliminar los Mensajes Directos con DELETE direct&#95;messages/events/destroy. La interfaz es prácticamente la misma y requiere el ID del mensaje que se va a eliminar. La diferencia principal es que ahora el endpoint requiere una solicitud DELETE en lugar de una solicitud POST.

La forma en que los Mensajes Directos eliminados se muestran en los clientes oficiales de X sigue siendo la misma. Los Mensajes Directos solo se eliminan de la interfaz del usuario en cuyo contexto se realiza la acción. Los demás miembros de la conversación aún pueden acceder al Mensaje Directo.

<div id="summary">
  #### Resumen
</div>

* Eliminar un Mensaje Directo requiere el id.
* El nuevo endpoint requiere una solicitud DELETE.
* La forma en que los Mensajes Directos eliminados se reflejan en los clientes oficiales de X no ha cambiado.

**¿Tienes preguntas sobre la migración a los nuevos endpoints de Mensajes Directos?
**Publica tu pregunta en el foro de la comunidad de desarrolladores en [devcommunity.com](https://devcommunity.x.com/).

<div id="frequently-asked-questions">
  ## Preguntas frecuentes
</div>

<div id="general">
  ### General
</div>

**¿Cuáles son las ventajas de usar la Account Activity API?**

La Account Activity API utiliza webhooks, lo que significa que, a diferencia de las APIs de streaming, no necesitamos que mantengas una conexión abierta para enviarte información. Los webhooks también son diferentes de las APIs REST porque no tienes que hacernos cientos de solicitudes cada 15 minutos para obtener los datos que te interesan. Esto aumenta la eficiencia entre un usuario y tu aplicación, ya que entrega los datos en el momento en que suceden.

La Account Activity API tiene varias ventajas:

1. **Velocidad**: entregamos los datos a la velocidad de X.
2. **Simplicidad**: entregamos todos los eventos de una cuenta a través de una sola conexión de webhook. Las actividades entregadas en la API incluyen Publicaciones, @menciones, respuestas, Retweets, Quote Tweets, Retweets de Quote Tweets, favoritos, Mensajes Directos enviados, Mensajes Directos recibidos, seguimientos, bloqueos y silenciamientos (mutes). 
3. **Escala**: recibes todas las actividades de una cuenta que administras sin estar limitado por ningún límite de frecuencia ni topes de eventos.

La Account Activity API está disponible como oferta de sandbox premium, premium de pago y Enterprise, para que puedas escalar a medida que necesites más cuentas para funciones de responsabilidad u otra funcionalidad adicional.

Para comenzar, descarga fragmentos de código de ejemplo desde [GitHub](https://github.com/xdevplatform/account-activity-dashboard).
 

**¿Cómo identifico qué nivel de producto es el mejor para mí?**

Lee nuestra página [Account Activity API Overview](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity) para obtener más información sobre las diferencias entre las opciones Premium y la opción Enterprise. 
 

**¿Cuál es la diferencia entre un entorno Premium y un webhook Enterprise?**

No hay ninguna diferencia. Cada entorno Premium tendrá su propio webhook&#95;id.
 

**Necesito un entorno de desarrollo, staging y producción para Account Activity API, ¿es posible?**

¡Sí! Con los niveles de pago de Account Activity API (Premium de pago y Enterprise), es posible registrar varias URLs de webhook y administrar las suscripciones por separado para cada una mediante los métodos de la API. Además, se pueden añadir varias aplicaciones cliente a una allowlist para mantener la autorización de tus usuarios actualmente autorizados.
 

**¿Tienen alguna guía paso a paso sobre cómo configurar la Account Activity API?**

De hecho, ¡sí!

* Si recién estás comenzando, te recomendamos que visites nuestra guía [Getting started with webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#getting-started-with-webhooks)

* Sigue nuestros scripts compatibles de X Dev: 
  * [Account Activity API dashboard](https://github.com/xdevplatform/account-activity-dashboard), una aplicación web en Node que muestra eventos de webhook.
  * El [chatbot SnowBot](https://github.com/xdevplatform/SnowBotDev), una aplicación web en Ruby creada sobre las Account Activity y Direct Message APIs. Esta base de código incluye un [script](https://github.com/xdevplatform/SnowBotDev/wiki/Account-Activity-API-setup-script) para ayudar a configurar los webhooks de Account Activity API.
     

**¿Hay alguna manera de recuperar datos si nuestro sistema se cae durante un período de tiempo?**

Con los niveles de pago de Account Activity API (Premium de pago y Enterprise), nuestro sistema [volverá a intentar](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#retries) enviarte las actividades varias veces durante un período de cuatro horas. Si tu sistema no responde dentro de ese período de cuatro horas, entonces la actividad se perderá y tendrás que usar otros endpoints REST para recuperar los datos dentro de un plazo de 7 días.

Te sugerimos que utilices tus distintos webhooks, o entornos, como herramienta de redundancia, como la [Account Activity Replay API](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-replay-api), para asegurarte de no perder ninguna actividad si uno de tus sistemas se cae.
 

**¿Qué autenticación tengo que usar con la Account Activity API?**

Los métodos de autorización requeridos para Account Activity API se describen para cada método en las [páginas de referencia de la API](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-api-reference-index). Si recién estás comenzando con la autenticación de X, te recomendamos que leas [esta sección](/es/resources/fundamentals/authentication).

**¿Qué es una verificación de challenge-response (CRC)?**

La comprobación de la respuesta al desafío de la Account Activity API es una función de seguridad implementada para garantizar que las actividades de la Account Activity API se envíen al desarrollador adecuado. También puede ser utilizada por desarrolladores para asegurarse de que los datos que están recibiendo provienen de X. X enviará automáticamente un CRC a tu URL de webhook una vez cada 24 horas, comenzando desde la última vez que se validó la URL del webhook. Tu sistema debe responder con una respuesta válida en un plazo de 3 segundos para seguir estando validado. 

Visita nuestra página [Asegurar los webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#securing-webhooks) para más detalles.
 

**¿Hay algo que invalidaría inmediatamente mi URL de webhook?**

Si ocurre alguna de las siguientes situaciones, marcaremos inmediatamente tu webhook como no válido:

* El servidor responde a un CRC con un token incorrecto. En este caso, nuestro sistema no volverá a [intentar](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#retries) enviarte la actividad.
* La URL del webhook tiene un certificado configurado de forma incorrecta. En este caso, nuestro sistema no volverá a [intentar](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#retries) enviarte la actividad.
* Tu servidor devuelve un código de respuesta que no es 2XX, ni 4XXX, ni 5XXX.
* Especificas el uso de gzip sin enviarlo realmente.
* No especificas el uso de gzip, pero lo envías realmente en la respuesta.
   

**¿Recibiré actividades duplicadas si estoy suscrito a usuarios que están interactuando entre sí?**

Sí. Si tu aplicación web tiene suscripciones activas para el Usuario A y el Usuario B, y el Usuario A menciona al Usuario B en una Publicación, se enviarán dos actividades POST al webhook registrado. Cada actividad tendrá un indicador &quot;for&#95;user&#95;id&quot; para mostrar a qué suscripción pertenece la actividad.
 

**Cuando creo una suscripción a mi webhook, ¿puedo reemplazar la parte `/all/` del siguiente endpoint con otros objetos de datos de actividad de cuenta para limitar las actividades que entrega la API? **`POST https://api.x.com/1.1/account_activity/all/:env_name/subscriptions.json`

No, esto no es posible. Por el momento, solo tenemos disponible el producto `/all/`.
 

**¿Hay alguna forma de usar la Account Activity API sin solicitar permisos de Mensajes Directos a los usuarios? **

En este momento, los permisos de Mensajes Directos son obligatorios porque no hay ninguna forma de &quot;filtrar&quot; las actividades de Mensajes Directos para esta API. 
 

**¿Existe una versión gratuita de la Account Activity API?**

Sí, ofrecemos la versión sandbox como nivel gratuito. Nuestra opción sandbox está limitada a un solo webhook con un máximo de 15 suscripciones. Puedes leer más sobre la opción sandbox en [nuestra documentación](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity). 

**¿Es posible usar la Account Activity API para obtener Retweets de Publicaciones que mencionan a usuarios suscritos? **

Lamentablemente, esto no forma parte de las actividades entregadas con esta API. Para esto, sugerimos usar la Streaming API. 
 

**¿Cuáles son los posibles tipos de actividad que están representados por un tweet&#95;create&#95;event?**

Se enviará un payload tweet&#95;create&#95;event:

Si el usuario de la suscripción realiza cualquiera de las siguientes acciones:

* Crea una Publicación
* Hace Retweet
* Responde a una Publicación

Si otro usuario:

* *menciona con @* al usuario de la suscripción
* Cita una Publicación creada por el usuario de la suscripción 

*Nota: La Account Activity API solo entrega eventos cuando el usuario de la suscripción recibiría una notificación de X y podría ver el evento públicamente. Esto significa que, si la cuenta mencionada (@userA) sigue a la cuenta protegida (@userB), entonces UserA recibirá una notificación de que UserB le mencionó. Si UserA no sigue a UserB (y ha sido aprobado por UserB), UserA no recibirá una notificación y, por lo tanto, no se enviaría un tweet&#95;create&#95;event a través de AAA si @userA tuviera una suscripción.

**Si un usuario bloqueado menciona a mi usuario suscrito, ¿cómo puedo identificarlo?**

Verás un campo booleano `user&#95;has&#95;blocked` en el nivel superior de la respuesta JSON, establecido en &quot;true&quot; o &quot;false&quot;. Este campo solo se expondrá en menciones en Publicaciones. 

Enterprise

**¿Cómo puedo añadir mi aplicación a una allowlist o comprobar si mi aplicación ya está en la allowlist?**

Para administrar las [X apps](/es/resources/fundamentals/developer-apps) que has agregado a una lista de permitidos para el acceso mediante las Enterprise APIs, comunícate con tu representante de cuenta y facilítale el id de tu app. Puedes encontrar el id de tu app navegando a la página [&quot;Apps&quot;](/es/resources/fundamentals/developer-apps) en el [portal para desarrolladores](/es/resources/fundamentals/developer-portal).
 

**Si tengo acceso a tres webhooks, ¿puedo usar tres webhooks para cada una de las apps que he registrado para uso de Enterprise?**

El límite de webhooks se establece a nivel de cuenta, no a nivel de app. Si tienes acceso a tres webhooks y dos apps registradas para uso de Enterprise, puedes usar dos webhooks en una app y el tercero en la otra app, pero no tres en cada app. 

**¿Puedo especificar qué tipos de eventos se volverán a entregar usando la Account Activity Replay API?**

No se pueden especificar los tipos de eventos que se van a reproducir. Se reproducirán todos los eventos entregados durante la ventana de fecha y hora especificada. 

**¿Habrá reintentos si mi aplicación no logra procesar un evento de la Account Activity Replay API?**

No, no habrá reintentos. Si una aplicación no logra procesar un evento enviado por la Account Activity Replay API, se puede enviar otro trabajo de Replay para el mismo período de tiempo a fin de intentar la nueva entrega de cualquier evento de Replay omitido. 

**¿Qué debo hacer cuando recibo un evento de finalización con éxito parcial?**

Sugerimos tomar nota de las marcas de tiempo de los eventos que se recibieron y solicitar otro trabajo de Replay para los eventos que faltaron. 

**¿Cuántos trabajos de Account Activity Replay API puedo tener en ejecución al mismo tiempo?**

Solo puede estar en ejecución un trabajo de Account Activity Replay API por webhook a la vez. 

**¿Cómo puedo diferenciar los eventos de Account Activity Replay API de los eventos de producción en tiempo real a medida que se entregan a mi webhook?**

Dado que la Account Activity Replay API siempre entregará eventos del pasado, los eventos pueden diferenciarse de los eventos de producción en tiempo real basándose en la marca de tiempo del evento. 

**¿Con cuánta anticipación puedo empezar a usar la Account Activity Replay API para volver a entregar una actividad que mi aplicación omitió o perdió?**

Una actividad se vuelve disponible para volver a entregarse aproximadamente 10 minutos después de que se crea. 

<div id="error-troubleshooting-guide">
  ### Guía para solucionar errores
</div>

<div id="code-32">
  #### Código 32
</div>

Este error generalmente significa que algo está mal formado en la solicitud, los encabezados, la autorización o la URL que estás especificando. No es un error de la Account Activity API, sino un error de autorización, y X no está recibiendo la configuración adecuada de OAuth ni la URL correcta.

* **Enterprise** - Asegúrate de que las claves de consumidor y los tokens de acceso que estás usando pertenecen a una [aplicación de X](/es/resources/fundamentals/developer-apps) que haya sido registrada para el uso de productos Enterprise. Si no tienes tus claves de consumidor y tokens de acceso, o necesitas añadir tu aplicación de X a la allowlist, ponte en contacto con tu account manager. 

* Si te autenticas con contexto de usuario, asegúrate de haber [autorizado correctamente tu solicitud](/es/resources/fundamentals/authentication#authorizing-a-request) con los valores adecuados de `oauth nonce`, `oauth_signature` y `oauth_timestamp`.

* Asegúrate de que tus tokens de acceso tengan el nivel de permiso adecuado.
  * En la pestaña &quot;Keys and tokens&quot; del [app dashboard](/es/resources/fundamentals/developer-apps), asegúrate de que tus tokens de acceso tienen el nivel de permiso &quot;Read, write, and direct messages&quot; [permission level](/es/resources/fundamentals/developer-apps#app-permissions). 
  * Si el nivel de permiso de los tokens está configurado en algo inferior a esto, ve a la pestaña &quot;Permissions&quot;, ajusta el permiso de acceso a &quot;Read, write, and direct messages&quot; y, a continuación, regenera tus tokens de acceso y secretos desde la pestaña &quot;Keys and tokens&quot;.

* Asegúrate de que tu URL esté formada correctamente.
  * Ten en cuenta que `:env_name` distingue entre mayúsculas y minúsculas.
     

<div id="code-200-forbidden">
  #### Código 200 - Prohibido
</div>

* **Premium** - Asegúrate de que tengas una [cuenta de desarrollador](/es/resources/fundamentals/developer-portal) aprobada antes de intentar realizar una solicitud a la API. También debes usar el :env&#95;name adecuado en la solicitud, que puedes configurar en la página de [dev environments](/es/resources/fundamentals/developer-portal).

* **Enterprise** - Asegúrate de que tu representante de cuenta te haya habilitado el acceso a la Account Activity API.

* Asegúrate de haber configurado correctamente la URI. Este error puede producirse si has introducido una URI incorrecta en tu solicitud.
   

<div id="code-214-webhook-url-does-not-meet-the-requirements">
  #### Código 214 - La URL del webhook no cumple con los requisitos.
</div>

* Asegúrate de usar HTTPS.
* Es posible que la URL de tu webhook esté mal formada.
* Obtén más información sobre cómo configurar la URL de tu webhook en la sección [Develop webhook consumer app](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#3-develop-webhook-consumer-app) de la página [Getting started with webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#getting-started-with-webhooks).
   

<div id="code-214-high-latency-on-crc-get-request-your-webhook-should-respond-in-less-than-3-seconds">
  #### Código 214 - Alta latencia en la solicitud GET de CRC. Tu webhook debe responder en menos de 3 segundos.
</div>

* Esto significa que tu servidor es lento. Asegúrate de responder al CRC dentro de los 3 segundos.
   

<div id="code-214-non-200-response-code-during-crc-get-request-ie-404-500-etc">
  #### Código 214 - Código de respuesta distinto de 200 durante la solicitud GET de CRC (por ejemplo, 404, 500, etc).
</div>

* Tu servidor no está disponible. Verifica que esté funcionando correctamente.
   

<div id="code-214-too-many-resources-already-created">
  #### Code 214 - Demasiados recursos ya creados.
</div>

* **Enterprise** - Ya has utilizado todos tus webhooks. Usa el endpoint [GET webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks) con cada una de tus aplicaciones registradas para identificar en cuáles están configurados tus webhooks. 

<div id="code-261-application-cannot-perform-write-actions">
  #### Código 261 - La aplicación no puede realizar acciones de escritura.
</div>

* La aplicación que estás usando con la API no tiene configurado el [nivel de permiso](/es/resources/fundamentals/developer-apps#app-permissions) adecuado para su token de acceso y token de acceso secreto. Ve a la pestaña «Keys and tokens» en el panel de [X apps](/es/resources/fundamentals/developer-apps) y verifica los niveles de permiso asignados a tu token de acceso y token de acceso secreto. Si está configurado en cualquier opción distinta de «Read, write and Direct Messages», tendrás que ajustar la configuración en la pestaña «Permission» y volver a generar tu token de acceso y token de acceso secreto para aplicar la nueva configuración.
* O bien, estás intentando registrar un webhook utilizando autenticación solo de aplicación, lo cual no está admitido. En su lugar, autentícate con contexto de usuario, como se indica en las secciones de referencia de la API para registrar un webhook para la [Enterprise Account Activity API](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks).

<div id="account-activity-api-reference-index">
  ## Índice de referencia de la API de actividad de cuenta
</div>

|     |     |
| :--- | :--- |
| **Finalidad** | Enterprise |
| Registra una URL de webhook / Genera un webhook&#95;id | [POST  <br />webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#enterprise-account-activity-api) |
| Devuelve todas las URL de webhook y sus estados | [GET  <br />webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks) |
| Activa manualmente una comprobación de respuesta al desafío | [PUT  <br />webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#put-account-activity-webhooks-webhook-id) |
| Suscribe una Aplicación a los eventos de una cuenta | [POST  <br />webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks-webhook-id-subscriptions-all) |
| Devuelve la cantidad de suscripciones activas actualmente | [GET  <br />subscriptions/count](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-subscriptions-count) |
| Comprueba si un webhook está suscrito a una cuenta | [GET  <br />webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all) |
| Devuelve una lista de las suscripciones activas actualmente | [GET  <br />webhooks/:webhook&#95;id/subscriptions/all/list](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-subscriptions-count) |
| Elimina el webhook | [DELETE  <br />webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id) |
| Desactiva una suscripción mediante OAuth de 3 patas (EN DESUSO) | [DELETE  <br />webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated) |
| Desactiva una suscripción mediante OAuth solo de Aplicación | [DELETE  <br />webhooks/:webhook&#95;id/subscriptions/:user&#95;id/all.json](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-user-id-all-json) |
| Vuelve a entregar actividades a un webhook | [POST  <br />replay/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated) |

<div id="enterprise-account-activity-api">
  ### API Enterprise de actividad de cuenta
</div>

<div id="post-account_activitywebhooks">
  #### POST account&#95;activity/webhooks[](#post-account-activity-webhooks "Permalink to this headline")
</div>

Registra una nueva URL de webhook para el contexto de la Aplicación dado. La URL se validará mediante una solicitud CRC antes de guardarse. En caso de que la validación falle, se devolverá un mensaje de error completo y detallado al solicitante.

La cantidad de webhooks permitidos viene determinada por el paquete de facturación.

<div id="resource-url">
  ### URL del recurso[](#resource-url "Permalink to this headline")
</div>

`https://api.x.com/1.1/account_activity/webhooks.json`

<div id="resource-information">
  ### Información del recurso[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| Formato de respuesta | JSON |
| Requiere autenticación | Sí (contexto de usuario: todos los tokens de consumidor y de acceso) |
| Sujeto a límite de frecuencia | Sí |
| Solicitudes por ventana de 15 min (autenticación de usuario) | 15  |
| Compatibilidad con ediciones de Publicaciones | Todos los objetos de Publicación incluirán metadatos de edición que describen el historial de ediciones de la Publicación. Consulta la página [&quot;Fundamentos de las ediciones de Publicaciones&quot;](/es/x-api/enterprise-gnip-2.0/fundamentals/edit-tweets) para obtener más detalles. |

<div id="parameters">
  ### Parámetros[](#parameters "Enlace permanente a este encabezado")
</div>

|     |     |
| :--- | :--- |
| url (obligatorio) | URL codificada para el endpoint de callback. |

### Ejemplo de solicitud[](#example-request "Permalink to this headline")

$ curl --request POST
--url &#39;https://api.x.com/1.1/account&#95;activity/webhooks.json?url=https%3A%2F%2Fyour&#95;domain.com%2Fwebhooks%2Ftwitter%2F0&#39;
--header &#39;authorization: OAuth oauth&#95;consumer&#95;key=&quot;CONSUMER&#95;KEY&quot;, oauth&#95;nonce=&quot;GENERATED&quot;, oauth&#95;signature=&quot;GENERATED&quot;, oauth&#95;signature&#95;method=&quot;HMAC-SHA1&quot;, oauth&#95;timestamp=&quot;GENERATED&quot;, oauth&#95;token=&quot;ACCESS&#95;TOKEN&quot;, oauth&#95;version=&quot;1.0&quot;&#39;

<div id="http-responses">
  ### Respuestas HTTP[](#http-responses "Enlace permanente a este encabezado")
</div>

| Código HTTP | Mensaje |
| :--- | :--- |
| 200 | La URL del webhook está registrada para la aplicación proporcionada |
| 403 | Hay un error en su solicitud. Consulte la sección de mensajes de error a continuación. |

### Ejemplo de respuesta - éxito[](#example-response-success "Permalink to this headline")

```json
_HTTP 200_

    {
      "id": "1234567890",
      "url": "https://your_domain.com/webhook/twitter/0",
      "valid": true,
      "created_at": "2016-06-02T23:54:02Z"
    }
```

<div id="error-messages">
  ### Mensajes de error[](#error-messages "Permalink to this headline")
</div>

| Código | Mensaje                                                                                                     |
| :----- | :---------------------------------------------------------------------------------------------------------- |
| 214    | La URL del webhook no cumple con los requisitos.                                                            |
| 214    | Ya se han creado demasiados recursos.                                                                       |
| 214    | La URL del webhook no cumple con los requisitos. Token CRC no válido o formato de respuesta JSON no válido. |
| 214    | Latencia elevada en la solicitud CRC GET. Tu webhook debe responder en menos de 3 segundos.                 |
| 214    | Código de respuesta distinto de 200 durante la solicitud CRC GET (por ejemplo, 404, 500, etc.).             |

*HTTP 403*

```json
    {
      "errors": [
        {
          "code": 214,
          "message": "Too many resources already created."
        }
      ]
    }
```

<div id="get-account_activitywebhooks">
  #### GET account&#95;activity/webhooks[](#get-account-activity-webhooks "Permalink to this headline")
</div>

Devuelve todas las URL y sus estados para la aplicación indicada.

Marcamos una URL como no válida si falla la comprobación diaria de validación. Para volver a habilitar la URL, llama al endpoint de actualización.

<div id="resource-url">
  ### URL del recurso[](#resource-url "Permalink to this headline")
</div>

`https://api.x.com/1.1/account_activity/webhooks.json`

<div id="resource-information">
  ### Información del recurso[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| Formato de respuesta | JSON |
| Requiere autenticación | Sí (solo aplicación: Bearer Token) |
| Sujeto a límite de frecuencia | Sí |
| Solicitudes / ventana de 15 minutos (autenticación de la aplicación) | 15  |

### Ejemplo de solicitud[](#example-request "Permalink to this headline")

```bash
    $ curl --request GET
     --url https://api.x.com/1.1/account_activity/webhooks.json
     --header 'authorization: Bearer TOKEN'
```

<div id="example-response">
  ### Ejemplo de respuesta[](#example-response "Permalink to this headline")
</div>

*HTTP 200 OK*

```json
    [
      {
        "id": "1234567890",
        "url": "https://your_domain.com/webhook/twitter/0",
        "valid": true,
        "created_at": "2016-06-02T23:54:02Z"
      }
      {
        "id": "2468013579",
        "url": "https://your_domain2.com/webhook/twitter/0",
        "valid": true,
        "created_at": "2016-06-04T22:31:29Z"
      }
    ]
```

<div id="error-messages">
  ### Mensajes de error[](#error-messages "Permalink to this headline")
</div>

| Código | Mensaje |
| :--- | :--- |
| 99  | No tienes acceso a este recurso. |

<div id="put-account_activitywebhookswebhook_id">
  #### PUT account&#95;activity/webhooks/:webhook&#95;id[](#put-account-activity-webhooks-webhook-id "Permalink to this headline")
</div>

Activa la verificación de respuesta al desafío (CRC) para la URL del webhook indicado. Si la verificación es satisfactoria, devuelve 204 y reactiva el webhook estableciendo su estado en `valid`.

<div id="resource-url">
  ### URL del recurso[](#resource-url "Permalink to this headline")
</div>

`https://api.x.com/1.1/account_activity/webhooks/:webhook_id.json`

<div id="resource-information">
  ### Información del recurso[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| Formato de respuesta | JSON |
| Requiere autenticación | Sí (contexto de usuario: todos los tokens de consumidor y de acceso) |
| Sujeto a límite de frecuencia | Sí |
| Solicitudes / ventana de 15 min (autenticación de usuario) | 15  |

### Parámetros[](#parameters "Permalink to this headline")

|     |     |
| :--- | :--- |
| webhook&#95;id (obligatorio) | ID del webhook. Definido en la ruta del recurso. |

### Ejemplo de solicitud[](#example-request "Permalink to this headline")

```json
    $ curl --request PUT
     --url https://api.x.com/1.1/account_activity/webhooks/:WEBHOOK_ID.json
     --header 'authorization: OAuth oauth_consumer_key="CONSUMER_KEY", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="ACCESS_TOKEN", oauth_version="1.0"'
```

<div id="response">
  ### Respuesta[](#response "Enlace permanente a este encabezado")
</div>

*HTTP 204 OK*

```
    { }
```

<div id="error-messages">
  ### Mensajes de error[](#error-messages "Permalink to this headline")
</div>

| Código | Mensaje |
| :--- | :--- |
| 34  | El webhook no existe o está asociado con otra aplicación de X. |
| 214 | La URL del webhook no cumple los requisitos. |
| 214 | La URL del webhook no cumple los requisitos. Token CRC no válido o formato de respuesta JSON no válido. |
| 214 | Alta latencia en la solicitud GET de CRC. El webhook debe responder en menos de 3 segundos. |
| 214 | Código de respuesta distinto de 200 durante la solicitud GET de CRC (es decir, 404, 500, etc.). |

<div id="post-account_activitywebhookswebhook_idsubscriptionsall">
  #### POST account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all[](#post-account-activity-webhooks-webhook-id-subscriptions-all "Enlace permanente a este encabezado")
</div>

Suscribe la aplicación proporcionada a todos los eventos en el contexto de usuario indicado y para todos los tipos de mensajes. Después de la activación, todos los eventos para el usuario que realiza la solicitud se enviarán al webhook de la aplicación mediante una solicitud POST.

Actualmente, las suscripciones están limitadas según la configuración de tu cuenta. Si necesitas agregar más suscripciones, ponte en contacto con tu administrador de cuenta.

<div id="resource-url">
  ### URL del recurso[](#resource-url "Permalink to this headline")
</div>

`https://api.x.com/1.1/account_activity/webhooks/:webhook_id/subscriptions/all.json`

<div id="resource-information">
  ### Información del recurso[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| Formato de respuesta | JSON |
| Requiere autenticación | Sí (OAuth con 3 participantes: clave de consumidor autorizada y token de acceso del usuario suscriptor) |
| Sujeto a límite de frecuencia | Sí |
| Solicitudes / ventana de 15 min (autenticación de usuario) | 500 |

### Parámetros[](#parameters "Permalink to this headline")

|     |     |
| :--- | :--- |
| webhook&#95;id (obligatorio) | ID de webhook. Se define en la ruta del recurso. |

### Ejemplo de solicitud[](#example-request "Enlace permanente a este encabezado")

```bash
    $ curl --request POST
     --url https://api.x.com/1.1/account_activity/webhooks/:WEBHOOK_ID/subscriptions/all.json
     --header 'authorization: OAuth oauth_consumer_key="WHITELISTED_CONSUMER_KEY", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="SUBSCRIBING_USER'S_ACCESS_TOKEN", oauth_version="1.0"'
```

### Ejemplo de respuesta: éxito[](#example-response-success "Enlace permanente a este título")

*HTTP 204 NO CONTENT*

```
    {}
```

<div id="error-messages">
  ### Mensajes de error[](#error-messages "Permalink to this headline")
</div>

| Código | Mensaje |
| :--- | :--- |
| 34  | El webhook no existe o está asociado con una aplicación de X diferente. |
| 348 | La aplicación cliente no tiene permiso para acceder a las suscripciones de webhook de este usuario. |

<div id="get-account_activitysubscriptionscount">
  #### GET account&#95;activity/subscriptions/count[](#get-account-activity-subscriptions-count "Permalink to this headline")
</div>

Devuelve la cantidad de suscripciones que están activas actualmente en tu cuenta. Ten en cuenta que el endpoint /count requiere OAuth solo de aplicación, por lo que debes hacer las solicitudes usando un Bearer Token en lugar de contexto de usuario.

<div id="resource-url">
  ### URL del recurso[](#resource-url "Permalink to this headline")
</div>

`https://api.x.com/1.1/account_activity/subscriptions/count.json`

<div id="resource-information">
  ### Información del recurso[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| Formato de respuesta | Código de respuesta HTTP |
| Requiere autenticación | Sí (solo aplicación - Bearer Token) |
| Con límite de frecuencia | Sí |
| Solicitudes / ventana de 15 minutos (autenticación de la aplicación) | 15  |

<div id="http-response-codes">
  ### Códigos de respuesta HTTP[](#http-response-codes "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| Código | Mensaje |
| 200 | Correcto. Se devolverá la cantidad de suscripciones del webhook solicitado. |
| 401 | Tu aplicación no tiene permiso para ver las suscripciones del webhook especificado. |

### Ejemplo de solicitud[](#example-request "Enlace permanente a este título")

```bash
    $ curl --request GET
     --url https://api.x.com/1.1/account_activity/subscriptions/count.json
     --header 'authorization: Bearer TOKEN'
```

### Respuesta de ejemplo - correcta[](#example-response-success "Permalink to this headline")

*HTTP 200*

```bash
    {
      "account_name":"my-account",
      "subscriptions_count_all":"1",
      "subscriptions_count_direct_messages":"0",
      "provisioned_count":"50"
    }
```

<div id="error-messages">
  ### Mensajes de error[](#error-messages "Permalink to this headline")
</div>

| Código | Mensaje                             |
| :----- | :---------------------------------- |
| 32     | No se pudo autenticar tu identidad. |

*HTTP 401*

```abash
    {
      "errors": [
        {
           "code": 32,
          "message": "Could not authenticate you."
        }
      ]
    }
```

<div id="get-account_activitywebhookswebhook_idsubscriptionsall">
  #### GET account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all[](#get-account-activity-webhooks-webhook-id-subscriptions-all "Permalink to this headline")
</div>

Permite determinar si una configuración de webhook está suscrita a los eventos del usuario especificado. Si el contexto de usuario proporcionado tiene una suscripción activa con la aplicación especificada, devuelve 204 OK. Si el código de respuesta no es 204, entonces el usuario no tiene una suscripción activa. Consulta el código de respuesta HTTP y los mensajes de error a continuación para obtener más detalles.

<div id="resource-url">
  ### URL del recurso[](#resource-url "Permalink to this headline")
</div>

`https://api.x.com/1.1/account_activity/webhooks/:webhook_id/subscriptions/all.json`

<div id="resource-information">
  ### Información del recurso[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| Formato de respuesta | JSON |
| Requiere autenticación | Sí (OAuth de 3 partes: clave de consumidor incluida en la lista blanca y token de acceso del usuario suscriptor) |
| Con límite de frecuencia | Sí |
| Solicitudes por ventana de 15 minutos (autenticación de usuario) | 500 |

### Parámetros[](#parameters "Permalink to this headline")

|     |     |
| :--- | :--- |
| webhook&#95;id (obligatorio) | ID del webhook. Definido en la ruta del recurso. |

<div id="example-request">
  ### Solicitud de ejemplo[](#example-request "Enlace permanente a este encabezado")
</div>

$ curl --request GET
--url https://api.x.com/1.1/account&#95;activity/webhooks/:WEBHOOK&#95;ID/subscriptions/all.json
--header &#39;authorization: OAuth oauth&#95;consumer&#95;key=&quot;WHITELISTED&#95;CONSUMER&#95;KEY&quot;, oauth&#95;nonce=&quot;GENERATED&quot;, oauth&#95;signature=&quot;GENERATED&quot;, oauth&#95;signature&#95;method=&quot;HMAC-SHA1&quot;, oauth&#95;timestamp=&quot;GENERATED&quot;, oauth&#95;token=&quot;SUBSCRIBING&#95;USER&#39;S&#95;ACCESS&#95;TOKEN&quot;, oauth&#95;version=&quot;1.0&quot;&#39;

<div id="example-response-success">
  ### Ejemplo de respuesta: correcta[](#example-response-success "Enlace permanente a este encabezado")
</div>

*HTTP 204 SIN CONTENIDO*

```
    { }
```

<div id="get-account_activitywebhookswebhook_idsubscriptionsalllist">
  #### GET account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all/list[](#get-account-activity-webhooks-webhook-id-subscriptions-all-list "Permalink to this headline")
</div>

Devuelve una lista de las suscripciones actuales de tipo All Activity para el webhook especificado. Ten en cuenta que el endpoint /list requiere OAuth solo de aplicación, por lo que las solicitudes se deben realizar con un Bearer Token en lugar de con contexto de usuario.

<div id="resource-url">
  ### URL del recurso[](#resource-url "Permalink to this headline")
</div>

`https://api.x.com/1.1/account_activity/webhooks/:webhook_id/subscriptions/all/list.json`

### Información del recurso[](#resource-information "Enlace permanente a este encabezado")

|     |     |
| :--- | :--- |
| Formato de respuesta | Código de estado HTTP |
| Requiere autenticación | Sí (solo de aplicación - Bearer Token) |
| Con límite de frecuencia | Sí |
| Solicitudes / ventana de 15 minutos (autenticación de aplicación) | 50  |

### Parámetros[](#parameters "Permalink to this headline")

|     |     |
| :--- | :--- |
| webhook&#95;id (obligatorio) | ID del webhook. Se define en la ruta del recurso. |

<div id="http-response-codes">
  ### Códigos de respuesta HTTP[](#http-response-codes "Permalink to this headline")
</div>

| Código | Mensaje |
| :--- | :--- |
| 200 | Correcto. Se devolverá una lista de suscripciones para el webhook solicitado. |
| 401 | Tu aplicación no tiene permiso para ver las suscripciones del webhook especificado. |

### Ejemplo de solicitud[](#example-request "Enlace permanente a este encabezado")

$ curl --request GET
--url https://api.x.com/1.1/account&#95;activity/webhooks/:WEBHOOK&#95;ID/subscriptions/all/list.json
--header &#39;authorization: Bearer TOKEN&#39;

### Ejemplo de respuesta correcta[](#example-response-success "Permalink to this headline")

*HTTP 200*

```bash
    {
      "webhook_id": "1234567890",
      "webhook_url": "https://your_domain.com/webhook/twitter/0",
      "application_id": "11231812",
      "subscriptions": [{
        "user_id": "20212306"
      }]
    }
```

<div id="error-messages">
  ### Mensajes de error[](#error-messages "Permalink to this headline")
</div>

| Code | Mensaje                             |
| :--- | :---------------------------------- |
| 32   | No se pudo autenticar tu solicitud. |

*HTTP 401*

```bash
    {
      "errors": [
        {
           "code": 32,
          "message": "No se pudo autenticar."
        }
      ]
    }
```

<div id="delete-account_activitywebhookswebhook_id">
  #### DELETE account&#95;activity/webhooks/:webhook&#95;id[](#delete-account-activity-webhooks-webhook-id "Permalink to this headline")
</div>

Elimina el webhook de la configuración de la aplicación indicada. El id del webhook se puede obtener realizando una llamada a GET /1.1/account&#95;activity/webhooks.

### URL del recurso[](#resource-url "Enlace permanente a este encabezado")

`https://api.x.com/1.1/account_activity/webhooks/:webhook_id.json`

### Información del recurso[](#resource-information "Enlace permanente a este encabezado")

|     |     |
| :--- | :--- |
| Formato de respuesta | JSON |
| Requiere autenticación | Sí (contexto de usuario: todos los tokens de consumidor y tokens de acceso) |
| Limitado por frecuencia | Sí |
| Solicitudes / ventana de 15 minutos (autenticación de usuario) | 15  |

### Parámetros[](#parameters "Permalink to this headline")

|     |     |
| :--- | :--- |
| webhook&#95;id (obligatorio) | ID del webhook. Especificado en la ruta del recurso. |

### Ejemplo de solicitud[](#example-request "Permalink to this headline")

```bash
    $ curl --request DELETE
     --url https://api.x.com/1.1/account_activity/webhooks/:WEBHOOK_ID.json
     --header 'authorization: OAuth oauth_consumer_key="CONSUMER_KEY", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="ACCESS_TOKEN", oauth_version="1.0"'
```

### Respuesta[](#response "Permalink to this headline")

*HTTP 204 OK*

```
    { }
```

<div id="delete-account_activitywebhookswebhook_idsubscriptionsall-deprecated">
  #### DELETE account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all (OBSOLETO)[](#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated- "Permalink to this headline")
</div>

Desactiva las suscripciones para el contexto de usuario y la aplicación indicados. Después de la desactivación, todos los eventos del usuario solicitante dejarán de enviarse a la URL del webhook.

<div id="resource-url">
  ### URL del recurso[](#resource-url "Permalink to this headline")
</div>

`https://api.x.com/1.1/account_activity/webhooks/:webhook_id/subscriptions/all.json`

<div id="resource-information">
  ### Información del recurso[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| Formato de respuesta | JSON |
| Requiere autenticación | Sí (OAuth de 3 pasos: clave de consumidor en lista blanca y token de acceso del usuario suscrito) |
| Sujeto a límites de frecuencia | Sí |
| Solicitudes / ventana de 15 minutos (autenticación de usuario) | 500 |

### Parámetros[](#parameters "Permalink to this headline")

|     |     |
| :--- | :--- |
| webhook&#95;id (obligatorio) | ID del webhook. Se define en la ruta del recurso. |

### Ejemplo de solicitud[](#example-request "Enlace permanente a este encabezado")

```bash
    $ curl --request DELETE
     --url https://api.x.com/1.1/account_activity/webhooks/:WEBHOOK_ID/subscriptions/all.json
     --header 'authorization: OAuth oauth_consumer_key="WHITELISTED_CONSUMER_KEY", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="SUBSCRIBED_USER'S_ACCESS_TOKEN", oauth_version="1.0"'
```

Ejemplo de solicitud

```
    { }
```

<div id="delete-account_activitywebhookswebhook_idsubscriptionsuser_idalljson">
  #### DELETE /account&#95;activity/webhooks/:webhook&#95;id/subscriptions/:user&#95;id/all.json[](#delete-account-activity-webhooks-webhook-id-subscriptions-user-id-all-json "Permalink to this headline")
</div>

Desactiva la suscripción para el webhook y el id de usuario especificados. Una vez desactivada, dejarán de enviarse al URL del webhook todos los eventos del usuario que realiza la solicitud. Ten en cuenta que este endpoint requiere OAuth de solo aplicación, por lo que las solicitudes deben realizarse usando un Bearer Token en lugar del contexto de usuario.

<div id="resource-url">
  ### URL del recurso[](#resource-url "Permalink to this headline")
</div>

`https://api.x.com/1.1/account_activity/webhooks/:webhook_id/subscriptions/:user_id/all.json`

<div id="resource-information">
  ### Información del recurso[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| Formato de respuesta | JSON |
| Requiere autenticación | Sí (solo aplicación - Bearer Token) |
| Sujeto a límite de frecuencia | Sí |
| Solicitudes por ventana de 15 minutos | 500 |

### Ejemplo de solicitud[](#example-request "Permalink to this headline")

```bash
    $ curl --request DELETE
     --url https://api.x.com/1.1/account_activity/webhooks/:webhook_id/subscriptions/:user_id/all.json
     --header 'authorization: Bearer TOKEN'
```

<div id="response">
  ### Respuesta[](#response "Enlace permanente a este encabezado")
</div>

*HTTP 204 NO CONTENT*

<div id="error-messages">
  ### Mensajes de error[](#error-messages "Permalink to this headline")
</div>

| Código | Mensaje |
| :--- | :--- |
| 404 | Lo sentimos, esa página no existe. Esto suele ocurrir cuando el id de usuario especificado no está realmente suscrito. |

<div id="replay-api">
  ### Replay API
</div>

**POST /1.1/account&#95;activity/replay/webhooks/:webhook&#95;id/subscriptions/all.json [¶](#post-1-1-account-activity-replay-webhooks-webhook-id-subscriptions-all-json- "Permalink to this headline")**

Envía una solicitud para recuperar actividades de hasta los últimos cinco días de todas las suscripciones presentes durante las ventanas de fecha y hora especificadas en la solicitud. Si tu webhook tiene suscripciones de usuarios activas, también recibirás esos eventos de forma concurrente. Nota: realizamos un CRC antes de entregar los eventos de repetición (replay).

|     |     |
| :--- | :--- |
| **Request Method** | HTTP POST |
| **URL** | /1.1/account&#95;activity/replay/webhooks/:webhook&#95;id/subscriptions/all.json?from&#95;date=yyyymmddhhmm&amp;to&#95;date=yyyymmddhhmm |
| **Response Format** | JSON |
| **Requires Authentication** | Sí (solo de aplicación - Bearer Token) |
| **Rate Limit** | 5 solicitudes cada 15 minutos. Actualmente no hay un límite máximo para la cantidad de trabajos de repetición (replay jobs) que se pueden solicitar. |
| **from&#95;date** | La marca de tiempo UTC más antigua (de inicio) a partir de la cual se proporcionarán los eventos; debe estar en formato &#39;yyyymmddhhmm&#39;. La marca de tiempo tiene granularidad de minutos y es inclusiva (es decir, 12:00 incluye el minuto 00). Los horarios válidos deben estar dentro de los últimos 5 días, en hora UTC, y no ser más recientes que 31 minutos antes del momento actual. Se recomienda que from&#95;date y to&#95;date estén dentro de un intervalo de aproximadamente 2 horas. |
| **to&#95;date** | La marca de tiempo UTC más reciente (de finalización) hasta la cual se proporcionará el evento; debe estar en formato &#39;yyyymmddhhmm&#39;. La marca de tiempo tiene granularidad de minutos y es exclusiva (es decir, 12:30 no incluye el minuto 30 de la hora). Los horarios válidos deben estar dentro de los últimos 5 días, en hora UTC, y no ser más recientes que 10 minutos antes del momento actual. |

<div id="responses">
  #### Respuestas
</div>

Las siguientes respuestas pueden ser devueltas por la API. La mayoría de los códigos de error se devuelven con una cadena que incluye detalles adicionales en el cuerpo. Para respuestas que no sean 200, debes resolver el error e intentarlo de nuevo.

| Status | Texto | Código de error | Descripción | Mensaje |
| :--- | :--- | :--- | :--- | :--- |
| 202 | Accepted | N/A | La solicitud se realizó correctamente y las actividades se enviarán. | N/A |
| 400 | Bad Request | 214 | El webhook se ha marcado como no válido. | El webhook está marcado como no válido y requiere una comprobación CRC. |
| 400 | Bad Request | 357 | Falta un parámetro de consulta. | : queryParam es obligatorio. |
| 400 | Bad Request | 358 | La ruta o el parámetro de consulta tienen un formato incorrecto. | No se puede analizar el parámetro. |
| 400 | Bad Request | 360 | El parámetro de ruta es negativo. | webhook&#95;id: [] no es mayor o igual que 0. |
| 400 | Bad Request | 368 | from&#95;date o to&#95;date no están en el pasado. | : [&lt;field&#95;value&gt;] no está en el pasado. |
| 400 | Bad Request | 356 | from&#95;date debe ser anterior a to&#95;date. | from&#95;date must be before to&#95;date. |
| 400 | Bad Request | 356 | from&#95;date debe estar dentro de los últimos 5 días. | from&#95;date must be within the past 5 days. |
| 401 | Unauthorized | 32  | La autenticación HTTP falló porque se proporcionó autenticación de 3 fases (3-legged auth). | Método de autenticación no válido. Utiliza autenticación solo de aplicación (application-only authentication). |
| 401 | Unauthorized | 61  | El cliente no tiene permiso para solicitar este método. | Client is not permitted to request this method. |
| 403 | Forbidden | 200 | El cliente no tiene una cuenta Enterprise con Replay habilitado. | Se requiere una cuenta Enterprise de Account Activity API con replay habilitado. Confirma que tienes una cuenta Enterprise y que replay está habilitado. |
| 404 | Not Found | 34  | webhook&#95;id inexistente; desajuste entre webhook&#95;id y application&#95;id. | El webhook no existe o está asociado con una aplicación de X diferente. |
| 409 | Conflict | 355 | Hay una solicitud en curso y tendrá que terminar de procesarse antes de hacer otra. | Ya hay un trabajo de replay en curso para este webhook. |
| 429 | Too Many Requests | 88  | Limitado por frecuencia (se alcanzó el límite de número de solicitudes por período de tiempo). | Demasiadas solicitudes. Reduce la frecuencia de tus solicitudes a la API. |
| 500 | Internal Server Error | 0   | Error interno del servidor. | Error interno del servidor. |
| 503 | Service Unavailable | 67  | Uno o más servicios dependientes en X no están disponibles. | Error de servidor de X. Vuelve a intentarlo utilizando un patrón de backoff exponencial. |

<div id="job-completed-successfully-message">
  #### &quot;Job completed successfully” message
</div>

Una vez que tu job se haya completado correctamente, la API Account Activity Replay enviará el siguiente evento de finalización de job. Cuando recibas este evento, el job habrá terminado de ejecutarse y podrás enviar otro.

```json
{
  "replay\_job\_status": {
    "webhook_id": "1234577122340233217",
    "job_state": "Complete",
    "job\_state\_description": "Job completed successfully"
    "job_id": "1095098195724558337"
  }
}
```

<div id="job-failed-to-complete-message">
  #### &quot;Job failed to complete&quot; message
</div>

En caso de que tu job no se complete correctamente, te devolveremos el siguiente mensaje para recomendarte que vuelvas a intentar tu Replay job. Una vez que recibas este evento, el job habrá terminado de ejecutarse y podrás enviar otro job.

```json
{
  "replay\_job\_status": {
    "webhook_id": "123451374207332352",
    "job_state": "Incomplete",
    "job\_state\_description": "Job failed to deliver all events, please retry your replay job",
    "job_id": "1093226942650736640"
  }
}
```

<div id="example-curl-request">
  #### Ejemplo de solicitud de cURL
</div>

```bash
    curl --request POST  --url 'https://api.x.com/1.1/account_activity/replay/webhooks/:webhook_id/subscriptions/all.json?from_date=yyyymmddhhmm&to_date=yyyymmddhhmm'
    --header 'authorization: Bearer TOKEN'
```

#### Ejemplo de respuesta

HTTP 202

```bash
{
  "job_id": "1234567890",
  "created_at": "2016-06-02T23:54:02Z"
}
```
