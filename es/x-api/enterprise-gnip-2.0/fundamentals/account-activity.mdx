---
title: "Account Activity API: Enterprise"
keywords: ["enterprise Account Activity API", "enterprise AAA", "Account Activity enterprise", "enterprise webhooks", "enterprise activity"]
---

<Note>
  Este endpoint se ha actualizado para incluir metadatos de edición de Publicaciones. Obtén más información sobre estos metadatos en la [página de conceptos básicos de &quot;Editar Publicaciones&quot;](/es/x-api/enterprise-gnip-2.0/fundamentals/edit-tweets). 

  Este endpoint se utiliza con frecuencia junto con los endpoints de Mensajes Directos. Hemos lanzado nuevos [endpoints v2 de Mensajes Directos](/es/x-api/direct-messages/manage/introduction). Ten en cuenta que las APIs de Account Activity Enterprise y Premium son compatibles con mensajes uno a uno de v2, pero aún no admiten conversaciones de grupo.   
</Note>

Descripción general

`Enterprise`

La Account Activity API te ofrece la posibilidad de suscribirte a actividades en tiempo real relacionadas con una cuenta de usuario mediante webhooks. Esto significa que puedes recibir Publicaciones, Mensajes Directos y otros eventos de cuenta en tiempo real desde una o más de tus cuentas propias o suscritas a través de una única conexión.

Recibirás todas las actividades relacionadas que se indican a continuación para cada suscripción de usuario en tu registro de webhook:

| Tipos de actividad |     |
| :--- | :--- |
| * Publicaciones (por el usuario)  <br />    <br />* Eliminaciones de Publicaciones (por el usuario)<br />* @menciones (del usuario)<br />* Respuestas (al usuario o del usuario)<br />* Retweets (por el usuario o del usuario)<br />* Publicaciones citadas (por el usuario o del usuario)<br />* Retweets de Publicaciones citadas (por el usuario o del usuario)<br />* Me gusta (por el usuario o del usuario)<br />* Follows (por el usuario o del usuario)  <br />    <br />* Unfollows (por el usuario) | * Bloqueos (por el usuario)<br />* Desbloqueos (por el usuario)<br />* Silenciamientos (por el usuario)<br />* Cancelaciones de silenciamiento (por el usuario)<br />* Mensajes Directos enviados (por el usuario)<br />* Mensajes Directos recibidos (por el usuario)<br />* Indicadores de escritura (al usuario)<br />* Confirmaciones de lectura (al usuario)<br />* Revocaciones de suscripción (por el usuario) |

**Ten en cuenta** - No entregamos datos de la cronología principal (home timeline) a través de la Account Activity API. Utiliza [GET statuses/home&#95;timeline](https://developer.x.com/en/docs/x-api/v1/tweets/timelines/overview) para obtener estos datos.
 

<div id="video-series">
  #### Serie de vídeos
</div>

Consulta nuestra [serie de vídeos de cuatro partes](https://www.youtube.com/watch?v=otPxejFhyy8\&index=0\&list=PLFKjcMIU2WshGG6Yj940XM7Z6BFs1zfBg) sobre la Account Activity API para ponerte al día.

<iframe src="https://platform.x.com/embed/Tweet.html?dnt=false&embedId=twitter-widget-0&features=eyJ0ZndfdGltZWxpbmVfbGlzdCI6eyJidWNrZXQiOltdLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X2ZvbGxvd2VyX2NvdW50X3N1bnNldCI6eyJidWNrZXQiOnRydWUsInZlcnNpb24iOm51bGx9LCJ0ZndfdHdlZXRfZWRpdF9iYWNrZW5kIjp7ImJ1Y2tldCI6Im9uIiwidmVyc2lvbiI6bnVsbH0sInRmd19yZWZzcmNfc2Vzc2lvbiI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9LCJ0ZndfZm9zbnJfc29mdF9pbnRlcnZlbnRpb25zX2VuYWJsZWQiOnsiYnVja2V0Ijoib24iLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X21peGVkX21lZGlhXzE1ODk3Ijp7ImJ1Y2tldCI6InRyZWF0bWVudCIsInZlcnNpb24iOm51bGx9LCJ0ZndfZXhwZXJpbWVudHNfY29va2llX2V4cGlyYXRpb24iOnsiYnVja2V0IjoxMjA5NjAwLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X3Nob3dfYmlyZHdhdGNoX3Bpdm90c19lbmFibGVkIjp7ImJ1Y2tldCI6Im9uIiwidmVyc2lvbiI6bnVsbH0sInRmd19kdXBsaWNhdGVfc2NyaWJlc190b19zZXR0aW5ncyI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9LCJ0ZndfdXNlX3Byb2ZpbGVfaW1hZ2Vfc2hhcGVfZW5hYmxlZCI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9LCJ0ZndfdmlkZW9faGxzX2R5bmFtaWNfbWFuaWZlc3RzXzE1MDgyIjp7ImJ1Y2tldCI6InRydWVfYml0cmF0ZSIsInZlcnNpb24iOm51bGx9LCJ0ZndfbGVnYWN5X3RpbWVsaW5lX3N1bnNldCI6eyJidWNrZXQiOnRydWUsInZlcnNpb24iOm51bGx9LCJ0ZndfdHdlZXRfZWRpdF9mcm9udGVuZCI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9fQ%3D%3D&frame=false&hideCard=false&hideThread=false&id=996790447048613888&lang=en&origin=https%3A%2F%2Fdeveloper.x.com%2Fen%2Fdocs%2Fx-api%2Fenterprise%2Faccount-activity-api%2Foverview&sessionId=81f4a0339cbd7bd77b669faa00bd3a7224bc4418&theme=light&widgetsVersion=2615f7e52b7e0%3A1702314776716&width=550px" height="400px" />

<div id="feature-summary">
  ### Resumen de funcionalidades
</div>

| Nivel | Precio | Número de suscripciones únicas | Número de webhooks | Fiabilidad y recuperación de la actividad |
| :--- | :--- | :--- | :--- | :--- |
| Enterprise | [Contacta con ventas](/es/x-api/enterprise-gnip-2.0/enterprise-gnip) | Hasta 500+ | 3+  | [Reintentos](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#retries) y [Replay](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-replay-api) |

* ¿Tienes preguntas? ¿Estás experimentando errores?
  * Lee nuestras [preguntas frecuentes](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#frequently-asked-questions) o la [guía de resolución de errores](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#frequently-asked-questions).

* Explora nuestro código de ejemplo:
  * [Enterprise Account Activity API dashboard](https://github.com/xdevplatform/account-activity-dashboard-enterprise), una aplicación web en Node que muestra eventos de webhook utilizando el nivel Enterprise de la Account Activity API e incluye funcionalidad de [Replay](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-replay-api).
  * El [SnowBot chatbot](https://github.com/xdevplatform/SnowBotDev), una aplicación web en Ruby basada en las APIs Enterprise Account Activity y Direct Message.

<div id="manage-webhooks-and-subscribed-users">
  ## Administrar webhooks y usuarios suscritos
</div>

**⏱ 10 min de lectura**

La API Enterprise Account Activity proporciona mensajes JSON mediante webhooks cada vez que se producen eventos asociados con cuentas de X suscritas a tu servicio. X entrega esas actividades a tu webhook registrado. En los siguientes pasos, aprenderás cómo administrar webhooks y usuarios suscritos.

Aprenderás a registrar, ver y eliminar tanto webhooks como usuarios suscritos. Usaremos comandos cURL sencillos para hacer solicitudes a los distintos endpoints de la API. cURL es una herramienta de línea de comandos para realizar solicitudes o enviar datos utilizando la sintaxis de URL.

Vas a necesitar:

* Una aplicación de X registrada - *[regístrate aquí](https://developer.x.com/content/developer-twitter/en/apps)*
* Un Bearer Token - *[más información](/es/resources/fundamentals/authentication#using-and-generating-an-app-only-bearer-token)*
* Un webhook que supere una Challenge-Response Check (CRC) - *[más información](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#securing-webhooks)*
* Una cuenta Enterprise - *[solicítala aquí](https://developer.x.com/en/products/x-api/enterprise)*

*Antes de comenzar, te recomendamos revisar nuestro [repositorio de GitHub](https://github.com/xdevplatform/account-activity-dashboard), que proporciona una aplicación web de ejemplo y scripts auxiliares para empezar a trabajar con la API Account Activity de X*

<div id="managing-a-webhook">
  #### Administrar un webhook:
</div>

Usar un webhook te permite suscribirte a actividades en tiempo real relacionadas con una cuenta de usuario a través de una única conexión. 

<Tabs>
  <Tab title="Agregar un webhook">
    Comencemos registrando una nueva URL de webhook para el contexto de la aplicación indicada.

    La URL se validará mediante una solicitud CRC antes de guardarse. Una vez que hayas registrado un webhook, asegúrate de documentar el ID del webhook, ya que lo necesitarás más adelante.

    Copia la siguiente solicitud de cURL en tu línea de comandos después de realizar cambios en lo siguiente:

    * **URL** `<URL>`, por ejemplo, `https://yourdomain.com/webhooks/twitter/`

    * **Consumer key** `<CONSUMER_KEY>`, por ejemplo, `xvz1evFS4wEEPTGEFPHBog`

    * **Access token** `<ACCESS_TOKEN>`, por ejemplo, `370773112-GmHxMAgYyLbNEtIKZeRNFsMKPR9EyMZeS9weJAEb`

      ```
      curl --request POST --url 'https://api.x.com/1.1/account_activity/webhooks.json?url=<URL>' --header 'authorization: OAuth oauth_consumer_key="<CONSUMER_KEY>", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="<ACCESS_TOKEN>", oauth_version="1.0"'
      ```
  </Tab>

  <Tab title="Ver un webhook">
    Ejecutaremos el siguiente comando para obtener todas las URLs de webhook registradas y sus estados para la aplicación especificada.

    Copia la siguiente solicitud de cURL en tu línea de comandos después de realizar cambios en lo siguiente:

    * **Bearer token** `<BEARER_TOKEN>`, por ejemplo, `AAAAAAAAAAAA0%2EUifi76ZC9Ub0wn...`

      ```curl --request GET --url https://api.x.com/1.1/account_activity/webhooks.json --header 'authorization: Bearer <BEARER_TOKEN>'
      ```
  </Tab>

  <Tab title="Eliminar un webhook">
    Para eliminar un webhook de la configuración de la aplicación indicada, copia la siguiente solicitud de cURL en tu línea de comandos después de realizar cambios en lo siguiente:

    * **Webhook ID** `<:WEBHOOK_ID>`, por ejemplo, `1234567890`

    * **Consumer key** `<CONSUMER_KEY>`, por ejemplo, `xvz1evFS4wEEPTGEFPHBog`

    * **Access token** `<ACCESS_TOKEN>`, por ejemplo, `370773112-GmHxMAgYyLbNEtIKZeRNFsMKPR9EyMZeS9weJAEb`

      ```curl --request DELETE --url https://api.x.com/1.1/account_activity/webhooks/<:WEBHOOK_ID>.json --header 'authorization: OAuth oauth_consumer_key="<CONSUMER_KEY>", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="<ACCESS_TOKEN>", oauth_version="1.0"'
      ```
  </Tab>
</Tabs>

<div id="managing-subscribed-users">
  #### Gestión de usuarios suscritos:
</div>

Una vez que hayas registrado un webhook, puedes añadir un usuario suscrito a la API Account Activity para comenzar a recibir la actividad de su cuenta.

<Tabs>
  <Tab title="Añadir una suscripción">
    Comenzaremos suscribiendo a un usuario para que recibas todos los tipos de eventos.

    Copia la siguiente solicitud cURL en tu línea de comandos después de realizar cambios en lo siguiente:

    * **Webhook ID** `<:WEBHOOK_ID>` p. ej. `1234567890`

    * **Nombre de la clave de consumidor** `<CONSUMER_KEY>` p. ej. `xvz1evFS4wEEPTGEFPHBog`

    * **Token de acceso del usuario suscrito** `<SUBSCRIBING_USER'S_ACCESS_TOKEN>` p. ej. `370773112-GmHxMAgYyLbNEtIKZeRNFsMKPR9EyMZeS9weJAEb`

      ```
      curl --request POST --url https://api.x.com/1.1/account_activity/webhooks/<:WEBHOOK_ID>/subscriptions/all.json --header 'authorization: OAuth oauth_consumer_key="<CONSUMER_KEY>", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="<SUBSCRIBING_USER'S_ACCESS_TOKEN>", oauth_version="1.0"'
      ```
  </Tab>

  <Tab title="Ver suscripciones">
    Para ver una lista de todas las suscripciones de todos los tipos de actividad para un webhook especificado, copia la siguiente solicitud cURL en tu línea de comandos después de realizar cambios en lo siguiente:

    * **Webhook ID** `<:WEBHOOK_ID>` p. ej. `1234567890`

    * **Bearer Token** `<BEARER_TOKEN>` p. ej. `AAAAAAAAAAAA0%2EUifi76ZC9Ub0wn...`

      ```
      curl --request GET --url https://api.x.com/1.1/account_activity/webhooks/<:WEBHOOK_ID>/subscriptions/all/list.json --header 'authorization: Bearer <BEARER_TOKEN>'
      ```
  </Tab>

  <Tab title="Eliminar una suscripción">
    Después de la desactivación, todos los eventos del usuario solicitante dejarán de enviarse a la URL del webhook.

    Para desactivar una suscripción desde el contexto de usuario y la aplicación proporcionados, copia la siguiente solicitud cURL en tu línea de comandos después de realizar cambios en lo siguiente:

    * **Webhook ID** `<:WEBHOOK_ID>` p. ej. `1234567890`

    * **Consumer key** `<CONSUMER_KEY>` p. ej. `xvz1evFS4wEEPTGEFPHBog`

    * **Token de acceso del usuario suscrito** `<SUBSCRIBING_USER'S_ACCESS_TOKEN>` p. ej. `370773112-GmHxMAgYyLbNEtIKZeRNFsMKPR9EyMZeS9weJAEb`

      ```
      curl --request DELETE --url https://api.x.com/1.1/account_activity/webhooks/:WEBHOOK_ID/subscriptions/all.json --header 'authorization: OAuth oauth_consumer_key="CONSUMER_KEY", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="SUBSCRIBED_USER'S_ACCESS_TOKEN", oauth_version="1.0"'
      ```
  </Tab>
</Tabs>

¡Buen trabajo! Ahora deberías poder gestionar tus webhooks y usuarios suscritos.

<div id="referenced-articles">
  #### Artículos de referencia
</div>

* [Descripción general de la comprobación de desafío-respuesta (CRC)](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#securing-webhooks)
* [Tipos de datos de actividad de la cuenta](/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-data-object-structure
* [Gestión de webhooks y suscripciones](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#managing-webhooks-and-subscriptions)

<div id="a-video-walkthrough-of-the-account-activity-api">
  ## Un recorrido en video por la Account Activity API
</div>

En este recorrido en video, aprenderás sobre las funcionalidades de los niveles premium y Enterprise de la Account Activity API.

Al final de este video, habrás aprendido lo siguiente:

* Registrar un webhook
* Agregar una suscripción de usuario
* Eliminar una suscripción de usuario
* Recibir actividades de la cuenta
* Reproducir actividades de la cuenta

<iframe src="https://platform.x.com/embed/Tweet.html?dnt=false&embedId=twitter-widget-0&features=eyJ0ZndfdGltZWxpbmVfbGlzdCI6eyJidWNrZXQiOltdLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X2ZvbGxvd2VyX2NvdW50X3N1bnNldCI6eyJidWNrZXQiOnRydWUsInZlcnNpb24iOm51bGx9LCJ0ZndfdHdlZXRfZWRpdF9iYWNrZW5kIjp7ImJ1Y2tldCI6Im9uIiwidmVyc2lvbiI6bnVsbH0sInRmd19yZWZzcmNfc2Vzc2lvbiI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9LCJ0ZndfZm9zbnJfc29mdF9pbnRlcnZlbnRpb25zX2VuYWJsZWQiOnsiYnVja2V0Ijoib24iLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X21peGVkX21lZGlhXzE1ODk3Ijp7ImJ1Y2tldCI6InRyZWF0bWVudCIsInZlcnNpb24iOm51bGx9LCJ0ZndfZXhwZXJpbWVudHNfY29va2llX2V4cGlyYXRpb24iOnsiYnVja2V0IjoxMjA5NjAwLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X3Nob3dfYmlyZHdhdGNoX3Bpdm90c19lbmFibGVkIjp7ImJ1Y2tldCI6Im9uIiwidmVyc2lvbiI6bnVsbH0sInRmd19kdXBsaWNhdGVfc2NyaWJlc190b19zZXR0aW5ncyI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9LCJ0ZndfdXNlX3Byb2ZpbGVfaW1hZ2Vfc2hhcGVfZW5hYmxlZCI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9LCJ0ZndfdmlkZW9faGxzX2R5bmFtaWNfbWFuaWZlc3RzXzE1MDgyIjp7ImJ1Y2tldCI6InRydWVfYml0cmF0ZSIsInZlcnNpb24iOm51bGx9LCJ0ZndfbGVnYWN5X3RpbWVsaW5lX3N1bnNldCI6eyJidWNrZXQiOnRydWUsInZlcnNpb24iOm51bGx9LCJ0ZndfdHdlZXRfZWRpdF9mcm9udGVuZCI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9fQ%3D%3D&frame=false&hideCard=false&hideThread=false&id=1204084171334832128&lang=en&origin=https%3A%2F%2Fdeveloper.x.com%2Fen%2Fdocs%2Fx-api%2Fenterprise%2Faccount-activity-api%2Fquick-start%2Fa-visual-walkthrough-of-the-account-activity-api&sessionId=b5b8e259a4c6287be2413de9059093170036fb30&theme=light&widgetsVersion=2615f7e52b7e0%3A1702314776716&width=550px" />

* ¿Tienes preguntas? ¿Te aparecen errores?
  * Lee nuestras [preguntas frecuentes](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#frequently-asked-questions) o la [guía de resolución de errores](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#frequently-asked-questions).

* Explora nuestro código de ejemplo:
  * [Enterprise Account Activity API dashboard](https://github.com/xdevplatform/account-activity-dashboard-enterprise), una aplicación web en Node que muestra eventos de webhooks usando el nivel Enterprise de Account Activity API e incluye la funcionalidad de [Replay](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-replay-api).
  * El [SnowBot chatbot](https://github.com/xdevplatform/SnowBotDev), una aplicación web en Ruby creada con las APIs Enterprise Account Activity y Direct Message.

**Enterprise**

<div id="getting-started-with-webhooks">
  ## Introducción a los webhooks
</div>

La API Account Activity es una API basada en webhooks que envía eventos de cuenta a una aplicación web que desarrollas, implementas y alojas. 

Hay varios detalles técnicos que requieren atención antes de poder empezar a recibir eventos de webhook en tu aplicación receptora de eventos. Como se describe a continuación, deberás crear una aplicación de X, obtener acceso a la API Account Activity y desarrollar una aplicación web que consuma eventos de webhook. 

<div id="1-create-a-x-app">
  ### 1. Crea una aplicación de X.
</div>

* Crea una [aplicación de X](/es/resources/fundamentals/developer-apps) con una cuenta de desarrollador aprobada desde el [portal para desarrolladores](/es/resources/fundamentals/developer-portal). Si estás creando la aplicación en nombre de tu empresa, se recomienda que la crees con una cuenta corporativa de X. Para solicitar una cuenta de desarrollador, [haz clic aquí](/es/resources/fundamentals/developer-apps).
* En la pestaña [permissions](/es/resources/fundamentals/developer-apps#oauth-1-0a-app-permissions) de la página de tu aplicación, habilita “Read, Write and Access direct messages”.
* En la pestaña &quot;Keys and Access Tokens&quot;, toma nota de la Consumer Key (API Key) y del Consumer Token (API Secret) de tu aplicación.
* En la misma pestaña, genera el [Access Token and Access Token Secret](/es/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow) de tu aplicación. Necesitarás estos tokens de acceso para registrar la URL de tu webhook, que es donde X enviará los eventos de la cuenta.
* Si no estás familiarizado con [X Sign-in](/es/resources/fundamentals/authentication#log-in-with-x) y con cómo funcionan los contextos de usuario con la X API, revisa [Obtaining Access Tokens](https://dev.x.com/webhooks/access-tokens). A medida que agregues cuentas para las cuales recibir eventos, las suscribirás usando los tokens de acceso de esa cuenta.
* Toma nota del id numérico de tu aplicación, tal como aparece en la página [&quot;Apps&quot;](/es/resources/fundamentals/developer-apps) del [portal para desarrolladores](/es/resources/fundamentals/developer-portal). Cuando solicites acceso a la Account Activity API, necesitarás este id de aplicación.
   

<div id="2-get-account-activity-api-access">
  ### 2. Obtener acceso a Account Activity API
</div>

Después de crear una Aplicación de X, el siguiente paso es solicitar acceso a Account Activity API. 

Account Activity API solo está disponible en Enterprise, por lo que deberás enviar una solicitud usando el siguiente enlace.

<Button href="https://developer.x.com/en/enterprise-application.html">
  Solicitar acceso a Enterprise
</Button>

<div id="3-develop-webhook-consumer-app">
  ### 3. Desarrollar la aplicación consumidora de webhooks
</div>

Una vez que hayas recibido acceso a la Account Activity API, necesitas desarrollar, desplegar y alojar una aplicación web que reciba eventos de webhooks de X. 

* Crea una aplicación web con una URL que usarás como tu webhook para recibir eventos. Este es el endpoint desplegado en tu servidor que escuchará los eventos de webhooks entrantes de X. 
  * La *path* del URI es totalmente decisión tuya. Este ejemplo sería válido: https://mydomain.com&#95;/service/listen&#95;

  * Si estás escuchando webhooks de una variedad de fuentes, un patrón común es: https://mydomain.com/webhook/twitter

  * Ten en cuenta que la URL especificada no puede incluir una especificación de puerto (https://mydomain.com:5000/NoWorkie).

* Como se describe en nuestra guía de [Protección de webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#securing-webhooks), un primer paso es escribir código que reciba una solicitud GET de X Challenge Response Check (CRC) y responda con una respuesta JSON con el formato adecuado. 

* Registra la URL de tu webhook. Harás una solicitud POST al endpoint /webhooks.json?url=. Cuando realices esta solicitud, X enviará una solicitud CRC a tu aplicación web. Cuando un webhook se registra correctamente, la respuesta incluirá un webhook id. Este webhook id se necesita más adelante al realizar algunas solicitudes a la Account Activity API. 

* X enviará eventos de webhook de cuenta a la URL que registraste. Asegúrate de que tu aplicación web admita solicitudes POST para eventos entrantes. Estos eventos se codificarán en JSON. Consulta [aquí](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-data-object-structure) para ver ejemplos de cargas útiles JSON de webhooks.

* Una vez que tu aplicación web esté lista, el siguiente paso es agregar cuentas para las que recibir actividades. Al agregar (o eliminar) cuentas, harás solicitudes POST haciendo referencia al account id. Consulta nuestra [guía sobre cómo agregar suscripciones](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#managing-webhooks-and-subscriptions) para obtener más información.

<div id="4-validate-setup">
  ### 4. Validar la configuración
</div>

* Para validar que tu aplicación y webhook están configurados correctamente, marca como favorita una Publicación publicada por una de las cuentas de X a las que tu aplicación está suscrita. Deberías recibir un `favorite_events` mediante una solicitud POST a tu URL de webhook por cada favorito que reciban esas cuentas.
* Ten en cuenta que la entrega de eventos puede tardar hasta 10 segundos en comenzar después de que se haya añadido una suscripción.

**Notas importantes**

* Al registrar tu URL de webhook, tu aplicación web debe autenticarse con su token y secreto de consumidor *y con el Token de acceso y el secreto del usuario propietario de la aplicación*. 

* Todos los Mensajes Directos entrantes se entregarán mediante webhooks. Todos los Mensajes Directos enviados mediante [POST direct&#95;messages/events/new (message&#95;create)](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/new-event) también se entregarán mediante webhooks. Esto es para que tu aplicación web pueda conocer los Mensajes Directos enviados a través de un cliente diferente.

* Ten en cuenta que cada evento de webhook incluye un ID de usuario `for_user_id` que indica para qué suscripción se entregó el evento.

* Si tienes dos usuarios usando tu aplicación web para Mensajes Directos en la misma conversación, tu webhook recibirá dos eventos duplicados (uno por cada usuario). Tu aplicación web debe tener esto en cuenta. 

* Si tienes más de una aplicación web que comparte la misma URL de webhook y el mismo usuario asignado a cada aplicación, el mismo evento se enviará a tu webhook varias veces (una por cada aplicación web).

* En algunos casos, tu webhook puede recibir eventos duplicados. Tu aplicación de webhook debe ser tolerante a ello y eliminar duplicados usando el ID del evento.

* No esperes que la respuesta de Quick Reply siga directamente a una solicitud. Un usuario puede ignorar una solicitud de Quick Reply y responder mediante un Mensaje Directo tradicional. El usuario también puede proporcionar una respuesta de Quick Reply a una solicitud a la que no haya respondido anteriormente en el hilo de mensajes.

* Consulta el código de ejemplo:
  * [Enterprise Account Activity API dashboard](https://github.com/xdevplatform/account-activity-dashboard-enterprise), una aplicación web en Node que muestra eventos de webhook utilizando el nivel Enterprise de la Account Activity API e incluye funcionalidad de [Replay](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-replay-api).

  * El [chatbot SnowBot](https://github.com/xdevplatform/SnowBotDev), una aplicación web en Ruby creada sobre las Account Activity y Direct Message APIs. Este código fuente incluye un [script](https://github.com/xdevplatform/SnowBotDev/wiki/Account-Activity-API-setup-script) para ayudar a configurar los webhooks de la Account Activity API.

<div id="securing-webhooks">
  ## Proteger los webhooks
</div>

Las API de X basadas en webhooks proporcionan dos métodos para confirmar la seguridad de tu servidor de webhooks:

1. Las comprobaciones de tipo desafío-respuesta permiten que X confirme la propiedad de la aplicación web que recibe eventos de webhooks. 
2. El encabezado de firma en cada solicitud POST te permite confirmar que X es el origen de los webhooks entrantes.
    

<div id="challenge-response-checks">
  ### Verificaciones de desafío-respuesta
</div>

Para verificar que eres tanto el propietario de la Aplicación como de la URL del webhook, X realizará una verificación de desafío-respuesta (CRC), que no debe confundirse con una comprobación de redundancia cíclica. Cuando se envía un CRC, X hará una solicitud GET a tu aplicación web con un parámetro *`crc_token`*. Cuando se reciba esa solicitud, tu aplicación web debe generar un `response_token` cifrado a partir del parámetro *`crc_token`* y del Consumer Secret de tu Aplicación (detalles a continuación). El `response_token` debe codificarse en JSON (ver ejemplo más abajo) y devolverse en un plazo de tres segundos. Si la operación se realiza correctamente, se devolverá un `id` de webhook. 

Se enviará un CRC cuando registres tu URL de webhook, por lo que implementar tu código de respuesta CRC es un primer paso fundamental. Una vez que tu webhook esté establecido, X activará un CRC aproximadamente cada 24 horas desde la última vez que recibimos una respuesta correcta. Tu Aplicación también puede activar un CRC cuando sea necesario realizando una solicitud PUT con el `id` de tu webhook. Activar un CRC es útil mientras desarrollas tu aplicación de webhook, después de implementar nuevo código y reiniciar tu servicio. 

Debes suponer que el *`crc_token`* cambiará en cada solicitud CRC entrante y debe usarse como el mensaje en el cálculo, donde tu Consumer Secret es la clave.

En caso de que la respuesta no se envíe en un plazo de 3 segundos o se vuelva inválida, se dejarán de enviar eventos al webhook registrado.

<div id="the-crc-request-will-occur">
  #### La solicitud de CRC se realizará:
</div>

* Cuando se registre una URL de webhook.
* Aproximadamente *cada hora* para validar tu URL de webhook.
* Puedes activar manualmente un CRC haciendo una solicitud PUT. A medida que desarrolles tu cliente de webhook, deberías planificar activar manualmente el CRC al mismo tiempo que desarrollas tu respuesta de CRC. 
   

<div id="response-requirements">
  #### Requisitos de la respuesta:
</div>

* Un hash HMAC SHA-256 codificado en Base64 creado a partir del `crc_token` y el Consumer Secret de tu Aplicación
* `response_token` válido y en formato JSON.
* Latencia inferior a 3 segundos.
* Código de respuesta HTTP 200.
   

<div id="language-specific-hmac-libraries">
  #### Bibliotecas HMAC por lenguaje:
</div>

* [Java/Scala](https://docs.oracle.com/javase/8/docs/api/index.html?javax/crypto/Mac.html)
* [Ruby](http://ruby-doc.org/stdlib-2.1.0/libdoc/openssl/rdoc/OpenSSL/HMAC.html)
* [Node.js](https://nodejs.org/api/crypto.html#crypto_class_hmac)
* [Python](https://docs.python.org/2/library/hmac.html)

<div id="example-response-token-generation-in-python">
  #### Ejemplo de generación de token de respuesta en Python:
</div>

Lo siguiente define una ruta en una aplicación web Flask para Python 2.7 que responderá correctamente a la comprobación de desafío-respuesta.

```
import base64
import hashlib
import hmac
import json


\# Defines a route for the GET request
@app.route('/webhooks/twitter', methods=\['GET'\])
def webhook_challenge():

  # crea un hash HMAC SHA-256 a partir del token entrante y tu clave secreta de consumidor
  sha256\_hash\_digest = hmac.new(TWITTER\_CONSUMER\_SECRET, msg=request.args.get('crc_token'), digestmod=hashlib.sha256).digest()

  # construye los datos de respuesta con el hash codificado en base64
  response = {
    'response\_token': 'sha256=' + base64.b64encode(sha256\_hash_digest)
  }

  # devuelve una respuesta JSON con el formato correcto
  return json.dumps(response)
```

<div id="example-json-response">
  #### Ejemplo de respuesta JSON:
</div>

Con la ruta definida como se indicó arriba, tu aplicación web debería devolver una respuesta similar a la siguiente cuando accedas a [https://your-app-domain/webhooks/twitter?crc&#95;token=foo](https://your-app-domain/webhooks/twitter?crc_token=foo) en tu navegador web.

```
{
  "response_token": "sha256=x0mYd8hz2goCTfcNAaMqENy2BFgJJfJOb4PdvTffpwg="
}
```

<div id="other-examples">
  #### Otros ejemplos:
</div>

* [AQUÍ](https://github.com/xdevplatform/account-activity-dashboard/blob/master/helpers/security.js) encontrarás un método de respuesta CRC de ejemplo implementado en Node.js.
* [AQUÍ](https://github.com/xdevplatform/SnowBotDev/blob/master/app/controllers/snow_bot_dev_app.rb) encontrarás un método de respuesta CRC de ejemplo implementado en Ruby (consulta *generate&#95;crc&#95;response* y la ruta GET que recibe eventos CRC).

<div id="optional-signature-header-validation">
  ### Validación opcional del encabezado de firma
</div>

Cuando se recibe una solicitud POST proveniente de X, se envía una solicitud GET para crear un webhook o se envía una solicitud GET para realizar un CRC manual, se incluirá una firma hash en los encabezados como x-twitter-webhooks-signature. Esta firma se puede usar para validar que el origen de los datos sea X. La firma hash de la solicitud POST comienza con sha256=, lo que indica el uso de HMAC SHA-256 para cifrar el Consumer Secret de tu App de X y la carga útil. El hash de la solicitud GET se calcula a partir de la cadena de parámetros de consulta crc&#95;token=$token&amp;nonce=$nonce. 

**Pasos para validar una solicitud**

1. Crea un hash usando tu Consumer Secret y el cuerpo de la carga útil entrante.
2. Compara el hash creado con el valor de x-twitter-webhooks-signature codificado en base64. Usa un método como [compare&#95;digest](https://docs.python.org/2/library/hmac.html) para reducir la vulnerabilidad a ataques de temporización.

<div id="additional-security-guidelines">
  ### Directrices de seguridad adicionales
</div>

A continuación se presentan directrices de seguridad adicionales que debes tener en cuenta para tu aplicación web. No implementar estas directrices no impedirá que tu webhook funcione, pero el equipo de Seguridad de la Información de X las recomienda encarecidamente. Si no estás familiarizado con las recomendaciones que se indican a continuación, consulta con el administrador de tu servidor.

<div id="x-aggregate-network-blocks">
  #### Bloques de red agregados de X
</div>

Para mayor seguridad, quizá desees agregar los siguientes bloques de red agregados a una lista de permitidos (allowlist):

* 199.59.148.0/22

* 199.16.156.0/22

* 192.133.77.0/26

* 64.63.15.0/24

* 64.63.31.0/24

* 64.63.47.0/24

* 202.160.128.0/24

* 202.160.129.0/24

* 202.160.130.0/24

<div id="recommended-server-configurations">
  #### Configuraciones recomendadas del servidor
</div>

* Calificación &quot;A&quot; en la prueba de [ssllabs.com](http://ssllabs.com/)
* **Habilitar TLS 1.2**
* Habilitar Forward Secrecy
* Desactivar SSLv2
* Desactivar SSLv3 (debido a POODLE)
* Desactivar TLS 1.0
* Desactivar TLS 1.1
* Desactivar la compresión TLS
* Desactivar Session Tickets a menos que rote las claves de Session Tickets.
* Establecer la opción “ssl&#95;prefer&#95;server&#95;ciphers” o “SSLHonorCipherOrder” en la configuración SSL a “on”.
* Asegurarse de que la lista de cifrados corresponda a una lista moderna como:
  `ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES128-SHA256:AES128-SHA:AES256-GCM-SHA384:AES256-SHA256:AES256-SHA:ECDHE-RSA-DES-CBC3-SHA:DES-CBC3-SHA`

<div id="managing-webhooks-and-subscriptions">
  ## Administración de webhooks y suscripciones
</div>

<div id="creating-changing-webhooks">
  ### Creación y modificación de webhooks
</div>

Para cambiar las URL de los webhooks, debes eliminar el webhook existente y luego crear uno nuevo. Ten en cuenta que, cuando hagas esto, deberás volver a añadir las suscripciones de usuario al nuevo webhook.

<div id="webhook-configuration-management-endpoints">
  #### Endpoints para la gestión de la configuración de webhooks:
</div>

|     |     |
| :--- | :--- |
| **Método** | Enterprise |
| Registra una URL de webhook / Genera un webhook&#95;id | [POST webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#enterprise-account-activity-api) |
| Devuelve todas las URL de webhook y sus estados | [GET webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks) |
| Elimina la configuración de webhook actual de la aplicación | [DELETE webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id) |
| Activa manualmente una solicitud CRC | [PUT webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#put-account-activity-webhooks-webhook-id) |

<div id="why-cant-i-just-update-the-webhook-url">
  #### ¿Por qué no puedo simplemente actualizar la URL del webhook?
</div>

¿Por qué las configuraciones de webhook son inmutables? X se toma la seguridad muy en serio. Si se cambia la URL de tu webhook, existe la posibilidad de que la consumer key y el consumer secret de tu Aplicación se hayan visto comprometidos. Al exigirte crear una nueva configuración de webhook, también se requiere que vuelvas a suscribirte a los eventos de tu usuario. Esto requiere el uso de Tokens de acceso, que es menos probable que una parte malintencionada posea. Como resultado, se reduce la probabilidad de que otra parte reciba la información privada de tu usuario.
 

<div id="adding-removing-user-subscriptions">
  ### Agregar y eliminar suscripciones de usuarios
</div>

La compatibilidad con miles de suscripciones está disponible con el nivel Enterprise. Si ya cuenta con un responsable de cuenta, póngase en contacto con esa persona si tiene preguntas. Para solicitar acceso a las APIs Enterprise, [haga clic aquí](https://developer.x.com/en/products/x-api/enterprise). 

<div id="subscription-management-endpoints">
  #### Endpoints para la gestión de suscripciones
</div>

|     |     |
| :--- | :--- |
| Método | Enterprise |
| Agregar una nueva suscripción de usuario | [POST webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks-webhook-id-subscriptions-all) |
| Obtener una suscripción de usuario | [GET webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all) |
| Devuelve una lista de todas las suscripciones activas | [GET webhooks/:webhook&#95;id/subscriptions/all/list](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-subscriptions-count) |
| Desactiva una suscripción de usuario mediante OAuth solo de aplicación (app-only) | [DELETE webhooks/:webhook&#95;id/subscriptions/:user&#95;id/all.json](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-user-id-all-json) |

Account Activity API: Enterprise

<Note>
  **Tenga en cuenta**: 

  X debe habilitar el acceso a la Account Activity API para su aplicación de desarrollador antes de que pueda empezar a usar la API. Para ello, asegúrese de compartir el App ID que tiene previsto utilizar para fines de autenticación con su gestor de cuenta o equipo de soporte técnico.
</Note>

La [Account Activity API](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity) consta de un conjunto de endpoints que le permiten crear y gestionar suscripciones de usuario para recibir actividad de cuenta en tiempo real de todas sus cuentas suscritas a través de una única conexión. 

Hay dos métodos de autenticación disponibles con la Account Activity API ([OAuth 1.0a](/es/resources/fundamentals/authentication#oauth-1-0a-2) y [OAuth 2.0 Bearer Token](/es/resources/fundamentals/authentication#bearer-token-also-known-as-app-only)). El método de autenticación que debe utilizar dependerá de qué endpoint esté usando.

|     |     |     |     |
| :--- | :--- | :--- | :--- |
| **Description** | **Endpoint ** | OAuth 1.0a  <br />(Contexto de usuario) | OAuth 2.0 Bearer Token (solo para aplicaciones) |
| Registrar una nueva URL de webhook para el contexto de aplicación dado | [POST account&#95;activity/webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks) | ✓   |     |
| Devolver todas las URL y sus estados para la aplicación dada | [GET account&#95;activity/webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks) |     | ✓   |
| Activar una verificación de respuesta de desafío (CRC) para la URL de un webhook dado | [PUT account&#95;activity/webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#put-account-activity-webhooks-webhook-id) | ✓   |     |
| Suscribir la aplicación a los eventos de cuenta de un usuario | [POST account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks-webhook-id-subscriptions-all) | ✓ * |     |
| Devolver el número de suscripciones actualmente activas | [GET account&#95;activity/subscriptions/count](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-subscriptions-count) |     | ✓   |
| Comprobar si una configuración de webhook está suscrita a los eventos de un usuario | [GET account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all) | ✓ * |     |
| Devolver una lista de suscripciones actualmente activas | [GET account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all/list](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all-list) |     | ✓   |
| Eliminar un webhook | [DELETE account&#95;activity/webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id) | ✓   |     |
| [OBSOLETO] Desactivar una suscripción para el contexto de usuario y aplicación proporcionados | [DELETE account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated) | ✓ * |     |
| Desactivar una suscripción usando OAuth solo para aplicaciones | [DELETE /account&#95;activity/webhooks/:webhook&#95;id/subscriptions/:user&#95;id/all.json](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-user-id-all-json) |     | ✓   |
| Volver a entregar las actividades a un webhook | [POST /1.1/account&#95;activity/replay/webhooks/:webhook&#95;id/subscriptions/all.json](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#replay-api) |     | ✓   |

*&#95; La autenticación requiere los tokens de acceso del usuario que se suscribe. &#95;

Para aquellos endpoints que requieren autenticación con contexto de usuario de OAuth 1.0a, deberás proporcionar las siguientes credenciales para autenticar la solicitud: 

* Consumer Keys (API Key y Secret)
* Tokens de acceso (Access Token y Secret)

En el caso de los siguientes tres endpoints, realizas acciones de escritura dentro del contexto de tu aplicación (no hay usuarios de X involucrados). Por lo tanto, los Tokens de acceso que debes proporcionar son los que pertenecen a tu aplicación de desarrollador. Estos se pueden generar directamente desde el [portal para desarrolladores](https://developer.x.com/en/portal/projects-and-apps), en la pestaña &quot;Keys and tokens&quot; de tu App.  

* [POST account&#95;activity/webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks): Registra una nueva URL de webhook para el contexto de aplicación indicado
* [PUT account&#95;activity/webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#put-account-activity-webhooks-webhook-id): Activa una verificación de respuesta de desafío (CRC) para la URL de un webhook determinado
* [DELETE account&#95;activity/webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id): Elimina un webhook

Por otro lado, en el caso de los siguientes tres endpoints, estás realizando una solicitud que permite que tu aplicación acceda a datos protegidos en nombre de un usuario de X (por ejemplo, Mensajes Directos). Por lo tanto, debes proporcionar los tokens de acceso que pertenecen al usuario suscriptor en cuestión. Los tokens de acceso necesarios se pueden obtener mediante el flujo OAuth de tres patas (consulta [OAuth 1.0a: how to obtain a user’s Access Tokens](/es/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow)). Estos endpoints se han marcado con un asterisco en la tabla anterior (*).

* [POST account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks-webhook-id-subscriptions-all): Suscribe la aplicación a los eventos de la cuenta de un usuario
* [GET account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all): Comprueba si una configuración de webhook está suscrita a los eventos de un usuario
* [DELETE account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated): Desactiva una suscripción para el contexto de usuario y la aplicación proporcionados [OBSOLETO]

<Note>
  **Ten en cuenta**: 

  Asegúrate de que tu aplicación de desarrollador tenga habilitada la opción &quot;Read, Write, and Direct Messages.&quot; Puedes cambiar esta configuración en la [Projects &amp; Apps section](https://developer.x.com/en/portal/projects-and-apps) de tu cuenta de desarrollador, en “App permissions” para la aplicación de desarrollador seleccionada. Tendrás que volver a generar las credenciales de tu aplicación después de cambiar la configuración de permisos.
</Note>

La lista de todos los endpoints disponibles con la Account Activity API, incluida la descripción asociada y ejemplos de solicitudes cURL con ejemplos de implementación de autenticación, se encuentra en [la documentación de referencia de la API](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-api-reference-index).

Para obtener información adicional, consulta la [aplicación web de ejemplo y los scripts auxiliares](https://github.com/xdevplatform/account-activity-dashboard-enterprise) de XDev para comenzar con la Enterprise Account Activity API.

<Note>
  **Ten en cuenta**: 

  X debe habilitar el acceso a la Account Activity API para tu aplicación de desarrollador antes de que puedas empezar a usar la API. Para ello, asegúrate de compartir el App ID que deseas usar con fines de autenticación con tu gestor de cuenta o con el equipo de soporte técnico.
</Note>

La [Account Activity API](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity) consta de un conjunto de endpoints que te permiten crear y gestionar suscripciones de usuario para recibir actividades de cuenta en tiempo real para todas tus cuentas suscritas a través de una única conexión. 

Hay dos métodos de autenticación disponibles para la Account Activity API ([OAuth 1.0a](/es/resources/fundamentals/authentication#oauth-1-0a-2) y [OAuth 2.0 Bearer Token](/es/resources/fundamentals/authentication#oauth-2-0)). El método de autenticación que debes usar dependerá del endpoint que estés utilizando.

|     |     |     |     |
| :--- | :--- | :--- | :--- |
| **Descripción** | **Endpoint ** | OAuth 1.0a  <br />(contexto de usuario) | OAuth 2.0 Bearer Token (solo aplicación) |
| Registrar una nueva URL de webhook para el contexto de aplicación indicado | [POST account&#95;activity/webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks) | ✓   |     |
| Devolver todas las URL y sus estados para la aplicación indicada | [GET account&#95;activity/webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks) |     | ✓   |
| Activar una comprobación de respuesta de desafío (CRC) para la URL de un webhook determinado | [PUT account&#95;activity/webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#put-account-activity-webhooks-webhook-id) | ✓   |     |
| Suscribir la aplicación a los eventos de la cuenta de un usuario | [POST account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks-webhook-id-subscriptions-all) | ✓ * |     |
| Devolver un recuento de las suscripciones activas actualmente | [GET account&#95;activity/subscriptions/count](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-subscriptions-count) |     | ✓   |
| Comprobar si una configuración de webhook está suscrita a los eventos de un usuario | [GET account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all) | ✓ * |     |
| Devolver una lista de las suscripciones activas actualmente | [GET account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all/list](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all-list) |     | ✓   |
| Eliminar un webhook | [DELETE account&#95;activity/webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id) | ✓   |     |
| [EN DESUSO] Desactivar una suscripción para el contexto de usuario y la aplicación proporcionados | [DELETE account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated) | ✓ * |     |
| Desactivar una suscripción usando OAuth solo para aplicación | [DELETE /account&#95;activity/webhooks/:webhook&#95;id/subscriptions/:user&#95;id/all.json](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-user-id-all-json) |     | ✓   |
| Volver a entregar actividades a un webhook | [POST /1.1/account&#95;activity/replay/webhooks/:webhook&#95;id/subscriptions/all.json](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#replay-api) |     | ✓   |

*&#95; La autenticación requiere los tokens de acceso del usuario que se suscribe. &#95;

Para aquellos endpoints que requieren autenticación en el contexto de usuario de OAuth 1.0a, debes proporcionar las siguientes credenciales para autenticar la solicitud: 

* Consumer Keys (API Key y Secret)
* Tokens de acceso (Access Token y Secret)

En el caso de los tres endpoints siguientes, realizas acciones de escritura dentro del contexto de tu aplicación (no intervienen usuarios de X). Por lo tanto, los tokens de acceso que debes proporcionar son los que pertenecen a tu aplicación de desarrollador. Estos pueden generarse directamente desde el [portal para desarrolladores](https://developer.x.com/en/portal/projects-and-apps), en la pestaña “Keys and tokens” de tu App.  

* [POST account&#95;activity/webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks): Registrar una nueva URL de webhook para el contexto de aplicación indicado
* [PUT account&#95;activity/webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#put-account-activity-webhooks-webhook-id): Activar una comprobación de respuesta de desafío (CRC) para la URL de un webhook determinado
* [DELETE account&#95;activity/webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id): Eliminar un webhook

Por otro lado, en el caso de los siguientes tres endpoints, se realiza una solicitud que permite que tu aplicación acceda a datos protegidos en nombre de un usuario de X (por ejemplo, Mensajes Directos). Por lo tanto, debes proporcionar los tokens de acceso que pertenecen al usuario suscriptor en cuestión. Los tokens de acceso requeridos pueden obtenerse mediante el flujo OAuth de tres patas (consulta [OAuth 1.0a: how to obtain a user’s Access Tokens](/es/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow)). Estos endpoints se han marcado con un asterisco en la tabla anterior (*).

* [POST account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks-webhook-id-subscriptions-all): Suscribir la aplicación a los eventos de la cuenta de un usuario
* [GET account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all): Comprobar si una configuración de webhook está suscrita a los eventos de un usuario
* [DELETE account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated): Desactivar una suscripción para el contexto de usuario y la aplicación proporcionados [DEPRECATED]

<Note>
  **Ten en cuenta**: 

  Asegúrate de que tu aplicación de desarrollador esté habilitada para &quot;Read, Write, and Direct Messages.&quot; Puedes cambiar esta configuración en la [sección Projects &amp; Apps](https://developer.x.com/en/portal/projects-and-apps) de tu cuenta de desarrollador, en “App permissions” para la aplicación de desarrollador seleccionada. Tendrás que volver a generar las credenciales de tu App después de cambiar la configuración de permisos.
</Note>

La lista de todos los endpoints disponibles con la API Account Activity, incluida la descripción asociada y ejemplos de solicitudes cURL con ejemplos de implementación de autenticación, se encuentra en [la documentación de referencia de la API](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-api-reference-index).

Para obtener información adicional, consulta la [aplicación web de ejemplo y los scripts auxiliares](https://github.com/xdevplatform/account-activity-dashboard-enterprise) de XDev para comenzar a trabajar con la API Enterprise Account Activity.

<div id="retries">
  ## Reintentos
</div>

`Enterprise`

Uno de los beneficios del nivel Enterprise de la Account Activity API es un mecanismo de reintento para los eventos de webhook. Si no se recibe un código de respuesta HTTP 200 de éxito (&quot;success&quot;), el servidor de X iniciará un mecanismo de reintento, reenviando el evento de webhook hasta tres veces durante un período de cinco minutos. Este servicio de reintento de eventos de webhook ayuda a ofrecer fiabilidad y recuperación de eventos cuando se producen problemas de red y durante interrupciones del servicio y despliegues en el lado del cliente.
 

<div id="what-are-retries">
  ### ¿Qué son los reintentos?
</div>

La API Account Activity proporciona una función de reintento cuando la aplicación web del cliente no devuelve una respuesta 200 de &quot;éxito&quot; para un evento de webhook de actividad de cuenta. Cuando el cliente no confirma la recepción correcta de un evento, X asume que el evento no se recibió. Si se recibe una respuesta distinta de 200, no se recibe una respuesta en un plazo de tres segundos o no recibimos ninguna respuesta, volvemos a intentar la solicitud y la dejamos abierta durante tres segundos. Esto significa que dispones de aproximadamente cinco segundos en dos intentos para responder y poder recibir la actividad que intentamos enviar a tu URL de webhook. En caso de que tu servidor no responda o devuelva un error transitorio, volveremos a intentarlo durante cinco minutos. Habrá un total de tres reintentos para confirmar la validación. Esto proporciona redundancia y garantiza que recibas todos los eventos del webhook. Ten en cuenta que las suscripciones con reintentos recibirán eventos reintentados para cualquier/todas las actividades de todos los usuarios suscritos en su webhook.

Si no confirmas la validación dentro de estos ocho intentos, la actividad ya no estará disponible a través de la API Account Activity. 

<div id="retry-timeline">
  ### Cronología de reintentos
</div>

La Account Activity API intentará realizar hasta tres reintentos durante un período de cinco minutos, hasta que se reciba una respuesta 200. Consulta la siguiente tabla para obtener más detalles. Transcurridos unos cinco minutos, la actividad no se puede volver a enviar a través de la Account Activity API. Deberás usar otros endpoints de X para recopilar los datos que faltan. Por ejemplo, las [search APIs](/es/x-api/enterprise-gnip-2.0/fundamentals/search-api) se pueden utilizar para recuperar Publicaciones, Retweets, Quote Tweets, Menciones y Respuestas relevantes. Los Mensajes Directos que falten se pueden recuperar con [este endpoint](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/list-events).

<div id="retries-timeline">
  #### Cronograma de reintentos
</div>

|     |
| :--- |
| Actividad creada, se realiza un POST a la URL del webhook desde la Account Activity API y se agota el tiempo de espera a los tres segundos. |
| Espera tres segundos después de que finalice el tiempo de espera anterior, luego realiza un POST a la URL del webhook desde la Account Activity API y se agota el tiempo de espera a los tres segundos. |
| Espera 27 segundos después de que finalice el tiempo de espera anterior, luego realiza un POST a la URL del webhook desde la Account Activity API y se agota el tiempo de espera a los tres segundos. |
| Espera 242 segundos después de que finalice el tiempo de espera anterior, luego realiza un POST a la URL del webhook desde la Account Activity API y se agota el tiempo de espera a los tres segundos. |
| Después de esto, la Account Activity API dejará de intentar hacer POST. El cliente debe usar otros endpoints de X para recuperar los datos. |

<div id="account-activity-data-object-structure">
  ## Estructura del objeto de datos de Account Activity
</div>

| Object | Details |
| :--- | :--- |
| for&#95;user&#95;id | Identifica la suscripción de usuario a la que está asociado el evento. |
| is&#95;blocked&#95;by | (condicional) Se muestra solo cuando otro usuario menciona a tu usuario suscrito. Se incluye si es true únicamente para eventos de mención de Publicaciones. |
| source | El usuario que realiza la actividad. Por ejemplo, el usuario que está siguiendo, bloqueando o silenciando es el usuario de origen. |
| target | El usuario al que se aplica la actividad. Por ejemplo, el usuario que está siendo seguido, bloqueado o silenciado es el usuario de destino. |

**Actividades disponibles**

| Message Type | Details |
| :--- | :--- |
| [tweet&#95;create&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#tweet-create-events-posts-retweets-replies-quotetweets) | Carga útil de estado de la Publicación cuando se realiza cualquiera de las siguientes acciones por parte del usuario de la suscripción o hacia él: Publicaciones, Retweets, Respuestas, @menciones, QuoteTweets, Retweet de QuoteTweets. |
| [favorite&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#favorite-events) | Evento de marcar como favorito (Me gusta) con el usuario y el destino. |
| [follow&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#follow-events) | Evento de seguir con el usuario y el destino. |
| [unfollow&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#unfollow-events) | Evento de dejar de seguir con el usuario y el destino. |
| [block&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#block-events) | Evento de bloqueo con el usuario y el destino. |
| [unblock&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#unblock-events) | Evento de desbloqueo con el usuario y el destino. |
| [mute&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#mute-events) | Evento de silenciamiento con el usuario y el destino. |
| [unmute&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#unmute-events) | Evento de dejar de silenciar con el usuario y el destino. |
| [user&#95;event](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#user-event) | Eventos de revocación enviados cuando un usuario elimina la autorización de la aplicación y la suscripción se elimina automáticamente. |
| [direct&#95;message&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#direct-message-events) | Estado de mensaje directo con el usuario y el destino cuando se envía o recibe un mensaje directo. |
| [direct&#95;message&#95;indicate&#95;typing&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#direct-message-indicate-typing-events) | Evento de indicación de escritura en mensaje directo con el usuario y el destino. |
| [direct&#95;message&#95;mark&#95;read&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#direct-message-mark-read-events) | Evento de marcado como leído de mensaje directo con el usuario y el destino. |
| [tweet&#95;delete&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#tweet-delete-events) | Aviso de Publicaciones eliminadas para facilitar el mantenimiento del cumplimiento normativo. |

**Ejemplos de carga útil**

Consulta los ejemplos de carga útil a continuación para cada evento de Account Activity descrito en la tabla anterior.

<div id="tweet_create_events-posts-retweets-replies-quotetweets">
  #### tweet&#95;create&#95;events (Publicaciones, Retweets, Respuestas, Publicaciones citadas)
</div>

```
{
	"for_user_id": "2244994945",
	"tweet_create_events": [
	  {
		<Tweet Object>
	  }
	]
}
```

<div id="tweet_create_events-mentions">
  #### tweet&#95;create&#95;events (@mentions)
</div>

```
{
	"for_user_id": "2244994945",
	"user_has_blocked": "false",
	"tweet_create_events": [
	  {
		<Tweet Object>
	  }
	]
}
```

<div id="favorite_events">
  #### favorite&#95;events
</div>

```
{
	"for_user_id": "2244994945",
	"favorite_events": [{
		"id": "a7ba59eab0bfcba386f7acedac279542",
		"created_at": "Mon Mar 26 16:33:26 +0000 2018",
		"timestamp_ms": 1522082006140,
		"favorited_status": {
			<Tweet Object>
		},
		"user": {
			<User Object>
		}
	}]
}
```

<div id="follow_events">
  #### follow&#95;events
</div>

```
{
	"for_user_id": "2244994945",
	"follow_events": [{
			"type": "follow",
			"created_timestamp": "1517588749178",
			"target": {
				<User Object >
			},
			"source": {
				< User Object >
			}
		]
	}
}
```

<div id="unfollow_events">
  #### unfollow&#95;events
</div>

```
{
	"for_user_id": "2244994945",
	"follow_events": [{
			"type": "unfollow",
			"created_timestamp": "1517588749178",
			"target": {
				<User Object >
			},
			"source": {
				< User Object >
			}
		]
	}
}
```

<div id="block_events">
  #### block&#95;events
</div>

```
{
	"for_user_id": "2244994945",
	"block_events": [{
		"type": "block",
		"created_timestamp": "1518127020304",
		"source": {
			<User Object>
		},
		"target": {
			<User Object>
		}
	}]
}
```

<div id="unblock_events">
  #### unblock&#95;events
</div>

```
{
	"for_user_id": "2244994945",
	"block_events": [{
		"type": "unblock",
		"created_timestamp": "1518127020304",
		"source": {
			<User Object>
		},
		"target": {
			<User Object>
		}
	}]
}
```

<div id="mute_events">
  #### mute&#95;events
</div>

```
{
	"for_user_id": "2244994945",
	"mute_events": [
		{
			"type": "mute",
		  	"created_timestamp": "1518127020304",
			"source": {
				<User Object>
			},
			"target": {
				<User Object>
			}
		}
	]
}
```

<div id="unmute_events">
  #### unmute&#95;events
</div>

```
{
	"for_user_id": "2244994945",
	"mute_events": [
		{
			"type": "unmute",
		  	"created_timestamp": "1518127020304",
			"source": {
				<User Object>
			},
			"target": {
				<User Object>
			}
		}
	]
}
```

<div id="user_event">
  #### user&#95;event
</div>

```
{
	"user_event": {
		"revoke": {
			"date_time": "2018-05-24T09:48:12+00:00",
			"target": {
				"app_id": "13090192"
			},
			"source": {
				"user_id": "63046977"
			}
		}
	}
}
```

<div id="direct_message_events">
  #### direct&#95;message&#95;events
</div>

```
{
  	"for_user_id": "4337869213",
	"direct_message_events": [{
		"type": "message_create",
		"id": "954491830116155396",
		"created_timestamp": "1516403560557",
		"message_create": {
			"target": {
				"recipient_id": "4337869213"
			},
			"sender_id": "3001969357",
			"source_app_id": "13090192",
			"message_data": {
				"text": "¡Hola Mundo!",
				"entities": {
					"hashtags": [],
					"symbols": [],
					"user_mentions": [],
					"urls": []
				}
			}
		}
	}],
	"apps": {
		"13090192": {
			"id": "13090192",
			"name": "FuriousCamperTestApp1",
			"url": "https://x.com/furiouscamper"
		},
		"users": {},
		"3001969357": {
			"id": "3001969357",
			"created_timestamp": "1422556069340",
			"name": "Jordan Brinks",
			"screen_name": "furiouscamper",
			"location": "Boulder, CO",
			"description": "Alter Ego - X PE opinions-are-my-own",
			"url": "https://t.co/SnxaA15ZuY",
			"protected": false,
			"verified": false,
			"followers_count": 22,
			"friends_count": 45,
			"statuses_count": 494,
			"profile_image_url": "null",
			"profile_image_url_https": "https://pbs.twimg.com/profile_images/851526626785480705/cW4WTi7C_normal.jpg"
		},
		"4337869213": {
			"id": "4337869213",
			"created_timestamp": "1448312972328",
			"name": "Harrison Test",
			"screen_name": "Harris_0ff",
			"location": "Burlington, MA",
			"protected": false,
			"verified": false,
			"followers_count": 8,
			"friends_count": 8,
			"profile_image_url": "null",
			"statuses_count": 240,
			"profile_image_url_https": "https://abs.twimg.com/sticky/default_profile_images/default_profile_normal.png"
		}
	}
}
```

<div id="direct_message_indicate_typing_events">
  #### direct&#95;message&#95;indicate&#95;typing&#95;events
</div>

```
{
	"for_user_id": "4337869213",
	"direct_message_indicate_typing_events": [{
		"created_timestamp": "1518127183443",
		"sender_id": "3284025577",
		"target": {
			"recipient_id": "3001969357"
		}
	}],
	"users": {
		"3001969357": {
			"id": "3001969357",
			"created_timestamp": "1422556069340",
			"name": "Jordan Brinks",
			"screen_name": "furiouscamper",
			"location": "Boulder, CO",
			"description": "Alter Ego - X PE las-opiniones-son-mías",
			"url": "https://t.co/SnxaA15ZuY",
			"protected": false,
			"verified": false,
			"followers_count": 23,
			"friends_count": 47,
			"statuses_count": 509,
			"profile_image_url": "null",
			"profile_image_url_https": "https://pbs.twimg.com/profile_images/851526626785480705/cW4WTi7C_normal.jpg"
		},
		"3284025577": {
			"id": "3284025577",
			"created_timestamp": "1437281176085",
			"name": "Bogus Bogart",
			"screen_name": "bogusbogart",
			"protected": true,
			"verified": false,
			"followers_count": 1,
			"friends_count": 4,
			"statuses_count": 35,
			"profile_image_url": "null",
			"profile_image_url_https": "https://pbs.twimg.com/profile_images/763383202857779200/ndvZ96mE_normal.jpg"
		}
	}
}
```

<div id="direct_message_mark_read_events">
  #### direct&#95;message&#95;mark&#95;read&#95;events
</div>

```
{
	"for_user_id": "4337869213",
	"direct_message_mark_read_events": [{
		"created_timestamp": "1518452444662",
		"sender_id": "199566737",
		"target": {
			"recipient_id": "3001969357"
		},
		"last_read_event_id": "963085315333238788"
	}],
	"users": {
		"199566737": {
			"id": "199566737",
			"created_timestamp": "1286429788000",
			"name": "Le Braat",
			"screen_name": "LeBraat",
			"location": "Denver, CO",
			"description": "data by day @X, design by dusk",
			"protected": false,
			"verified": false,
			"followers_count": 299,
			"friends_count": 336,
			"statuses_count": 752,
			"profile_image_url": "null",
			"profile_image_url_https": "https://pbs.twimg.com/profile_images/936652894371119105/YHEozVAg_normal.jpg"
		},
		"3001969357": {
			"id": "3001969357",
			"created_timestamp": "1422556069340",
			"name": "Jordan Brinks",
			"screen_name": "furiouscamper",
			"location": "Boulder, CO",
			"description": "Alter Ego - X PE opinions-are-my-own",
			"url": "https://t.co/SnxaA15ZuY",
			"protected": false,
			"verified": false,
			"followers_count": 23,
			"friends_count": 48,
			"statuses_count": 510,
			"profile_image_url": "null",
			"profile_image_url_https": "https://pbs.twimg.com/profile_images/851526626785480705/cW4WTi7C_normal.jpg"
		}
	}
}
```

<div id="tweet_delete_events">
  #### tweet&#95;delete&#95;events
</div>

```
{
    "for_user_id": "930524282358325248",
    "tweet_delete_events": [
{
        "status": {
            "id": "1045405559317569537",
            "user_id": "930524282358325248"
        },
        "timestamp_ms": "1432228155593"
    }
   ]
}
```

<div id="account-activity-replay-api">
  ## API de Reproducción de Actividad de Cuenta
</div>

`Enterprise`

La API de Reproducción de Actividad de Cuenta es una herramienta de recuperación de datos que te permite recuperar eventos de hasta cinco días atrás. Debe utilizarse para recuperar datos en escenarios en los que tu servidor de [webhook](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#enterprise-account-activity-api) pierde eventos, ya sea por desconexiones que duren más que la [ventana de reintento](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#retries), o en aquellos escenarios de recuperación ante desastres en los que necesitas unos días para restaurar tu sistema a la normalidad.

La API de Reproducción de Actividad de Cuenta se diseñó para cualquier escenario en el que no puedas procesar [actividades](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity) durante un período de tiempo. Envía las actividades al mismo webhook que se usa para la entrega original en tiempo real de las actividades. Este producto es una herramienta de recuperación y no de backfill, lo que significa que los eventos solo se volverán a reproducir si se intentó una entrega previa de los mismos. La API de Reproducción de Actividad de Cuenta no puede entregar eventos para un período de tiempo previo al momento de creación de una suscripción.

<div id="using-account-activity-replay-api">
  ### Uso de Account Activity Replay API
</div>

Si tu cuenta está configurada con la funcionalidad de Replay, puedes hacer solicitudes de manera similar a las solicitudes a la Account Activity API. Es importante tener en cuenta que tu solicitud debe especificar un parámetro webhook id para indicar las actividades de qué webhook deseas reproducir. En otras palabras, una solicitud de Replay le pide a Account Activity Replay API que recupere eventos desde una fecha y hora de inicio hasta una fecha y hora de finalización basándose en el webhook id y el application id.

Ten en cuenta que se espera que la hora esté en UTC. Estas actividades se entregan a través del webhook registrado asociado con el id a una tasa de hasta 2.500 eventos por segundo. También recuerda que solo puede ejecutarse un trabajo de Replay por webhook a la vez, aunque todas las suscripciones que estuvieron activas durante la fecha/hora especificada en ese webhook se reproducirán.

Los eventos se entregan comenzando con el primer (más antiguo) minuto del período de tiempo especificado y continúan cronológicamente (en la medida de lo posible) hasta que se entregue el último minuto. En ese momento, Replay entregará un [evento de finalización de trabajo](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#job-completed-successfully-message) al webhook. Dado que entregamos las actividades de forma cronológica, si hay pocos o ningún resultado coincidente cerca de la hora de inicio, probablemente habrá un período de tiempo antes de que se entreguen los primeros resultados.

<div id="limitations">
  ### Limitaciones
</div>

Replay está diseñado como una herramienta para recuperar fácilmente actividades de hasta cinco días en el pasado, pero no entregará eventos anteriores al momento en que se creó una suscripción. Por ejemplo, si hace tres días agregaste una nueva suscripción y ejecutaste un trabajo de Replay con una ventana de cinco días previos a hoy, solo recibirías datos correspondientes a los tres días durante los cuales esta nueva suscripción estuvo activa.

<div id="data-availability-and-types">
  ### Disponibilidad y tipos de datos
</div>

Las actividades de la Account Activity Replay API están disponibles durante cinco días a partir del inicio de la solicitud, y los nuevos datos pasan a estar disponibles aproximadamente 10 minutos después de que se crea una actividad determinada. Podrás realizar solicitudes especificando un intervalo de tiempo dentro de este período de cinco días utilizando los parámetros from&#95;date y to&#95;date en la solicitud. Los eventos que se entregaron originalmente antes de tener acceso a Replay no se pueden reproducir. Por ejemplo, si tu cuenta se habilitó para tener acceso a la Account Activity Replay API el 1 de junio de 2019 a las 3:30 p. m. UTC, no podrías usar Replay para recuperar ningún evento anterior a esa fecha y hora.

Continúa con la [referencia de la Account Activity Replay API](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated)

<div id="migration-introduction">
  ## Introducción a la migración
</div>

**En 2018 retiramos los productos Site Streams, User Streams y la versión beta estándar de Account Activity API - DM Only. Si has estado utilizando esos productos, asegúrate de migrar a la versión premium o Enterprise de Account Activity API.**

**También hemos retirado los endpoints heredados de Mensajes Directos. Si has estado utilizando esos endpoints, asegúrate de migrar a los nuevos endpoints de DM o a la versión premium o Enterprise de Account Activity API. **

**Consulta [este anuncio](https://devcommunity.x.com/t/details-and-what-to-expect-from-the-api-deprecations-this-week-on-august-16-2018/110746) para obtener más información.**

Estos son los endpoints que se verán afectados por estos cambios:

* User Streams
* Site Streams
* GET direct&#95;messages
* GET direct&#95;messages/sent
* GET direct&#95;messages/show
* POST direct&#95;messages/new
* POST direct&#95;messages/destroy
   

Disponemos de nuevos endpoints y servicios que proporcionan un acceso similar y, en el caso de los Mensajes Directos, funcionalidad adicional:

* Account Activity API [Enterprise](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#enterprise-account-activity-api) y [premium](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-api-reference-index)
* [GET direct&#95;messages/events/list](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/list-events)
* [GET direct&#95;messages/events/show](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/get-event)
* [POST direct&#95;messages/events/new](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/new-event)
* [POST direct&#95;messages/events/destroy](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/delete-message-event)

Para ayudarte a realizar una migración fluida a estos nuevos endpoints y servicios, contamos con dos guías de migración:

* [Guía de migración de Account Activity API](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#migration-guide-moving-from-user-streams-site-streams-to-account-activity-api) para quienes pasan de User Streams y Site Streams a nuestro nuevo servicio basado en webhooks
* [Guía de migración de Mensajes Directos](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/guides/direct-message-migration) para quienes migran entre endpoints REST de Mensajes Directos
   

Además, contamos con una [serie de videos](https://www.youtube.com/playlist?list=PLFKjcMIU2WshGG6Yj940XM7Z6BFs1zfBg) sobre Account Activity API y cómo empezar.

Y, por último, tenemos ejemplos de código para ayudarte a profundizar en el tema y comenzar rápidamente:

* El [Account Activity Dashboard](https://github.com/xdevplatform/Account-Activity-dashboard) es una aplicación web de ejemplo en Node.js con scripts auxiliares para comenzar con Account Activity API.
* [SnowBot](https://github.com/xdevplatform/SnowBotDev) es un chatbot de ejemplo que utiliza Account Activity API y endpoints REST de Mensajes Directos. Está escrito en Ruby, utiliza el framework web Sinatra y se implementa en Heroku.

<div id="migration-guide-moving-from-user-streamssite-streams-to-account-activity-api">
  ## Guía de migración: pasar de User Streams/Site Streams a Account Activity API
</div>

**A partir del 23 de agosto de 2018 retiramos tanto Site Streams como User Streams. Asegúrate de migrar a Account Activity API.**

**Revisa [este anuncio](https://devcommunity.x.com/t/details-and-what-to-expect-from-the-api-deprecations-this-week-on-august-16-2018/110746) para obtener más información.**

Esta guía está diseñada para ayudarte a migrar de las API heredadas User Streams y Site Streams a su reemplazo, Account Activity API. A continuación encontrarás un resumen de los cambios, una lista de las nuevas funciones y las principales diferencias y consideraciones para facilitar la transición. Para obtener orientación sobre la migración desde endpoints básicos de Mensajes Directos (DM), consulta la [guía de migración de Mensajes Directos](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/guides/direct-message-migration).

<div id="summary-of-changes">
  ### Resumen de los cambios
</div>

La API Account Activity proporcionará eventos para las cuentas autenticadas y suscritas mediante webhooks, en lugar de a través de una conexión de streaming como en User Streams y Site Streams.

<div id="deprecated-apis">
  #### APIs obsoletas
</div>

GET user

GET site (incluidos los flujos de control: GET site/c/:stream&#95;id,  GET site/c/:stream&#95;id/info.json,  GET site/c/:stream&#95;id/friends/ids.json,  POST site/c/:stream&#95;id/add&#95;user.json,  POST /site/c/:stream&#95;id/remove&#95;user.json)

<div id="replacement-apis">
  #### APIs de reemplazo
</div>

[Enterprise Account Activity API: todas las actividades](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#enterprise-account-activity-api)

<div id="differences-migration-considerations">
  ### Diferencias y consideraciones de migración
</div>

**Formato de la API:** La nueva Account Activity API funciona de manera diferente a User Streams y Site Streams. Deberás modificar tu aplicación web para recibir datos mediante webhooks. Puedes encontrar más información sobre webhooks [aquí](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#getting-started-with-webhooks).

**Datos disponibles:** Otra diferencia clave que notarás se refiere a los datos que se entregan. X ya no enviará eventos de personas a las que sigues en X (es decir, tu timeline principal o *home timeline*). Este fue un cambio intencional y no es algo que planeemos modificar en el futuro.

**Confiabilidad:** A diferencia del streaming, los webhooks permiten confirmar la entrega y ofrecen opciones para reintentar el envío de actividades enviadas mediante POST que no lleguen a la URL del webhook. Esto brinda mayor garantía de que la aplicación está recibiendo todas las actividades correspondientes, incluso si hay breves desconexiones o períodos de inactividad.

<div id="new-features">
  ### Nuevas funcionalidades
</div>

La Account Activity API ofrece muchas funcionalidades nuevas, entre ellas la más destacada es que ahora los datos se entregan mediante webhooks en lugar de streaming. Los webhooks ofrecen muchas ventajas en comparación con el streaming, pero las más importantes son la velocidad y la fiabilidad. La API enviará los datos en forma de eventos JSON a medida que estén disponibles y ya no será necesario mantener una conexión activa ni consultar periódicamente el endpoint. Esto reduce la necesidad de funcionalidades de redundancia y aumenta la eficiencia en general. Puedes encontrar más información sobre webhooks en la [documentación técnica](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#getting-started-with-webhooks).

<div id="managing-user-subscriptions">
  ### Gestión de suscripciones de usuarios
</div>

La API Account Activity permite múltiples suscripciones para un solo webhook registrado. Esto posibilita que la actividad de múltiples suscripciones de usuario se entregue en el mismo punto, de forma similar a la arquitectura de Site Streams, pero mediante webhooks. Esto significa que puedes hacer un seguimiento de las suscripciones, en lo que respecta a tus límites de suscripción, de forma independiente de la conexión del webhook. Esto también permite escalar desde solo una o unas pocas suscripciones hasta miles de suscripciones para un solo webhook.

<div id="how-to-migrate">
  ### **Cómo migrar**
</div>

<div id="follow-the-steps-below-to-easily-migrate-from-the-site-streams-api-to-the-account-activity-api">
  ### **Sigue los pasos a continuación para migrar fácilmente de la Site Streams API a la Account Activity API**
</div>

**Paso 1: Elige un paquete**

Según cómo estés operando actualmente con User Streams o Site Streams, deberías considerar pasarte a la versión Enterprise o premium de la Account Activity API. Ten en cuenta la cantidad de aplicaciones o usuarios autorizados que estás admitiendo actualmente y ajusta el escalado al volumen y a la fiabilidad necesarios. Al decidir qué paquete se ajusta mejor a tus necesidades, algunos aspectos que vale la pena considerar son:

* Número de webhooks necesarios
* Suscripciones/usuarios autorizados actuales y proyectados que se gestionan en tu aplicación
* Número actual de aplicaciones cliente de X
* El nivel de soporte que prefieres de X (soporte por foro o soporte Enterprise gestionado 1:1)
* Precio de cada paquete

**Paso 2:** **Verifica la configuración de tu X app en el portal para desarrolladores**

La [X app](/es/resources/fundamentals/developer-apps) que se utiliza actualmente para User Streams o Site Streams aparecerá para el usuario propietario dentro del [portal para desarrolladores](/es/resources/fundamentals/developer-portal). Esta X app también se puede usar para la Account Activity API para conservar los usuarios autorizados para esa aplicación. También se puede crear una aplicación nueva, y los usuarios pueden volver a autorizar esta nueva aplicación si se desea. Si estás creando una aplicación en nombre de una empresa, se recomienda que crees la aplicación con una cuenta corporativa de X @handle.

* Habilita “Read, Write and Access direct messages” en la pestaña [permissions](/es/resources/fundamentals/developer-apps#app-permissions) de la página de tu X app. 
  *Ten en cuenta que cambiar esta configuración no es retroactivo; cualquier usuario autorizado conservará la configuración de autorización del momento en que fue autorizado. Si un usuario aún no te ha otorgado acceso de lectura, escritura y mensajes directos, tendrás que pedirle que vuelva a autorizar tu aplicación.
* Si no estás familiarizado con [X Sign-in](/es/resources/fundamentals/authentication#log-in-with-x) y cómo funcionan los contextos de usuario con la X API, revisa [Obtaining Access Tokens](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#getting-started-with-webhooks).
* Genera tokens de acceso para el propietario de la X app en la parte inferior de la pestaña “Keys and Tokens”. En esta misma pestaña, toma nota de tu Consumer Key, Consumer Secret, Access Token y Access Token Secret. Los necesitarás para usar la API.
* Genera un Bearer Token utilizando tu Consumer Key y Consumer Secret para métodos de API de [application-only](/es/resources/fundamentals/authentication#bearer-token-also-known-as-app-only).

**Paso 3: Configura tus webhooks**

* Crea una aplicación web con un endpoint para usar como webhook y recibir eventos (por ejemplo, https://your&#95;domain.com/webhook/twitter o https://webhooks.your&#95;domain.com).

* Usa tu Consumer Key, Consumer Secret, Access Token y Access Token Secret cuando crees tu webhook. Ten en cuenta que tu endpoint debe devolver una respuesta JSON con un response&#95;token que sea un hash HMAC SHA-256 codificado en base64 creado a partir del crc&#95;token y tu Consumer Secret de la aplicación.

* Revisa la documentación de [Securing Webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#securing-webhooks), prestando especial atención a los requisitos de Challenge Response Check (CRC).

* Asegúrate de que tu webhook admita solicitudes POST para eventos entrantes y solicitudes GET para el CRC.

* Asegúrate de que tu webhook tenga baja latencia (&lt;3 segundos para responder a las solicitudes POST).

**Paso 4: Valida la configuración de tu webhook**

* Las API de webhooks protegerán tus webhooks de dos maneras:

               - Requerir comprobaciones de challenge response para validar que el propietario del webhook es el propietario de la aplicación web.

               - Incluir un encabezado de firma en cada solicitud POST para que tu aplicación web valide el origen.

* Para verificar que eres tanto el propietario de la aplicación web como de la URL del webhook, X realizará un Challenge Response Check (CRC), que no debe confundirse con un cyclic redundancy check.
* Se enviará una solicitud GET con un parámetro llamado crc&#95;token a la URL de tu webhook. Tu endpoint debe devolver una respuesta JSON con un response&#95;token que sea un hash HMAC SHA-256 codificado en base64 creado a partir del crc&#95;token y tu Consumer Secret de la aplicación.
* Se debe esperar que el crc&#95;token cambie con cada solicitud CRC entrante. El crc&#95;token se debe usar como mensaje en el cálculo, donde tu Consumer Secret es la clave.
* En caso de que la respuesta no sea válida, se dejarán de enviar eventos al webhook registrado.

**Paso 5: Crea suscripciones para cada usuario autorizado de User Streams o Site Streams**

Conversión a la Account Activity API desde User Streams:

* Obtén una lista de tus suscripciones de usuario actuales en User Streams
* Configura tus nuevas suscripciones de Account Activity API usando la solicitud:  *POST account&#95;activity/all/:env&#95;name/subscriptions*
* Confirma tus suscripciones de Account Activity API usando la solicitud:  &#95;GET account&#95;activity/all/:env&#95;name/subscriptions/list
   &#95;

Conversión a Account Activity API desde Site Streams: (usando streams de control):

* Obtén una lista de tus suscripciones actuales en Site Streams usando la solicitud:  *GET /1.1/site/c/:stream&#95;id/info.json*
* Configura tus nuevas suscripciones de Account Activity API usando la solicitud:  *POST account&#95;activity/all/:env&#95;name/subscriptions*
* Confirma tus suscripciones de Account Activity API usando la solicitud:  &#95;GET account&#95;activity/all/:env&#95;name/subscriptions/list
   &#95;

Registro de un webhook y creación de suscripciones (sin migrar desde Site Streams o User Streams)

* Registra la URL de tu webhook con tu aplicación usando [POST webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#enterprise-account-activity-api) y recibe un webhook&#95;id.
* Usa el webhook&#95;id devuelto para añadir suscripciones de usuario con [POST webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks-webhook-id-subscriptions-all).

<div id="the-account-activity-dashboard-sample-account-activity-api-application">
  ### El panel de Account Activity (aplicación de ejemplo de Account Activity API)
</div>

Hemos creado una aplicación de ejemplo para que probar la Account Activity API sea un poco más rápido:   

* Descarga la aplicación de ejemplo Account Activity Dashboard [aquí](https://github.com/xdevplatform/Account-Activity-dashboard) (usa Node.js)
* Sigue las instrucciones del README para instalar e iniciar la aplicación
* Una vez que la aplicación esté en ejecución, puedes usar la interfaz de usuario para configurar fácilmente tu webhook y crear una nueva suscripción

<div id="available-activities">
  ### Actividades disponibles
</div>

| Tipo de mensaje | Detalles |
| :--- | :--- |
| [tweet&#95;create&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#tweet-create-events-posts-retweets-replies-quotetweets) | Carga útil de estado de la Publicación cuando se realiza cualquiera de las siguientes acciones por parte del usuario suscrito o dirigidas a él: Publicaciones, Retweets, respuestas, @menciones, QuoteTweets. |
| [favorite&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#favorite-events) | Estado del evento de favorito (Me gusta) con el usuario y la cuenta de destino. |
| [follow&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#follow-events) | Evento de seguimiento con el usuario y la cuenta de destino. |
| [block&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#block-events) | Evento de bloqueo con el usuario y la cuenta de destino. |
| [mute&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#mute-events) | Evento de silenciar con el usuario y la cuenta de destino. |
| [direct&#95;message&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#direct-message-events) | Estado de mensaje directo con el usuario y la cuenta de destino. |
| [direct&#95;message&#95;indicate&#95;typing&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#direct-message-indicate-typing-events) | Evento de indicación de escritura en mensaje directo con el usuario y la cuenta de destino. |
| [direct&#95;message&#95;mark&#95;read&#95;events](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#direct-message-mark-read-events) | Evento de marcado como leído de mensaje directo con el usuario y la cuenta de destino. |

<div id="deprecated-streaming-message-types">
  ### Tipos de mensajes de streaming obsoletos
</div>

|     |     |
| :--- | :--- |
| Líneas en blanco | Las líneas en blanco ya no se entregarán en la Account Activity API, ya que se utilizaban como mensajes de keep-alive en User Streams y Site Streams. |
| Avisos de límite | Los avisos de límite ya no se enviarán a un webhook determinado. En su lugar, los usuarios pueden llamar a la API para obtener el uso actual de los identificadores disponibles. Esto se incluirá en el portal para desarrolladores en algún momento en el futuro. |
| Mensajes de desconexión | Los avisos de desconexión ya no serán necesarios, ya que los webhooks no dependen de una conexión activa. |
| Advertencias de saturación | Las advertencias de saturación ya no serán necesarias, ya que los webhooks no dependen de una conexión activa capaz de manejar grandes cantidades de mensajes entrantes. |
| Lista de amigos | Las listas de amigos ya no se enviarán de forma proactiva. Ahora habrá un endpoint REST para obtener esta información. |

<div id="deprecated-event-types">
  ### Tipos de eventos obsoletos
</div>

|     |     |     |     |     |
| :--- | :--- | :--- | :--- | :--- |
| **Descripción** | **Nombre del evento** | **Origen** | **Destino** | **Objeto de destino** |
| El usuario elimina una Publicación | delete | Usuario actual | Usuario actual | Publicación |
| Un usuario seguido elimina una Publicación | delete | Usuario seguido | Usuario seguido | Publicación |
| El usuario deja de marcar como favorita una Publicación | unfavorite | Usuario actual | Autor de la Publicación | Publicación |
| Se deja de marcar como favorita la Publicación del usuario | unfavorite | Usuario que deja de marcar como favorita | Usuario actual | Publicación |
| El usuario deja de seguir a alguien | unfollow | Usuario actual | Usuario seguido | Null |
| El usuario crea una lista | list&#95;created | Usuario actual | Usuario actual | Lista |
| El usuario elimina una lista | list&#95;destroyed | Usuario actual | Usuario actual | Lista |
| El usuario edita una lista | list&#95;updated | Usuario actual | Usuario actual | Lista |
| El usuario agrega a alguien a una lista | list&#95;member&#95;added | Usuario actual | Usuario agregado | Lista |
| El usuario es agregado a una lista | list&#95;member&#95;added | Usuario que agrega | Usuario actual | Lista |
| El usuario elimina a alguien de una lista | list&#95;member&#95;removed | Usuario actual | Usuario eliminado | Lista |
| El usuario es eliminado de una lista | list&#95;member&#95;removed | Usuario que elimina | Usuario actual | Lista |
| El usuario se suscribe a una lista | list&#95;user&#95;subscribed | Usuario actual | Propietario de la lista | Lista |
| La lista del usuario es suscrita | list&#95;user&#95;subscribed | Usuario que se suscribe | Usuario actual | Lista |
| El usuario cancela la suscripción a una lista | list&#95;user&#95;unsubscribed | Usuario actual | Propietario de la lista | Lista |
| Se cancela la suscripción a la lista del usuario | list&#95;user&#95;unsubscribed | Usuario que cancela la suscripción | Usuario actual | Lista |
| El usuario actualiza su perfil | user&#95;update | Usuario actual | Usuario actual | Null |
| El usuario actualiza su estado protegido | user&#95;update | Usuario actual | Usuario actual | Null |

<div id="direct-message-migration-guide">
  ## Guía de migración de Mensajes Directos
</div>

**El 17 de septiembre de 2018 retiramos los endpoints heredados de Mensajes Directos.
Si utilizabas esos endpoints, asegúrate de migrar a los nuevos endpoints de Mensajes Directos o a la API de Account Activity.**

**Consulta [este anuncio](https://devcommunity.x.com//t/details-and-what-to-expect-from-the-api-deprecations-this-week-on-august-16-2018/110746) para obtener más información.**

Esta guía está diseñada para ayudarte a migrar desde las APIs REST heredadas de Mensajes Directos a sus reemplazos mejorados, que han salido de la fase beta. A continuación encontrarás un resumen de los cambios, una lista de nuevas funciones y las diferencias y consideraciones clave para ayudarte en la transición. Los nuevos endpoints de Mensajes Directos ya están disponibles para todos los desarrolladores. Para obtener orientación sobre cómo migrar desde User Streams o Site Streams, consulta la [guía de migración a la API de Account Activity](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#migration-guide-moving-from-user-streams-site-streams-to-account-activity-api).

* [Resumen de cambios](#summary)
* [Nuevas funciones](#features)
* [Envío de Mensajes Directos](#sending)
* [Recepción de Mensajes Directos](#receiving)
* [Eliminación de Mensajes Directos](#deleting)

### Resumen de cambios

Si todavía usas los siguientes endpoints de DM, tendrás que migrar a los endpoints más recientes. 

| Endpoint obsoleto | Nueva alternativa para la migración |
| :--- | :--- |
| [POST direct&#95;messages/new](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/new-event) | [POST direct&#95;messages/events/new](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/new-event) |
| [GET direct&#95;messages/show](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/get-event) | [GET direct&#95;messages/events/show](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/get-event) |
| [GET direct&#95;messages](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/list-events) | [GET direct&#95;messages/events/list](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/list-events) |
| [GET direct&#95;messages/sent](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/get-event) | [GET direct&#95;messages/events/list](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/list-events) |
| [POST direct&#95;messages/destroy](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/delete-message-event) | [DELETE direct&#95;messages/events/destroy](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/delete-message-event "GET direct_messages/events/list") |

<div id="new-features">
  ### Nuevas funcionalidades
</div>

Los nuevos endpoints de la API de Mensajes Directos admiten varias funcionalidades nuevas y proporcionan un acceso mejorado a los Mensajes Directos anteriores. Las nuevas funcionalidades incluyen:

* Compatibilidad con adjuntos de contenido multimedia (imagen, GIF y vídeo).
* Posibilidad de solicitar a los usuarios respuestas estructuradas con una lista de opciones predefinida.
* Hasta 30 días de acceso a Mensajes Directos anteriores.

Para ver una lista completa de las nuevas funcionalidades de Mensajes Directos y los endpoints adicionales de la API, consulta la [documentación técnica](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/overview).
 

<div id="differences-migration-considerations">
  ### Diferencias y consideraciones de migración
</div>

Los nuevos endpoints de la API se comportan de manera muy diferente a los anteriores. Simplemente actualizar las URL de los endpoints provocará errores en tu aplicación. Ten en cuenta lo siguiente al actualizar tu aplicación durante la migración.

<div id="new-direct-message-object">
  #### Nuevo objeto de mensaje directo
</div>

Lo primero que probablemente notarás es la nueva estructura de objeto de los mensajes directos. Esta nueva estructura de objeto Message Create se ha introducido para habilitar nuevas funcionalidades como [Quick Replies](https://developer.x.com/en/docs/x-api/v1/direct-messages/quick-replies/overview) y [Attachments](https://developer.x.com/en/docs/x-api/v1/direct-messages/message-attachments/overview). El nuevo objeto también contiene un objeto de usuario más pequeño y condensado. Deberás actualizar tu aplicación para tener en cuenta esta nueva estructura de objeto al analizarlo y, potencialmente, en los modelos de datos o el almacenamiento. Para las descripciones de cada propiedad, consulta la [documentación completa sobre el objeto Message Create](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/guides/message-create-object).

**Ejemplo de objeto Message Create**

```json
{
      "type": "message_create",
      "id": "1234858592",
      "created_timestamp": "1392078023603",
      "initiated_via": {
        "tweet_id": "123456",
        "welcome_message_id": "456789"
      },
      "message_create": {
        "target": {
          "recipient_id": "1234858592"
        },
        "sender_id": "3805104374",
        "source_app_id": "268278",
        "message_data": {
          "text": "Blue Bird",
          "entities": {
            "hashtags": [],
            "symbols": [],
            "urls": [],
            "user_mentions": [],
          },
          "quick_reply_response": {
            "type": "options",
            "metadata": "external_id_2"
          },
          "attachment": {
            "type": "media",
            "media": {
             ...
            }
          }
        }
      }
```

<div id="summary">
  #### Resumen
</div>

* Estructura completamente nueva para el objeto de Mensaje Directo.
* Objeto de usuario simplificado.
* Se proporciona nueva información (respuestas rápidas, archivos adjuntos, etc.).

<div id="sending-direct-messages">
  ### Enviar Mensajes Directos
</div>

[POST direct&#95;messages/events/new](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/new-event) es un reemplazo directo para el envío de mensajes directos. La diferencia más significativa con este endpoint es que ahora toda la información se envía como JSON en el cuerpo de la solicitud POST, en lugar de como parámetros POST individuales.

**Ejemplo de solicitud Twurl**

```bash
twurl -A 'Content-type: application/json' -X POST /1.1/direct\_messages/events/new.json -d '{"event": {"type": "message\_create", "message\_create": {"target": {"recipient\_id": "4534871"}, "message_data": {"text": "Hello World!"}}}}'
```

Observa en la solicitud anterior que el tipo de contenido está establecido en application/json en lugar de application/x-www-form-urlencoded. Además, si estás creando la firma OAuth 1.0a, ten en cuenta que el cuerpo JSON no se incluye al generar la firma. La mayoría de las bibliotecas OAuth ya contemplan esto. Si estás usando [twurl](https://github.com/twitter/twurl), asegúrate de estar usando al menos la versión 0.9.3.

<div id="summary">
  #### Resumen
</div>

* El mensaje se define en el cuerpo de la solicitud POST en formato JSON
* El encabezado Content-Type debe establecerse en application/json
* El cuerpo JSON no se incluye al generar la firma OAuth.
   

<div id="retrieving-direct-messages">
  ### Recuperar Mensajes Directos
</div>

La recuperación de Mensajes Directos anteriores ahora se realiza mediante un único endpoint de la API: [GET direct&#95;messages/events/list](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/list-events). La diferencia significativa con este nuevo endpoint es que ahora devuelve tanto los mensajes enviados como los recibidos en orden cronológico inverso. Esto puede facilitar la reconstrucción de una conversación. Sin embargo, si solo buscas mensajes enviados o recibidos, deberás procesar posteriormente la respuesta haciendo referencia a la propiedad sender&#95;id.

La paginación ahora se basa en un valor de cursor en lugar del id de un Mensaje Directo. Se devuelve una propiedad cursor con cada respuesta. [GET direct&#95;messages/events/list](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/list-events) devolverá hasta 30 días de mensajes anteriores, independientemente de cuántos mensajes existan en esos 30 días. Cuando no se devuelve un cursor, no hay más mensajes por devolver. El método para acceder a Mensajes Directos individuales con [GET direct&#95;messages/events/show](https://developer.x.com/en/docs/x-api/v1/direct-messages/sending-and-receiving/api-reference/get-event) sigue siendo el mismo, aunque el objeto de Mensaje Directo devuelto tiene una estructura diferente, como se describió anteriormente.

Por último, el acceso en tiempo real a los Mensajes Directos ahora se realizará mediante webhook con la [Account Activity API](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity). Para obtener orientación sobre cómo migrar desde User Streams o Site Streams, consulta la guía de migración a Account Activity API para más información.

<div id="summary">
  #### Resumen
</div>

* Los mensajes enviados y recibidos ahora se devuelven en el mismo endpoint.
* Se devuelven mensajes de hasta 30 días de antigüedad.
* Paginación basada en cursores.
* Acceso en tiempo real a los Mensajes Directos mediante un webhook.

<div id="deleting-direct-messages">
  ### Eliminación de Mensajes Directos
</div>

Ahora se pueden eliminar los Mensajes Directos con DELETE direct&#95;messages/events/destroy. La interfaz es prácticamente la misma y requiere el id del mensaje que se va a eliminar. La diferencia clave es que el endpoint ahora requiere una solicitud DELETE en lugar de una solicitud POST.

La forma en que los Mensajes Directos eliminados se reflejan en los clientes oficiales de X sigue siendo la misma. Los Mensajes Directos solo se eliminan de la interfaz del usuario cuyo contexto se haya proporcionado. Otros miembros de la conversación pueden seguir accediendo al Mensaje Directo.

<div id="summary">
  #### Resumen
</div>

* Eliminar un Mensaje Directo requiere el ID.
* El nuevo endpoint requiere una petición DELETE.
* La forma en que los Mensajes Directos eliminados se muestran en los clientes oficiales de X no ha cambiado.

**¿Tienes preguntas sobre la migración a los nuevos endpoints de Mensajes Directos?
**Publica tu pregunta en el foro de la comunidad de desarrolladores en [devcommunity.com](https://devcommunity.x.com/).

<div id="frequently-asked-questions">
  ## Preguntas frecuentes
</div>

<div id="general">
  ### General
</div>

**¿Cuáles son las ventajas de usar la API Account Activity?**

La API Account Activity usa webhooks, lo que significa que, a diferencia de las APIs de streaming, no requerimos que mantengas una conexión abierta para enviarte información. Los webhooks también son diferentes de las APIs REST porque no tienes que hacernos cientos de solicitudes cada 15 minutos para obtener los datos que te interesan. Esto aumenta la eficiencia entre un usuario y tu aplicación, ya que entrega los datos cuando suceden.

La API Account Activity tiene varias ventajas:

1. **Velocidad**: entregamos los datos a la velocidad de X.
2. **Simplicidad**: entregamos todos los eventos de una cuenta a través de una única conexión de webhook. Las actividades entregadas en la API incluyen Publicaciones, @menciones, respuestas, Retweets, Quote Tweets, Retweets de Quote Tweets, favoritos, Mensajes Directos enviados, Mensajes Directos recibidos, follows, blocks, mutes. 
3. **Escala**: recibes todas las actividades de una cuenta que administras sin estar restringido por límites de frecuencia ni topes de eventos.

La API Account Activity está disponible como sandbox Premium, Premium de pago y oferta Enterprise, para que puedas escalar a medida que necesites más cuentas para funciones de responsabilidad legal o funcionalidad adicional.

Para comenzar, descarga fragmentos de código de ejemplo desde [GitHub](https://github.com/xdevplatform/account-activity-dashboard).
 

**¿Cómo identifico qué nivel de producto es el mejor para mí?**

Lee nuestra página de [Account Activity API Overview](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity) para obtener más información sobre las diferencias entre las opciones Premium y la opción Enterprise. 
 

**¿Cuál es la diferencia entre un entorno Premium y un webhook de Enterprise?**

No hay ninguna diferencia. Cada entorno Premium tendrá su propio webhook&#95;id.
 

**Necesito entornos de desarrollo, staging y producción para la API Account Activity, ¿es esto posible?**

¡Sí! Con los niveles de pago de la API Account Activity (Premium de pago y Enterprise), es posible registrar varias URL de webhook y administrar las suscripciones por separado para cada una mediante los métodos de la API. Además, se pueden agregar varias aplicaciones cliente a una lista de permitidos (allowlist) para mantener la autorización de tus usuarios actualmente autorizados.
 

**¿Tienen alguna guía paso a paso sobre cómo empezar a usar la API Account Activity?**

De hecho, sí tenemos.

* Si estás comenzando, te recomendamos visitar nuestra guía [Getting started with webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#getting-started-with-webhooks)

* Sigue nuestros scripts oficiales de X Dev: 
  * [Account Activity API dashboard](https://github.com/xdevplatform/account-activity-dashboard), una aplicación web en Node que muestra eventos de webhook.
  * El [SnowBot chatbot](https://github.com/xdevplatform/SnowBotDev), una aplicación web en Ruby creada sobre las APIs Account Activity y Direct Message. Esta base de código incluye un [script](https://github.com/xdevplatform/SnowBotDev/wiki/Account-Activity-API-setup-script) para ayudar a configurar los webhooks de la API Account Activity.
     

**¿Existe alguna forma de recuperar datos si nuestro sistema se cae durante un período de tiempo?**

Con los niveles de pago de la API Account Activity (Premium de pago y Enterprise), nuestro sistema [reintentará](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#retries) enviarte las actividades varias veces durante un período de cuatro horas. Si tu sistema no responde dentro de ese período de cuatro horas, entonces la actividad se perderá y tendrás que usar otros endpoints REST para recuperar datos en un plazo de 7 días.

Sugerimos que uses tus diferentes webhooks, o entornos, como una herramienta de redundancia, como la [Account Activity Replay API](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-replay-api), para asegurarte de que no pierdas ninguna actividad si uno de tus sistemas se cae.
 

**¿Qué autenticación tengo que usar con la API Account Activity?**

Los métodos de autorización requeridos para la API Account Activity se describen para cada método en las [páginas de referencia de la API](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#account-activity-api-reference-index). Si recién estás comenzando con la autenticación de X, te recomendamos leer [esta sección](/es/resources/fundamentals/authentication).

**¿Qué es una verificación de challenge-response (CRC)?**

La verificación de respuesta al desafío de la Account Activity API es una función de seguridad implementada para garantizar que las actividades de la Account Activity API se envíen al desarrollador correcto. También puede ser utilizada por los desarrolladores para asegurarse de que los datos que están recibiendo provienen de X. X enviará automáticamente un CRC a la URL de tu webhook una vez cada 24 horas, comenzando desde la última vez que se validó la URL del webhook. Tu sistema debe responder con una respuesta válida en un plazo de 3 segundos para que siga validado. 

Visita nuestra página [Asegurar webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#securing-webhooks) para más detalles.
 

**¿Hay algo que invalidaría inmediatamente mi URL de webhook?**

Si ocurre una de las siguientes situaciones, marcaremos inmediatamente tu webhook como inválido:

* El servidor responde a un CRC con un token incorrecto. En este caso, nuestro sistema no [reintentará](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#retries) enviarte la actividad.
* La URL del webhook tiene configurado un certificado incorrecto. En este caso, nuestro sistema no [reintentará](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#retries) enviarte la actividad.
* Tu servidor devuelve un código de respuesta que no sea 2XX, 4XXX o 5XXX.
* Especificas el uso de gzip sin enviarlo realmente.
* No especificas el uso de gzip, pero lo envías realmente en la respuesta.
   

**¿Recibiré actividades duplicadas si estoy suscrito a usuarios que interactúan entre sí?**

Sí. Si tu aplicación web tiene suscripciones activas para el Usuario A y el Usuario B, y el Usuario A menciona al Usuario B en una Publicación, se enviarán dos actividades POST al webhook registrado. Cada actividad tendrá un indicador &quot;for&#95;user&#95;id&quot; para mostrar a qué suscripción pertenece la actividad.
 

**Cuando creo una suscripción a mi webhook, ¿puedo reemplazar la parte `/all/` del siguiente endpoint con otros objetos de datos de actividad de la cuenta para limitar las actividades que la API entrega? **`POST https://api.x.com/1.1/account_activity/all/:env_name/subscriptions.json`

No, esto no es posible. Por ahora, solo tenemos disponible el producto `/all/`.
 

**¿Hay alguna forma de usar la Account Activity API sin solicitar permisos de Mensajes Directos a los usuarios? **

En este momento, se requieren permisos de Mensajes Directos porque no hay forma de &quot;filtrar&quot; las actividades de Mensajes Directos para esta API. 
 

**¿Existe una versión gratuita de la Account Activity API?**

Sí, ofrecemos la versión sandbox como nivel gratuito. Nuestra opción sandbox está limitada a un único webhook con un máximo de 15 suscripciones. Puedes leer más sobre la opción sandbox en [nuestra documentación](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity). 

**¿Es posible usar la Account Activity API para obtener Retweets de Publicaciones que mencionan a usuarios suscritos? **

Lamentablemente, esto no forma parte de las actividades entregadas con esta API. Para esto, sugerimos usar la Streaming API. 
 

**¿Cuáles son los posibles tipos de actividad que están representados por un tweet&#95;create&#95;event?**

Se enviará una carga (payload) de tweet&#95;create&#95;event:

Si el usuario suscrito realiza alguna de las siguientes acciones:

* Crea una Publicación
* Hace Retweets
* Responde a una Publicación

Si otro usuario:

* @menciona* al usuario suscrito
* Cita una Publicación creada por el usuario suscrito 

*Nota: La Account Activity API solo entrega eventos cuando el usuario suscrito recibiría una notificación de X y podría ver el evento públicamente. Esto significa que, si la cuenta mencionada (@userA) sigue a la cuenta protegida (@userB), entonces UserA recibirá una notificación de que UserB la mencionó. Si UserA no sigue a UserB (y no ha sido aprobada por UserB), UserA no recibirá una notificación y, por lo tanto, no se enviará un tweet&#95;create&#95;event a través de AAA si @userA tiene una suscripción.*

**Si un usuario bloqueado menciona a mi usuario suscrito, ¿cómo puedo identificarlo?**

Verás un campo booleano `user&#95;has&#95;blocked` en el nivel superior de la respuesta JSON, establecido en “true” o “false”. Este campo solo se expondrá en menciones en Publicaciones. 

Enterprise

**¿Cómo puedo agregar mi aplicación a una allowlist (lista de permitidos) o comprobar si mi aplicación ya está en la allowlist?**

Para administrar las [X apps](/es/resources/fundamentals/developer-apps) que has añadido a una allowlist para el acceso a través de las Enterprise APIs, ponte en contacto con tu account manager y facilítale el ID de tu app. Puedes encontrar el ID de tu app yendo a la página de [&quot;Apps&quot;](/es/resources/fundamentals/developer-apps) en el [portal para desarrolladores](/es/resources/fundamentals/developer-portal).
 

**Si tengo acceso a tres webhooks, ¿puedo usar tres webhooks para cada una de las apps que he registrado para uso Enterprise?**

El límite de webhooks se establece a nivel de cuenta, no a nivel de app. Si tienes acceso a tres webhooks y dos apps registradas para uso Enterprise, puedes usar dos webhooks en una app y el tercero en la otra app, pero no tres en cada app. 

**¿Puedo especificar qué tipos de eventos se volverán a entregar usando la Account Activity Replay API?**

No se pueden especificar los tipos de eventos a reproducir. Se reproducirán todos los eventos entregados durante la ventana de fecha y hora especificada. 

**¿Habrá reintentos si mi aplicación no logra procesar un evento de la Account Activity Replay API?**

No, no habrá reintentos. Si una aplicación no logra procesar un evento enviado por la Account Activity Replay API, se puede enviar otro Replay job para el mismo período de tiempo para intentar la reentrega de cualquier evento de Replay que se haya perdido. 

**¿Qué debo hacer cuando reciba un evento de finalización con éxito parcial?**

Sugerimos tomar nota de las marcas de tiempo de los eventos que se recibieron y solicitar otro Replay job para los eventos que se omitieron. 

**¿Cuántos Account Activity Replay API jobs puedo tener ejecutándose al mismo tiempo?**

Solo puede ejecutarse un Account Activity Replay API job por webhook a la vez. 

**¿Cómo puedo diferenciar los eventos de Account Activity Replay API de los eventos de producción en tiempo real a medida que se entregan a mi webhook?**

Dado que la Account Activity Replay API siempre entregará eventos del pasado, los eventos pueden diferenciarse de los eventos de producción en tiempo real en función de la marca de tiempo del evento. 

**¿Con qué rapidez puedo empezar a usar la Account Activity Replay API para volver a entregar una actividad que mi aplicación descartó o perdió?**

Una actividad está disponible para reentrega aproximadamente 10 minutos después de su creación. 

<div id="error-troubleshooting-guide">
  ### Guía para solucionar errores
</div>

<div id="code-32">
  #### Código 32
</div>

Este error generalmente significa que algo está mal formado en la solicitud, los encabezados, la autorización o la URL que estás especificando. Este no es un error de la Account Activity API, es un error de autorización y X no está recibiendo la configuración correcta de OAuth o la URL.

* **Enterprise** - Asegúrate de que las claves de consumidor y los tokens de acceso que estás usando pertenezcan a una [X app](/es/resources/fundamentals/developer-apps) que haya sido registrada para el uso de productos Enterprise. Si no tienes tus claves de consumidor y tokens de acceso, o necesitas agregar tu X app a la lista de permitidos (allowlist), ponte en contacto con tu account manager. 

* Si te autenticas con contexto de usuario, asegúrate de haber [autorizado tu solicitud](/es/resources/fundamentals/authentication#authorizing-a-request) correctamente con los `oauth nonce`, `oauth_signature` y `oauth_timestamp` adecuados.

* Asegúrate de que tus tokens de acceso tengan el nivel de permisos adecuado.
  * En la pestaña &quot;Keys and tokens&quot; del [app dashboard](/es/resources/fundamentals/developer-apps), asegúrate de que tus tokens de acceso tengan el nivel de permiso &quot;Read, write, and direct messages&quot; [permission level](/es/resources/fundamentals/developer-apps#app-permissions). 
  * Si el nivel de permiso de los tokens está configurado en algo inferior a esto, ve a la pestaña &quot;Permissions&quot;, ajusta el permiso de acceso a &quot;Read, write, and direct messages&quot; y luego regenera tus tokens de acceso y secretos desde la pestaña &quot;Keys and tokens&quot;.

* Asegúrate de que tu URL esté formada correctamente.
  * Ten en cuenta que `:env_name` distingue entre mayúsculas y minúsculas.
     

<div id="code-200-forbidden">
  #### Código 200 - Prohibido
</div>

* **Premium** - Asegúrate de tener una [cuenta de desarrollador](/es/resources/fundamentals/developer-portal) aprobada antes de intentar realizar una solicitud a la API. También debes usar el :env&#95;name correcto en la solicitud, que puedes configurar en la página de [dev environments](/es/resources/fundamentals/developer-portal).

* **Enterprise** - Asegúrate de que tu responsable de cuenta haya habilitado para ti el acceso a la Account Activity API.

* Asegúrate de haber configurado correctamente la URI. Este error puede producirse si has introducido una URI incorrecta en tu solicitud.
   

<div id="code-214-webhook-url-does-not-meet-the-requirements">
  #### Código 214 - La URL del webhook no cumple con los requisitos.
</div>

* Asegúrate de usar HTTPS.
* Es posible que la URL de tu webhook esté mal formada.
* Obtén más información sobre cómo configurar la URL de tu webhook en la sección [Develop webhook consumer app](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#3-develop-webhook-consumer-app) de la página [Getting started with webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#getting-started-with-webhooks).
   

<div id="code-214-high-latency-on-crc-get-request-your-webhook-should-respond-in-less-than-3-seconds">
  #### Código 214 - Alta latencia en la petición CRC GET. Tu webhook debe responder en menos de 3 segundos.
</div>

* Esto indica que tu servidor es lento. Asegúrate de responder al CRC en menos de 3 segundos.
   

<div id="code-214-non-200-response-code-during-crc-get-request-ie-404-500-etc">
  #### Code 214 - Código de respuesta distinto de 200 durante la solicitud CRC GET (es decir, 404, 500, etc.).
</div>

* Tu servidor no está disponible. Asegúrate de que esté funcionando correctamente.
   

<div id="code-214-too-many-resources-already-created">
  #### Código 214 - Ya se han creado demasiados recursos.
</div>

* **Enterprise** - Ya ha utilizado todos sus webhooks. Use el endpoint [GET webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks) con cada una de sus Aplicaciones registradas para identificar dónde están distribuidos sus webhooks. 

<div id="code-261-application-cannot-perform-write-actions">
  #### Código 261 - La aplicación no puede realizar acciones de escritura.
</div>

* La aplicación que estás usando con la API no tiene configurado el [nivel de permisos](/es/resources/fundamentals/developer-apps#app-permissions) adecuado para su token de acceso y su secreto de token de acceso. Ve a la pestaña &#39;Keys and tokens&#39; en el panel de [X apps](/es/resources/fundamentals/developer-apps) y revisa los niveles de permisos asignados a tu token de acceso y a tu secreto de token de acceso. Si está configurado en cualquier opción distinta de &#39;Read, write and Direct Messages&#39;, tendrás que ajustar la configuración en la pestaña &#39;Permission&#39; y volver a generar tu token de acceso y tu secreto de token de acceso para aplicar la nueva configuración.
* O bien, estás intentando registrar un webhook utilizando autenticación de solo aplicación (app-only authentication), lo cual no está admitido. En su lugar, autentícate con contexto de usuario, tal como se indica en las secciones de referencia de la API para registrar un webhook para la [Enterprise Account Activity API](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks).

<div id="account-activity-api-reference-index">
  ## Índice de referencia de la Account Activity API
</div>

|     |     |
| :--- | :--- |
| **Purpose** | Enterprise |
| Registra una URL de webhook / Genera un webhook&#95;id | [POST  <br />webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#enterprise-account-activity-api) |
| Devuelve todas las URL de webhook y sus estados | [GET  <br />webhooks](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks) |
| Activa manualmente una comprobación de respuesta al desafío | [PUT  <br />webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#put-account-activity-webhooks-webhook-id) |
| Suscribe una aplicación a los eventos de una cuenta | [POST  <br />webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#post-account-activity-webhooks-webhook-id-subscriptions-all) |
| Devuelve el número de suscripciones activas actualmente | [GET  <br />subscriptions/count](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-subscriptions-count) |
| Comprueba si un webhook está suscrito a una cuenta | [GET  <br />webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-webhooks-webhook-id-subscriptions-all) |
| Devuelve una lista de suscripciones activas actualmente | [GET  <br />webhooks/:webhook&#95;id/subscriptions/all/list](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#get-account-activity-subscriptions-count) |
| Elimina el webhook | [DELETE  <br />webhooks/:webhook&#95;id](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id) |
| Desactiva una suscripción usando OAuth de 3 pasos (OBSOLETO) | [DELETE  <br />webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated) |
| Desactiva una suscripción usando OAuth solo de aplicación | [DELETE  <br />webhooks/:webhook&#95;id/subscriptions/:user&#95;id/all.json](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-user-id-all-json) |
| Vuelve a enviar actividades a un webhook | [POST  <br />replay/webhooks/:webhook&#95;id/subscriptions/all](/es/x-api/enterprise-gnip-2.0/fundamentals/account-activity#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated) |

<div id="enterprise-account-activity-api">
  ### API de actividad de cuenta Enterprise
</div>

<div id="post-account_activitywebhooks">
  #### POST account&#95;activity/webhooks[](#post-account-activity-webhooks "Enlace permanente a este encabezado")
</div>

Registra una nueva URL de webhook para el contexto de aplicación dado. La URL se validará mediante una solicitud CRC antes de guardarla. En caso de que la validación falle, se devolverá un mensaje de error detallado al solicitante.

La cantidad de webhooks permitidos depende del paquete de facturación.

<div id="resource-url">
  ### URL del recurso[](#resource-url "Permalink to this headline")
</div>

`https://api.x.com/1.1/account_activity/webhooks.json`

<div id="resource-information">
  ### Información del recurso[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| Formato de respuesta | JSON |
| Requiere autenticación | Sí (contexto de usuario: todos los tokens de consumidor y tokens de acceso) |
| Sujeto a límite de frecuencia | Sí |
| Solicitudes / ventana de 15 min (autenticación de usuario) | 15  |
| Compatibilidad con ediciones de Publicaciones | Todos los objetos de Publicación incluirán metadatos de edición que describen el historial de ediciones de cada Publicación. Consulta la página [&quot;Tweet edits&quot; fundamentals](/es/x-api/enterprise-gnip-2.0/fundamentals/edit-tweets) para obtener más detalles. |

<div id="parameters">
  ### Parámetros[](#parameters "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| url (obligatorio) | URL codificada del endpoint de callback. |

<div id="example-request">
  ### Ejemplo de solicitud[](#example-request "Permalink to this headline")
</div>

$ curl --request POST
--url &#39;https://api.x.com/1.1/account&#95;activity/webhooks.json?url=https%3A%2F%2Fyour&#95;domain.com%2Fwebhooks%2Ftwitter%2F0&#39;
--header &#39;authorization: OAuth oauth&#95;consumer&#95;key=&quot;CONSUMER&#95;KEY&quot;, oauth&#95;nonce=&quot;GENERATED&quot;, oauth&#95;signature=&quot;GENERATED&quot;, oauth&#95;signature&#95;method=&quot;HMAC-SHA1&quot;, oauth&#95;timestamp=&quot;GENERATED&quot;, oauth&#95;token=&quot;ACCESS&#95;TOKEN&quot;, oauth&#95;version=&quot;1.0&quot;&#39;

<div id="http-responses">
  ### Respuestas HTTP[](#http-responses "Permalink to this headline")
</div>

| Código HTTP | Mensaje |
| :--- | :--- |
| 200 | La URL del webhook está registrada en la aplicación proporcionada |
| 403 | Se produjo un error en tu solicitud. Consulta la sección de mensajes de error a continuación. |

### Ejemplo de respuesta correcta[](#example-response-success "Permalink to this headline")

```json
_HTTP 200_

    {
      "id": "1234567890",
      "url": "https://your_domain.com/webhook/twitter/0",
      "valid": true,
      "created_at": "2016-06-02T23:54:02Z"
    }
```

<div id="error-messages">
  ### Mensajes de error[](#error-messages "Permalink to this headline")
</div>

| Code | Message                                                                                                  |
| :--- | :------------------------------------------------------------------------------------------------------- |
| 214  | La URL del webhook no cumple los requisitos.                                                             |
| 214  | Ya se han creado demasiados recursos.                                                                    |
| 214  | La URL del webhook no cumple los requisitos. Token CRC o formato de respuesta JSON no válidos.           |
| 214  | Alta latencia en la solicitud CRC mediante GET. El webhook debe responder en menos de 3 segundos.        |
| 214  | Código de respuesta distinto de 200 durante la solicitud CRC mediante GET (por ejemplo, 404, 500, etc.). |

*HTTP 403*

```json
    {
      "errors": [
        {
          "code": 214,
          "message": "Too many resources already created."
        }
      ]
    }
```

<div id="get-account_activitywebhooks">
  #### GET account&#95;activity/webhooks[](#get-account-activity-webhooks "Permalink to this headline")
</div>

Devuelve todas las URL y sus estados para la aplicación especificada.

Marcamos una URL como no válida si no supera la verificación diaria. Para volver a habilitar la URL, llama al endpoint de actualización.

<div id="resource-url">
  ### URL del recurso[](#resource-url "Permalink to this headline")
</div>

`https://api.x.com/1.1/account_activity/webhooks.json`

<div id="resource-information">
  ### Información del recurso[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| Formato de respuesta | JSON |
| Requiere autenticación | Sí (solo aplicación: Bearer Token) |
| Con limitación de frecuencia | Sí |
| Solicitudes por ventana de 15 minutos (autenticación de aplicación) | 15  |

### Ejemplo de solicitud[](#example-request "Enlace permanente a este encabezado")

```bash
    $ curl --request GET
     --url https://api.x.com/1.1/account_activity/webhooks.json
     --header 'authorization: Bearer TOKEN'
```

<div id="example-response">
  ### Ejemplo de respuesta[](#example-response "Permalink to this headline")
</div>

*HTTP 200 OK*

```json
    [
      {
        "id": "1234567890",
        "url": "https://your_domain.com/webhook/twitter/0",
        "valid": true,
        "created_at": "2016-06-02T23:54:02Z"
      }
      {
        "id": "2468013579",
        "url": "https://your_domain2.com/webhook/twitter/0",
        "valid": true,
        "created_at": "2016-06-04T22:31:29Z"
      }
    ]
```

<div id="error-messages">
  ### Mensajes de error[](#error-messages "Permalink to this headline")
</div>

| Código | Mensaje |
| :--- | :--- |
| 99  | No tienes permiso para acceder a este recurso. |

<div id="put-account_activitywebhookswebhook_id">
  #### PUT account&#95;activity/webhooks/:webhook&#95;id[](#put-account-activity-webhooks-webhook-id "Permalink to this headline")
</div>

Inicia la comprobación de respuesta de desafío (CRC) para la URL del webhook indicado. Si la comprobación se realiza correctamente, devuelve 204 y vuelve a habilitar el webhook estableciendo su estado en `valid`.

<div id="resource-url">
  ### URL del recurso[](#resource-url "Permalink to this headline")
</div>

`https://api.x.com/1.1/account_activity/webhooks/:webhook_id.json`

<div id="resource-information">
  ### Información del recurso[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| Formato de respuesta | JSON |
| Requiere autenticación | Sí (contexto de usuario: todos los consumer tokens y los tokens de acceso) |
| Con límite de frecuencia | Sí |
| Solicitudes por ventana de 15 min (autenticación de usuario) | 15  |

<div id="parameters">
  ### Parámetros[](#parameters "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| webhook&#95;id (obligatorio) | ID del webhook. Definido en la ruta del recurso. |

<div id="example-request">
  ### Ejemplo de solicitud[](#example-request "Permalink to this headline")
</div>

```json
    $ curl --request PUT
     --url https://api.x.com/1.1/account_activity/webhooks/:WEBHOOK_ID.json
     --header 'authorization: OAuth oauth_consumer_key="CONSUMER_KEY", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="ACCESS_TOKEN", oauth_version="1.0"'
```

<div id="response">
  ### Respuesta[](#response "Permalink to this headline")
</div>

*HTTP 204 OK*

```
    { }
```

<div id="error-messages">
  ### Mensajes de error[](#error-messages "Permalink to this headline")
</div>

| Code | Message |
| :--- | :--- |
| 34  | El webhook no existe o está asociado con una aplicación de X diferente. |
| 214 | La URL del webhook no cumple con los requisitos. |
| 214 | La URL del webhook no cumple con los requisitos. Token CRC no válido o formato de respuesta JSON inválido. |
| 214 | Alta latencia en la solicitud GET de CRC. Tu webhook debe responder en menos de 3 segundos. |
| 214 | Código de respuesta distinto de 200 durante la solicitud GET de CRC (es decir, 404, 500, etc.). |

<div id="post-account_activitywebhookswebhook_idsubscriptionsall">
  #### POST account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all[](#post-account-activity-webhooks-webhook-id-subscriptions-all "Enlace permanente a este encabezado")
</div>

Suscribe la aplicación proporcionada a todos los eventos del contexto de usuario indicado para todos los tipos de mensajes. Después de la activación, todos los eventos para el usuario que realiza la solicitud se enviarán al webhook de la aplicación mediante una solicitud POST.

Las suscripciones están actualmente limitadas en función de la configuración de tu cuenta. Si necesitas agregar más suscripciones, comunícate con tu representante de cuenta.

### URL del recurso[](#resource-url "Enlace permanente a este encabezado")

`https://api.x.com/1.1/account_activity/webhooks/:webhook_id/subscriptions/all.json`

<div id="resource-information">
  ### Información del recurso[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| Formato de respuesta | JSON |
| Requiere autenticación | Sí (OAuth de 3 pasos - consumer key en lista blanca y token de acceso del usuario suscriptor) |
| Con límite de frecuencia | Sí |
| Solicitudes por ventana de 15 min (autenticación de usuario) | 500 |

<div id="parameters">
  ### Parámetros[](#parameters "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| webhook&#95;id (obligatorio) | ID del webhook. Se define en la ruta del recurso. |

### Ejemplo de solicitud[](#example-request "Enlace permanente a este título")

```bash
    $ curl --request POST
     --url https://api.x.com/1.1/account_activity/webhooks/:WEBHOOK_ID/subscriptions/all.json
     --header 'authorization: OAuth oauth_consumer_key="WHITELISTED_CONSUMER_KEY", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="SUBSCRIBING_USER'S_ACCESS_TOKEN", oauth_version="1.0"'
```

### Ejemplo de respuesta: correcta[](#example-response-success "Permalink to this headline")

*HTTP 204 NO CONTENT*

```
    {}
```

<div id="error-messages">
  ### Mensajes de error[](#error-messages "Permalink to this headline")
</div>

| Código | Mensaje |
| :--- | :--- |
| 34  | El webhook no existe o está asociado a una Aplicación de X diferente. |
| 348 | La aplicación cliente no tiene permiso para acceder a las suscripciones de webhook de este usuario. |

<div id="get-account_activitysubscriptionscount">
  #### GET account&#95;activity/subscriptions/count[](#get-account-activity-subscriptions-count "Enlace permanente a este encabezado")
</div>

Devuelve la cantidad de suscripciones que están actualmente activas en tu cuenta. Ten en cuenta que el endpoint /count requiere OAuth solo de aplicación, por lo que debes hacer solicitudes utilizando un Bearer Token en lugar de usar contexto de usuario.

<div id="resource-url">
  ### URL del recurso[](#resource-url "Permalink to this headline")
</div>

`https://api.x.com/1.1/account_activity/subscriptions/count.json`

<div id="resource-information">
  ### Información del recurso[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| Formato de respuesta | Código de respuesta HTTP |
| Requiere autenticación | Sí (solo aplicación: Bearer Token) |
| Límite de frecuencia | Sí |
| Solicitudes por ventana de 15 minutos (autenticación de aplicación) | 15  |

<div id="http-response-codes">
  ### Códigos de respuesta HTTP[](#http-response-codes "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| Code | Message |
| 200 | Correcto. Se devolverá la cantidad de suscripciones del webhook solicitado. |
| 401 | Tu aplicación no tiene permiso para ver las suscripciones del webhook especificado. |

### Ejemplo de solicitud[](#example-request "Enlace permanente a este encabezado")

```bash
    $ curl --request GET
     --url https://api.x.com/1.1/account_activity/subscriptions/count.json
     --header 'authorization: Bearer TOKEN'
```

### Ejemplo de respuesta - éxito[](#example-response-success "Permalink to this headline")

*HTTP 200*

```bash
    {
      "account_name":"my-account",
      "subscriptions_count_all":"1",
      "subscriptions_count_direct_messages":"0",
      "provisioned_count":"50"
    }
```

<div id="error-messages">
  ### Mensajes de error[](#error-messages "Permalink to this headline")
</div>

| Código | Mensaje                  |
| :----- | :----------------------- |
| 32     | No se pudo autenticarte. |

*HTTP 401*

```abash
    {
      "errors": [
        {
           "code": 32,
          "message": "Could not authenticate you."
        }
      ]
    }
```

<div id="get-account_activitywebhookswebhook_idsubscriptionsall">
  #### GET account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all[](#get-account-activity-webhooks-webhook-id-subscriptions-all "Permalink to this headline")
</div>

Proporciona un método para determinar si una configuración de webhook está suscrita a los eventos del usuario proporcionado. Si el contexto de usuario proporcionado tiene una suscripción activa con la aplicación indicada, devuelve 204 OK. Si el código de respuesta no es 204, entonces el usuario no tiene una suscripción activa. Consulte el código de respuesta HTTP y los mensajes de error a continuación para obtener más detalles.

<div id="resource-url">
  ### URL del recurso[](#resource-url "Permalink to this headline")
</div>

`https://api.x.com/1.1/account_activity/webhooks/:webhook_id/subscriptions/all.json`

<div id="resource-information">
  ### Información del recurso[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| Formato de la respuesta | JSON |
| Requiere autenticación | Sí (OAuth de 3 fases - consumer key autorizada y token de acceso del usuario suscrito) |
| Con límite de frecuencia | Sí |
| Solicitudes / ventana de 15 min (autenticación de usuario) | 500 |

<div id="parameters">
  ### Parámetros[](#parameters "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| webhook&#95;id (obligatorio) | id del webhook. Especificado en la ruta del recurso. |

### Ejemplo de solicitud[](#example-request "Enlace permanente a este encabezado")

$ curl --request GET
--url https://api.x.com/1.1/account&#95;activity/webhooks/:WEBHOOK&#95;ID/subscriptions/all.json
--header &#39;authorization: OAuth oauth&#95;consumer&#95;key=&quot;WHITELISTED&#95;CONSUMER&#95;KEY&quot;, oauth&#95;nonce=&quot;GENERATED&quot;, oauth&#95;signature=&quot;GENERATED&quot;, oauth&#95;signature&#95;method=&quot;HMAC-SHA1&quot;, oauth&#95;timestamp=&quot;GENERATED&quot;, oauth&#95;token=&quot;SUBSCRIBING&#95;USER&#39;S&#95;ACCESS&#95;TOKEN&quot;, oauth&#95;version=&quot;1.0&quot;&#39;

<div id="example-response-success">
  ### Respuesta de ejemplo: correcta[](#example-response-success "Enlace permanente a este encabezado")
</div>

*HTTP 204 NO CONTENT*

```
    { }
```

<div id="get-account_activitywebhookswebhook_idsubscriptionsalllist">
  #### GET account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all/list[](#get-account-activity-webhooks-webhook-id-subscriptions-all-list "Permalink to this headline")
</div>

Devuelve una lista de las suscripciones actuales de tipo All Activity para el webhook especificado. Ten en cuenta que el endpoint /list requiere OAuth solo de aplicación, por lo que las solicitudes deben realizarse usando un Bearer Token en lugar del contexto de usuario.

### URL del recurso[](#resource-url "Enlace permanente a este encabezado")

`https://api.x.com/1.1/account_activity/webhooks/:webhook_id/subscriptions/all/list.json`

<div id="resource-information">
  ### Información del recurso[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| Formato de respuesta | Código de respuesta HTTP |
| Requiere autenticación | Sí (solo aplicación: Bearer Token) |
| Limitado por frecuencia | Sí |
| Solicitudes por ventana de 15 minutos (autenticación de la aplicación) | 50  |

<div id="parameters">
  ### Parámetros[](#parameters "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| webhook&#95;id (obligatorio) | ID de webhook. Definido en la ruta del recurso. |

<div id="http-response-codes">
  ### Códigos de respuesta HTTP[](#http-response-codes "Permalink to this headline")
</div>

| Code | Message |
| :--- | :--- |
| 200 | Correcto. Se devolverá una lista de suscripciones para el webhook solicitado. |
| 401 | Tu aplicación no tiene permiso para ver las suscripciones para el webhook especificado. |

### Ejemplo de solicitud[](#example-request "Enlace permanente a este encabezado")

$ curl --request GET
--url https://api.x.com/1.1/account&#95;activity/webhooks/:WEBHOOK&#95;ID/subscriptions/all/list.json
--header &#39;authorization: Bearer TOKEN&#39;

### Ejemplo de respuesta - éxito[](#example-response-success "Enlace permanente a este encabezado")

*HTTP 200*

```bash
    {
      "webhook_id": "1234567890",
      "webhook_url": "https://your_domain.com/webhook/twitter/0",
      "application_id": "11231812",
      "subscriptions": [{
        "user_id": "20212306"
      }]
    }
```

<div id="error-messages">
  ### Mensajes de error[](#error-messages "Permalink to this headline")
</div>

| Código | Mensaje                          |
| :----- | :------------------------------- |
| 32     | No se pudo autenticar tu cuenta. |

*HTTP 401*

```bash
    {
      "errors": [
        {
           "code": 32,
          "message": "No se pudo autenticar."
        }
      ]
    }
```

<div id="delete-account_activitywebhookswebhook_id">
  #### DELETE account&#95;activity/webhooks/:webhook&#95;id[](#delete-account-activity-webhooks-webhook-id "Permalink to this headline")
</div>

Elimina el webhook de la configuración de la aplicación especificada. Se puede acceder al id del webhook realizando una llamada a GET /1.1/account&#95;activity/webhooks.

### URL del recurso[](#resource-url "Enlace permanente a este encabezado")

`https://api.x.com/1.1/account_activity/webhooks/:webhook_id.json`

<div id="resource-information">
  ### Información del recurso[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| Formato de respuesta | JSON |
| Requiere autenticación | Sí (contexto de usuario: todos los tokens de consumidor y de acceso) |
| Sujeto a límite de frecuencia | Sí |
| Solicitudes / ventana de 15 minutos (autenticación de usuario) | 15  |

<div id="parameters">
  ### Parámetros[](#parameters "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| webhook&#95;id (obligatorio) | ID del webhook. Definido en la ruta del recurso. |

<div id="example-request">
  ### Ejemplo de solicitud[](#example-request "Permalink to this headline")
</div>

```bash
    $ curl --request DELETE
     --url https://api.x.com/1.1/account_activity/webhooks/:WEBHOOK_ID.json
     --header 'authorization: OAuth oauth_consumer_key="CONSUMER_KEY", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="ACCESS_TOKEN", oauth_version="1.0"'
```

<div id="response">
  ### Respuesta[](#response "Permalink to this headline")
</div>

*HTTP 204 OK*

```
    { }
```

<div id="delete-account_activitywebhookswebhook_idsubscriptionsall-deprecated">
  #### DELETE account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all (OBSOLETO)[](#delete-account-activity-webhooks-webhook-id-subscriptions-all-deprecated- "Permalink to this headline")
</div>

Desactiva las suscripciones para el contexto de usuario y la aplicación proporcionados. Después de la desactivación, todos los eventos del usuario solicitante ya no se enviarán a la URL del webhook.

<div id="resource-url">
  ### URL del recurso[](#resource-url "Permalink to this headline")
</div>

`https://api.x.com/1.1/account_activity/webhooks/:webhook_id/subscriptions/all.json`

<div id="resource-information">
  ### Información del recurso[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| Formato de la respuesta | JSON |
| Requiere autenticación | Sí (OAuth de 3 partes: clave de consumidor en lista de permitidos y token de acceso del usuario suscrito) |
| Con límite de frecuencia | Sí |
| Solicitudes por ventana de 15 minutos (autenticación de usuario) | 500 |

<div id="parameters">
  ### Parámetros[](#parameters "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| webhook&#95;id (obligatorio) | ID del webhook. Especificado en la ruta del recurso. |

### Ejemplo de solicitud[](#example-request "Enlace permanente a este título")

```bash
    $ curl --request DELETE
     --url https://api.x.com/1.1/account_activity/webhooks/:WEBHOOK_ID/subscriptions/all.json
     --header 'authorization: OAuth oauth_consumer_key="WHITELISTED_CONSUMER_KEY", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="SUBSCRIBED_USER'S_ACCESS_TOKEN", oauth_version="1.0"'
```

Ejemplo de solicitud

```
    { }
```

<div id="delete-account_activitywebhookswebhook_idsubscriptionsuser_idalljson">
  #### DELETE /account&#95;activity/webhooks/:webhook&#95;id/subscriptions/:user&#95;id/all.json[](#delete-account-activity-webhooks-webhook-id-subscriptions-user-id-all-json "Permalink to this headline")
</div>

Desactiva la suscripción para el webhook y el id de usuario especificados. Después de la desactivación, todos los eventos para el usuario solicitante dejarán de enviarse a la URL del webhook. Ten en cuenta que este endpoint requiere OAuth solo de aplicación, por lo que las solicitudes deben realizarse utilizando un Bearer Token en lugar de con contexto de usuario.

<div id="resource-url">
  ### URL del recurso[](#resource-url "Permalink to this headline")
</div>

`https://api.x.com/1.1/account_activity/webhooks/:webhook_id/subscriptions/:user_id/all.json`

<div id="resource-information">
  ### Información del recurso[](#resource-information "Permalink to this headline")
</div>

|     |     |
| :--- | :--- |
| Formato de respuesta | JSON |
| Requiere autenticación | Sí (solo aplicación - Bearer Token) |
| Con límite de frecuencia | Sí |
| Solicitudes por ventana de 15 minutos | 500 |

<div id="example-request">
  ### Ejemplo de solicitud[](#example-request "Permalink to this headline")
</div>

```bash
    $ curl --request DELETE
     --url https://api.x.com/1.1/account_activity/webhooks/:webhook_id/subscriptions/:user_id/all.json
     --header 'authorization: Bearer TOKEN'
```

<div id="response">
  ### Respuesta[](#response "Permalink to this headline")
</div>

*HTTP 204 NO CONTENT*

<div id="error-messages">
  ### Mensajes de error[](#error-messages "Permalink to this headline")
</div>

| Código | Mensaje |
| :--- | :--- |
| 404 | Lo sentimos, esa página no existe. - Esto suele ocurrir cuando el id de usuario especificado no está realmente suscrito. |

<div id="replay-api">
  ### API de Replay
</div>

**POST /1.1/account&#95;activity/replay/webhooks/:webhook&#95;id/subscriptions/all.json [¶](#post-1-1-account-activity-replay-webhooks-webhook-id-subscriptions-all-json- "Enlace permanente a este encabezado")**

Envía una solicitud para recuperar actividades de hasta los últimos cinco días de todas las suscripciones presentes durante las ventanas de fecha y hora especificadas en la solicitud. Si tu webhook tiene suscripciones de usuario activas, también recibirás esos eventos de forma concurrente. Nota: realizamos un CRC antes de entregar los eventos de replay.

|     |     |
| :--- | :--- |
| **Request Method** | HTTP POST |
| **URL** | /1.1/account&#95;activity/replay/webhooks/:webhook&#95;id/subscriptions/all.json?from&#95;date=yyyymmddhhmm&amp;to&#95;date=yyyymmddhhmm |
| **Response Format** | JSON |
| **Requires Authentication** | Sí (solo aplicación - Bearer Token) |
| **Rate Limit** | 5 solicitudes por cada 15 minutos. Actualmente no existe un límite máximo para la cantidad de trabajos de replay que se pueden solicitar. |
| **from&#95;date** | La marca de tiempo UTC más antigua (de inicio) a partir de la cual se proporcionarán los eventos; debe estar en el formato &#39;yyyymmddhhmm&#39;. La marca de tiempo tiene granularidad de minutos y es inclusiva (es decir, 12:00 incluye el minuto 00). Los tiempos válidos deben estar dentro de los últimos 5 días, hora UTC, y no ser más recientes que 31 minutos antes del momento actual. Se recomienda que from&#95;date y to&#95;date estén dentro de un intervalo de ~2 horas. |
| **to&#95;date** | La marca de tiempo UTC más reciente (de fin) hasta la cual se proporcionarán los eventos; debe estar en el formato &#39;yyyymmddhhmm&#39;. La marca de tiempo tiene granularidad de minutos y es exclusiva (es decir, 12:30 no incluye el minuto 30 de la hora). Los tiempos válidos deben estar dentro de los últimos 5 días, hora UTC, y no ser más recientes que 10 minutos antes del momento actual. |

<div id="responses">
  #### Respuestas
</div>

Las siguientes respuestas pueden ser devueltas por la API. La mayoría de los códigos de error se devuelven con una cadena que incluye detalles adicionales en el cuerpo. Para respuestas distintas de 200, debes resolver el error y volver a intentarlo.

| Estado | Texto | Código de error | Descripción | Mensaje |
| :--- | :--- | :--- | :--- | :--- |
| 202 | Aceptado | N/D | La solicitud se realizó correctamente y se enviarán las actividades. | N/D |
| 400 | Solicitud incorrecta | 214 | El webhook se ha marcado como no válido. | El webhook está marcado como no válido y requiere una comprobación CRC. |
| 400 | Solicitud incorrecta | 357 | Falta un parámetro de consulta. | : queryParam es obligatorio. |
| 400 | Solicitud incorrecta | 358 | La ruta o el parámetro de consulta tiene un formato no válido. | No se puede analizar el parámetro. |
| 400 | Solicitud incorrecta | 360 | El parámetro de ruta es negativo. | webhook&#95;id: [] no es mayor o igual que 0. |
| 400 | Solicitud incorrecta | 368 | from&#95;date o to&#95;date no está en el pasado. | : [&lt;field&#95;value&gt;] no está en el pasado. |
| 400 | Solicitud incorrecta | 356 | from&#95;date debe ser anterior a to&#95;date. | from&#95;date debe ser anterior a to&#95;date. |
| 400 | Solicitud incorrecta | 356 | from&#95;date debe estar dentro de los últimos 5 días. | from&#95;date debe estar dentro de los últimos 5 días. |
| 401 | No autorizado | 32  | La autenticación HTTP falló porque se proporcionó autenticación 3-legged OAuth. | Método de autenticación no válido. Utiliza autenticación solo de aplicación. |
| 401 | No autorizado | 61  | El cliente no tiene permiso para solicitar este método. | El cliente no tiene permiso para solicitar este método. |
| 403 | Prohibido | 200 | El cliente no tiene una cuenta Enterprise con Replay habilitado. | Se requiere una cuenta Enterprise de la Account Activity API con Replay. Confirma que tienes una cuenta Enterprise y que Replay está habilitado. |
| 404 | No encontrado | 34  | webhook&#95;id inexistente; discrepancia entre webhook&#95;id y application&#95;id. | El webhook no existe o está asociado con una aplicación de X diferente. |
| 409 | Conflicto | 355 | Hay una solicitud en curso y deberá terminar de procesarse antes de realizar otra. | Ya hay un trabajo de Replay en curso para este webhook. |
| 429 | Demasiadas solicitudes | 88  | Se alcanzó el límite de frecuencia de solicitudes (rate limit). | Demasiadas solicitudes. Reduce la frecuencia de tus solicitudes a la API. |
| 500 | Error interno del servidor | 0   | Error interno del servidor. | Error interno del servidor. |
| 503 | Servicio no disponible | 67  | Uno o más servicios dependientes en X no están disponibles. | Error del servidor de X. Vuelve a intentarlo utilizando un patrón de retroceso exponencial. |

<div id="job-completed-successfully-message">
  #### &quot;Trabajo completado correctamente” mensaje
</div>

Una vez que tu trabajo se complete correctamente, Account Activity Replay API enviará el siguiente evento de finalización de trabajo. Una vez que recibas este evento, el trabajo habrá finalizado y podrás enviar otro.

```json
{
  "replay\_job\_status": {
    "webhook_id": "1234577122340233217",
    "job_state": "Complete",
    "job\_state\_description": "Job completed successfully"
    "job_id": "1095098195724558337"
  }
}
```

<div id="job-failed-to-complete-message">
  #### Mensaje &quot;Job failed to complete&quot;
</div>

En caso de que tu tarea no se complete correctamente, devolveremos el siguiente mensaje para recomendarte que vuelvas a intentar tu tarea de Replay. Una vez que recibas este evento, la tarea habrá terminado de ejecutarse y podrás enviar otra.

```json
{
  "replay\_job\_status": {
    "webhook_id": "123451374207332352",
    "job_state": "Incomplete",
    "job\_state\_description": "Job failed to deliver all events, please retry your replay job",
    "job_id": "1093226942650736640"
  }
}
```

<div id="example-curl-request">
  #### Ejemplo de solicitud curl
</div>

```bash
    curl --request POST  --url 'https://api.x.com/1.1/account_activity/replay/webhooks/:webhook_id/subscriptions/all.json?from_date=yyyymmddhhmm&to_date=yyyymmddhhmm'
    --header 'authorization: Bearer TOKEN'
```

#### Ejemplo de respuesta

HTTP 202

```bash
{
  "job_id": "1234567890",
  "created_at": "2016-06-02T23:54:02Z"
}
```
