---
title: Introducción a R y la v2 de la X API
mode: wide
keywords: ["programación en R", "tutorial de R", "API de R", "análisis estadístico", "análisis de datos", "lenguaje R", "integración con R"]
---

<div id="introduction">
  ## Introducción
</div>

Este tutorial explicará paso a paso lo que necesitas para comenzar a usar el
lenguaje de programación R y la X API v2. Usando R para conectarte al endpoint
[user lookup](/es/x-api/users/lookup/introduction), mostraré cómo trabajar
con el JSON que devuelve la X API. User lookup es un método GET y devuelve
información sobre un usuario o grupo de usuarios, especificados por un user ID o
un username.

Si no estás familiarizado, R es uno de los lenguajes más populares para tareas
comunes de ciencia de datos como análisis de series temporales, modelado,
visualización y otros tipos de análisis de datos, y a menudo se usa junto con
la X API. Con el endpoint de user
lookup, puedes usar el
[user object](/es/x-api/fundamentals/data-dictionary#user) para
determinar una correlación entre la cantidad de seguidores que tiene una
persona y la puntuación de sentimiento de su biografía. El user object también
puede usarse para mapear un grupo de cuentas en función de la ubicación
indicada públicamente en sus perfiles.

<div id="getting-started-with-the-x-api">
  ### Primeros pasos con la X API
</div>

Antes de poder usar la X API v2, debes
[registrarte](https://developer.x.com/en/portal/petition/essential/basic-info)
para obtener una cuenta de desarrollador.

Una vez que tengas una cuenta de desarrollador aprobada, primero deberás crear un
[Proyecto](/es/resources/fundamentals/projects). Los Proyectos te permiten organizar tu trabajo
en función de cómo tengas previsto usar la X API, para que puedas gestionar de forma eficaz
tu acceso a la API y supervisar su uso.

Cada Proyecto contiene una [Aplicación](/es/resources/fundamentals/developer-apps), con la cual puedes
generar las credenciales necesarias para usar la X API. Puedes obtener más información
sobre cómo comenzar a usar la X API en la sección
[Primeros pasos](/es/x-api/getting-started/about-x-api) de nuestra
documentación.

<div id="getting-your-r-environment-set-up">
  ### Cómo configurar tu entorno de R
</div>

Primero, necesitas [descargar R](https://cloud.r-project.org/), lo cual puedes hacer
en el [sitio web de CRAN.](https://cran.r-project.org/)

Luego, para configurar un entorno de trabajo con R, puedes usar
[RStudio](https://www.rstudio.com/), el paquete de extensiones de R para
[Visual Studio Code](https://marketplace.visualstudio.com/items?itemName=Ikuyadeu.r-pack),
o un
[Jupyter notebook](https://docs.anaconda.com/anaconda/navigator/tutorials/r-lang/)
si vienes del mundo de Python.

<div id="setting-up-your-environment-variable">
  ### Configurar tu variable de entorno
</div>

Para los ejemplos de código que voy a mostrarte hoy, querrás crear una
variable de entorno para tu Bearer Token. El Bearer Token es lo que te permite
autenticarte en la X API y empezar a realizar solicitudes. Primero, reemplaza
“your-bearer-token” por tu propio Bearer Token, que puedes obtener en la sección
de claves y tokens de tu Aplicación en el portal para desarrolladores. Tendrás que
ejecutar esta línea de código en la consola antes de empezar a escribir un script.

```r
Sys.setenv(BEARER_TOKEN = "tu-token-de-portador")
```

<div id="making-your-request">
  ### Realizar tu solicitud
</div>

Puedes usar el paquete
[httr](https://cran.r-project.org/web/packages/httr/index.html) para hacer
solicitudes HTTP a la X API. Si aún no lo has instalado, instala el paquete en
tu consola. También necesitarás instalar
[jsonlite](https://cran.r-project.org/web/packages/jsonlite/index.html) para
trabajar con nuestros objetos JSON y [dplyr](https://dplyr.tidyverse.org/) para
la manipulación de datos.

```r
install.packages("httr")
install.packages("jsonlite")
install.packages("dplyr")
```

Ahora puedes comenzar a escribir tu script en R para conectarte a la API. En la parte superior del
archivo, carga los paquetes httr, jsonlite y dplyr.

```r
require(httr)
require(jsonlite)
require(dplyr)
```

El primer paso en tu ejemplo de código es prepararte para autenticarte con la
X API. Toma el
[Bearer Token](/es/resources/fundamentals/authentication#using-and-generating-an-app-only-bearer-token) que obtuviste de
tu aplicación e inclúyelo en los encabezados para la autenticación. En el siguiente
ejemplo, reemplaza $BEARER&#95;TOKEN con tu token.

```r
bearer_token <- Sys.getenv("$BEARER_TOKEN")
headers <- c(`Authorization` = sprintf('Bearer %s', bearer_token))
```

Una vez que tengas configurada la autenticación, define los parámetros de tu solicitud.
De forma predeterminada, recibirás el id, el nombre y el nombre de usuario de cada usuario devuelto
en la respuesta. Puedes hacer ajustes a este payload agregando
[campos](/es/x-api/fundamentals/fields) y
[expansiones](/es/x-api/fundamentals/expansions). Para este ejemplo, necesitarás
la biografía del perfil del usuario, que se solicita usando user.fields=description,
y una expansión que contenga la Publicación fijada del usuario.

```r
params <- list(`user.fields` = 'description', `expansions` = 'pinned_tweet_id')
```

Ahora estás listo para dar formato a tu URL con el usuario de X, también conocido
como cuenta, sobre el que quieres obtener más información. Usa el método readline
para que este ejemplo se pueda reutilizar. Después de escribir el usuario que quieres consultar,
da formato a tu URL para que contenga el usuario que definiste, reemplazando $USERNAME por
el usuario de X deseado.

```r
handle <- readline('$USERNAME')
url_handle <- sprintf('https://api.x.com/2/users/by?usernames=%s', handle)
```

En este punto, utiliza el paquete httr para hacer una solicitud GET a la URL que
acabas de crear, incluye nuestras credenciales de autenticación en el encabezado y
especifica los parámetros que definiste. Puedes guardar la respuesta como un objeto
de texto en la variable obj e imprimirla para ver el resultado de la solicitud
que realizaste.

```r
response <-
  httr::GET(url = url_handle,
    httr::add_headers(.headers = headers),
    query = params)
obj <- httr::content(response, as = "text")
print(obj)
```

<div id="working-with-our-json-payload">
  ### Trabajar con nuestra carga útil JSON
</div>

Una de mis formas favoritas de trabajar con un JSON es usar un data frame, que te
permite acceder fácilmente a datos complejos y anidados. Para hacerlo, usa el
método fromJSON del paquete jsonlite para aplanar tu archivo y permitir que los
campos estén en el mismo objeto. Luego, pasa ese objeto a un data frame. Ahora
ya puedes consultar ese data frame.

```
json_data <- fromJSON(obj, flatten = TRUE) %>% as.data.frame View(json_data)
```

Puedes acceder a los campos de los datos desde el data frame e incluirlos en una
cadena de texto que contenga el handle, el nombre de usuario y la biografía.

```r
final <-
  sprintf(
    "Handle: %s\nBio: %s\nPublicación fijada: %s",
    json_data$data.username,
    json_data$data.description,
    json_data$includes.tweets.text
  )
```

Usa cat en lugar de print para ver el objeto con saltos de línea entre cada campo que
estás obteniendo.

```r
cat(final)
```

Si tenías varios handles para los que realizabas solicitudes, podías usar fácilmente un bucle
para acceder a cada elemento del data frame.

<div id="conclusion">
  ### Conclusión
</div>

Esperamos que este tutorial pueda ser un punto de partida para trabajar con R y la
API de X. Como siguiente paso, quizá quieras consultar nuestros ejemplos en R para búsqueda reciente,
consulta de Publicaciones y consulta de usuarios en nuestro
[código de ejemplo de v2](https://github.com/xdevplatform). Asegúrate de avisarnos en los
[foros](https://devcommunity.x.com/) si encuentras algún problema en el
proceso o publica una Publicación dirigida a [@XDevelopers](https://x.com/XDevelopers) si este
tutorial te inspira a crear algo.