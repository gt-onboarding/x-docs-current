---
title: Flujo de código de autorización de OAuth 2.0 con PKCE
sidebarTitle: Flujo de código de autorización de OAuth 2.0 con PKCE
keywords: ["OAuth 2.0 PKCE", "flujo de código de autorización", "PKCE", "flujo de OAuth 2.0", "flujo PKCE", "autorización de OAuth 2.0", "code challenge"]
---

<div id="oauth-20-authorization-code-flow-with-pkce">
  ### Flujo de código de autorización de OAuth 2.0 con PKCE
</div>

<div id="introduction">
  #### Introducción
</div>

OAuth 2.0 es un protocolo de autorización estándar del sector que permite un control más detallado sobre el ámbito de una aplicación y sobre los flujos de autorización en múltiples dispositivos. OAuth 2.0 te permite elegir ámbitos de acceso granulares que te otorgan permisos específicos en nombre de un usuario. 

Para habilitar OAuth 2.0 en tu aplicación, debes activarlo en la configuración de autenticación de la aplicación, que se encuentra en la sección Configuración de la aplicación en el portal para desarrolladores.

<div id="how-long-will-my-credentials-stay-valid">
  #### ¿Durante cuánto tiempo serán válidas mis credenciales?
</div>

De forma predeterminada, el token de acceso que creas mediante el flujo de código de autorización con PKCE solo será válido durante dos horas, a menos que hayas usado el scope `offline.access`.

<div id="refresh-tokens">
  #### Tokens de actualización
</div>

Los tokens de actualización permiten que una Aplicación obtenga un nuevo token de acceso sin solicitar la interacción del usuario, mediante el flujo de token de actualización.

Si se aplica el alcance `offline.access`, se emitirá un token de actualización de OAuth 2.0. Con este token de actualización se obtiene un token de acceso. Si este alcance no se envía, no generaremos un token de actualización.

Un ejemplo de la solicitud que deberías realizar para usar un token de actualización y obtener un nuevo token de acceso es el siguiente:

```bash
POST 'https://api.x.com/2/oauth2/token' \
--header 'Content-Type: application/x-www-form-urlencoded' \
--data-urlencode 'refresh_token=bWRWa3gzdnk3WHRGU1o0bmRRcTJ5VUxWX1lZTDdJSUtmaWcxbTVxdEFXcW5tOjE2MjIxNDc3NDM5MTQ6MToxOnJ0OjE' \
--data-urlencode 'grant_type=refresh_token' \
--data-urlencode 'client_id=rG9n6402A3dbUJKzXTNX4oWHJ
```

<div id="app-settings">
  #### Configuración de la aplicación
</div>

Puedes seleccionar la configuración de autenticación de tu aplicación como OAuth 1.0a u OAuth 2.0. También puedes habilitar una aplicación para que use tanto OAuth 1.0a como OAuth 2.0.

OAuth 2.0 solo puede usarse con la X API v2. Si has seleccionado OAuth 2.0, podrás ver un Client ID en la sección Claves y tokens de tu aplicación. 

<div id="confidential-clients">
  #### Clientes confidenciales
</div>

[Los clientes confidenciales](https://datatracker.ietf.org/doc/html/rfc6749#section-2.1) pueden mantener credenciales de forma segura sin exponerlas a partes no autorizadas y autenticarse de forma segura con el servidor de autorización, manteniendo tu client secret protegido. Los clientes públicos, como normalmente se ejecutan en un navegador o en un dispositivo móvil, no pueden utilizar tus client secrets. Si seleccionas un tipo de Aplicación que sea un cliente confidencial, se te proporcionará un client secret. 

Si seleccionaste en el portal para desarrolladores un tipo de cliente que es confidencial, también podrás ver un Client Secret. Tus opciones son Native App, Single page App, Web App, Automated App o bot. Native App y Single page App son clientes públicos, y Web App y Automated App o bots son clientes confidenciales.

No necesitas el client id para clientes confidenciales cuando utilizas un Authorization Header válido. Aun así, sigues estando obligado a incluir Client Id en el cuerpo de las solicitudes realizadas con un cliente público. 

<div id="scopes">
  #### Ámbitos
</div>

Los ámbitos te permiten establecer niveles de acceso granulares para tu Aplicación, de modo que tu Aplicación solo tenga los permisos que necesita. Para obtener más información sobre qué ámbitos se asignan a qué endpoints, consulta nuestra [guía de asignación de autenticación](/es/resources/fundamentals/authentication/guides/v2-authentication-mapping).

|     |     |
| :--- | :--- |
| **Scope** | **Descripción** |
| tweet.read | Todas las Publicaciones que puedes ver, incluidas las Publicaciones de cuentas protegidas. |
| tweet.write | Publicar y volver a publicar por ti. |
| tweet.moderate.write | Ocultar y dejar de ocultar respuestas a tus Publicaciones. |
| users.email | Correo electrónico de un usuario autenticado. |
| users.read | Cualquier cuenta que puedas ver, incluidas las cuentas protegidas. |
| follows.read | Personas que te siguen y personas a las que sigues. |
| follows.write | Seguir y dejar de seguir personas por ti. |
| offline.access | Mantener la conexión con tu cuenta hasta que revoques el acceso. |
| space.read | Todos los Spaces que puedes ver. |
| mute.read | Cuentas que has silenciado. |
| mute.write | Silenciar y dejar de silenciar cuentas por ti. |
| like.read | Publicaciones que te han gustado y Me gusta que puedes ver. |
| like.write | Indicar y quitar Me gusta en Publicaciones por ti. |
| list.read | Listas, miembros de listas y seguidores de listas que has creado o de las que eres miembro, incluidas las listas privadas. |
| list.write | Crear y administrar listas por ti. |
| block.read | Cuentas que has bloqueado. |
| block.write | Bloquear y desbloquear cuentas por ti. |
| bookmark.read | Obtener las Publicaciones que un usuario autenticado ha añadido a Marcadores. |
| bookmark.write | Añadir Publicaciones a Marcadores y quitarlas de Marcadores. |
| media.write | Subir contenido multimedia. |

<div id="rate-limits">
  #### Límites de frecuencia
</div>

En la mayoría de los casos, los límites de frecuencia son los mismos que al autenticarse con OAuth 1.0a, salvo en el caso de la búsqueda de Publicaciones y de Usuarios. Estamos aumentando el límite por aplicación de 300 a 900 solicitudes cada 15 minutos cuando se usa OAuth 2.0 para las búsquedas de Publicaciones y de Usuarios. Para obtener más información, asegúrate de consultar nuestra [documentación sobre límites de frecuencia](/es/resources/fundamentals/rate-limits).

<div id="grant-types">
  #### Tipos de concesión
</div>

Solo ofrecemos [authorization code](https://oauth.net/2/grant-types/authorization-code/) con [PKCE](https://oauth.net/2/pkce/) y [refresh token](https://oauth.net/2/grant-types/refresh-token/) como [tipos de concesión (grant types)](https://oauth.net/2/grant-types/) admitidos en este lanzamiento inicial. Es posible que en el futuro admitamos más tipos de concesión.

<div id="oauth-20-flow">
  #### Flujo de OAuth 2.0
</div>

OAuth 2.0 utiliza un flujo similar al que utilizamos actualmente para OAuth 1.0a. Puedes consultar un diagrama y una explicación detallada en nuestra [documentación al respecto](/es/resources/fundamentals/authentication/oauth-1-0a/obtaining-user-access-tokens). 

<div id="glossary">
  #### Glosario
</div>

|     |     |
| :--- | :--- |
| **Término** | **Descripción** |
| Grant types | El framework OAuth especifica varios tipos de grant para diferentes casos de uso y un marco para crear nuevos tipos de grant. Algunos ejemplos son authorization code, client credentials, device code y refresh token. |
| Confidential client | Clientes que son aplicaciones capaces de autenticarse de forma segura con el servidor de autorización, por ejemplo, manteniendo a salvo su client secret registrado. |
| Public client | Clientes que no pueden usar client secrets registrados, como las aplicaciones que se ejecutan en un navegador o en un dispositivo móvil. |
| Authorization code flow | Flujo usado tanto por clientes confidenciales como públicos para intercambiar un código de autorización por un Token de acceso. |
| PKCE | Extensión del authorization code flow para evitar varios tipos de ataques y poder realizar de forma segura el intercambio OAuth desde clientes públicos. |
| Client ID | Se puede encontrar en la sección de claves y tokens del portal para desarrolladores, bajo el encabezado &quot;Client ID&quot;. Si no ves esto, ponte en contacto directamente con nuestro equipo. El Client ID será necesario para generar la URL de autorización. |
| Redirect URI | Tu URL de callback. Necesitarás tener [validación de coincidencia exacta](https://datatracker.ietf.org/doc/html/rfc6749#section-10.6). |
| Authorization code | Permite que una Aplicación llame a APIs en nombre de los usuarios. Se conoce como auth&#95;code. El auth&#95;code tiene un límite de tiempo de 30 segundos una vez que el propietario de la Aplicación recibe del usuario un auth&#95;code aprobado. Tendrás que intercambiarlo por un Token de acceso en un plazo de 30 segundos o el auth&#95;code caducará. |
| Access token | Los Tokens de acceso son el token que las aplicaciones utilizan para hacer solicitudes de API en nombre de un usuario. |
| Refresh token | Permite que una aplicación obtenga un nuevo Token de acceso sin volver a solicitar la intervención del usuario, mediante el flujo de refresh token. |
| Client Secret | Si has seleccionado un tipo de Aplicación que es un confidential client, se te proporcionará un &quot;Client Secret&quot; debajo de &quot;Client ID&quot; en la sección de claves y tokens de tu Aplicación. |

<div id="parameters">
  #### Parámetros
</div>

Para construir una URL de autorización OAuth 2.0, debes asegurarte de incluir los siguientes parámetros en la URL de autorización. 

|     |     |
| :--- | :--- |
| **Parámetro** | **Descripción** |
| response&#95;type | Debes especificar que se trata de un código con la palabra &quot;code&quot;. |
| client&#95;id | Se puede encontrar en el portal para desarrolladores con el encabezado &quot;Client ID&quot;. |
| redirect&#95;uri | Tu URL de callback. Este valor debe corresponder a una de las Callback URLs definidas en la configuración de tu Aplicación. Para OAuth 2.0, debes tener [validación de coincidencia exacta](https://datatracker.ietf.org/doc/html/rfc6749#section-10.6) para tu URL de callback. |
| state | Una cadena aleatoria que proporcionas para protegerte frente a [ataques CSRF](https://auth0.com/docs/protocols/state-parameters). La longitud de esta cadena puede ser de hasta 500 caracteres. |
| code&#95;challenge | Un parámetro [PKCE](https://www.oauth.com/oauth2-servers/pkce/authorization-request/), un secreto aleatorio para cada solicitud que realices. |
| code&#95;challenge&#95;method | Especifica el método que estás utilizando para hacer una solicitud (S256 o plain). |

<div id="authorize-url">
  #### URL de autorización
</div>

Con OAuth 2.0, creas una URL de autorización que puedes usar para que un usuario se autentique mediante un flujo de autenticación, similar a “Iniciar sesión” con X. 

Un ejemplo de la URL que estás creando es el siguiente:

```
https://x.com/i/oauth2/authorize?response_type=code&client_id=M1M5R3BMVy13QmpScXkzTUt5OE46MTpjaQ&redirect_uri=https://www.example.com&scope=tweet.read%20users.read%20account.follows.read%20account.follows.write&state=state&code_challenge=challenge&code_challenge_method=plain
```

Necesitas utilizar la codificación correcta para que esta URL funcione. Asegúrate de consultar nuestra documentación sobre la [codificación de porcentajes](/es/resources/fundamentals/authentication/oauth-1-0a/percent-encoding-parameters).
