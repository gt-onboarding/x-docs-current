---
title: "流式处理"
sidebarTitle: "流式处理"
---

TypeScript SDK 提供对实时数据流的流式处理能力。

<div id="basic-streaming">
  ## 基础流式传输
</div>

连接到实时抽样的帖子流：

<CodeGroup>

```typescript stream.ts theme={null}
import { Client } from '@xdevplatform/xdk';

const client: Client = new Client({ bearerToken: 'your-bearer-token' });

// 1% 抽样的公开帖子
const stream = await client.stream.postsSample({
  tweetFields: ['id','text','created_at'],
  expansions: ['author_id'],
  userFields: ['id','username','name']
});

// 监听事件
stream.on('data', (event) => {
  // event 是解析后的 JSON 行（data/includes/matching_rules）
  console.log('New data:', event);
});

stream.on('error', (e) => console.error('Stream error:', e));
stream.on('close', () => console.log('Stream closed'));
```

```javascript stream.js theme={null}
import { Client } from '@xdevplatform/xdk';

const client = new Client({ bearerToken: 'your-bearer-token' });
const stream = await client.stream.postsSample({ tweetFields: ['id','text'] });

stream.on('data', (event) => {
  console.log('New data:', event);
});
stream.on('error', (e) => console.error('Stream error:', e));
stream.on('close', () => console.log('Stream closed'));
```

</CodeGroup>

<div id="async-iteration">
  ## 异步迭代
</div>

使用异步迭代来处理流数据：

<CodeGroup>

```typescript async.ts theme={null}
const stream = await client.stream.postsSample();
for await (const event of stream) {
  // 每个 event 都是一行已解析的 JSON（data/includes/matching_rules）
  console.log(event);
}
```

```javascript async.js theme={null}
const stream = await client.stream.postsSample();
for await (const event of stream) {
  console.log(event);
}
```

</CodeGroup>

<div id="stream-management">
  ## 流管理
</div>

管理事件驱动流的生命周期：

```typescript
// 关闭流
stream.close();

// 自动重连(如果在您的包装器中启用)
// 默认的 EventDrivenStream 暴露了基本的重连钩子
```


<div id="error-handling">
  ## 错误处理
</div>

处理流式传输错误和重连：

```typescript
stream.on('error', (event) => {
  const err = event.error || event;
  console.error('Stream error:', err);
});

stream.on('keepAlive', () => {
  // 心跳事件
});
```

<Info>
  如需查看使用 JavaScript/TypeScript XDK 的详细代码示例，请前往我们的 [GitHub 代码示例仓库](https://github.com/xdevplatform/samples/tree/main/javascript)。
</Info>
