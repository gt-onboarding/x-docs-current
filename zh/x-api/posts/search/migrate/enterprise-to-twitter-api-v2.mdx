---
title: v1 到 v2（Enterprise）
sidebarTitle: v1 到 v2（Enterprise）
keywords: ["enterprise to v2", "enterprise migration", "GNIP to v2", "enterprise search migration", "migrate enterprise", "v1 to v2 enterprise"]
---

<div id="enterprise-compared-to-x-api-v2">
  ### Enterprise 与 X API v2 的比较
</div>

**相似之处**

* 分页
* 时区
* 对帖子编辑历史和元数据的支持

**不同之处**

* 端点 URL
* 应用和项目要求
* 可用时间范围
* 响应数据格式
* HTTP 方法
* 请求时间格式
* 请求参数
* 过滤运算符

<div id="similarities">
  #### 相似之处
</div>

**分页**

虽然 v2 提供了额外的分页功能（新增的分页参数允许你结合帖子 ID 使用 `since_id` 和 `until_id` 进行导航），但 Enterprise 和 v2 都允许你按时间进行分页（Enterprise 使用 `fromDate` 和 `toDate`，v2 使用 `start_time` 和 `end_time`）。

**时区**

如在“分页”部分所述，你可以在 Enterprise 和 v2 中通过时间来翻页获取不同的数据。在这两种情况下，使用这些参数时你都需要使用 UTC 作为时区。

**对帖子编辑历史和元数据的支持**

这两个版本都提供用于描述任何编辑历史的元数据。请查看 [search API 参考文档](/zh/x-api/posts/recent-search) 和 [Post edits 基础页面](/zh/x-api/fundamentals/edit-posts) 以获取更多详情。 

<div id="differences">
  #### 差异
</div>

**端点 URL**

* Enterprise 端点：
  * 30 天 - `http://gnip-api.x.com/search/30day/accounts/:account_name/:label.json`
  * 全量归档 - `http://gnip-api.x.com/search/fullarchive/accounts/:account_name/:label.json`
* X API v2 端点
  * 最近（7 天）- `https://api.x.com/2/tweets/search/recent`
  * 全量归档 - `https://api.x.com/2/tweets/search/all`

**应用和项目要求**

在对请求进行身份验证时，X API v2 端点要求你使用来自某个项目的凭据。所有 X API v1.1 端点都可以使用来自独立应用或与项目关联应用的凭据。
 

**可用时间范围**

Enterprise API 和 X API v2 都提供了端点，允许你在完整帖子归档中检索经过过滤的帖子数据。

然而，X API v2 并不像 Enterprise API 那样提供 30 天时间范围的端点。它提供的是前文提到的全量归档端点，或者 7 天时间范围的端点，这与 Native Enriched to v2 和 [Activity Streams to v2](/zh/x-api/migrate/data-format-migration#migrating-from-activity-streams-data-format-to-v2) 迁移相对应，可帮助你将 Enterprise 字段映射到新的 v2 字段。本指南还将为你提供在 v2 请求中需要传递的具体 expansions 和 fields 参数，以返回特定字段。
 

**响应数据格式**

[Enterprise 响应格式](https://developer.x.com/x-api/enterprise-gnip-2.0/fundamentals/data-dictionary) 与 [X API v2 的格式](/zh/x-api/fundamentals/data-dictionary) 之间最大的差异之一，是你如何选择在载荷中返回哪些字段。

对于 Enterprise Search API，你默认会收到许多响应字段，然后可以选择使用参数来指定应在载荷中返回哪些字段或字段集合。

X API v2 默认只返回帖子 `id` 和 `text` 字段。若要请求任何其他字段或对象，你需要使用 [fields](/zh/x-api/fundamentals/fields) 和 [expansions](/zh/x-api/fundamentals/expansions) 参数。从这些端点请求的任何帖子字段都会返回在主帖子对象中。任何展开的用户、媒体、投票或地点对象及其字段都会返回在响应中的 `includes` 对象内。然后，你可以通过匹配帖子对象和展开对象中出现的 ID，将任何展开对象重新映射回帖子对象。

我们建议你在各自的指南中进一步了解这些新参数，或者阅读我们的[如何使用 fields 和 expansions](/zh/x-api/fundamentals/data-dictionary#how-to-use-fields-and-expansions) 指南。

除了你请求某些字段的方式发生变化之外，X API v2 还为 API 返回的对象引入了新的 JSON 设计，包括 [Post](/zh/x-api/fundamentals/data-dictionary#tweet) 对象和 [user](/zh/x-api/fundamentals/data-dictionary#user) 对象。

* 在 JSON 根级别，标准端点在 `statuses` 数组中返回帖子对象，而 X API v2 返回的是 `data` 数组。
* X API v2 JSON 不再引用被转发和被引用的 “statuses”，而是引用转发和引用的帖子。许多传统和已弃用字段，例如 `contributors` 和 `user.translator_type`，正在被移除。
* X API v2 不再同时使用 `favorites`（帖子对象中）和 `favourites`（用户对象中），而是使用术语 `like`。
* X 采用这样一种约定：没有值的 JSON 字段（例如值为 `null`）不会写入载荷。只有在帖子和用户属性具有非空值时，这些属性才会被包含。
   

我们还在帖子对象中引入了一组新的字段，包括以下内容：

* 一个 [conversation&#95;id](/zh/x-api/fundamentals/conversation-id) 字段
* 两个新的 [annotations](/zh/x-api/fundamentals/post-annotations) 字段，包括 context 和 entities
* 若干新的 [metrics](/zh/x-api/fundamentals/metrics) 字段
* 一个新的 `reply_setting` 字段，用于指示谁可以回复某条帖子

最后再说明一点。Premium 响应在根级别包含一个 `requestParameters` 对象，其中包含你在请求中加入的参数。而 v2 版本则在根级别包含一个 `meta` 对象，其中包括 `newest_id`、`oldest_id`、`result_count`，以及在存在附加结果页时的 `next_token`。

**HTTP 方法**

API 的 Enterprise 版本允许你使用带 JSON 请求体的 POST HTTP 方法，或使用带查询字符串的 GET HTTP 方法发送请求。

v2 只允许你使用带查询字符串的 GET HTTP 方法。
 

**请求时间格式**

此端点的 Enterprise 版本在分页参数和 `timePeriod` 响应字段中使用以下日期/时间格式：`YYYYMMDDHHmm`

v2 端点在分页参数以及 `start` 和 `end` 响应字段中使用 ISO 8601/RFC 3339 日期/时间格式：`YYYY-MM-DDTHH:mm:ssZ`
 

**请求参数**

下面的表格列出了 Enterprise 和 X API v2 所使用的请求参数：

| Enterprise | Search Posts v2 |
| :--- | :--- |
| query | query |
| maxResults | max&#95;results |
| fromDate (YYMMDDHHmm) | start&#95;time (YYYY-MM-DDTHH:mm:ssZ) |
| toDate (YYMMDDHHmm) | end&#95;time (YYYY-MM-DDTHH:mm:ssZ) |
|     | since&#95;id |
|     | until&#95;id |
| next | next&#95;token or pagination&#95;token |

**过滤运算符**

虽然 Enterprise 和 X API v2 之间的大多数运算符是相同的，但在运算符可用性方面存在一些差异，并且有一些新运算符仅在 X API v2 中引入。

要查看适用于 X API v2、Enterprise 以及 premium 和 standard 的完整运算符列表，请访问 [Search Posts 迁移落地页](/zh/x-api/posts/search/migrate/overview)。

**后续步骤**

[查看 X API v2 全量存档搜索的快速入门指南](/zh/x-api/posts/search/quickstart/full-archive-search)

[查看全量存档搜索的 API 参考](/zh/x-api/posts/full-archive-search)

[查看这些端点的一些示例代码](https://github.com/xdevplatform/Twitter-API-v2-sample-code)