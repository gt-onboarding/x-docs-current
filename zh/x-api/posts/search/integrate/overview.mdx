---
title: 概览
sidebarTitle: 概览
keywords: ["搜索集成", "搜索概览", "搜索指南", "搜索实现", "帖子搜索集成"]
---

<div id="how-to-integrate-with-the-search-posts-endpoints">
  ## 如何集成 Search Posts 端点
</div>

本页介绍在将近期搜索或完整存档搜索端点集成到你的系统时需要了解的一些工具和关键概念。我们将本页内容划分为以下部分：

* [实用工具](#helpful-tools)
* 关键概念
  * [认证](#authentication)

  * [开发者门户、项目和应用](#developer-portal)

  * [速率限制](#rate-limits)

  * [字段和扩展字段](#fields-expansions)

  * [指标](#metrics)

  * [构建搜索查询](#queries)

  * [分页](#pagination)

  * [帖子上限](#tweet-caps) 

  * [帖子编辑](#tweet-edits) 

<div id="helpful-tools">
  ### 实用工具
</div>

在开始探索一些关键概念之前，我们建议你先使用下列工具或代码示例之一，对这些接口的功能进行测试。

<div id="code-samples">
  #### 代码示例
</div>

想使用你偏好的编程语言，通过一些代码来对接这些端点吗？我们在 [GitHub 页面](https://github.com/xdevplatform/Twitter-API-v2-sample-code) 上提供了多种可作为起点的代码示例，其中包括一个 [Python client](https://github.com/xdevplatform/search-tweets-python) 和一个 [Ruby client](https://github.com/xdevplatform/search-tweets-ruby)。

<div id="libraries">
  #### 库
</div>

使用我们提供的众多[社区第三方库](/zh/x-api/tools-and-libraries/overview)来帮助你开始集成。你可以通过查找相应的版本标签，找到与 v2 端点兼容的库。

<div id="postman">
  #### Postman
</div>

Postman 是一个非常好用的工具，你可以用它来测试这些端点。每个 Postman 请求都包含该端点支持的所有参数，帮助你快速了解有哪些可用内容。要进一步了解我们的 Postman 集合，请访问我们的 [使用 Postman](/zh/tutorials/postman-getting-started) 页面。
 

<div id="key-concepts">
  ### 关键概念
</div>

<div id="authentication">
  #### 身份验证
</div>

所有 X API v2 端点都要求你使用一组凭证（也称为密钥和令牌）对请求进行身份验证。你可以使用 OAuth 1.0a 用户上下文、OAuth 2.0 应用仅模式，或 OAuth 2.0 Authorization Code with PKCE 来对发送到近期搜索端点的请求进行身份验证。使用全量归档搜索端点时，必须使用 OAuth 2.0 应用仅模式。

[OAuth 2.0 应用仅模式](/zh/resources/fundamentals/authentication#oauth-2-0-authorization-code-flow-with-pkce-3) 只要求你在请求中携带一个 [OAuth 2.0 App Access Token](/zh/resources/fundamentals/authentication#bearer-token-also-known-as-app-only)。你可以直接在开发者应用中生成一个应用访问令牌（App Access Token），或者通过 [POST oauth2/token](/zh/resources/fundamentals/authentication#post-oauth2-token) 端点生成。

[OAuth 1.0a 用户上下文](/zh/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow) 要求你使用 API 密钥、用户访问令牌以及少量其他参数来[创建授权头](https://developer-staging.x.com/resources/fundamentals/authentication/authorizing-a-request)，然后将该授权头随请求一起发送。访问令牌必须与代表其发起请求的用户相关联。如果你想为另一位用户生成一组访问令牌，则该用户必须使用 [三方 OAuth 流程](https://developer-staging.x.com/resources/fundamentals/authentication/obtaining-user-access-tokens) 授权你的应用。 

请注意，OAuth 1.0a 的使用可能比较困难。如果你不熟悉这种身份验证方式，我们建议你使用一个[库](/zh/x-api/tools-and-libraries/overview)、使用 Postman 之类的工具，或使用 OAuth 2.0 来对请求进行身份验证。如果你想从这些端点请求某条帖子或其私有指标，你需要使用 OAuth 1.0a 用户上下文或 OAuth 2.0 Authorization Code with PKCE，以确保你拥有该内容所属用户授予的适当权限。

[OAuth 2.0 Authorization Code with PKCE](/zh/resources/fundamentals/authentication#oauth-2-0-authorization-code-flow-with-pkce-2) 允许你对应用的权限范围（scope）以及跨多设备的授权流程进行更精细的控制。OAuth 2.0 允许你选择特定的细粒度 scope，以便代表用户获得特定权限。 

要在你的应用中启用 OAuth 2.0，你必须在开发者门户中该应用设置页的“身份验证设置”部分将其启用。

<Note>
  **请注意**

  如果你请求以下[字段](/zh/x-api/fundamentals/fields)，则需要使用 OAuth 1.0a 用户上下文或 OAuth 2.0 Authorization Code： 

  * tweet.fields.non&#95;public&#95;metrics
  * tweet.fields.promoted&#95;metrics
  * tweet.fields.organic&#95;metrics
  * media.fields.non&#95;public&#95;metrics
  * media.fields.promoted&#95;metrics
  * media.fields.organic&#95;metrics
</Note>

####

开发者门户、项目和开发者应用

要使用任何 X API v2 端点，你必须先[注册开发者账号](https://developer.x.com/en/portal/petition/essential/basic-info)，在该账号下设置一个项目，并在该项目中创建一个开发者应用。你在该开发者应用中获得的密钥和令牌可用于这些搜索端点。

你可以使用任意[访问级别](/zh/x-api/getting-started/about-x-api)项目中的密钥和令牌，向最近搜索端点发出请求。但是，要向完整归档搜索端点发出请求，你需要使用具有 Pro 或 Enterprise 访问级别的项目。如果你拥有[Enterprise 访问权限](/zh/x-api/getting-started/getting-access)，你将能够使用更多功能，包括更多可用的运算符以及更长的查询长度。
 

<div id="rate-limits">
  #### 速率限制
</div>

每天都有成千上万的开发者向 X API 发起请求。为了管理请求量，我们在每个端点上都设置了[速率限制](/zh/x-api/fundamentals/rate-limits)，用于限制每位开发者代表某个应用或某个已认证用户所能发起的请求次数。

针对这些端点，会根据所使用的认证方式施加不同的速率限制。应用级速率限制适用于使用 OAuth 2.0 应用仅模式发起请求的应用，而用户级速率限制适用于代表特定授权用户、使用 OAuth 1.0a 用户上下文或 OAuth 2.0 Authorization Code with PKCE 发起的请求。这两类速率限制都基于 15 分钟时间窗口内的请求频率。

例如，一个使用 OAuth 2.0 应用仅模式来调用最近搜索端点的应用，可以在 15 分钟时间段内发起 450 次请求（包括分页请求）。同一个应用，在相同的 15 分钟时间段内，通过两个不同的已认证用户（使用 OAuth 1.0a 用户上下文或 OAuth 2.0 Authorization Code with PKCE）时，可以针对每个已认证用户向最近搜索端点最多发起 180 次请求（包括分页请求）。
 

<div id="fields-and-expansions">
  #### 字段和扩展字段
</div>

X API v2 允许你通过使用 [字段](/zh/x-api/fundamentals/fields) 和 [扩展字段](/zh/x-api/fundamentals/expansions) 精确选择希望从 API 返回的具体数据。`expansions` 参数允许你将响应负载中被引用的对象扩展为完整对象。例如，此端点允许你使用 `expansions` 参数请求投票、地点、媒体以及其他对象。

`fields` 参数允许你精确选择希望接收的不同数据对象中的具体字段。默认情况下，这些端点返回的主要帖子对象会包含 `id` 和 `text` 字段（对于该功能发布后创建的帖子，还会包含 `edit_history_tweet_ids`）。要接收 `author_id` 或 `public_metrics` 等其他字段，你必须通过 `fields` 参数显式请求这些字段。在你的集成中，一些你可能希望考虑使用的重要字段包括投票数据、[指标](/zh/x-api/fundamentals/metrics)、[帖子注释](/zh/x-api/fundamentals/post-annotations)以及[会话 ID](/zh/x-api/fundamentals/conversation-id) 字段。

我们在 [X API v2 数据字典](/zh/x-api/fundamentals/data-dictionary) 中新增了一篇指南，介绍如何[结合使用字段和扩展字段](/zh/x-api/fundamentals/data-dictionary#how-to-use-fields-and-expansions)。
 

<div id="metrics">
  #### 指标
</div>

X API v2 端点允许你直接从返回的对象中请求指标，只要你在请求中传入适当的[字段](/zh/x-api/fundamentals/fields)。

与帖子指标相关存在一些限制，你需要注意，特别是与用户隐私以及以下响应字段相关的限制：

* tweet.fields.non&#95;public&#95;metrics
* tweet.fields.promoted&#95;metrics
* tweet.fields.organic&#95;metrics
* media.fields.non&#95;public&#95;metrics
* media.fields.promoted&#95;metrics
* media.fields.organic&#95;metrics

上述字段包含私有指标数据，这意味着在使用最近搜索端点时，你必须获得帖子的发布者授权，才能代表他们获取这些数据，也就是说，你必须使用 [OAuth 1.0a 用户上下文](/zh/resources/fundamentals/authentication)。由于你只能在最近搜索中使用这种认证方式，因此无法通过完整归档搜索端点获取这些指标。

例如，为了获取用户 ID 1234 的帖子对应的 `non_public_metrics`，你需要在请求中包含与该用户关联的访问令牌。你可以通过使用[三方 OAuth 流程](/zh/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow)，让用户授权你的应用，并获取一组与他们关联的访问令牌。

所有 `non_public_metrics`、`organic_metrics` 和 `promoted_metrics` 仅对过去 30 天内创建的帖子可用。这意味着当你请求上述字段时，结果会自动调整为只包含最近 30 天内的帖子。

如果请求了这些字段，只会返回由已认证用户创作的帖子，其他所有帖子在这些字段上都会返回错误。
 

<div id="building-search-queries">
  #### 构建搜索查询
</div>

这些端点的核心特性在于使用单个搜索查询来筛选返回给你的帖子。这些查询由运算符组成，这些运算符用于匹配帖子和用户的属性，例如消息关键词、话题标签和 URL。你可以使用布尔逻辑和括号将运算符组合成查询，从而更精细地控制查询的匹配行为。

你可以参考我们的[如何构建查询](/zh/x-api/posts/search/integrate/build-a-query)指南了解更多信息。

<div id="pagination">
  #### 分页
</div>

这些端点使用分页机制以便更快返回响应。当可返回的结果多于单个响应所能包含的数量时（最近搜索最多返回 100 条帖子，完整存档搜索最多返回 500 条），你需要进行分页。使用 `max_results` 参数来指定每页返回的结果数量，并使用 `pagination_token` 参数来获取下一页的结果。你可以通过查看我们的[分页指南](/zh/x-api/fundamentals/pagination)了解更多信息。

<div id="post-caps">
  #### 帖子上限
</div>

Search Posts 端点在任意一个月内可返回的帖子数量是有限的，与分页无关。

无论你使用哪个搜索端点，返回的帖子都会计入项目级别的 [Post caps](/zh/x-api/fundamentals/post-cap)。使用量会显示在开发者门户中，“month”（月份）从你在 [开发者门户仪表盘](https://developer.x.com/en/portal/dashboard) 上显示的订阅续费日开始计算。

**帖子编辑**

符合编辑条件的帖子，在原始帖子发布后的 30 分钟内最多可以编辑五次。搜索端点始终会返回该帖子的最新版本。如果你只请求发布于 30 分钟或更早之前的帖子，你将始终收到该帖子的最终版本。另一方面，如果你的用例需要接近实时，并且正在查询最近三十分钟内发布的帖子，那么这些帖子在你收到之后可能会被编辑。这些帖子可以通过搜索端点，或通过 Post Lookup 端点重新获取（rehydrate），以确认其最终状态。要了解帖子编辑的工作原理，请参阅 [Post edits fundamentals](/zh/x-api/fundamentals/edit-posts) 页面。  

**后续步骤**

[向 Search Posts 端点发送你的第一个请求](/zh/x-api/posts/search/quickstart/recent-search)

[在我们的 API Reference 页面中查看完整的参数、字段列表及更多内容](/zh/x-api/posts/recent-search)

[获取支持或排查错误](https://developer.x.com/en/support/x-api)