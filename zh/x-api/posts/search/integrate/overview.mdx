---
title: 概览
sidebarTitle: 概览
keywords: ["搜索集成", "搜索概览", "搜索指南", "搜索实现", "帖子搜索集成"]
---

<div id="how-to-integrate-with-the-search-posts-endpoints">
  ## 如何集成 Search Posts 端点
</div>

本页介绍在将最近搜索或完整归档搜索端点集成到你的系统时，你需要了解的若干工具和关键概念。我们将本页划分为以下几个部分：

* [实用工具](#helpful-tools)
* 关键概念
  * [身份验证](#authentication)

  * [开发者门户、项目和应用](#developer-portal)

  * [速率限制](#rate-limits)

  * [字段和扩展字段](#fields-expansions)

  * [指标](#metrics)

  * [构建搜索查询](#queries)

  * [分页](#pagination)

  * [帖子上限](#tweet-caps) 

  * [帖子编辑](#tweet-edits) 

<div id="helpful-tools">
  ### 实用工具
</div>

在开始探索一些关键概念之前，我们建议你先使用下列工具或代码示例之一，对这些端点的功能进行测试。

<div id="code-samples">
  #### 代码示例
</div>

想用你喜欢的编程语言，通过一些代码来完成这些端点的集成吗？我们在 [GitHub 页面](https://github.com/xdevplatform/Twitter-API-v2-sample-code)上提供了多种可作为起点的代码示例，其中包括一个 [Python 客户端](https://github.com/xdevplatform/search-tweets-python) 和一个 [Ruby 客户端](https://github.com/xdevplatform/search-tweets-ruby)。

<div id="libraries">
  #### 库
</div>

充分利用我们提供的众多[社区第三方库](/zh/x-api/tools-and-libraries/overview)，帮助你快速开始集成。你可以通过查看相应的版本标签，找到适用于 v2 端点的库。

<div id="postman">
  #### Postman
</div>

Postman 是一个非常实用的工具，你可以用它来测试这些接口端点。每个 Postman 请求都包含该端点的全部参数，帮助你快速了解可用选项。要进一步了解我们的 Postman 集合，请访问我们的 [使用 Postman](/zh/tutorials/postman-getting-started) 页面。
 

<div id="key-concepts">
  ### 关键概念
</div>

<div id="authentication">
  #### 身份验证
</div>

所有 X API v2 端点都要求你使用一组凭证（也称为密钥和令牌）对请求进行身份验证。你可以使用 OAuth 1.0a 用户上下文、OAuth 2.0 应用仅模式 或 OAuth 2.0 Authorization Code with PKCE 来对发往近期搜索端点的请求进行身份验证。使用完整归档搜索端点时，你必须使用 OAuth 2.0 应用仅模式。

[OAuth 2.0 应用仅模式](/zh/resources/fundamentals/authentication#oauth-2-0-authorization-code-flow-with-pkce-3) 只要求你在请求中携带一个 [OAuth 2.0 App Access Token](/zh/resources/fundamentals/authentication#bearer-token-also-known-as-app-only)。你可以直接在某个开发者应用中生成一个 App Access Token，或者使用 [POST oauth2/token](/zh/resources/fundamentals/authentication#post-oauth2-token) 端点生成。

[OAuth 1.0a 用户上下文](/zh/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow) 要求你使用 API 密钥、用户访问令牌和少量其他参数来[创建授权头](https://developer-staging.x.com/resources/fundamentals/authentication/authorizing-a-request)，然后将其随请求一起发送。访问令牌必须与代表其发出请求的用户关联。如果你希望为其他用户生成一组访问令牌，他们必须通过 [三方 OAuth 流程](https://developer-staging.x.com/resources/fundamentals/authentication/obtaining-user-access-tokens) 授权你的应用。

请注意，OAuth 1.0a 的使用可能较为复杂。如果你不熟悉这种身份验证方法，建议你使用某个[库](/zh/x-api/tools-and-libraries/overview)、使用 Postman 等工具，或使用 OAuth 2.0 来对请求进行身份验证。如果你希望从这些端点请求某条帖子或私有指标，你需要使用 OAuth 1.0a 用户上下文或 OAuth 2.0 Authorization Code with PKCE，以确保你已从拥有该内容的用户那里获得适当的权限。

[OAuth 2.0 Authorization Code with PKCE](/zh/resources/fundamentals/authentication#oauth-2-0-authorization-code-flow-with-pkce-2) 允许你对应用的 scope（权限范围）以及跨多设备的授权流程进行更精细的控制。OAuth 2.0 允许你选择特定的细粒度 scope，从而代表某个用户获取特定权限。

要在你的应用中启用 OAuth 2.0，你必须在开发者门户的 App 设置部分中，在该应用的身份验证设置里启用 OAuth 2.0。

<Note>
  **请注意**

  如果你正在请求以下[字段](/zh/x-api/fundamentals/fields)，则需要使用 OAuth 1.0a 用户上下文或 OAuth 2.0 Authorization Code：

  * tweet.fields.non&#95;public&#95;metrics
  * tweet.fields.promoted&#95;metrics
  * tweet.fields.organic&#95;metrics
  * media.fields.non&#95;public&#95;metrics
  * media.fields.promoted&#95;metrics
  * media.fields.organic&#95;metrics
</Note>

####

开发者门户、项目和开发者应用

要使用任何 X API v2 的端点，你必须先[注册开发者账号](https://developer.x.com/en/portal/petition/essential/basic-info)，在该账号下设置一个项目，然后在该项目中创建一个开发者应用。你在该开发者应用中的密钥和令牌可用于这些搜索端点。

你可以使用任意[访问级别](/zh/x-api/getting-started/about-x-api)的项目中的密钥和令牌来向最近搜索端点发起请求。但是，要向完整存档搜索端点发起请求，你需要使用具有 Pro 或 Enterprise 访问级别的项目。如果你拥有 [Enterprise 访问权限](/zh/x-api/getting-started/getting-access)，你将可以使用更多功能，包括更多可用的运算符以及更长的查询字符串。
 

<div id="rate-limits">
  #### 速率限制
</div>

每天都有成千上万的开发者向 X API 发起请求。为帮助管理请求量，我们在每个 endpoint 上设置了[速率限制](/zh/x-api/fundamentals/rate-limits)，以限制每位开发者代表一个应用或代表一个已认证用户所能发起的请求次数。

根据所使用的认证方式不同，这些 endpoint 会适用不同的速率限制。应用级速率限制适用于使用 OAuth 2.0 应用仅模式发起请求的应用；而用户级速率限制适用于使用 OAuth 1.0a 用户上下文或 OAuth 2.0 Authorization Code with PKCE，代表特定授权用户发起的请求。这两类速率限制都基于 15 分钟时间窗口内的请求频率。

例如，一个使用 OAuth 2.0 应用仅模式认证来访问最近搜索 endpoint 的应用，可以在 15 分钟时间段内发起 450 次请求（包括分页请求）。同一个应用，在相同的 15 分钟时间段内，使用两个不同的已认证用户（通过 OAuth 1.0a 用户上下文或 OAuth 2.0 Authorization Code with PKCE）访问最近搜索 endpoint 时，可以为每个已认证用户分别发起最多 180 次请求（包括分页请求）。
 

<div id="fields-and-expansions">
  #### 字段和扩展字段
</div>

X API v2 允许你使用[字段](/zh/x-api/fundamentals/fields)和[扩展字段](/zh/x-api/fundamentals/expansions)精确指定希望从 API 返回的数据。expansions 参数允许你展开响应载荷中引用的对象。例如，该端点允许你通过 expansions 参数请求投票、地点、媒体以及其他对象。

fields 参数允许你精确选择希望接收的各类数据对象中的具体字段。默认情况下，这些端点返回的主要帖子对象包含 id 和 text 字段（对于该功能推出后创建的帖子，还会额外包含 edit&#95;history&#95;tweet&#95;ids）。如果你希望接收诸如 author&#95;id 或 public&#95;metrics 之类的其他字段，则必须使用 fields 参数显式请求这些字段。在你的集成中，一些你可能会考虑使用的重要字段包括我们的投票数据、[指标](/zh/x-api/fundamentals/metrics)、[帖子注解](/zh/x-api/fundamentals/post-annotations)以及[会话 ID](/zh/x-api/fundamentals/conversation-id) 等字段。

我们在 [X API v2 数据字典](/zh/x-api/fundamentals/data-dictionary)中新增了一篇关于[如何同时使用字段和扩展字段](/zh/x-api/fundamentals/data-dictionary#how-to-use-fields-and-expansions)的指南。
 

<div id="metrics">
  #### 指标
</div>

X API v2 端点允许你直接从返回的对象中请求指标，前提是你在请求中传递了适当的[字段](/zh/x-api/fundamentals/fields)。

与帖子指标相关存在一些限制，你需要了解这些限制，尤其是与用户隐私以及以下响应字段相关的限制：

* tweet.fields.non&#95;public&#95;metrics
* tweet.fields.promoted&#95;metrics
* tweet.fields.organic&#95;metrics
* media.fields.non&#95;public&#95;metrics
* media.fields.promoted&#95;metrics
* media.fields.organic&#95;metrics

上述字段包含私密指标数据，这意味着在使用最近搜索端点时，你必须获得帖子发布者的授权，才能代表他们检索这些数据，也就是说，你必须使用 [OAuth 1.0a 用户上下文](/zh/resources/fundamentals/authentication)。由于此身份验证方法只能用于最近搜索端点，因此你无法通过完整存档搜索端点检索这些指标。

例如，为了获取用户 ID 1234 的帖子对应的 `non_public_metrics`，你需要在请求中包含与该用户关联的访问令牌。你可以通过使用[三方 OAuth 流程](/zh/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow)，让用户授权你的应用，并获取与他们关联的一组访问令牌。

所有 `non_public_metrics`、`organic_metrics` 和 promoted&#95;metrics 仅适用于在过去 30 天内创建的帖子。这意味着，当你请求上述字段时，结果会自动调整为只包含过去 30 天内的帖子。

如果请求了上述这些字段，则只会返回由已认证用户创作的帖子，所有其他帖子都会返回错误消息。
 

<div id="building-search-queries">
  #### 构建搜索查询
</div>

这些端点的核心特性在于，它们使用单个搜索查询来筛选返回给你的帖子。查询由一组运算符构成，这些运算符会匹配帖子和用户的属性，例如消息关键词、话题标签和 URL。可以使用布尔逻辑和括号将运算符组合成查询，从而进一步细化查询的匹配行为。

你可以查看我们的指南[如何构建查询](/zh/x-api/posts/search/integrate/build-a-query)以了解更多信息。

<div id="pagination">
  #### 分页
</div>

这些端点使用分页机制，以便更快返回响应。当结果数量多于单个响应可包含的上限时（最近搜索最多返回 100 条帖子，完整归档搜索最多返回 500 条），你就需要使用分页。使用 `max_results` 参数指定每页返回的结果数，并使用 `pagination_token` 参数获取下一页的结果。你可以通过查看我们的[分页指南](/zh/x-api/fundamentals/pagination)了解更多信息。

<div id="post-caps">
  #### 帖子上限
</div>

Search Posts 端点在指定月份内可返回的帖子数量是有限制的，与分页无关。

无论你使用哪个搜索端点，返回的帖子都会计入项目级别的[帖子上限](/zh/x-api/fundamentals/post-cap)。使用量会显示在开发者门户中，“月份”从你在[开发者门户仪表板](https://developer.x.com/en/portal/dashboard)中显示的订阅续费日开始计算。

**帖子编辑**

符合编辑条件的帖子可以在原始帖子发布后的 30 分钟内最多编辑五次。搜索端点将始终提供该帖子的最新版本。如果你只请求发布于 30 分钟之前的帖子，你将始终收到该帖子的最终版本。然而，如果你的用例是近实时的，并且正在查询过去 30 分钟内发布的帖子，那么这些帖子在你收到之后仍有可能被编辑。你可以通过搜索或 Post Lookup 端点重新获取这些帖子，以确认它们的最终状态。要进一步了解帖子编辑的工作方式，请参阅[帖子编辑基础](/zh/x-api/fundamentals/edit-posts)页面。  

**后续步骤**

[向 Search Posts 端点发出你的第一个请求](/zh/x-api/posts/search/quickstart/recent-search)

[在我们的 API 参考文档页面中查看完整的参数、字段等列表](/zh/x-api/posts/recent-search)

[获取支持或排查错误](https://developer.x.com/en/support/x-api)