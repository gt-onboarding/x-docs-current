---
title: v1 到 v2
sidebarTitle: v1 到 v2
keywords: ["v1.1 到 v2 迁移", "用户查询迁移", "迁移用户查询", "标准版到 v2 用户查询", "v1 到 v2 用户查询", "迁移指南"]
---

import { Button } from '/snippets/zh/button.mdx';

<div id="standard-v11-compared-to-x-api-v2">
  ### 标准 v1.1 与 X API v2 的对比
</div>

如果你一直在使用标准 v1.1 的 GET users/show 和 GET users/lookup，本指南旨在帮助你了解标准版与 X API v2 用户查找端点之间的相似之处和差异。

* **相似之处**
  * OAuth 1.0a 用户上下文
  * 每个请求可包含的用户数量限制
* **差异**
  * 端点 URL
  * 应用和项目要求
  * 响应数据格式
  * 请求参数

<div id="similarities">
  #### 相似之处
</div>

**OAuth 1.0a 用户上下文身份验证方法**

标准端点支持 [OAuth 1.0a 用户上下文](/zh/resources/fundamentals/authentication#oauth-1-0a-2)，而新的 X API v2 用户查找端点同时支持 OAuth 1.0a 用户上下文和 [仅应用（App only）](/zh/resources/fundamentals/authentication#oauth-2-0) 身份验证。因此，如果你之前使用的是某个标准 v1.1 用户查找端点，那么在迁移到 X API v2 版本时，可以继续使用相同的身份验证方法。 

根据你所使用的身份验证库/包，仅应用（App only）身份验证通常是最容易上手的方式，并且只需通过一个简单的请求头即可完成设置。要了解如何生成仅应用访问令牌（App only Access Token），请参阅[本仅应用指南](/zh/resources/fundamentals/authentication#bearer-token-also-known-as-app-only)。 

**每个请求的用户数量限制**

标准 v1.1 GET users/lookup 端点允许你在每个请求中最多指定 100 个用户。GET /users 和 GET /users/by 端点也是如此。要指定完整的 100 个用户，你需要将 ids（GET /users）参数或 username（GET /users/by）参数作为查询参数传递，并在其中以逗号分隔列表的形式包含用户 ID/用户名列表。 
 

<div id="differences">
  #### 差异
</div>

**Endpoint URL**

* 标准 v1.1 endpoint：
  * https://api.x.com/1.1/users/show（单个 ID 或用户名查询）
  * https://api.x.com/1.1/users/lookup（多个 ID 或用户名查询）
* X API v2 endpoint：
  * https://api.x.com/2/users（多个 ID 查询）
  * https://api.x.com/2/users/:id（单个 ID 查询）
  * https://api.x.com/2/users/by（多个用户名查询）
  * https://api.x.com/2/users/by/username/:username（单个用户名查询）

**应用和项目要求**

在对请求进行认证时，X API v2 endpoint 要求你使用来自与某个[项目](/zh/resources/fundamentals/projects)关联的[开发者应用](/zh/resources/fundamentals/developer-apps)的凭证。所有 X API v1.1 endpoint 都可以使用独立应用或与项目关联的应用中的凭证。 

**响应数据格式**

标准 v1.1 与 X API v2 版本 endpoint 之间最大的差异之一，是你如何选择在负载中返回哪些字段。

对于标准 endpoint，你会默认收到许多响应字段，然后可以再通过参数来指定应该在负载中返回哪些字段或字段集。

X API v2 版本默认只返回 user `id`、`name` 和 `username` 字段。若要请求任何其他字段或对象，你需要使用 [fields](/zh/x-api/fundamentals/fields) 和 [expansions](/zh/x-api/fundamentals/expansions) 参数。你从该 endpoint 请求的任何 user 字段都会返回在主 user 对象中。任何通过扩展得到的帖子对象及其字段都会返回在响应中的 includes 对象里。然后，你可以通过匹配 user 对象和扩展帖子对象中出现的 ID，将这些扩展对象与 user 对象对应起来。 

我们建议你在各自的指南中进一步了解这些新参数，或阅读我们的[如何使用 fields 和 expansions](/zh/x-api/fundamentals/data-dictionary#how-to-use-fields-and-expansions) 指南。 

我们还整理了一份[数据格式迁移指南](/zh/x-api/migrate/data-format-migration#migrating-from-standard-v1-1s-data-format-to-v2)，帮助你将标准 v1.1 字段映射到新的 v2 字段。该指南还会提供你在 v2 请求中需要传入的具体 `expansions` 和 `fields` 参数，以返回特定字段。 
 

除了你请求某些字段的方式发生变化之外，X API v2 还为 API 返回的对象（包括 [Post](/zh/x-api/fundamentals/data-dictionary#tweet) 和 [user](/zh/x-api/fundamentals/data-dictionary#user) 对象）引入了新的 JSON 设计。

* 在 JSON 根级别，标准 endpoint 会在 `statuses` 数组中返回帖子对象，而 X API v2 会在 `data` 数组中返回。 
* X API v2 JSON 不再引用被转发（Retweeted）和被引用（Quoted）的 “statuses”，而是引用被转发和被引用的帖子。许多传统和已弃用的字段（例如 `contributors` 和 `user.translator_type`）会被移除。 
* X API v2 不再在帖子对象中使用 `favorites` 字段、在 user 对象中使用 `favourites` 字段，而是统一使用 `like`。 
* X 采用的约定是：JSON 值为空（例如为 `null`）时，不会写入负载。只有在帖子和 user 属性具有非 null 值时，这些属性才会被包含。 
   

我们还为 [Post 对象](/zh/x-api/fundamentals/data-dictionary#tweet) 引入了一组新的字段，包括以下内容：

* 一个 [conversation&#95;id](/zh/x-api/fundamentals/conversation-id) 字段
* 两个新的 [annotations](/zh/x-api/fundamentals/post-annotations) 字段，包括 `context` 和 `entities`
* 多个新的 [metrics](/zh/x-api/fundamentals/metrics) 字段 
* 一个新的 `reply_setting` 字段，用于显示谁可以回复某条帖子

**请求参数**

以下标准 v1.1 请求参数在 X API v2 中有对应的等价参数：

|     |     |
| :--- | :--- |
| **Standard** | **X API v2** |
| user&#95;id | ids |
| screen&#95;name | username |

此外，还有一组标准的 users 查找请求参数在 X API v2 中**不**支持：

| 标准 | 说明 |
| :--- | :--- |
| include&#95;entities | 此参数用于从帖子负载中移除 entities 节点。它已被基于 fields 和 expansions 的增量字段机制所取代。 |