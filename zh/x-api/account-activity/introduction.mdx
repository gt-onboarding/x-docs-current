---
keywords: ["Account Activity API", "AAA", "webhooks", "账户事件", "用户活动", "实时事件", "活动订阅", "webhook 事件"]
---

<div id="v2-account-activity-api">
  # V2 Account Activity API
</div>

<Note>
  Account Activity API v2 现已在 [**Pro**](https://developer.x.com/en/portal/products) 产品中开放使用！
</Note>

<div id="overview">
  ## 概述
</div>

Account Activity API（AAA）通过 webhooks 提供了一种接收与 X 用户账号相关的实时事件的方式。通过将特定用户账号订阅到一个预先配置好的 webhook，你的应用可以通过单一连接，从一个或多个你拥有或已订阅的账号中，接收到诸如帖子、私信、点赞、关注、屏蔽等各种活动通知。\
此 API 通常用于构建需要对用户操作即时响应，或基于用户活动维护最新状态的应用。对于你在 webhook 注册中订阅的每个用户账号，你都会在此 webhook 上收到其下列所有相关活动：

<div id="activity-types">
  ## 活动类型
</div>

* **帖子**（由用户发布）
* **帖子删除**（由用户执行）
* **@提及**（提及该用户）
* **回复**（发给用户或来自用户）
* **转发**（由用户转发或转发用户的帖子）
* **引用帖子**（由用户发布或引用用户的帖子）
* **引用帖子的转发**（由用户转发或转发用户的引用帖子）
* **点赞**（由用户点赞或点赞用户的帖子）
* **关注**（由用户关注或关注用户）
* **取消关注**（由用户取消关注或他人取消关注该用户）
* **拉黑**（由用户拉黑或拉黑人用户）
* **取消拉黑**（由用户取消拉黑或他人取消拉黑该用户）
* **静音**（由用户静音或静音用户）
* **取消静音**（由用户取消静音或他人取消对该用户的静音）
* **发送的私信**（由用户发送）
* **收到的私信**（由用户接收）
* **正在输入状态指示**（发给用户）
* **已读回执**（发给用户）
* **撤销订阅**（由用户执行）

**注意**：我们不会通过 Account Activity API 提供主页时间线数据。请使用 User Posts timeline by User ID 端点来获取这些数据。

<div id="feature-summary">
  ## 功能概览
</div>

| 级别 | 价格 | 唯一订阅数 | Webhook 数量 |
| :----- | :----- | :----- | :----- |
| Pro | $5000/月 | 3 | 1 |
| Enterprise | [联系销售](/zh/enterprise/forms/enterprise-api-interest) | 5000+ | 5+ |

本文档重点介绍如何使用 v2 Account Activity API 的端点来管理与你的 webhooks 关联的用户订阅。

<div id="manage-subscriptions">
  ## 管理订阅
</div>

Account Activity API 会在与订阅了你服务的 X 账号相关的事件发生时，通过 webhook 向你发送 JSON 格式的消息。X 会将这些活动推送到你注册的 webhook。通过以下步骤，你将了解如何为用户账号设置和管理订阅。

<Warning>
  Account Activity API v2 目前不支持 User Auth 2.0。我们正在解决这一问题，并会在支持 OAuth 2.0 时更新我们的文档。
</Warning>

<div id="1-create-an-x-app">
  ### 1. 创建 X 应用
</div>

使用已获批准的开发者账号，通过[开发者门户](https://developer.x.com/en/portal/products/enterprise)创建一个 X 应用。若是代表公司创建，请使用公司的 X 账号。

* 在应用页面的“权限”（Permissions）选项卡中启用“读取、写入和访问私信”。
* 在 &quot;Keys and Access Tokens&quot; 选项卡中，记下你应用的 **Consumer Key (API Key)**、**Consumer Token (API Secret)** 和 **Bearer Token**。
* 生成你应用的 **Access Token** 和 **Access Token Secret**。订阅用户账号时需要用到这些。
* 如果你不熟悉 X 登录和用户上下文，请查看 [Obtaining Access Tokens](https://developer.x.com/en/docs/authentication)。
* 从开发者门户中的 &quot;Apps&quot; 页面记下你应用的数值型 id。在申请 Account Activity API 访问权限时需要提供该 id。

<div id="2-get-account-activity-api-access">
  ### 2. 获取 Account Activity API 访问权限
</div>

Account Activity API 仅在 Enterprise 级别中提供。请通过 [开发者门户](https://developer.x.com/en/portal/products/enterprise) 提交申请以获取 Enterprise 访问权限。

<div id="3-register-a-webhook">
  ### 3. 注册 Webhook
</div>

要接收 Account Activity 事件，你必须注册一个具有公开可访问 HTTPS URL 的 webhook。有关开发 webhook 消费者应用程序、注册 webhook、对其进行安全配置以及处理 Challenge-Response Checks (CRC) 的详细信息，请参阅 V2 Webhooks API 文档。

* 确保你的 webhook 被配置为处理带有 JSON 编码的事件负载的 POST 请求。
* 从 webhook 注册响应中获取 **webhook&#95;id**，因为管理订阅时需要使用它。

<div id="4-validate-setup">
  ### 4. 验证设置
</div>

要验证你的应用和 webhook 是否配置正确：

* 为你的 webhook 订阅一个用户账户（参见下文 “Adding a Subscription”）。
* 让该用户为你的应用已订阅的某个 X 账号发布的一条帖子点收藏（favorite）。
* 你应该会通过发送到你的 webhook URL 的 POST 请求收到一个 `favorite_events` 负载。
* **注意**：在添加订阅后，事件开始被投递可能需要长达 10 秒钟。

<div id="important-notes">
  ### 重要说明
</div>

* **认证**：在为用户订阅时，使用该用户帐户的 consumer key、consumer secret、access token 和 access token secret。
* **私信（Direct Messages）**：所有收发的私信（通过 POST /2/dm&#95;conversations/with/:participant&#95;id/messages 发送）都会通过 webhook 投递，以便让你的应用了解所有私信相关活动。
* **事件重复**：
  * 如果两个已订阅用户在同一个私信会话中，你的 webhook 会接收到重复事件（每个用户一条）。请使用 for&#95;user&#95;id 字段进行区分。
  * 如果多个应用共享同一个 webhook URL 和用户，事件会被多次发送（每个应用一次）。
  * 你的应用应使用事件 ID 对事件进行去重，以处理偶发的重复事件。
* **示例代码**：有关展示 webhook 事件的 Web 应用程序示例，请参见 [Account Activity API Setup](https://github.com/xdevplatform/account-activity-dashboard-enterprise/tree/master)。

<div id="managing-subscribed-users-v2-api">
  ## 管理已订阅用户（v2 API）
</div>

在你拥有一个已注册且具有有效 webhook&#95;id 的 webhook 之后，你可以管理用户的订阅，以接收他们的账户活动。使用以下端点来添加、查看或移除订阅。

<div id="adding-a-subscription">
  ### [添加订阅](https://docs.x.com/x-api/account-activity/subscribes-the-provided-application-to-all-events-for-the-provided-user-context-for-all-message-types)
</div>

**Endpoint**: POST /2/account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all
**Description**: 将正在进行身份验证的用户订阅到指定的 webhook，以便接收事件。
**Authentication**: OAuthUser（需要三方 OAuth 流程，代表要订阅的用户）。

* **Consumer Key**: 例如，xvz1evFS...
* **Access Token**: 例如，370773112-GmHxMAgYyLbN...

**Path Parameters**:

| Parameter      | Description            |
| :------------- | :--------------------- |
| webhook&#95;id | 要将订阅关联到的 webhook 的 ID。 |

**Request**:
bash

```
curl --request POST --url 'https://api.twitter.com/2/account_activity/webhooks/:WEBHOOK_ID/subscriptions/all' \
--header 'authorization: OAuth oauth_consumer_key="<CONSUMER_KEY>", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="<ACCESS_TOKEN>", oauth_version="1.0"'
```

**响应**：

* **成功（200 OK）**：
* JSON

```
{
  "data": {
    "subscribed": true
  }
}
```

* **失败（400 Bad Request）**：

| 原因                          | 说明                               |
| :-------------------------- | :------------------------------- |
| WebhookIdInvalid            | 提供的 webhook&#95;id 未找到，或未与该应用关联。 |
| DuplicateSubscriptionFailed | 针对该用户和指定 webhook&#95;id 的订阅已存在。  |
| SubscriptionLimitExceeded   | 该应用在所有 webhook 上的订阅数量已达到上限。      |

###

<div id="checking-a-subscription">
  ### [检查订阅](https://docs.x.com/x-api/account-activity/check-if-a-subscription-exists-for-a-given-webhook-and-user)
</div>

**Endpoint**: GET /2/account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all
**Description**: 检查当前进行身份验证的用户是否已订阅指定的 webhook。
**Authentication**: OAuthUser（需要三方 OAuth 流程）。
**Path Parameters**:

| 参数             | 说明                 |
| :------------- | :----------------- |
| webhook&#95;id | 要检查的 webhook 的 id。 |

**Request**:
bash

```
curl --request GET --url 'https://api.twitter.com/2/account_activity/webhooks/:WEBHOOK_ID/subscriptions/all' \
--header 'authorization: OAuth oauth_consumer_key="<CONSUMER_KEY>", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="<ACCESS_TOKEN>", oauth_version="1.0"'
```

**响应**:

* **成功 (200 OK)**:
* JSON

```
{
  "data": {
    "subscribed": true // 或 false
  }
}
```

* **失败（400 Bad Request）**:

| 原因               | 说明                               |
| :--------------- | :------------------------------- |
| WebhookIdInvalid | 所提供的 webhook&#95;id 未找到或未与该应用关联。 |

###

<div id="removing-subscriptions">
  ### [Removing Subscriptions](https://docs.x.com/x-api/account-activity/deactivates-a-subscription-for-the-specified-webhook-and-user-id)
</div>

**接口**：DELETE /2/account&#95;activity/webhooks/:webhook&#95;id/subscriptions/:user&#95;id/all
**描述**：停用特定用户 ID 的订阅，停止向该 webhook 投递事件。
**认证方式**：OAuth2 应用仅限（App only）Bearer Token。

* **Bearer Token**：例如，AAAAAAAAAAAA0%2EUifi76ZC9Ub0wn...

**路径参数**：

| 参数             | 说明                   |
| :------------- | :------------------- |
| webhook&#95;id | 包含该订阅的 webhook 的 ID。 |
| user&#95;id    | 要取消订阅的用户的数值 ID。      |

**请求**:
bash

```
curl --request DELETE --url 'https://api.twitter.com/2/account_activity/webhooks/:WEBHOOK_ID/subscriptions/:USER_ID/all' \
--header 'authorization: Bearer <BEARER_TOKEN>'
```

**响应**：

* **成功 (200 OK)**：
* JSON

```
{
  "data": {
    "subscribed": false
  }
}
```

* **失败（400 错误请求）**：

| 原因                   | 描述                                               |
| :------------------- | :----------------------------------------------- |
| SubscriptionNotFound | 在给定的 webhook&#95;id 上不存在针对指定 user&#95;id 的订阅。    |
| WebhookIdInvalid     | 未找到提供的 webhook&#95;id，或该 webhook&#95;id 未与该应用关联。 |

<div id="viewing-all-subscriptions">
  ### [查看所有订阅](https://docs.x.com/x-api/account-activity/get-a-list-of-the-current-all-activity-type-subscriptions-for-the-specified-webhook)
</div>

**端点**: GET /2/account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all/list
**描述**: 获取当前订阅指定 webhook 的所有用户 ID 列表。
**认证方式**: OAuth2 应用级（App-only）Bearer Token。
**路径参数**:

| 参数             | 描述                     |
| :------------- | :--------------------- |
| webhook&#95;id | 用于列出其订阅的 webhook 的 ID。 |

**请求**:
bash

```
curl --request GET --url 'https://api.twitter.com/2/account_activity/webhooks/:WEBHOOK_ID/subscriptions/all/list' \
--header 'authorization: Bearer <BEARER_TOKEN>'
```

**响应**:

* **成功 (200 OK)**:
* json

```
{
  "data": {
    "application_id": "<your app id>",
    "webhook_id": "<webhook id>",
    "webhook_url": "<the webhook's callback url>",
    "subscriptions": [
      { "user_id": "<user_id_1>" },
      { "user_id": "<user_id_2>" }
    ]
  }
}
```

* **失败（400 Bad Request）**:

| 原因               | 说明                                |
| :--------------- | :-------------------------------- |
| WebhookIdInvalid | 提供的 webhook&#95;id 无法找到，或未与该应用关联。 |

###

<div id="subscriptions-count">
  ### [Subscriptions Count](https://docs.x.com/x-api/account-activity/get-a-count-of-subscriptions-that-are-currently-active-on-your-account)
</div>

**Endpoint**: GET /2/account&#95;activity/subscriptions/count
**Description**: 返回当前活动订阅的总数，以及为当前认证应用预配置的上限。
**Authentication**: OAuth2 应用专用 Bearer Token。
**Request**:
bash

```
curl --request GET --url 'https://api.twitter.com/2/account_activity/subscriptions/count' \
--header 'authorization: Bearer <BEARER_TOKEN>'
```

**响应**：

* **成功（200 OK）**：
* json

```
{
  "data": {
    "account_name": "<your application name>",
    "provisioned_count": "<subscription limit allocated>",
    "subscriptions_count_all": "<current active subscription count>",
    "subscriptions_count_direct_messages": "0" // 不再支持仅私信订阅
  }
}
```

<div id="replay">
  ## [重放](https://docs.x.com/x-api/account-activity/request-activity-replay)
</div>

AAAv2 提供重放功能，你可以在指定的时间范围内检索历史事件，并将其重新投递到你的 webhook。这对于在停机期间恢复遗漏的事件非常有用。

**Endpoint**: POST /2/account&#95;activity/replay/webhooks/:webhook&#95;id/subscriptions/all

**Description**: 启动一个重放任务

**Authentication**: OAuth2 App Only Bearer Token

**Path Parameters**:

| Parameter      | Description         |
| :------------- | :------------------ |
| webhook&#95;id | 要开始重放的 webhook 的 ID |

**Query Parameters**:

| Parameter     | Description                                                                                                                                                            |
| :------------ | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| from&#95;date | 要提供事件的最早（起始）UTC 时间戳，必须为 “yyyymmddhhmm” 格式。时间戳粒度为分钟，且为包含端点（例如，12:00 包含第 0 分钟）。有效时间必须在过去 24 小时内（UTC），且必须早于当前时间点至少 31 分钟。建议 from&#95;date 和 to&#95;date 之间的间隔控制在约 2 小时以内。 |
| to&#95;date   | 要提供事件的最晚（结束）UTC 时间戳，必须为 “yyyymmddhhmm” 格式。时间戳粒度为分钟，且为不包含端点（例如，12:30 不包含该小时的第 30 分钟）。有效时间必须在过去 24 小时内（UTC），且必须早于当前时间点至少 10 分钟。                                          |

**Responses**:

Success:

```
200

{
  "for_user_id": "<USER_ID>"
  "replay_event": {
    "job_id": <REPLAY_JOB_ID>",
    "created_at: "yyyy-mm-ddThh:mm:ss.000Z"
  }
}
```

Failures:

| Reason              | Description                         |
| :------------------ | :---------------------------------- |
| QueryParamInvalid   | from&#95;date 早于当前时间 24 小时以上。       |
| QueryParamInvalid   | from&#95;date 晚于 to&#95;date。       |
| QueryParamInvalid   | from&#95;date 是未来时间。                |
| QueryParamInvalid   | to&#95;date 是未来时间。                  |
| QueryParamInvalid   | from&#95;date 或 to&#95;date 的格式不正确。 |
| CrcValidationFailed | 在 CRC 验证期间从 webhook URL 收到的响应不正确。   |
| ReplayConflictError | 指定的 webhook 已有重放作业在进行中。             |
| WebhookIdInvalid    | 提供的 webhook&#95;id 无效或未与该应用关联。      |

<div id="job-completed-messages">
  ### 任务完成消息
</div>

当你的重放任务成功完成后，X 会发送以下任务完成事件。一旦你收到该事件，说明任务已运行结束，可以提交下一个任务。

```
{
  "replay_job_status": {
    "webhook_id": "<WEBHOOK_ID>",
    "job_state": "Complete",
    "job_state_description": "Job completed successfully",
    "job_id": "<JOB_ID>"
  }
}
```

如果你的作业未能成功完成，我们会返回以下消息，提示你重试该 Replay 作业。收到此事件后，表示该作业已运行结束，你可以提交另一个作业。

```
{
  "replay_job_status": {
    "webhook_id": "<WEBHOOK_ID>",
    "job_state": "Incomplete",
    "job_state_description": "作业未能传递所有事件,请重试您的重放作业",
    "job_id": "<JOB_ID>"
  }
}
```

<div id="account-activity-data-object-structure">
  ## 账户活动数据对象结构
</div>

| 对象 | 详情 |
| :----- | :----- |
| for&#95;user&#95;id | 标识与该事件相关的用户订阅。 |
| is&#95;blocked&#95;by | （条件字段）仅在帖子提及事件中显示，当提及方用户被订阅用户屏蔽时。 |
| source | 执行该活动的用户（例如发起关注、屏蔽或静音操作的用户）。 |
| target | 活动所作用到的用户（例如被关注、被屏蔽或被静音的用户）。 |

<div id="available-activities">
  ### 可用活动
</div>

| 消息类型 | 详细信息 |
| :----- | :----- |
| tweet&#95;create&#95;events | 帖子、转发、回复、@提及、引用帖子或对引用帖子的转发等的发布事件。 |
| favorite&#95;events | 包含用户和目标的点赞事件。 |
| follow&#95;events | 包含用户和目标的关注事件。 |
| unfollow&#95;events | 包含用户和目标的取消关注事件。 |
| block&#95;events | 包含用户和目标的屏蔽事件。 |
| unblock&#95;events | 包含用户和目标的取消屏蔽事件。 |
| mute&#95;events | 包含用户和目标的静音事件。 |
| unmute&#95;events | 包含用户和目标的取消静音事件。 |
| user&#95;event | 当用户移除应用授权时触发的授权撤销事件（订阅会自动删除）。 |
| direct&#95;message&#95;events | 已发送或已接收消息的 DM 事件。 |
| direct&#95;message&#95;indicate&#95;typing&#95;events | 包含用户和目标的 DM 正在输入事件。 |
| direct&#95;message&#95;mark&#95;read&#95;events | 包含用户和目标的 DM 已读事件。 |
| tweet&#95;delete&#95;events | 为合规性提供的帖子删除通知。 |
| spaces&#95;events | 当前尚不支持。即将推出。 |

<div id="payload-examples">
  ## 负载示例
</div>

以下是每种 Account Activity 事件的负载示例。

<div id="tweet_create_events-posts-retweets-replies-quotetweets">
  ### tweet&#95;create&#95;events（帖子、转推、回复、引用帖子）
</div>

```json
{
  "for_user_id": "2244994945",
  "tweet_create_events": [
    {
      <Tweet Object>
    }
  ]
}
```

###

<div id="tweet_create_events-mentions">
  ### tweet&#95;create&#95;events（@提及）
</div>

```json
{
  "for_user_id": "2244994945",
  "user_has_blocked": "false",
  "tweet_create_events": [
    {
      <Tweet Object>
    }
  ]
}
```

<div id="favorite_events">
  ### favorite&#95;events
</div>

```json
{
  "for_user_id": "2244994945",
  "favorite_events": [{
    "id": "a7ba59eab0bfcba386f7acedac279542",
    "created_at": "Mon Mar 26 16:33:26 +0000 2018",
    "timestamp_ms": 1522082006140,
    "favorited_status": {
      <Tweet Object>
    },
    "user": {
      <User Object>
    }
  }]
}
```

<div id="follow_events">
  ### follow&#95;events
</div>

```json
{
  "for_user_id": "2244994945",
  "follow_events": [{
    "type": "follow",
    "created_timestamp": "1517588749178",
    "target": {
      <User Object>
    },
    "source": {
      <User Object>
    }
  }]
}
```

<div id="unfollow_events">
  ### unfollow&#95;events
</div>

```json
{
  "for_user_id": "2244994945",
  "follow_events": [{
    "type": "unfollow",
    "created_timestamp": "1517588749178",
    "target": {
      <User Object>
    },
    "source": {
      <User Object>
    }
  }]
}
```

<div id="block_events">
  ### block&#95;events
</div>

```json
{
  "for_user_id": "2244994945",
  "block_events": [{
    "type": "block",
    "created_timestamp": "1518127020304",
    "source": {
      <User Object>
    },
    "target": {
      <User Object>
    }
  }]
}
```

<div id="unblock_events">
  ### unblock&#95;events
</div>

```json
{
  "for_user_id": "2244994945",
  "block_events": [{
    "type": "unblock",
    "created_timestamp": "1518127020304",
    "source": {
      <User Object>
    },
    "target": {
      <User Object>
    }
  }]
}
```

<div id="mute_events">
  ### mute&#95;events
</div>

```json
{
  "for_user_id": "2244994945",
  "mute_events": [
    {
      "type": "mute",
      "created_timestamp": "1518127020304",
      "source": {
        <User Object>
      },
      "target": {
        <User Object>
      }
    }
  ]
}
```

<div id="unmute_events">
  ### unmute&#95;events
</div>

```json
{
  "for_user_id": "2244994945",
  "mute_events": [
    {
      "type": "unmute",
      "created_timestamp": "1518127020304",
      "source": {
        <User Object>
      },
      "target": {
        <User Object>
      }
    }
  ]
}
```

<div id="user_event">
  ### user&#95;event
</div>

```json
{
  "user_event": {
    "revoke": {
      "date_time": "2018-05-24T09:48:12+00:00",
      "target": {
        "app_id": "13090192"
      },
      "source": {
        "user_id": "63046977"
      }
    }
  }
}
```

<div id="direct_message_events">
  ### direct&#95;message&#95;events
</div>

```json
{
  "for_user_id": "4337869213",
  "direct_message_events": [{
    "type": "message_create",
    "id": "954491830116155396",
    "created_timestamp": "1516403560557",
    "message_create": {
      "target": {
        "recipient_id": "4337869213"
      },
      "sender_id": "3001969357",
      "source_app_id": "13090192",
      "message_data": {
        "text": "Hello World!",
        "entities": {
          "hashtags": [],
          "symbols": [],
          "user_mentions": [],
          "urls": []
        }
      }
    }
  }],
  "apps": {
    "13090192": {
      "id": "13090192",
      "name": "FuriousCamperTestApp1",
      "url": "https://x.com/furiouscamper"
    }
  },
  "users": {
    "3001969357": {
      "id": "3001969357",
      "created_timestamp": "1422556069340",
      "name": "Jordan Brinks",
      "screen_name": "furiouscamper",
      "location": "Boulder, CO",
      "description": "另一个自我 - X PE 观点仅代表个人",
      "url": "https://t.co/SnxaA15ZuY",
      "protected": false,
      "verified": false,
      "followers_count": 22,
      "friends_count": 45,
      "statuses_count": 494,
      "profile_image_url_https": "https://pbs.twimg.com/profile_images/851526626785480705/cW4WTi7C_normal.jpg"
    },
    "4337869213": {
      "id": "4337869213",
      "created_timestamp": "1448312972328",
      "name": "Harrison Test",
      "screen_name": "Harris_0ff",
      "location": "Burlington, MA",
      "protected": false,
      "verified": false,
      "followers_count": 8,
      "friends_count": 8,
      "statuses_count": 240,
      "profile_image_url_https": "https://abs.twimg.com/sticky/default_profile_images/default_profile_normal.png"
    }
  }
}
```

<div id="direct_message_indicate_typing_events">
  ### direct&#95;message&#95;indicate&#95;typing&#95;events
</div>

```json
{
  "for_user_id": "4337869213",
  "direct_message_indicate_typing_events": [{
    "created_timestamp": "1518127183443",
    "sender_id": "3284025577",
    "target": {
      "recipient_id": "3001969357"
    }
  }],
  "users": {
    "3001969357": {
      "id": "3001969357",
      "created_timestamp": "1422556069340",
      "name": "Jordan Brinks",
      "screen_name": "furiouscamper",
      "location": "Boulder, CO",
      "description": "Alter Ego - X PE opinions-are-my-own",
      "url": "https://t.co/SnxaA15ZuY",
      "protected": false,
      "verified": false,
      "followers_count": 23,
      "friends_count": 47,
      "statuses_count": 509,
      "profile_image_url_https": "https://pbs.twimg.com/profile_images/851526626785480705/cW4WTi7C_normal.jpg"
    },
    "3284025577": {
      "id": "3284025577",
      "created_timestamp": "1437281176085",
      "name": "Bogus Bogart",
      "screen_name": "bogusbogart",
      "protected": true,
      "verified": false,
      "followers_count": 1,
      "friends_count": 4,
      "statuses_count": 35,
      "profile_image_url_https": "https://pbs.twimg.com/profile_images/763383202857779200/ndvZ96mE_normal.jpg"
    }
  }
}
```

<div id="direct_message_mark_read_events">
  ### direct&#95;message&#95;mark&#95;read&#95;events
</div>

```json
{
  "for_user_id": "4337869213",
  "direct_message_mark_read_events": [{
    "created_timestamp": "1518452444662",
    "sender_id": "199566737",
    "target": {
      "recipient_id": "3001969357"
    },
    "last_read_event_id": "963085315333238788"
  }],
  "users": {
    "199566737": {
      "id": "199566737",
      "created_timestamp": "1286429788000",
      "name": "Le Braat",
      "screen_name": "LeBraat",
      "location": "Denver, CO",
      "description": "data by day @X, design by dusk",
      "protected": false,
      "verified": false,
      "followers_count": 299,
      "friends_count": 336,
      "statuses_count": 752,
      "profile_image_url_https": "https://pbs.twimg.com/profile_images/936652894371119105/YHEozVAg_normal.jpg"
    },
    "3001969357": {
      "id": "3001969357",
      "created_timestamp": "1422556069340",
      "name": "Jordan Brinks",
      "screen_name": "furiouscamper",
      "location": "Boulder, CO",
      "description": "Alter Ego - X PE opinions-are-my-own",
      "url": "https://t.co/SnxaA15ZuY",
      "protected": false,
      "verified": false,
      "followers_count": 23,
      "friends_count": 48,
      "statuses_count": 510,
      "profile_image_url_https": "https://pbs.twimg.com/profile_images/851526626785480705/cW4WTi7C_normal.jpg"
    }
  }
}
```

<div id="tweet_delete_events">
  ### tweet&#95;delete&#95;events
</div>

```json
{
  "for_user_id": "930524282358325248",
  "tweet_delete_events": [
    {
      "status": {
        "id": "1045405559317569537",
        "user_id": "930524282358325248"
      },
      "timestamp_ms": "1432228155593"
    }
  ]
}
```

<div id="support-for-longform-posts">
  ## 对长格式帖子的支持
</div>

V2 Account Activity API 现已支持 **长格式**帖子，即长度超过 280 个字符的帖子。当长格式帖子包含在 tweet&#95;create&#95;events 负载中时，`text` 字段仅包含前 140 个字符（或更少），并且 `truncated` 字段会被设置为 true。帖子的完整内容会在 `extended_tweet` 对象中提供，其中包括：

* full&#95;text: 帖子的完整文本，包括所有超出 280 字符限制的内容。
* entities: 出现在完整文本中的任意实体（例如 hashtags、URL、用户提及、符号），包括出现在第 280 个字符之后的实体。
* display&#95;text&#95;range: 用于显示的字符范围，基于完整文本计算。

这样可以确保应用能够处理长格式帖子的全部内容，包括出现在文本后部的提及或其他实体。下面是一个长格式帖子的 tweet&#95;create&#95;events 负载示例：

```json
{
  "for_user_id": "1603419180975409153",
  "tweet_create_events": [
    {
      "created_at": "Mon May 19 14:01:46 +0000 2025",
      "id": 1924465506158879000,
      "id_str": "1924465506158878979",
      "text": "The Antikythera Mechanism: A Window into Ancient Ingenuity Discovered in 1901 among the wreckage of a Roman ship of… https://t.co/bzbEKj8cd8",
      "display_text_range": [
        0,
        140
      ],
      ...
      "user": {
        ...
      },
      ...
      "extended_tweet": {
        "full_text": "安提基特拉机械:古代智慧的窗口 1901年在希腊安提基特拉岛附近一艘罗马沉船的残骸中发现,安提基特拉机械常被誉为世界上第一台模拟计算机。这个精密的青铜装置可追溯到公元前100年左右,以其精巧的设计和神秘的用途吸引了历史学家、考古学家和科学家。该机械由一个复杂的齿轮系统组成,精心制作以执行在当时仍然令人惊讶地先进的计算。它的发现挑战了人们长期以来对古代世界技术能力的假设。安提基特拉机械的主要功能似乎是天文学的。它可以预测太阳、月亮以及可能的行星的位置,追踪月食和日食,甚至计算奥林匹克运动会的日期。该装置的刻度盘和指针,加上古希腊文的铭文,表明它既是科学探究的工具,也是文化活动的工具。其精确度可与19世纪的钟表制造相媲美,凸显了其创造者(可能来自希腊化世界)的非凡智慧。尽管经过数十年的研究,许多问题仍然存在。是谁建造的,为谁建造?它是一件独特的杰作,还是历史上失传的更广泛机械装置传统的一部分?X射线成像和现代计算技术揭示了其内部运作的许多信息,但其功能的全部范围仍有争议。有人认为它用于占星预测,而另一些人则认为它是天文学家的教学工具。安提基特拉机械是人类好奇心和创新精神的见证,连接了古代和现代世界。它提醒我们,即使在古代,人们也试图用与当今技术复杂性相媲美的工具来理解宇宙。它持久的神秘感继续激发敬畏和探索,使其成为有史以来出土的最非凡的文物之一。\n@xai\n@HistoryInPics",
        "display_text_range": [
          0,
          2051
        ],
        "entities": {
          "hashtags": [],
          "urls": [],
          "user_mentions": [
            {
              "screen_name": "xai",
              "name": "xAI",
              "id": 1661523610111193000,
              "id_str": "1661523610111193088",
              "indices": [
                2032,
                2036
              ]
            },
            {
              "screen_name": "HistoryInPics",
              "name": "History Photographed",
              "id": 1582853809,
              "id_str": "1582853809",
              "indices": [
                2037,
                2051
              ]
            }
          ],
          "symbols": []
        }
      },
      ...
      "entities": {
        "hashtags": [],
        "urls": [
          {
            "url": "https://t.co/bzbEKj8cd8",
            "expanded_url": "https://twitter.com/i/web/status/1924465506158878979",
            "display_url": "twitter.com/i/web/status/1…",
            "indices": [
              117,
              140
            ]
          }
        ],
        "user_mentions": [],
        "symbols": []
      },
      ...
    }
  ]
}
```

<div id="account-activity-api-migrating-from-legacy-enterprise-to-v2">
  ## 从旧版 Enterprise Account Activity API 迁移到 v2
</div>

请参阅[迁移指南](https://docs.x.com/x-api/account-activity/migrate/overview)！

<div id="frequently-asked-questions">
  ## 常见问题解答
</div>

**使用 Account Activity API 有哪些优势？**

Account Activity API 使用 webhooks，无需保持开放连接（不同于流式 API）或频繁轮询（不同于 REST API），即可实时传递数据。其优势包括：

* **速度**：以 X 的速度传递数据。
* **简单性**：通过单个 webhook 连接提供所有账户事件，包括帖子、@ 提及、回复、转帖、引用帖子、点赞、DM、关注、拉黑和静音。
* **可扩展性**：在 Enterprise 级别下，为托管账户支持所有活动，没有速率限制或事件上限。

**我需要为 Account Activity API 准备开发、预发布和生产环境，这可以实现吗？**

可以！您可以注册多个 webhook URL，并通过 [V2 Webhooks API](https://docs.x.com/x-api/webhooks/introduction) 分别管理订阅。

**是否有关于如何设置 Account Activity API 的分步指南？**

有！请参阅 [Webhooks 入门指南](https://docs.x.com/x-api/webhooks/introduction) 和 [Account Activity API 示例应用](https://github.com/m-rosinsky/XWebhookTest/blob/main/app.py)。

**使用 Account Activity API 时必须使用哪种身份验证方式？**

身份验证要求是按端点指定的。详细信息请查看 [身份验证部分](https://developer.x.com/en/docs/authentication)。

**如果我为彼此交互的用户创建了订阅，会不会收到重复的活动？**

会。如果您的应用为用户 A 和用户 B 创建了订阅，并且用户 A 在帖子中提及了用户 B，您的 webhook 会接收两个事件（每个用户一个）。请使用 `for_user_id` 字段来识别对应的订阅。

**当我为我的 webhook 创建订阅时，能否将端点中的** /all/ **部分替换为其他账户活动数据对象，以限制传递的活动类型？**

不能。/all/ 产品是唯一选项，会传递所有受支持的事件类型。

**如果我有三个 webhook 配额，能否为每个已注册的 Enterprise 应用分别使用三个 webhook？**

webhook 数量限制是按账户设置的，而不是按应用设置的。比如，在有三个 webhook 和两个应用的情况下，您可以为一个应用使用两个 webhook、为另一个应用使用一个，但不能为每个应用都使用三个。

<div id="account-activity-api-reference-index">
  ## Account Activity API 参考索引
</div>

| 目的 | V2 端点 |
| :----- | :----- |
| 将应用订阅到某个账户的事件 | POST /2/account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all |
| 返回当前活动订阅的数量 | GET /2/account&#95;activity/subscriptions/count |
| 检查某个 webhook 是否已订阅某个账户 | GET /2/account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all |
| 返回当前活动订阅列表 | GET /2/account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all/list |
| 使用仅应用 OAuth 停用订阅 | DELETE /2/account&#95;activity/webhooks/:webhook&#95;id/subscriptions/:user&#95;id/all |
| 创建回放作业 | POST /2/account&#95;activity/replay/webhooks/:webhook&#95;id/subscriptions/all |

有关 webhook 管理端点（注册、查看、验证、删除），请参阅 [V2 Webhooks API 文档](https://docs.x.com/x-api/webhooks/introduction)