---
title: 快速入门
sidebarTitle: 快速入门
keywords: ["activity API quickstart", "X Activity API quickstart", "activity quickstart", "activity tutorial", "activity guide"]
---

本指南介绍如何使用 X Activity API 端点订阅并接收事件。通常需要 3 个步骤：

1. 确定你要筛选其事件的用户的 User ID
2. 为该用户创建你想要筛选的事件类型的订阅
3. 通过 webhook 或持久 HTTP 流式连接接收事件

<div id="getting-user-ids">
  ## 获取用户 ID
</div>

在创建订阅之前，你需要先知道要作为过滤对象的那个账号的用户 ID。在本示例中，我们将使用 XDevelopers 这个 handle。你可以通过几种方式查询用户 ID，包括：

**通过用户名查询用户的 ID：**

```bash
curl -H "Authorization: Bearer YOUR_BEARER_TOKEN" "https://api.x.com/2/users/by/username/xdevelopers"
```

**获取你的用户 id：**

```bash
curl -H "Authorization: Bearer YOUR_BEARER_TOKEN" https://api.x.com/2/users/me
```

这两个端点都会返回用户信息，包括 `id` 字段，你可以在订阅过滤条件中使用该字段。示例 JSON 响应如下所示：

```json
{
    "data": {
        "id": "2244994945",
        "name": "Developers",
        "username": "XDevelopers"
    }
}
```


<div id="creating-a-subscription">
  ## 创建订阅
</div>

下一步是创建一个订阅。在这个示例中，我们将订阅 X Developers 的个人简介更新。为此，我们会在 JSON 请求体中传入 `user_id` 和 `event_type`。在本例中，`event_type` 为 `ProfileBioUpdate`。

我们将传入 X Developers 的用户 ID：`2244994945`，以及一个可选标签：

```json
{
  "event_type": "ProfileBioUpdate",
  "filter": {
    "user_id": "2244994945"
  },
  "tag": "Xdevelopers' bio updates"
}
```

我们将使用在开发者门户中获取的 [Bearer Token](https://docs.x.com/fundamentals/authentication/oauth-2-0/overview#bearer-token-also-known-as-app-only)，对所有与 XAA 相关的端点进行授权：

```bash
curl -H "Authorization: Bearer YOUR_BEARER_TOKEN" \
  https://api.x.com/2/activity/subscriptions \
  -X POST \
  -d '{
    "event_type": "ProfileBioUpdate",
    "filter": {
      "user_id": "2244994945"
    },
    "tag": "Xdevelopers' bio updates"
  }'
```

请求成功后，将创建你的订阅：

```json
{
  "data":[
    {
      "created_at":"2025-10-09T16:35:08.000Z",
      "event_type":"ProfileBioUpdate",
      "filter":{
        "user_id":"2244994945"
      },
      "subscription_id":"1976325569252868096",
      "tag": "Xdevelopers 的简介更新",
      "updated_at":"2025-10-09T16:35:08.000Z"
    }
  ],
  "meta": {
    "total_subscriptions": 1
  }
}
```


<div id="getting-the-events">
  ## 获取事件
</div>

创建订阅之后，我们可以通过 [webhooks](https://docs.x.com/x-api/webhooks/introduction) 或持久 HTTP 流来接收事件。在本示例中，我们将建立持久 HTTP 流连接：

```bash
curl -H "Authorization: Bearer YOUR_BEARER_TOKEN" https://api.x.com/2/activity/stream
```

当 X 开发者账户更新其个人简介时，该事件将通过流发送：

```json
{
  "data": {
    "filter": {
      "user_id": "2244994945"
    },
    "event_type": "ProfileBioUpdate",
    "tag": "Xdevelopers 的个人简介更新",
    "payload": {
      "before": "Mars & Cars",
      "after": "Mars, Cars & AI"
    }
  }
}
```


<div id="subscription-management">
  ## 订阅管理
</div>

X Activity API 提供了一组端点，可通过标准的 CRUD 操作管理订阅。

<div id="create-subscription">
  ### 创建订阅
</div>

创建新的订阅以接收事件：

```bash
curl -H "Authorization: Bearer YOUR_BEARER_TOKEN" \
  -X POST \
  https://api.x.com/2/activity/subscriptions \
  -d '{
    "event_type": "ProfileBioUpdate",
    "filter": {
      "user_id": "123456789"
    },
    "tag": "my bio updates",
    "webhook_id": "1976325569252868099"
  }'
```

**注意：**

* `tag` 字段是可选的。可用于在投递时标识事件。
* `webhook_id` 字段也是可选的。请参阅我们的 [webhook 文档](https://docs.x.com/x-api/webhooks/introduction) 了解如何设置 webhook。如果指定了 `webhook_id`，在流处于打开状态时，事件会在发送到该流的同时，也被投递到指定的 webhook。

**响应：**

```json
{
  "data": {
    "subscription_id": "1976325569252868096",
    "event_type": "ProfileBioUpdate",
    "filter": {
      "user_id": "123456789"
    },
    "created_at": "2025-10-09T16:35:08.000Z",
    "updated_at": "2025-10-09T16:35:08.000Z",
    "tag": "my bio updates",
    "webhook_id": "1976325569252868099"
  }
}
```


<div id="list-subscriptions">
  ### 列出订阅
</div>

获取您应用的所有有效订阅：

```bash
curl -H "Authorization: Bearer YOUR_BEARER_TOKEN" \
  https://api.x.com/2/activity/subscriptions
```

**响应：**

```json
{
  "data": [
    {
      "subscription_id": "1976325569252868096",
      "event_type": "ProfileBioUpdate",
      "filter": {
        "user_id": "123456789"
      },
      "created_at": "2025-10-09T16:35:08.000Z",
      "updated_at": "2025-10-10T03:50:59.000Z",
    },
    {
      "subscription_id": "1976325569252868097",
      "event_type": "ProfilePictureUpdate",
      "filter": {
        "user_id": "987654321"
      },
      "created_at": "2025-10-08T14:35:08.000Z",
      "updated_at": "2025-10-08T14:35:08.000Z",
    }
  ],
  "meta": {
    "total_subscriptions": 2
  }
}
```


<div id="delete-subscription">
  ### 删除订阅
</div>

移除订阅：

```bash
curl -H "Authorization: Bearer YOUR_BEARER_TOKEN" \
  -X DELETE \
  https://api.x.com/2/activity/subscriptions/1976325569252868096
```

**响应：**

```json
{
  "data": {
    "deleted": true
  },
  "meta": {
    "total_subscriptions": 0
  }
}
```

`total_subscriptions` 表示删除操作执行后与你的应用关联的剩余订阅数量。


<div id="update-subscription">
  ### 更新订阅
</div>

该 PUT 端点允许你更新订阅的投递方式或标签。

更新 `filter` 或 `event_type` 字段时，需要先删除现有订阅，然后再创建一个新的订阅。

```
curl -H "Authorization: Bearer YOUR_BEARER_TOKEN" \
  -X PUT \
  https://api.x.com/2/activity/subscriptions/1976325569252868096 \
  -d '{
    "tag": "my new tag",
    "webhook_id": "192846273860294839"
  }'
```

**响应：**

```json
{
  "data": {
    "subscription_id": "1976325569252868096",
    "event_type": "ProfileBioUpdate",
    "filter": {
      "user_id": "123456789"
    },
    "created_at": "2025-10-09T16:35:08.000Z",
    "updated_at": "2025-10-10T17:10:58.000Z",
    "tag": "my new tag",
    "webhook_id": "192846273860294839"
  },
  "meta": {
    "total_subscriptions": 1
  }
}
```
