---
title: 快速入门
sidebarTitle: 快速入门
keywords: ["activity API 快速入门", "X Activity API 快速入门", "activity 快速入门", "activity 教程", "activity 指南"]
---

本指南说明如何使用 X Activity API 端点来订阅并接收事件。一般分为 3 个步骤：

1. 确定你想要筛选其事件的用户的 User ID
2. 为该用户创建你想要筛选的事件类型的订阅
3. 使用 Webhook 或持久 HTTP 流式连接接收事件

<div id="getting-user-ids">
  ## 获取用户 ID
</div>

在创建订阅之前，你需要先知道你想要作为过滤条件的账号的用户 ID。此示例中，我们将使用 XDevelopers 账号。你可以通过几种方式查询用户 ID，包括：

**通过用户名查询用户的 ID：**

```bash
curl -H "Authorization: Bearer YOUR_BEARER_TOKEN" "https://api.x.com/2/users/by/username/xdevelopers"
```

**获取你的用户 id：**

```bash
curl -H "Authorization: Bearer YOUR_BEARER_TOKEN" https://api.x.com/2/users/me
```

这两个端点都会返回用户信息，包括 `id` 字段，你可以在订阅过滤条件中使用该字段。下面是一个示例 JSON 响应：

```json
{
    "data": {
        "id": "2244994945",
        "name": "Developers",
        "username": "XDevelopers"
    }
}
```


<div id="creating-a-subscription">
  ## 创建订阅
</div>

下一步是创建一个订阅。在本示例中，我们将订阅 XDevelopers 账号的个人简介更新。为此，我们会在 JSON 请求体中传入 `user_id` 和 `event_type`。在这个例子中，`event_type` 为 `ProfileBioUpdate`。

我们将传入 XDevelopers 的用户 id：`2244994945`，以及一个可选的标签：

```json
{
  "event_type": "ProfileBioUpdate",
  "filter": {
    "user_id": "2244994945"
  },
  "tag": "Xdevelopers' bio updates"
}
```

我们将使用来自开发者门户的 [Bearer Token](https://docs.x.com/fundamentals/authentication/oauth-2-0/overview#bearer-token-also-known-as-app-only)，来对所有与 XAA 相关的端点进行授权：

```bash
curl -H "Authorization: Bearer YOUR_BEARER_TOKEN" \
  https://api.x.com/2/activity/subscriptions \
  -X POST \
  -d '{
    "event_type": "ProfileBioUpdate",
    "filter": {
      "user_id": "2244994945"
    },
    "tag": "Xdevelopers' bio updates"
  }'
```

请求成功后，将创建订阅：

```json
{
  "data":[
    {
      "created_at":"2025-10-09T16:35:08.000Z",
      "event_type":"ProfileBioUpdate",
      "filter":{
        "user_id":"2244994945"
      },
      "subscription_id":"1976325569252868096",
      "tag": "Xdevelopers 的简介更新",
      "updated_at":"2025-10-09T16:35:08.000Z"
    }
  ],
  "meta": {
    "total_subscriptions": 1
  }
}
```


<div id="getting-the-events">
  ## 获取事件
</div>

创建订阅后，我们可以通过 [webhooks](https://docs.x.com/x-api/webhooks/introduction) 或持久 HTTP 流来接收事件。在本示例中，我们将打开一个持久 HTTP 流：

```bash
curl -H "Authorization: Bearer YOUR_BEARER_TOKEN" https://api.x.com/2/activity/stream
```

当 X 开发者账号更新其个人简介时，该事件将通过流进行推送：

```json
{
  "data": {
    "filter": {
      "user_id": "2244994945"
    },
    "event_type": "ProfileBioUpdate",
    "tag": "Xdevelopers 的个人简介更新",
    "payload": {
      "before": "Mars & Cars",
      "after": "Mars, Cars & AI"
    }
  }
}
```


<div id="subscription-management">
  ## 订阅管理
</div>

X Activity API 提供接口，可通过标准的 CRUD 操作来管理订阅。

<div id="create-subscription">
  ### 创建订阅
</div>

创建一个新的订阅用于接收事件：

```bash
curl -H "Authorization: Bearer YOUR_BEARER_TOKEN" \
  -X POST \
  https://api.x.com/2/activity/subscriptions \
  -d '{
    "event_type": "ProfileBioUpdate",
    "filter": {
      "user_id": "123456789"
    },
    "tag": "my bio updates",
    "webhook_id": "1976325569252868099"
  }'
```

**注意：**

* `tag` 字段是可选的。可用于在投递时标识事件。
* `webhook_id` 字段同样是可选的。有关设置 webhook 的帮助，请参阅我们的 [webhook 文档](https://docs.x.com/x-api/webhooks/introduction)。如果指定了 `webhook_id`，在流处于打开状态时，事件除了会投递到提供的 webhook，还会投递到该流。

**响应：**

```json
{
  "data": {
    "subscription_id": "1976325569252868096",
    "event_type": "ProfileBioUpdate",
    "filter": {
      "user_id": "123456789"
    },
    "created_at": "2025-10-09T16:35:08.000Z",
    "updated_at": "2025-10-09T16:35:08.000Z",
    "tag": "my bio updates",
    "webhook_id": "1976325569252868099"
  }
}
```


<div id="list-subscriptions">
  ### 列出订阅
</div>

获取你的应用的所有当前有效订阅：

```bash
curl -H "Authorization: Bearer YOUR_BEARER_TOKEN" \
  https://api.x.com/2/activity/subscriptions
```

**响应：**

```json
{
  "data": [
    {
      "subscription_id": "1976325569252868096",
      "event_type": "ProfileBioUpdate",
      "filter": {
        "user_id": "123456789"
      },
      "created_at": "2025-10-09T16:35:08.000Z",
      "updated_at": "2025-10-10T03:50:59.000Z",
    },
    {
      "subscription_id": "1976325569252868097",
      "event_type": "ProfilePictureUpdate",
      "filter": {
        "user_id": "987654321"
      },
      "created_at": "2025-10-08T14:35:08.000Z",
      "updated_at": "2025-10-08T14:35:08.000Z",
    }
  ],
  "meta": {
    "total_subscriptions": 2
  }
}
```


<div id="delete-subscription">
  ### 删除订阅
</div>

删除订阅：

```bash
curl -H "Authorization: Bearer YOUR_BEARER_TOKEN" \
  -X DELETE \
  https://api.x.com/2/activity/subscriptions/1976325569252868096
```

**响应：**

```json
{
  "data": {
    "deleted": true
  },
  "meta": {
    "total_subscriptions": 0
  }
}
```

`total_subscriptions` 显示删除操作完成后与你的应用关联的剩余订阅数。


<div id="update-subscription">
  ### 更新订阅
</div>

该 PUT 端点允许你更新订阅的交付方式或标签。

更新 `filter` 或 `event_type` 时，需要先删除现有订阅，然后再创建一个新的订阅。

```
curl -H "Authorization: Bearer YOUR_BEARER_TOKEN" \
  -X PUT \
  https://api.x.com/2/activity/subscriptions/1976325569252868096 \
  -d '{
    "tag": "my new tag",
    "webhook_id": "192846273860294839"
  }'
```

**响应：**

```json
{
  "data": {
    "subscription_id": "1976325569252868096",
    "event_type": "ProfileBioUpdate",
    "filter": {
      "user_id": "123456789"
    },
    "created_at": "2025-10-09T16:35:08.000Z",
    "updated_at": "2025-10-10T17:10:58.000Z",
    "tag": "my new tag",
    "webhook_id": "192846273860294839"
  },
  "meta": {
    "total_subscriptions": 1
  }
}
```
