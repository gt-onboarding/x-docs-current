---
title: 一致性
keywords: ["一致性", "API 一致性", "统一的 API", "一致的端点", "API 设计", "端点一致性"]
---

<div id="consistency-across-the-x-api-v2-endpoints">
  ## X API v2 各个 endpoint 之间的一致性
</div>

全新的 X API v2 的一个主要方面，是在各个 endpoint 之间保持一致性。这意味着在相似的 endpoint 间，返回的对象、功能以及 API 的行为都是统一的。

你可以期望所有 endpoint 在以下元素上保持一致：

<div id="path-naming">
  ### 路径命名
</div>

路径命名始终包含端点的[版本](/zh/x-api/fundamentals/versioning)，后面跟着**资源**。除此之外，路径可以包含与前面资源相关的 **ID**，用于帮助确定要返回哪些数据的**选择动词**（例如 `search` 或 `sample`）、用于帮助确定数据将如何传递的**传输动词**（例如 `stream`），或者与主要资源存在**关系**的其他资源（例如 `/user/12/tweets`）。最后，如果端点包含任何查询参数，你可以在末尾追加**查询参数**。

下面是这些路径和查询项的组织方式示例：

`/version/resource/id?param1=value&param2=value /version/resource/delivery/selection?param1=value&param2=value`

实际请求示例：

`/2/tweets/1067094924124872705?expansions=attachments.media_keys&tweet.fields=author_id /2/users/2244994945?user.fields=created_at,description /2/tweets/search/stream /2/tweets/search/recent?query=snow`

<div id="json-schema">
  ### JSON Schema
</div>

请求的响应是使用 [JSON Schema](http://json-schema.org/) 定义的。这意味着请求会始终以数组的形式返回一组对象，并且每个元素都有一个 id。请求不会返回以 id 作为键的映射（map）。

<div id="response-object-and-parameters">
  ### 响应对象和参数
</div>

默认返回的对象在此对象类型的每个端点中都是相同的：

* `id` 始终为字符串。
* 参数和响应字段始终使用美式英语拼写。
* 如果没有值，字段将为空或不返回。
* `entities` 对象只包含从帖子文本中提取的实体：包括 `urls`、`hashtags`、`mentions` 和 `cashtags`。
* 所有与 cards 相关的信息（包括 `media_keys` 和 `poll_ids` 字段）都在 `attachments` 对象中返回。

下面是一个来自[单条帖子查询](/zh/x-api/posts/post-lookup-by-post-id) 端点的响应对象示例（将 [tweet.fields](/zh/x-api/fundamentals/data-dictionary#tweet) 参数设置为 `author_id`、`entities`）：

```json
{
   "data": {
       "id": "1278747501642657792",
       "text": "自 Twitter 开发者实验室推出以来已经一年了。\n\n在我们构建下一代 #TwitterAPI（即将推出）的过程中，看看我们一路上学到和改变的东西。https://t.co/WvjuEWCa6G",
       "author_id": "2244994945",
       "entities": {
           "urls": [
               {
                   "start": 188,
                   "end": 211,
                   "url": "https://t.co/WvjuEWCa6G",
                   "expanded_url": "https://blog.x.com/developer/en_us/topics/tools/2020/a-year-with-twitter-developer-labs.html",
                   "display_url": "blog.x.com/developer/en_u…",
                   "images": [
                       {
                           "url": "https://pbs.twimg.com/news_img/1278747527043362816/7HQRkQeV?format=jpg&name=orig",
                           "width": 1600,
                           "height": 600
                       },
                       {
                           "url": "https://pbs.twimg.com/news_img/1278747527043362816/7HQRkQeV?format=jpg&name=150x150",
                           "width": 150,
                           "height": 150
                       }
                   ],
                   "status": 200,
                   "title": "A year with Twitter Developer Labs: What we've learned and changed",
                   "description": "Labs has been invaluable in helping us understand what works well and what doesn’t, what you liked and what you didn’t.",
                   "unwound_url": "https://blog.x.com/developer/en_us/topics/tools/2020/a-year-with-twitter-developer-labs.html"
               }
           ],
           "hashtags": [
               {
                   "start": 106,
                   "end": 117,
                   "tag": "TwitterAPI"
               }
           ]
       }
   }
}
```

<div id="authentication">
  ### 身份验证
</div>

所有 X API v2 端点都需要身份验证。许多端点接受 [OAuth 2.0 Bearer Token](/zh/resources/fundamentals/authentication#oauth-2-0) 方法，你需要在请求中向端点提供 Bearer Token 才能成功发起请求。

对于那些需要授权才能代表其他用户创建、操作或检索数据的端点，请使用 [OAuth 1.0a 用户上下文](/zh/resources/fundamentals/authentication)。这意味着你需要提供你的[开发者应用](/zh/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow)的 [API 密钥和令牌](/zh/resources/fundamentals/authentication#api-key-and-secret)，以及一组用户 [访问令牌](/zh/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow)，这些访问令牌由你为要代表其发起请求的用户生成。[三方 OAuth 流程](/zh/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow) 可以帮助你获取访问令牌。请使用能够自动构建此授权请求头的[工具或库](/zh/x-api/tools-and-libraries/overview)。

有关身份验证的更多信息，请参阅我们的[身份验证](/zh/resources/fundamentals/authentication)文档。

***

<div id="fields">
  ### 字段
</div>

每个端点返回的对象都是简化过的。为了让开发者能够对从 API 返回的响应进行更多自定义，可以使用 [`fields`](/zh/x-api/fundamentals/fields) 参数来请求所需的字段。字段在各个端点之间保持一致。无论在哪个返回 Post 对象的端点中，Post 对象都会返回相同的字段。同一组字段也可以在相似的端点中进行查询。

例如，相同的 Post 字段既可以在 [Posts lookup](/zh/x-api/posts/lookup/introduction) 中查询，也可以在 [Users lookup](/zh/x-api/users/lookup/introduction) 中用于展开的置顶 Post。

***

<div id="expansions">
  ### 扩展字段
</div>

在适用的情况下，[expansions](/zh/x-api/fundamentals/expansions) 可用于所有嵌套的 id 字段（例如所有名为 `*_id` 的字段，如 `author_id`）。对于所有包含 id 且该 id 不是当前对象顶级标识符的字段，也可以使用扩展字段。举例来说，在 [Posts 查询](/zh/x-api/posts/lookup/introduction) 中，Post 是当前对象，其字段 `id` 为顶级标识符。通过将这些以逗号分隔的值添加到 `expansions` 参数中，可以将 `author_id` 或 `referenced_tweets.id` 字段扩展为完整的用户或 Post 对象。

如果你发现与这些字段相关的任何不一致之处，请[提交问题反馈](https://twitterdevfeedback.uservoice.com/)。