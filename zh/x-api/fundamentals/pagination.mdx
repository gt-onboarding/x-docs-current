---
title: 分页
keywords: ["分页", "分页令牌", "next token", "previous token", "分页浏览结果", "分页处理", "游标分页", "pagination token"]
---

<div id="introduction">
  ## 介绍
</div>

分页是 X API v2 端点中的一项功能，当需要返回的结果数量超过单个响应可以承载的上限时就会用到。此时，数据会以一系列“页面”的形式返回。分页指的是通过编程方式请求所有这些页面，以获取完整的结果数据集。并非所有 API 端点都支持或需要分页，但在结果集较大时通常会使用分页。

<div id="use-cases-for-pagination">
  ### 分页的使用场景
</div>

**检索某个请求的全部结果：** 应使用分页来获取与特定请求及其参数相关的所有数据。当匹配结果数量多于该请求允许的 `max_results` 时，就需要使用分页。通过在循环请求中使用分页令牌，可以检索所有结果。当返回的响应中不再包含 `next_token` 值时，可以认为所有结果都已通过分页获取完毕。分页不应用于轮询。如果你想获取上次请求之后的最新结果，请查看使用 `since_id` 进行轮询的方式。

**在请求结果中向前或向后遍历：** 分页提供了方向控制选项，可以使用响应中的 `next_token` 和 `previous_token` 值在请求结果中导航。可以将这些令牌设置为后续请求中的 `pagination_token`，以跳转到下一页或上一页的结果。

<div id="pagination-token-definitions">
  ### 分页令牌定义
</div>

* `next_token` - 在支持分页的端点中，在 meta 对象的响应中返回的不透明字符串。表示还有更多可用结果，并且可以在下一次请求中作为 `pagination_token` 参数使用，以返回下一页结果。最后一页结果将不会包含 `next_token`。
  * `previous_token` - 在支持分页的端点中，在 meta 对象的响应中返回的不透明字符串。表示存在上一页可用结果，并且可以在下一次请求中将其设置为 `pagination_token` 参数，以返回上一页结果。
  * `pagination_token` - 在分页请求中使用的参数。将其设置为 `next_token` 的值以获取下一页结果，设置为 `previous_token` 的值以获取上一页结果。

<div id="fundamentals-of-pagination">
  ### 分页基础
</div>

* 使用分页的端点在初始请求时会返回第一页的结果，并在 JSON 响应中的 meta 对象内提供一个 `next_token`（如果还有更多结果页可用）。若要获取所有结果，请重复此过程，直到响应中不再包含 `next_token`。
  * 结果按时间逆序返回。这在单个页面内以及跨多个页面都成立：
    * 第一份响应中的第一个帖子是最新的。
    * 最后一份响应中的最后一个帖子是最早的。
  * `max_results` 请求参数允许你配置每个响应页面返回的帖子数量。`max_results` 存在默认值和最大值。
  * 任何分页实现都需要从响应负载中解析令牌，这些令牌可用于后续请求。
  * 在某些情况下，每页返回的结果可能少于 `max_results`。不要假定每页结果数总是等于 `max_results` 参数值。
  * 使用循环逻辑编写集成代码，或使用支持 X API v2 的[库](/zh/x-api/tools-and-libraries/overview)，是利用分页获取完整结果的最佳方式。

<div id="pagination-example">
  ### 分页示例
</div>

在本示例中，一共有三页结果，因为 `max_results` 设置为 `100`，并且在 2019 年 1 月 1 日 17:00:00 UTC 至 12 月 12 日 00:00:00 UTC 之间，用户 ID `2244994945`（@XDevelopers）大约创建了 295 条帖子。第一页上的第一条帖子（`1337498609819021312`）是最新的，第三页结果中的最后一条帖子（`1082718487011885056`）是最早的。

<div id="initial-request">
  #### 初始请求
</div>

```bash
      https://api.x.com/2/users/2244994945/tweets?tweet.fields=created_at&max_results=100&start_time=2019-01-01T17:00:00Z&end_time=2020-12-12T01:00:00Z
```

<div id="sequence-table">
  ### 顺序表
</div>

|                  | **首个请求**                                                                                                                                                                                                                                                                                                                                                                                                                        | **第二页**                                                                                                                                                                                                                                                                                                                                                                                                                                                         | **第三页**                                                                                                                                                                                                                                                                                                                                                                                                     | **第四页**                                                                                                                                                                    |
| :--------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **请求参数**         | * `max_results` = `100`  - `tweet.fields` = `created_at`  - `start_time` = `2019-01-01T17:00:00Z`  - `end_time` = `2020-12-12T01:00:00Z`                                                                                                                                                                                                                                                                                        | - `max_results` = `100`  - `tweet.fields` = `created_at`  - `start_time` = `2019-01-01T17:00:00Z`  - `end_time` = `2020-12-12T01:00:00Z`  - `pagination_token` = `7140w`                                                                                                                                                                                                                                                                                        | * `max_results` = `100`  - `tweet.fields` = `created_at`  - `start_time` = `2019-01-01T17:00:00Z`  - `end_time` = `2020-12-12T01:00:00Z`  - `pagination_token` = `7140k9`                                                                                                                                                                                                                                   | - `max_results` = `100`  - `tweet.fields` = `created_at`  - `start_time` = `2019-01-01T17:00:00Z`  - `end_time` = `2020-12-12T01:00:00Z`  - `pagination_token` = `71408hi` |
| **响应**           | `json { "data": [ { "created_at": "2020-12-11T20:44:52.000Z", "id": "1337498609819021312", "text": "Thanks to everyone who tuned in today..." }, ... , { "created_at": "2020-05-06T17:24:31.000Z", "id": "1258085245091368960", "text": "It’s now easier to understand Tweet impact..." } ], "meta": { "oldest_id": "1258085245091368960", "newest_id": "1337498609819021312", "result_count": 100, "next_token": "7140w" } } ` | `json { "data": [ { "created_at": "2020-04-29T17:01:44.000Z", "id": "1255542797765013504", "text": "Our developer community is full of inspiring ideas..." }, ... , { "created_at": "2019-11-21T16:17:23.000Z", "id": "1197549579035496449", "text": "Soon, we'll be releasing tools in..." } ], "meta": { "oldest_id": "1197549579035496449", "newest_id": "1255542797765013504", "result_count": 100, "next_token": "7140k9", "previous_token": "77qp8" } } ` | `json { "data": [ { "created_at": "2019-11-21T16:17:23.000Z", "id": "1197549578418941952", "text": "我们知道，有些收到大量回复的人可能会……" }, ... , { "created_at": "2019-01-08T19:19:37.000Z", "id": "1082718487011885056", "text": "关于 Grid 嵌入的更新……" } ], "meta": { "oldest_id": "1082718487011885056", "newest_id": "1197549578418941952", "result_count": 95, "next_token": "71408hi", "previous_token": "77qplte" } } ` | `json { "meta": { "result_count": 0, "previous_token": "77qpw8l" } } `                                                                                                     |
| **下一次请求需要执行的操作** | 要获取下一页，请直接从响应中取出 `next_token` 值（`7140w`），并在下一次请求中将其设置为 `pagination_token` 参数。                                                                                                                                                                                                                                                                                                                                                   | 若要继续获取所有结果：直接从响应中获取 `next_token` 值（`7140k9`），并将其设置为下一次请求的 `pagination_token`。若要跳转到上一页：直接从响应中获取 `previous_token` 值（`77qp8`），并将其设置为下一次请求的 `pagination_token`。                                                                                                                                                                                                                                                                                                     | 若要继续获取全部结果：从响应中直接取出 `next_token` 值（`71408hi`），并将其设置为下一次请求的 `pagination_token`。若要返回上一页：从响应中直接取出 `previous_token` 值（`77qplte`），并将其设置为下一次请求的 `pagination_token`。                                                                                                                                                                                                                                               | 请注意，响应中没有 `next_token`，这表示所有结果都已接收完毕。要获取上一页：从响应中直接取出 `previous_token` 的值（`77qpw8l`），并将其设置为下一次请求中的 `pagination_token`。                                                      |