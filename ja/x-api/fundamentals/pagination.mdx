---
title: ページネーション
keywords: ["pagination", "pagination tokens", "next token", "previous token", "page through results", "paging", "cursor pagination", "pagination token"]
---

<div id="introduction">
  ## はじめに
</div>

ページネーションは、1 回のレスポンスで返送できる件数を超える結果を返す X API v2 エンドポイントに用意されている機能です。このような場合、データは一連の「ページ」に分割されて返されます。ページネーションとは、プログラムからすべてのページを順にリクエストし、結果データセット全体を取得するための方法を指します。すべての API エンドポイントがページネーションをサポートしたり必要としたりするわけではありませんが、結果セットが大きい場合によく使用されます。

<div id="use-cases-for-pagination">
  ### ページネーションのユースケース
</div>

**1 件のリクエストで全結果を取得する場合:** 特定のリクエストとパラメータに関連するすべてのデータを受け取るために、ページネーションを使用する必要があります。1 回のリクエストで返せる `max_results` を超える件数の結果が存在する場合、ページネーションは必須です。ページネーション用トークンを使ってリクエストを繰り返すことで、すべての結果を取得できます。レスポンスから `next_token` が返されなくなった場合、すべての結果のページ送りが完了したとみなせます。ページネーションはポーリング目的で使用すべきではありません。前回のリクエスト以降の最新結果を取得するには、`since_id` を使用したポーリング方法を確認してください。

**リクエスト結果を順方向・逆方向にたどる場合:** ページネーションを使うと、レスポンスに含まれる `next_token` と `previous_token` の値を利用して、リクエスト結果の中を前後方向に移動できます。これらのトークンを次のリクエストの `pagination_token` に設定することで、結果の次ページまたは前ページへ移動できます。

<div id="pagination-token-definitions">
  ### ページネーショントークンの定義
</div>

* `next_token` - ページネーションをサポートするエンドポイントで、レスポンスの meta オブジェクト内で返される不透明な文字列です。さらに取得可能な結果が存在することを示し、次のリクエストで `pagination_token` パラメータとして指定することで、次のページの結果を返すことができます。最後のページの結果には `next_token` は含まれません。
  * `previous_token` - ページネーションをサポートするエンドポイントで、レスポンスの meta オブジェクト内で返される不透明な文字列です。前のページの結果が存在することを示し、次のリクエストで `pagination_token` パラメータとして指定することで、前のページの結果を返すことができます。
  * `pagination_token` - ページネーションリクエストで使用されるパラメータです。次のページの結果を取得する場合は `next_token` の値を、前のページの結果を取得する場合は `previous_token` の値を設定します。

<div id="fundamentals-of-pagination">
  ### ページネーションの基本
</div>

* ページネーションを使用するエンドポイントは、最初のリクエストに対して最初のページの結果で応答し、追加の結果ページがある場合は JSON レスポンス内の meta オブジェクトに `next_token` を含めて返します。すべての結果を取得するには、レスポンスに `next_token` が含まれなくなるまでこの処理を繰り返します。
  * 結果は新しいものから古いものへの逆時系列で返されます。これは各ページ内だけでなく、複数ページにまたがっても同様です。
    * 最初のレスポンス内の最初のポストが最も新しいものになります。
    * 最後のレスポンス内の最後のポストが最も古いものになります。
  * `max_results` リクエストパラメータを使用すると、レスポンスの 1 ページあたりに返されるポスト数を設定できます。`max_results` にはデフォルト値と最大値があります。
  * ページネーションを実装する場合は必ず、レスポンスペイロードからトークンをパースし、それを後続のリクエストで使用することが必要になります。
  * 状況によっては、1 ページあたりの結果数が `max_results` より少なくなる場合があります。1 ページあたりの結果数が常に `max_results` パラメータ値と等しいことを前提にしないでください。
  * 完全な結果を取得するためにページネーションを利用する最良の方法は、連携コード内でループロジックを使用するか、X API v2 をサポートする[ライブラリ](/ja/x-api/tools-and-libraries/overview)を使用することです。

<div id="pagination-example">
  ### ページネーションの例
</div>

ここでは、`max_results` が `100` に設定されており、2019 年 1 月 1 日 17:00:00 UTC から 12 月 12 日 00:00:00 UTC までの間にユーザー ID `2244994945` (@XDevelopers) によって作成されたポストが約 295 件あるため、結果は 3 ページになります。1 ページ目の最初のポスト（`1337498609819021312`）が最も新しく、結果の 3 ページ目の最後のポスト（`1082718487011885056`）が最も古いポストです。

<div id="initial-request">
  #### 初回リクエスト
</div>

```bash
      https://api.x.com/2/users/2244994945/tweets?tweet.fields=created_at&max_results=100&start_time=2019-01-01T17:00:00Z&end_time=2020-12-12T01:00:00Z
```

<div id="sequence-table">
  ### シーケンステーブル
</div>

|                  | **1回目のリクエスト**                                                                                                                                                                                                                                                                                                                                                                                                                   | **2ページ目**                                                                                                                                                                                                                                                                                                                                                                                                                                                       | **3ページ目**                                                                                                                                                                                                                                                                                                                                                                                                                                                              | **4ページ目**                                                                                                                                                                  |
| :--------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **リクエストパラメータ**   | * `max_results` = `100`  - `tweet.fields` = `created_at`  - `start_time` = `2019-01-01T17:00:00Z`  - `end_time` = `2020-12-12T01:00:00Z`                                                                                                                                                                                                                                                                                        | - `max_results` = `100`  - `tweet.fields` = `created_at`  - `start_time` = `2019-01-01T17:00:00Z`  - `end_time` = `2020-12-12T01:00:00Z`  - `pagination_token` = `7140w`                                                                                                                                                                                                                                                                                        | * `max_results` = `100`  - `tweet.fields` = `created_at`  - `start_time` = `2019-01-01T17:00:00Z`  - `end_time` = `2020-12-12T01:00:00Z`  - `pagination_token` = `7140k9`                                                                                                                                                                                                                                                                                              | - `max_results` = `100`  - `tweet.fields` = `created_at`  - `start_time` = `2019-01-01T17:00:00Z`  - `end_time` = `2020-12-12T01:00:00Z`  - `pagination_token` = `71408hi` |
| **レスポンス**        | `json { "data": [ { "created_at": "2020-12-11T20:44:52.000Z", "id": "1337498609819021312", "text": "Thanks to everyone who tuned in today..." }, ... , { "created_at": "2020-05-06T17:24:31.000Z", "id": "1258085245091368960", "text": "It’s now easier to understand Tweet impact..." } ], "meta": { "oldest_id": "1258085245091368960", "newest_id": "1337498609819021312", "result_count": 100, "next_token": "7140w" } } ` | `json { "data": [ { "created_at": "2020-04-29T17:01:44.000Z", "id": "1255542797765013504", "text": "Our developer community is full of inspiring ideas..." }, ... , { "created_at": "2019-11-21T16:17:23.000Z", "id": "1197549579035496449", "text": "Soon, we'll be releasing tools in..." } ], "meta": { "oldest_id": "1197549579035496449", "newest_id": "1255542797765013504", "result_count": 100, "next_token": "7140k9", "previous_token": "77qp8" } } ` | `json { "data": [ { "created_at": "2019-11-21T16:17:23.000Z", "id": "1197549578418941952", "text": "We know that some people who receive a large volume of replies may..." }, ... , { "created_at": "2019-01-08T19:19:37.000Z", "id": "1082718487011885056", "text": "Updates to Grid embeds..." } ], "meta": { "oldest_id": "1082718487011885056", "newest_id": "1197549578418941952", "result_count": 95, "next_token": "71408hi", "previous_token": "77qplte" } } ` | `json { "meta": { "result_count": 0, "previous_token": "77qpw8l" } } `                                                                                                     |
| **次回リクエストで行う操作** | 次のページを取得するには、レスポンスから `next_token` の値（`7140w`）をそのまま取得し、次回のリクエストで `pagination_token` として指定します。                                                                                                                                                                                                                                                                                                                                    | すべての結果を引き続き取得するには、レスポンスから `next_token` の値（`7140k9`）をそのまま使用し、次回のリクエストの `pagination_token` に設定します。  前のページに移動するには、レスポンスから `previous_token` の値（`77qp8`）をそのまま使用し、次回のリクエストの `pagination_token` に設定します。                                                                                                                                                                                                                                                                | すべての結果を取得し続けるには、レスポンスの `next_token` の値（`71408hi`）をそのまま `pagination_token` として次回のリクエストに指定します。前のページに移動するには、レスポンスの `previous_token` の値（`77qplte`）をそのまま `pagination_token` として次回のリクエストに指定します。                                                                                                                                                                                                                                                                              | `next_token` が含まれていないことに注意してください。これは、すべての結果を受信し終えたことを示します。前のページに遡るには、レスポンスから `previous_token` の値（`77qpw8l`）をそのまま取得し、次のリクエスト呼び出しの `pagination_token` として設定します。              |