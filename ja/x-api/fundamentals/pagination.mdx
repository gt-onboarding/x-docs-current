---
title: ページネーション
keywords: ["ページネーション", "ページネーショントークン", "next token", "previous token", "結果をページネーションで取得する", "ページング", "カーソルページネーション", "pagination token"]
---

<div id="introduction">
  ## はじめに
</div>

ページネーションは、1 回のレスポンスで返せる件数を超える結果を返す X API v2 のエンドポイントに用意されている機能です。そのような場合、データは一連の「ページ」に分割されて返されます。ページネーションとは、すべてのページをプログラムから順番にリクエストして、結果データセット全体を取得するための方法を指します。すべての API エンドポイントがページネーションをサポートしたり必要としたりするわけではありませんが、結果セットが大きい場合によく利用されます。

<div id="use-cases-for-pagination">
  ### ページネーションのユースケース
</div>

**リクエストのすべての結果を取得する場合:** ページネーションは、特定のリクエストとそのパラメータに関連するすべての関連データを取得するために使用する必要があります。リクエストに対して一致する結果が `max_results` を上回る場合、ページネーションが必要です。ページネーション用トークンを使ってリクエストを繰り返し実行することで、すべての結果を取得できます。レスポンスが `next_token` を含まずに返ってきた場合、それまでにすべての結果ページを取得し終えていると見なせます。ページネーションはポーリング目的で使用すべきではありません。前回のリクエスト以降の最新結果を取得するには、`since_id` を使ったポーリングについての説明を参照してください。

**リクエスト結果を順にたどる場合:** ページネーションを使用すると、レスポンス内の `next_token` と `previous_token` の値を使って、リクエスト結果を前後に移動しながら確認できます。これらのトークンを次のリクエストで `pagination_token` に指定することで、結果の次ページまたは前ページに移動できます。

<div id="pagination-token-definitions">
  ### ページネーショントークンの定義
</div>

* `next_token` - ページネーションをサポートするエンドポイントで、meta オブジェクトのレスポンス内に返される不透明な文字列です。さらに結果が存在することを示し、次のリクエストで次のページの結果を取得するために `pagination_token` パラメータとして使用できます。最後のページの結果には `next_token` は含まれません。
  * `previous_token` - ページネーションをサポートするエンドポイントで、meta オブジェクトのレスポンス内に返される不透明な文字列です。前のページの結果が存在することを示し、次のリクエストで前のページの結果を取得するために `pagination_token` パラメータとして指定できます。
  * `pagination_token` - ページネーションリクエストで使用されるパラメータです。次のページの結果を取得する場合は `next_token` の値を、前のページの結果を取得する場合は `previous_token` の値を設定します。

<div id="fundamentals-of-pagination">
  ### ページネーションの基本
</div>

* ページネーションを使用するエンドポイントは、最初のリクエストに対して最初のページの結果を返し、追加の結果ページがある場合は JSON レスポンス内の meta オブジェクトに `next_token` を含めて返します。すべての結果を取得するには、レスポンスに `next_token` が含まれなくなるまで、この処理を繰り返します。
  * 結果は新しいものから古いものへと並ぶ降順（逆時系列）で返されます。これは個々のページ内だけでなく、ページをまたいでも同様です。
    * 最初のレスポンス内の最初のポストが、最も新しいものになります。
    * 最後のレスポンス内の最後のポストが、最も古いものになります。
  * リクエストパラメータ `max_results` によって、レスポンス 1 ページあたりに返されるポスト数を設定できます。`max_results` にはデフォルト値と最大値が存在します。
  * すべてのページネーション実装では、レスポンスペイロードからトークンをパースし、それを後続のリクエストで使用する必要があります。
  * 状況によっては、1 ページあたりの結果数が `max_results` 未満になる場合があります。1 ページあたりの結果数が常に `max_results` パラメータ値と等しいことを前提にしないでください。
  * 完全な結果を取得するためにページネーションを利用する最適な方法は、統合コード内でループロジックを使用するか、X API v2 をサポートする[ライブラリ](/ja/x-api/tools-and-libraries/overview)を使用することです。

<div id="pagination-example">
  ### ページネーションの例
</div>

ここでは、`max_results` を `100` に設定しており、2019年1月1日 17:00:00 UTC から12月12日 00:00:00 UTC までの間にユーザー ID `2244994945` (@XDevelopers) によって作成されたポストが約295件あるため、結果は3ページに分かれます。1ページ目の最初のポスト（`1337498609819021312`）が最も新しく、3ページ目の最後のポスト（`1082718487011885056`）が最も古いものです。

<div id="initial-request">
  #### 初回リクエスト
</div>

```bash
      https://api.x.com/2/users/2244994945/tweets?tweet.fields=created_at&max_results=100&start_time=2019-01-01T17:00:00Z&end_time=2020-12-12T01:00:00Z
```

<div id="sequence-table">
  ### シーケンス テーブル
</div>

|                 | **最初のリクエスト**                                                                                                                                                                                                                                                                                                                                                                                                                    | **2ページ目**                                                                                                                                                                                                                                                                                                                                                                                                                                                       | **3ページ目**                                                                                                                                                                                                                                                                                                                                                                                                                                                              | **4 ページ目**                                                                                                                                                                 |
| :-------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **リクエストパラメータ**  | * `max_results` = `100`  - `tweet.fields` = `created_at`  - `start_time` = `2019-01-01T17:00:00Z`  - `end_time` = `2020-12-12T01:00:00Z`                                                                                                                                                                                                                                                                                        | - `max_results` = `100`  - `tweet.fields` = `created_at`  - `start_time` = `2019-01-01T17:00:00Z`  - `end_time` = `2020-12-12T01:00:00Z`  - `pagination_token` = `7140w`                                                                                                                                                                                                                                                                                        | * `max_results` = `100`  - `tweet.fields` = `created_at`  - `start_time` = `2019-01-01T17:00:00Z`  - `end_time` = `2020-12-12T01:00:00Z`  - `pagination_token` = `7140k9`                                                                                                                                                                                                                                                                                              | - `max_results` = `100`  - `tweet.fields` = `created_at`  - `start_time` = `2019-01-01T17:00:00Z`  - `end_time` = `2020-12-12T01:00:00Z`  - `pagination_token` = `71408hi` |
| **レスポンス**       | `json { "data": [ { "created_at": "2020-12-11T20:44:52.000Z", "id": "1337498609819021312", "text": "Thanks to everyone who tuned in today..." }, ... , { "created_at": "2020-05-06T17:24:31.000Z", "id": "1258085245091368960", "text": "It’s now easier to understand Tweet impact..." } ], "meta": { "oldest_id": "1258085245091368960", "newest_id": "1337498609819021312", "result_count": 100, "next_token": "7140w" } } ` | `json { "data": [ { "created_at": "2020-04-29T17:01:44.000Z", "id": "1255542797765013504", "text": "Our developer community is full of inspiring ideas..." }, ... , { "created_at": "2019-11-21T16:17:23.000Z", "id": "1197549579035496449", "text": "Soon, we'll be releasing tools in..." } ], "meta": { "oldest_id": "1197549579035496449", "newest_id": "1255542797765013504", "result_count": 100, "next_token": "7140k9", "previous_token": "77qp8" } } ` | `json { "data": [ { "created_at": "2019-11-21T16:17:23.000Z", "id": "1197549578418941952", "text": "We know that some people who receive a large volume of replies may..." }, ... , { "created_at": "2019-01-08T19:19:37.000Z", "id": "1082718487011885056", "text": "Updates to Grid embeds..." } ], "meta": { "oldest_id": "1082718487011885056", "newest_id": "1197549578418941952", "result_count": 95, "next_token": "71408hi", "previous_token": "77qplte" } } ` | `json { "meta": { "result_count": 0, "previous_token": "77qpw8l" } } `                                                                                                     |
| **次回リクエスト時の操作** | 次のページを取得するには、レスポンスから `next_token` の値（`7140w`）をそのまま取り出し、次回のリクエストの `pagination_token` に設定します。                                                                                                                                                                                                                                                                                                                                     | すべての結果を取得し続けるには、レスポンスから `next_token` の値（`7140k9`）をそのまま取得し、次回のリクエストの `pagination_token` に設定します。 前のページに移動するには、レスポンスから `previous_token` の値（`77qp8`）をそのまま取得し、次回のリクエストの `pagination_token` に設定します。                                                                                                                                                                                                                                                                   | すべての結果を取得し続けるには、レスポンスの `next_token` の値（`71408hi`）をそのまま次のリクエストの `pagination_token` に設定します。 前のページに移動するには、レスポンスの `previous_token` の値（`77qplte`）をそのまま次のリクエストの `pagination_token` に設定します。                                                                                                                                                                                                                                                                                   | `next_token` が存在しないことに注意してください。これは、すべての結果を取得済みであることを示します。前のページに移動するには、レスポンスからそのまま `previous_token` の値（`77qpw8l`）を取得し、それを次回のリクエストの `pagination_token` に設定します。               |