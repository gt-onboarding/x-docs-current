---
title: 概要
sidebarTitle: 概要
keywords: ["検索連携", "検索概要", "検索ガイド", "検索実装", "ポスト検索連携"]
---

<div id="how-to-integrate-with-the-search-posts-endpoints">
  ## Search Posts エンドポイントとの統合方法
</div>

このページでは、recent search エンドポイントや full-archive search エンドポイントをシステムに統合する際に把握しておくべき、いくつかのツールおよび重要な概念について説明します。ページの内容は次のセクションに分かれています。

* [便利なツール](#helpful-tools)
* 重要な概念
  * [認証](#authentication)

  * [developer portal、プロジェクト、アプリ](#developer-portal)

  * [レート制限](#rate-limits)

  * [フィールドと expansions](#fields-expansions)

  * [メトリクス](#metrics)

  * [検索クエリの構築](#queries)

  * [ページネーション](#pagination)

  * [ポスト上限](#tweet-caps) 

  * [ポストの編集](#tweet-edits) 

<div id="helpful-tools">
  ### 便利なツール
</div>

いくつかの重要な概念を見ていく前に、まずはこれらのエンドポイントの動作を試すために、次のいずれかのツールまたはコードサンプルを使用することをおすすめします。

<div id="code-samples">
  #### コードサンプル
</div>

お好みのプログラミング言語でこれらのエンドポイントをコードから利用したい場合のために、いくつかのコードサンプルを用意しています。[GitHub ページ](https://github.com/xdevplatform/Twitter-API-v2-sample-code)で、[Python クライアント](https://github.com/xdevplatform/search-tweets-python) や [Ruby クライアント](https://github.com/xdevplatform/search-tweets-ruby) など、実装の出発点として使えるサンプルを確認できます。

<div id="libraries">
  #### ライブラリ
</div>

多数ある[コミュニティ製サードパーティライブラリ](/ja/x-api/tools-and-libraries/overview)を活用して、スムーズに使い始めましょう。v2 エンドポイントに対応したライブラリは、該当するバージョンタグを確認することで見つけられます。

<div id="postman">
  #### Postman
</div>

Postman は、これらのエンドポイントを試す際に利用できる優れたツールです。各 Postman リクエストには、そのエンドポイントで指定できるすべてのパラメータが含まれており、どのようなオプションがあるかを素早く把握するのに役立ちます。Postman コレクションの詳細については、[Using Postman](/ja/tutorials/postman-getting-started) のページをご覧ください。
 

<div id="key-concepts">
  ### 主要な概念
</div>

<div id="authentication">
  #### 認証
</div>

すべての X API v2 エンドポイントでは、「キーとトークン」とも呼ばれる一連の認証情報を使用してリクエストを認証する必要があります。recent search エンドポイントへのリクエストの認証には、OAuth 1.0a User Context、OAuth 2.0 アプリ専用フロー、または OAuth 2.0 Authorization Code with PKCE のいずれかを使用できます。full archive search エンドポイントを使用する場合は、OAuth 2.0 アプリ専用フローを使用しなければなりません。

[OAuth 2.0 アプリ専用フロー](/ja/resources/fundamentals/authentication#oauth-2-0-authorization-code-flow-with-pkce-3) では、リクエストに [OAuth 2.0 App Access Token](/ja/resources/fundamentals/authentication#bearer-token-also-known-as-app-only) を渡すだけで済みます。App Access Token は、開発者アプリ内から直接生成するか、[POST oauth2/token](/ja/resources/fundamentals/authentication#post-oauth2-token) エンドポイントを使って生成できます。

[OAuth 1.0a User Context](/ja/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow) では、API Keys、ユーザーの Access Tokens、およびいくつかの追加パラメータを使用して[認可ヘッダーを作成](https://developer-staging.x.com/resources/fundamentals/authentication/authorizing-a-request)し、それをリクエストと一緒に送信する必要があります。Access Tokens は、代理でリクエストを送信する対象ユーザーに紐づいている必要があります。別のユーザー用の Access Tokens セットを生成したい場合は、そのユーザーが [3-legged OAuth フロー](https://developer-staging.x.com/resources/fundamentals/authentication/obtaining-user-access-tokens) を使ってあなたのアプリを承認しなければなりません。

OAuth 1.0a の利用は難しい場合がある点に注意してください。この認証方法に慣れていない場合は、[ライブラリ](/ja/x-api/tools-and-libraries/overview) を使用するか、Postman のようなツールを使用するか、OAuth 2.0 を使ってリクエストを認証することをおすすめします。これらのエンドポイントからポストやプライベートメトリクスをリクエストする場合は、OAuth 1.0a User Context か OAuth 2.0 Authorization Code with PKCE のいずれかを使用する必要があります。これにより、そのコンテンツの所有ユーザーから適切な権限を取得していることを保証できます。

[OAuth 2.0 Authorization Code with PKCE](/ja/resources/fundamentals/authentication#oauth-2-0-authorization-code-flow-with-pkce-2) は、アプリケーションのスコープや複数デバイス間にまたがる認可フローを、より細かく制御できるようにします。OAuth 2.0 では、ユーザーに代わって特定の権限を付与する、粒度の細かいスコープを選択できます。

アプリで OAuth 2.0 を有効にするには、developer portal の App 設定セクションにある App の認証設定で有効にする必要があります。

<Note>
  **注意事項**

  次の [fields](/ja/x-api/fundamentals/fields) をリクエストする場合は、OAuth 1.0a User Context または OAuth 2.0 Authorization Code が必要です。

  * tweet.fields.non&#95;public&#95;metrics
  * tweet.fields.promoted&#95;metrics
  * tweet.fields.organic&#95;metrics
  * media.fields.non&#95;public&#95;metrics
  * media.fields.promoted&#95;metrics
  * media.fields.organic&#95;metrics
</Note>

####

Developer Portal、プロジェクト、および開発者アプリ

いずれかの X API v2 エンドポイントを利用するには、[開発者アカウントに登録](https://developer.x.com/en/portal/petition/essential/basic-info)し、そのアカウント内にプロジェクトを作成し、そのプロジェクト内に開発者アプリを作成しておく必要があります。その開発者アプリ内のキーとトークンは、これらの検索エンドポイントで利用できます。

任意の[アクセスレベル](/ja/x-api/getting-started/about-x-api)を持つプロジェクトのキーとトークンを使用して、recent search エンドポイントへのリクエストを送信できます。ただし、full archive search エンドポイントへのリクエストを送信するには、アクセスレベルが Pro または Enterprise のプロジェクトを使用する必要があります。[Enterprise アクセス](/ja/x-api/getting-started/getting-access)がある場合は、追加のオペレーターを利用できるほか、より長いクエリを指定するなどの追加機能にアクセスできます。
 

<div id="rate-limits">
  #### レート制限
</div>

毎日、何千人もの開発者が X API にリクエストを送信しています。リクエスト量を管理するために、各エンドポイントには[レート制限](/ja/x-api/fundamentals/rate-limits)が設けられており、アプリ単位または認証済みユーザー単位で、各開発者が行えるリクエスト数が制限されています。

これらのエンドポイントには、使用する認証方式に応じて異なるレート制限が適用されます。アプリレベルのレート制限は、OAuth 2.0 アプリ専用フローを使用してリクエストを行うアプリに適用されます。一方、ユーザーレベルのレート制限は、OAuth 1.0a User Context または OAuth 2.0 Authorization Code with PKCE を使用し、特定の承認ユーザーに代わって行われるリクエストに適用されます。これら 2 種類のレート制限は、15 分間の時間枠におけるリクエスト頻度に基づいています。

たとえば、OAuth 2.0 アプリ専用フローを使用して recent search エンドポイントにリクエストを行うアプリは、15 分間で 450 件のリクエスト（ページネーションに伴うリクエストを含む）を行うことができます。同じアプリは、同じ 15 分間の時間枠内に、2 人の異なる認証済みユーザー（OAuth 1.0a User Context または OAuth 2.0 Authorization Code with PKCE を使用）ごとに、recent search エンドポイントに対して最大 180 件のリクエスト（ページネーションに伴うリクエストを含む）を行うことができます。
 

<div id="fields-and-expansions">
  #### フィールドと expansions
</div>

X API v2 では、[fields](/ja/x-api/fundamentals/fields) と [expansions](/ja/x-api/fundamentals/expansions) を使用して、API から取得するデータを正確に選択できます。`expansions` パラメーターを使用すると、ペイロード内で参照されているオブジェクトを展開できます。たとえば、このエンドポイントでは、`expansions` パラメーターを使って poll、place、メディアなどのオブジェクトをリクエストできます。

`fields` パラメーターを使用すると、さまざまなデータオブジェクト内のどのフィールドを受け取りたいかを正確に指定できます。デフォルトでは、これらのエンドポイントによって返される主要なポストオブジェクトには、id と text フィールド（この機能が導入されて以降に作成されたポストについては edit&#95;history&#95;tweet&#95;ids も追加で）が含まれます。author&#95;id や public&#95;metrics などの追加フィールドを取得するには、それらを `fields` パラメーターで明示的にリクエストする必要があります。連携での利用を検討すべき重要なフィールドとしては、poll データ、[metrics](/ja/x-api/fundamentals/metrics)、[Post annotations](/ja/x-api/fundamentals/post-annotations)、および [conversation ID](/ja/x-api/fundamentals/conversation-id) フィールドがあります。

[X API v2 data dictionary](/ja/x-api/fundamentals/data-dictionary) には、[fields と expansions を組み合わせて使用する方法](/ja/x-api/fundamentals/data-dictionary#how-to-use-fields-and-expansions) に関するガイドを追加しています。
 

<div id="metrics">
  #### メトリクス
</div>

X API v2 のエンドポイントでは、リクエストに適切な[フィールド](/ja/x-api/fundamentals/fields)を指定すれば、返されるオブジェクトからメトリクスを直接取得できます。

ユーザーのプライバシーおよび、以下のレスポンスフィールドに関連して、ポストのメトリクスにはいくつかの制限があることに注意してください。

* tweet.fields.non&#95;public&#95;metrics
* tweet.fields.promoted&#95;metrics
* tweet.fields.organic&#95;metrics
* media.fields.non&#95;public&#95;metrics
* media.fields.promoted&#95;metrics
* media.fields.organic&#95;metrics

上記のフィールドには非公開のメトリクスデータが含まれており、recent search エンドポイントを使用する際に、そのポストの投稿者の代理としてこのデータを取得するための認可を受けている必要があります。そのためには、[OAuth 1.0a User Context](/ja/resources/fundamentals/authentication) を使用する必要があります。recent search でのみこの認証方式を使用できるため、full archive search エンドポイント経由でこれらのメトリクスを取得することはできません。

例えば、ユーザー ID 1234 のポストに対する `non_public_metrics` を取得するには、そのユーザーに関連付けられたアクセストークンをリクエストに含める必要があります。[3-legged OAuth フロー](/ja/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow) を使用すると、ユーザーにアプリを承認してもらい、そのユーザーに関連付けられた一連のアクセストークンを取得できます。

すべての `non_public_metrics`、`organic_metrics`、および `promoted_metrics` は、過去 30 日以内に作成されたポストに対してのみ利用可能です。つまり、これらのフィールドをリクエストすると、結果は自動的に過去 30 日以内のポストのみを含むように調整されます。

これらのフィールドがリクエストされた場合、認証済みユーザーが作成したポストのみが返され、それ以外のポストについてはエラーが返されます。
 

<div id="building-search-queries">
  #### 検索クエリの構築
</div>

これらのエンドポイントの主な機能は、1 つの検索クエリを使って配信されるポストを絞り込むことです。クエリは、メッセージのキーワード、ハッシュタグ、URL などのポストおよびユーザー属性にマッチするオペレーターで構成されます。オペレーターは、クエリのマッチング動作をより細かく制御するために、ブール論理や括弧を使って組み合わせることができます。

詳細については、[クエリの構築方法](/ja/x-api/posts/search/integrate/build-a-query)に関するガイドを参照してください。

<div id="pagination">
  #### ページネーション
</div>

これらのエンドポイントでは、レスポンスを迅速に返すためにページネーションを利用します。単一のレスポンスで送信できる結果数（最近の検索では最大 100 件のポスト、フルアーカイブ検索では最大 500 件）を超える場合は、ページネーションを行う必要があります。`max_results` パラメータを使用して 1 ページあたりに返す結果数を指定し、`pagination_token` パラメータを使用して次のページの結果を取得します。詳しくは、[ページネーションガイド](/ja/x-api/fundamentals/pagination)を参照してください。

<div id="post-caps">
  #### ポスト上限
</div>

Search Posts エンドポイントでは、ページネーションに関係なく、1 か月あたりに返せるポスト数に上限があります。

どの検索エンドポイントを使用した場合でも、返されるポストはプロジェクトレベルの[ポスト上限](/ja/x-api/fundamentals/post-cap)にカウントされます。利用状況は developer portal に表示され、ここでいう「月」は [developer portal dashboard](https://developer.x.com/en/portal/dashboard) に表示されているサブスクリプション更新日から起算されます。

**ポスト編集**

編集可能なポストは、元のポストが公開されてから 30 分以内であれば最大 5 回まで編集できます。検索エンドポイントは常にそのポストの最新バージョンを返します。公開から 30 分以上経過したポストのみをリクエストする場合は、常にそのポストの最終版を受け取ることになります。一方、ほぼリアルタイムのユースケースで、直近 30 分以内に公開されたポストをクエリする場合、それらのポストは取得後に編集されている可能性があります。これらのポストは、検索エンドポイントまたは Post Lookup エンドポイントで再取得して、最終状態を確認できます。ポスト編集の仕組みについて詳しくは、[Post edits fundamentals](/ja/x-api/fundamentals/edit-posts) ページを参照してください。  

**次のステップ**

[Search Posts エンドポイントへの最初のリクエストを実行する](/ja/x-api/posts/search/quickstart/recent-search)

[API Reference ページで、パラメータやフィールドなどの完全な一覧を確認する](/ja/x-api/posts/recent-search)

[サポートを受ける、またはエラーのトラブルシューティングを行う](https://developer.x.com/en/support/x-api)