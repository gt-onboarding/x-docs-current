---
title: フルアーカイブ検索
sidebarTitle: フルアーカイブ検索
keywords: ["フルアーカイブ検索", "アーカイブ検索クイックスタート", "履歴検索", "フルアーカイブチュートリアル", "アーカイブ検索ガイド"]
---

import { Button } from '/snippets/ja/button.mdx';

<div id="getting-started-with-the-full-archive-search-endpoint">
  ## フルアーカイブ検索エンドポイントの利用開始
</div>

このクイックスタートガイドでは、Postman を使用して、指定したフィールドを含むフルアーカイブ検索エンドポイントへの最初のリクエストを送信する方法を説明します。

さまざまな言語で書かれたサンプルコードを参照したい場合は、GitHub の [X API v2 sample code](https://github.com/xdevplatform/Twitter-API-v2-sample-code) リポジトリをご覧ください。 

<Note>
  ### 前提条件

  フルアーカイブ検索エンドポイントは現在、Pro および Enterprise アクセスでのみ利用可能です。このエンドポイントを使用するには、Pro アクセスにアップグレードするか、[Enterprise アクセスレベルを申請](https://docs.google.com/forms/d/e/1FAIpQLScO3bczKWO2jFHyVZJUSEGfdyfFaqt2MvmOfl_aJp0KxMqtDA/viewform)する必要があります。

  アクセスが承認されていることに加えて、リクエストを認証するための一連の [keys and tokens](/ja/resources/fundamentals/authentication) が必要です。これらのキーとトークンは、次の手順に従って生成できます。

  * developer portal で Enterprise または Pro アクセスを持つ [Project](/ja/resources/fundamentals/projects) に移動し、その Project 内に関連付けられた [developer App](/ja/resources/fundamentals/developer-apps) が存在することを確認します。

  * アプリの「Keys and tokens」ページに移動して、必要な認証情報を生成します。すべての認証情報は安全な場所に保存してください。
</Note>

<div id="steps-to-build-a-full-archive-search-request">
  ### フルアーカイブ検索リクエストを構築する手順
</div>

**ステップ1: ツールまたはライブラリを用意する**

このエンドポイントへのリクエストには、さまざまなツール、コード例、およびライブラリを使用できますが、ここではプロセスを簡略化するために Postman ツールを使用します。

X API v2 の Postman コレクションを環境に読み込むには、次のボタンをクリックしてください。

<Button href="https://app.getpostman.com/run-collection/9956214-784efcda-ed4c-4491-a4c0-a26470a67400">
  X API v2 を Postman に追加
</Button>

Postman に X API v2 コレクションを読み込んだら、Search Posts &gt; Full-archive search リクエストに移動します。

**ステップ2: リクエストを認証する**

X API に正しくリクエストを送信するには、自分に権限があることを確認する必要があります。このエンドポイントでそれを行うには、[OAuth 2.0 アプリ専用フロー](/ja/resources/fundamentals/authentication#app-only-authentication-and-oauth-2-0-bearer-token) の認証方法でリクエストを認証する必要があります。

キーとトークン、特に [App Access Token](/ja/resources/fundamentals/authentication#using-and-generating-an-app-only-bearer-token)（App-only Bearer Token とも呼ばれます）を Postman に追加する必要があります。これは、Postman の右上隅で「X API v2」という名前の environment を選択し、environment ドロップダウンの横にある目のアイコンをクリックして &quot;initial value&quot; フィールドと &quot;current value&quot; フィールドにキーとトークンを追加することで行えます。

これを正しく設定していれば、この変数はリクエストの Authorization タブに自動的に取り込まれます。
 

**ステップ3: 検索クエリを作成する**

各フルアーカイブ検索リクエストには 1 つの検索クエリが必要です。この例では、@XDevelopers アカウントによってポストされたポストにマッチするクエリを使用します。このクエリでは from 演算子を使用し、その値を XDevelopers（大文字小文字は区別されません）に設定します。

`from:XDevelopers`

Postman で &quot;Params&quot; タブに移動し、このクエリ、またはカンマ区切りの複数のポスト ID の文字列を、`ids` パラメータの &quot;Value&quot; 列に入力します。
 

| Key | Value | Description |
| :--- | :--- | :--- |
| `query` | `from:XDevelopers` | フルアーカイブ検索エンドポイントに送信する検索クエリ |

**ステップ4: 取得したいフィールドを特定して指定する**

ステップ3の後に &quot;Send&quot; ボタンをクリックすると、レスポンスにはデフォルトの [Post オブジェクト](/ja/x-api/fundamentals/data-dictionary#tweet) のフィールド `id`、`text`、`edit_history_tweet_ids` が含まれます。編集機能がサポートされる前のポストを受け取った場合、`edit_history_tweet_ids` フィールドは返されないことに注意してください。このフィールドについて履歴のバックフィル処理は行われていません。 

これらのデフォルトフィールド以外の追加フィールドを受け取りたい場合は、リクエスト内で [field](/ja/x-api/fundamentals/fields) パラメータおよび/または [expansion](/ja/x-api/fundamentals/expansions) パラメータを使って、それらのフィールドを指定する必要があります。

この演習では、異なるオブジェクトから 4 種類のフィールドセットをリクエストします。

1. デフォルトの Post オブジェクトのフィールド
2. プライマリユーザーオブジェクトの追加フィールド tweet.created&#95;at
3. 返されるポストの作成者に対応する [user オブジェクト](/ja/x-api/fundamentals/data-dictionary#user) のデフォルトフィールド
4. 対応するユーザーオブジェクトの追加フィールド user.description
    

Postman で &quot;Params&quot; タブに移動し、&quot;Query Params&quot; テーブルに次のキーと値のペアを追加します。

| Key | Value | Returned fields |
| :--- | :--- | :--- |
| `tweet.fields` | `created_at` | `tweets.created_at` |
| `expansions` | `author_id` | includes.users.id, includes.users.name, includes.users.username |
| user.fields | description | includes.users.description |

&quot;Send&quot; ボタンの横に次の URL が表示されているはずです。

`https://api.x.com/2/tweets/search/all?query=from:XDevelopers&tweet.fields=created_at&expansions=author_id&user.fields=created_at`

<Note>
  **ご注意ください**

  デフォルトでは、最新のポスト 10 件のみが返されます。1 回のリクエストで 10 件を超えるポストを取得したい場合は、max&#95;results パラメータを使用し、1 回のリクエストにつき最大 500 件のポストまで設定できます。同様に、デフォルトでは過去 30 日間のポストのみが返されます。30 日より前のポストを取得したい場合は、API 呼び出しで start&#95;time パラメータと end&#95;time パラメータを使用できます。
</Note>

**ステップ5：リクエストを送信し、レスポンスを確認する**

すべての設定が完了したら、「Send」ボタンをクリックすると、以下のようなレスポンスが返ってきます。

```
{
   "data": [
       {
           "author_id": "2244994945",
           "created_at": "2020-06-11T16:05:06.000Z",
           "id": "1271111223220809728",
           "text": "Tune in tonight and watch as @jessicagarson takes us through running your favorite Python package in R. 🍿\n\nLearn how to use two powerful programming languages for data science together, and see a live example that uses the recent search endpoint from Twitter’s Developer Labs. https://t.co/v178oUZNuj"
       },
       {
           "author_id": "2244994945",
           "created_at": "2020-06-10T19:25:24.000Z",
           "id": "1270799243071062016",
           "text": "As we work towards building the new Twitter API, we’ve extended the deprecation timeline for several Labs v1 endpoints. Learn more 📖 https://t.co/rRWaJYJgKk"
       },
       {
           "author_id": "2244994945",
           "created_at": "2020-06-09T18:08:47.000Z",
           "id": "1270417572001976322",
           "text": "Annotations help you learn more about a Tweet — they can even help you find topics of interest. 🔬\n\nIn this tutorial, @suhemparack shows us how find Tweets related to COVID-19 using annotations + the filtered stream endpoint.\n\nLearn how you can, too. ⤵️\nhttps://t.co/qwVOgw0zSV"
       }
   ],
   "includes": {
       "users": [
           {
               "description": "The voice of Twitter's #DevRel team, and your official source for updates, news, & events about Twitter's API. \n\n#BlackLivesMatter",
               "id": "2244994945",
               "name": "Twitter Dev",
               "username": "TwitterDev"
           }
       ]
   },
   "meta": {
       "newest_id": "1271111223220809728",
       "oldest_id": "1270417572001976322",
       "result_count": 3
   }
}
```

この例では、非常にシンプルなクエリを使用しました。より詳しいガイドをご覧になりたい場合は、以下のリソースをご参照ください。 

**次のステップ**

[API Reference を使ってリクエストをカスタマイズする](/ja/x-api/posts/full-archive-search)

[クエリ演算子の一覧を見る](/ja/x-api/posts/search/integrate/build-a-query "クエリ演算子の一覧を見る")

[これらのエンドポイント向けのサンプルコードを利用する](https://github.com/xdevplatform/Twitter-API-v2-sample-code "これらのエンドポイント向けのサンプルコードを利用する")
