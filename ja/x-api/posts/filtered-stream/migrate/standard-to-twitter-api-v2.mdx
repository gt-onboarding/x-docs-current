---
title: v1 から v2 へ
sidebarTitle: v1 から v2 へ
keywords: ["v1.1 から v2 への移行", "filtered stream の移行", "filtered stream 移行", "standard から v2 filtered stream への移行", "v1 から v2 filtered stream への移行", "移行ガイド"]
---

<div id="standard-v11-compared-to-x-api-v2">
  ### Standard v1.1 と X API v2 の比較
</div>

v1.1 の [statuses/filter](https://developer.x.com/en/docs/x-api/v1/tweets/filter-realtime/api-reference/post-statuses-filter) エンドポイントを利用している場合、このガイドは、Standard と X API v2 の filtered stream エンドポイントの共通点と相違点を理解するのに役立ちます。

* **類似点**
  * リクエストパラメータとオペレーター
  * ポストの編集履歴およびメタデータのサポート
* **相違点**
  * エンドポイントの URL
  * アプリおよびプロジェクトの要件
  * 認証方式
  * ルール数と永続的なストリーム
  * レスポンスデータの形式
  * リクエストパラメータ
  * リカバリおよび冗長性機能の有無
  * クエリオペレーター

<div id="similarities">
  #### 類似点
</div>

**リクエストパラメータとオペレーター**

Standard v1.1 の `statuses/filter` エンドポイントでは、ストリームをフィルタリングするためのパラメータを、リクエスト時にいくつか指定できます。v2 の filtered stream では代わりに、ブールロジックで組み合わせ可能な一連の[オペレーター](/ja/x-api/posts/filtered-stream#building-rules-for-filtered-stream)を使用して、目的のポストをフィルタリングします。利用可能なオペレーターの中には、Standard v1.1 の既存パラメータに直接対応するものも含まれます。 

次の Standard v1.1 のリクエストパラメータには、X API v2 で同等のオペレーターがあります。
 

| **Standard** | **X API v2** |
| :--- | :--- |
| follow - カンマ区切りのユーザーIDのリストで、ストリーム上でポストを配信すべきユーザーを示します。 | 特定のユーザーに関連するポストを見つけるのに役立つ、いくつかのオペレーター:<br /><br />* @<br />* from:<br />* to:<br />* など |
| track - ストリーム上でどのポストが配信されるかを決定するために使用される、カンマ区切りのフレーズのリスト。 | 特定のキーワードに関連するポストを見つけるのに役立つ、いくつかのオペレーター:<br /><br />* keyword<br />* &quot;exact phrase match&quot;<br />* #<br />* など |

**ポストの編集履歴とメタデータのサポート**

どちらのバージョンでも、編集履歴を表すメタデータが提供されます。詳細は、[filtered stream API リファレンス](/ja/x-api/posts/filtered-stream#api-reference-index)と[ポスト編集の基本](/ja/x-api/fundamentals/edit-posts)ページを参照してください。 

<div id="differences">
  #### Differences
</div>

**エンドポイント URL**

* Standard v1.1 エンドポイント:
  * https://stream.x.com/1.1/statuses/filter.json
* X API v2 エンドポイント:
  * https://api.x.com/2/tweets/search/stream
  * https://api.x.com/2/tweets/search/stream/rule

**アプリとプロジェクトの要件**

X API v2 エンドポイントでは、リクエストを認証する際に、[Project](/ja/resources/fundamentals/projects) に関連付けられた [developer App](/ja/resources/fundamentals/developer-apps) の認証情報を使用する必要があります。すべての X API v1.1 エンドポイントでは、スタンドアロンの App でも、Project に紐づいた App でも、その認証情報を使用できます。

**認証方式**

Standard エンドポイントは [OAuth 1.0a User Context](/ja/resources/fundamentals/authentication) をサポートしますが、X API v2 の filtered stream エンドポイントは [OAuth 2.0 App-Only](/ja/resources/fundamentals/authentication#oauth-2-0)（Application-only authentication とも呼ばれます）をサポートします。X API v2 のエンドポイントにリクエストを送信するには、アプリアクセストークンを使用してリクエストを認証する必要があります。

developer portal で Project とアプリを作成した際に付与されたアプリアクセストークンをすでにお持ちでない場合は、developer portal 上のそのアプリの “Keys and tokens” ページに移動して、新しいトークンを生成できます。アプリアクセストークンをプログラムから生成したい場合は、[OAuth 2.0 App-Only guide](/ja/resources/fundamentals/authentication#app-only-authentication-and-oauth-2-0-bearer-token) を参照してください。 

**ルール数と永続ストリーム**

Standard v1.1 エンドポイントでは、ストリーミング接続をフィルタリングするためのルールを 1 つだけサポートします。ルールを変更するには、ストリームを切断し、パラメータとして指定するフィルタリングルールを更新した新しいリクエストを送信する必要があります。 

X API v2 filtered stream エンドポイントでは、1 つのストリームに複数のルールを適用でき、ストリーム接続を維持したままストリームのルールを追加・削除できます。 

**レスポンスデータ形式**

Standard v1.1 と X API v2 のエンドポイントバージョン間の最大の違いの 1 つは、ペイロードにどのフィールドを返すかをどのように選択するかという点です。

Standard エンドポイントでは、多くのレスポンスフィールドがデフォルトで返され、そのうえでパラメータを使用して、どのフィールドまたはどのフィールドセットをペイロードで返すかを指定できます。

X API v2 では、デフォルトで返されるのはポストの id と text フィールドのみです。追加のフィールドまたはオブジェクトをリクエストするには、[fields](/ja/x-api/fundamentals/fields) と [expansions](/ja/x-api/fundamentals/expansions) パラメータを使用する必要があります。これらのエンドポイントからリクエストしたポストのフィールドはすべて、プライマリのポストオブジェクト内で返されます。展開された user、media、poll、place の各オブジェクトとフィールドは、レスポンス内の includes オブジェクトの中で返されます。その後、ポストオブジェクトと展開されたオブジェクトの両方に含まれる ID を突き合わせることで、展開されたオブジェクトをポストオブジェクトに対応付けることができます。 

これらの新しいパラメータの詳細については、それぞれのガイド、または [fields と expansions の使い方](/ja/x-api/fundamentals/data-dictionary#how-to-use-fields-and-expansions) のガイドを参照することを推奨します。 

また、Standard v1.1 のフィールドを新しい v2 のフィールドにマッピングするのに役立つ [data format migration guide](/ja/x-api/migrate/data-format-migration#migrating-from-standard-v1-1s-data-format-to-v2) も用意しています。このガイドでは、特定のフィールドを返すために v2 リクエストで指定する必要がある具体的な expansion および field パラメータも確認できます。 
 

特定のフィールドのリクエスト方法の変更に加えて、X API v2 では、API が返すオブジェクト（ポストや [user](/ja/x-api/fundamentals/data-dictionary#user) オブジェクトなど）向けに新しい JSON 設計も導入しています。

* JSON ルートレベルでは、Standard エンドポイントは statuses 配列内にポストオブジェクトを返しますが、X API v2 は data 配列を返します。 
* Retweeted および Quoted の「statuses」を参照する代わりに、X API v2 の JSON では Retweeted および Quoted ポストを参照します。contributors や user.translator&#95;type など、多くのレガシーまたは非推奨フィールドは削除されます。 
* ポストオブジェクト内の favorites とユーザーオブジェクト内の favourites の両方を使用する代わりに、X API v2 では like という用語を使用します。 
* X では、値を持たない JSON 値（たとえば null）はペイロードに書き出さないという規約を採用しています。ポストおよびユーザーの属性は、非 null の値を持つ場合にのみ含まれます。 
   

また、[Post object](/ja/x-api/fundamentals/data-dictionary#tweet) に対して、次のような新しいフィールド群も導入しました。

* [conversation&#95;id](/ja/x-api/fundamentals/conversation-id) フィールド
* `context` と `entities` を含む 2 つの新しい [annotations](/ja/x-api/fundamentals/post-annotations) フィールド
* いくつかの新しい [metrics](/ja/x-api/fundamentals/metrics) フィールド
* 特定のポストに誰が返信できるかを示す、新しい `reply_setting` フィールド

**リクエストパラメータ**

また、X API v2 ではサポート**されていない**標準的な filtered stream のリクエストパラメータも存在します。

| Standard v1.1 parameter | Details |
| :--- | :--- |
| locations - ポストをフィルタリングするためのバウンディングボックスの集合を指定する、コンマ区切りの経度・緯度ペアのリスト。 | X API v2 向けの位置情報ベースのオペレーターは、まだ提供していません。 |
| Delimited | v1.1 エンドポイントでは、これを文字列長に設定すると、ステータスがストリーム内で区切られ、クライアントはステータスメッセージの終端までに何バイト読み込めばよいかを把握できます。<br /><br />この機能は X API v2 では利用できません。 |
| Stall&#95;warnings | v1.1 エンドポイントでは、このパラメータを true に設定すると、クライアントが切断される危険がある場合に、定期的なメッセージが配信されます。<br /><br />X API v2 では、一定間隔で送信される改行行として、stall warning がデフォルトで送信されます。 |

**リカバリ機能および冗長化機能の有無**

X API v2 の filtered stream には、ストリーミングのアップタイムを最大化し、5 分以内の切断によって取り逃がした可能性のあるポストを復旧するのに役立つ、リカバリ機能および冗長化機能が導入されています。

冗長接続により、特定のストリームに最大 2 回まで接続できるため、一方の接続が失敗しても、常にストリームへの接続を維持しやすくなります。

`backfill_minutes` パラメータを使用すると、最大 5 分間分の取り逃したデータを復旧できます。

これら 2 つの機能はどちらも、[Academic Research access](/ja/x-api/getting-started/about-x-api) でのみ利用可能です。この機能の詳細については、[recovery and redundancy features](/ja/x-api/posts/filtered-stream#filtered-stream-recovery-and-redundancy-features) 統合ガイドを参照してください。

**新しいクエリオペレーター**

X API v2 では、次の 2 つの新機能をサポートする新しいオペレーターが導入されています。

* **[Conversation IDs](/ja/x-api/fundamentals/conversation-id)** - X 上で会話が展開されると、その会話に属するポストを識別するための Conversation ID が利用可能になります。会話内のすべてのポストの `conversation_id` は、その会話を開始したポストの Post ID に設定されます。
  * conversation&#95;id:
* **[X Annotations](/ja/x-api/fundamentals/post-annotations)** はポストに関するコンテキスト情報を提供し、entity と context のアノテーションを含みます。Entities は、人、場所、製品、組織で構成されます。Contexts は、対象となる entity が属するドメイン、つまりトピックです。たとえば、ポスト内で言及された人物は、その人がアスリート、俳優、政治家のいずれであるかを示すコンテキストを持つ場合があります。
  * context: - 関心のあるコンテキストでアノテーションされたポストにマッチします。
  * entity: - 関心のあるエンティティでアノテーションされたポストにマッチします。 