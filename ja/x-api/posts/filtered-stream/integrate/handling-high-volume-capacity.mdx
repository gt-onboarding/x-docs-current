---
title: 高ボリューム時のキャパシティ管理
sidebarTitle: 高ボリューム時のキャパシティ管理
keywords: ["高ボリューム", "キャパシティ管理", "ストリームキャパシティ", "ボリューム管理", "高スループット", "ストリームのスケーリング"]
---

---

<div id="how-to-plan-for-high-volume-social-data-events">
  ### 大量のソーシャルデータが発生するイベントへの備え方
</div>

国内外の大規模なイベントの多くは、ソーシャルメディアプラットフォーム全体でのユーザーアクティビティの劇的な急増を伴います。これらのイベントの中には、Super Bowl（スーパーボウル）、政治選挙、世界各地の新年の祝い事のように、事前に発生がわかっているものもあります。一方で、自然災害、突発的な政治的出来事、ポップカルチャーの話題、COVID-19 のような健康危機やパンデミックなど、予期せぬ出来事がきっかけで投稿ボリュームが急増する場合もあります。

このようなユーザーアクティビティの急増は、非常に短時間（秒単位）で収束することもあれば、数分間にわたって継続する場合もあります。いずれの要因によるものであっても、X からデータを取得しているアプリケーションに与える影響を考慮することが重要です。ここでは、大量のソーシャルデータが発生するイベントに備える際に、チームの役に立つベストプラクティスをいくつか紹介します。

<div id="review-your-current-filtered-stream-rules">
  #### 現在の filtered stream ルールを見直す
</div>

* ブランドが主要なスポーツイベントをスポンサーしているときのブランド言及のように、高ボリュームのイベント中には特定のキーワードが急増することがあります。
* 不要なアクティビティ量を発生させる可能性のある、不必要または過度に一般的なルールは避けるよう注意してください。
* あらかじめ高ボリュームのイベントが見込まれる場合は、クライアントと連絡を取り、適切な計画が立てられるよう支援することを検討してください。
     

<div id="stress-test-your-application">
  #### アプリケーションをストレステストする
</div>

バースト時のデータ量は、平常時の 1 日あたりの平均消費量の 5～10 倍に達する可能性があると想定しておきましょう。ルールセットによっては、その増加幅がさらに大きくなる場合があります。

<div id="understand-delivery-caps-for-connections">
  #### 接続における配信上限について理解する
</div>

フローと配信の上限値はアクセスレベルによって決まります。このため、ストリームで配信される結果のボリュームは一定になります。

* **Academic**: 250 ポスト/秒
* **Enterprise**: ポスト/秒はアクセスレベルで設定されます

<div id="optimize-to-stay-connected">
  #### 接続を維持するための最適化
</div>

ストリームを利用する場合、データを取りこぼさないためには接続を維持することが不可欠です。クライアントアプリケーションは、接続の切断を検知し、再接続が失敗した場合には指数バックオフを用いつつ即座に再接続を再試行できるロジックを備えている必要があります。
 

<div id="add-built-in-buffering-on-your-end">
  #### クライアント側にバッファリング機構を組み込む
</div>

マルチスレッドのアプリを構築することは、大量のストリームデータを処理するための重要な戦略です。大まかに言えば、データストリームを管理するためのベストプラクティスは、ストリーミング接続を確立する専用スレッド／プロセスを用意し、受信した JSON アクティビティをメモリ構造またはバッファ付きのストリームリーダーに書き込む、というものです。この「軽量な」ストリーム処理スレッドは受信データを扱う役割を担い、必要に応じてサイズを増減できる形でメモリ上にバッファリングします。続いて別のスレッドがそのハッシュ（例: ハッシュテーブル）の内容を取り出し、JSON のパースやデータベース書き込みの準備、その他アプリで必要な「重い処理」を行います。
 

<div id="global-events-global-time-zones">
  #### グローバルなイベント = グローバルなタイムゾーン
</div>

イベントは営業時間外や週末に発生する可能性があるため、通常の営業時間とは異なる時間帯にスパイクが発生しても対応できるよう、あらかじめチームの体制を整えておいてください。