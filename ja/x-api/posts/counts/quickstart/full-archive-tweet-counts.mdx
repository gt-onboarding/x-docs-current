---
title: ポストを検索（フルアーカイブ）
sidebarTitle: ポストを検索（フルアーカイブ）
keywords: ["フルアーカイブ ポスト件数 クイックスタート", "アーカイブ ポスト件数 クイックスタート", "過去ポスト件数 クイックスタート", "フルアーカイブ件数"]
---

import { Button } from '/snippets/ja/button.mdx';

<div id="getting-started-with-the-full-archive-post-counts-endpoint">
  ### 全アーカイブのポスト件数エンドポイントの利用を開始する
</div>

このクイックスタートガイドでは、HTTP リクエストを送信するためのグラフィカルツールである Postman を使って、全アーカイブのポスト件数エンドポイントへの最初のリクエストを送信する方法を説明します。

さまざまなプログラミング言語でのサンプルコードを確認したい場合は、[X API v2 sample code](https://github.com/xdevplatform/Twitter-API-v2-sample-code) の GitHub リポジトリをご覧ください。 

<Note>
  ### 前提条件

  全アーカイブのポスト件数エンドポイントは現在、Pro または Enterprise アクセス権を持つ開発者のみが利用できます。このエンドポイントを使用するには、Pro または [Enterprise アクセス](https://docs.google.com/forms/d/e/1FAIpQLScO3bczKWO2jFHyVZJUSEGfdyfFaqt2MvmOfl_aJp0KxMqtDA/viewform)を申請する必要があります。 

  アクセスが承認されていることに加えて、リクエストを認証するための [キーとトークン](/ja/resources/fundamentals/authentication) 一式が必要です。これらのキーとトークンは、次の手順に従って生成できます。

  * 開発者ポータルで Enterprise アクセス権を持つ [プロジェクト](/ja/resources/fundamentals/projects) に移動し、そのプロジェクト内に関連付けられた [開発者アプリ](/ja/resources/fundamentals/developer-apps) があることを確認します。

  * アプリの「Keys and tokens」ページに移動し、必要な認証情報を生成します。すべての認証情報は安全な場所に保存してください。
</Note>

<div id="steps-to-build-a-full-archive-post-counts-request">
  #### フルアーカイブのポスト件数リクエストを構築する手順
</div>

**ステップ1：ツールまたはライブラリを選択する**

このエンドポイントへのリクエストを行うために使用できるツール、コード例、ライブラリはいくつかありますが、ここではプロセスを簡略化するために Postman ツールを使用します。

X API v2 の Postman コレクションを自分の環境に読み込むには、次のボタンをクリックしてください。

<Button href="https://app.getpostman.com/run-collection/9956214-784efcda-ed4c-4491-a4c0-a26470a67400">
  X API v2 を Postman に追加
</Button>

Postman に X API v2 コレクションを読み込んだら、Post counts &gt; Full-archive Post counts request に移動します。

**ステップ2：リクエストを認証する**

X API へ適切にリクエストを行うには、自分に権限があることを確認する必要があります。このエンドポイントでそれを行うには、[OAuth 2.0 アプリ専用フロー](/ja/resources/fundamentals/authentication#app-only-authentication-and-oauth-2-0-bearer-token) の認証方式でリクエストを認証する必要があります。

キーとトークン、特に [App Access Token](/ja/resources/fundamentals/authentication#using-and-generating-an-app-only-bearer-token)（App-only Bearer Token とも呼ばれます）を Postman に追加する必要があります。これは、Postman の右上隅で「X API v2」という名前の environment を選択し、「initial value」と「current value」のフィールドにキーとトークンを追加することで実行できます（environment ドロップダウンの横にある目のアイコンをクリックします）。

これを正しく設定すると、この変数はリクエストの Authorization タブに自動的に取り込まれます。
 

**ステップ3：クエリを作成する**

各フルアーカイブのポスト件数リクエストには、1 つの[クエリ](/ja/x-api/posts/counts/integrate/build-a-query)が必要です。この例では、@XDevelopers アカウントによってポストされたポストに一致するクエリを使用します。このクエリでは from 演算子を使用し、その値を XDevelopers（大文字小文字は区別されません）に設定します。

`from:XDevelopers`

Postman で「Params」タブに移動し、この ID、またはカンマ区切りのポスト ID の文字列を、`ids` パラメータの「Value」列に入力します。
 

| Key | Value | Description |
| :--- | :--- | :--- |
| `query` | `from:XDevelopers` | フルアーカイブのポスト件数エンドポイントに送信するクエリ |

ステップ4（オプション）：粒度と期間を指定する

ステップ3の後に「Send」ボタンをクリックすると、デフォルトのフルアーカイブのポスト件数、つまり過去30日間について 1 時間ごとの件数が返されます。日ごとのフルアーカイブのポスト件数を取得したい場合は、granularity パラメータを追加し、その値を day に設定する必要があります。30日より前の期間のポスト件数を取得したい場合は、取得したい期間に対応する値で start&#95;time および end&#95;time パラメータを指定する必要があります。 

Postman で「Params」タブに移動し、「Query Params」テーブルに次の key:value の組み合わせを追加します。

|     |     |     |
| :--- | :--- | :--- |
| **Key** | **Value** | **Description** |
| granularity | day | ポスト件数結果の粒度。指定可能な値は day、hour、minute です |
| start&#95;time | 2021-05-01T00:00:00Z | ポストが提供される最も古い UTC タイムスタンプ |
| end&#95;time | 2021-06-01T00:00:00Z | ポストが提供される最も古い UTC タイムスタンプ。 |

「Send」ボタンの横に次の URL が表示されているはずです。

`https://api.x.com/2/tweets/counts/all?query=from%3AXDevelopers&start_time=2021-05-01T00:00:00Z&end_time=2021-06-01T00:00:00Z&granularity=day`

**ステップ5：リクエストを送信し、レスポンスを確認する**

すべての設定が完了したら、「Send」ボタンを押すと、次のようなレスポンスが返されます。

```
{
   "data": [
       {
           "end": "2021-05-02T00:00:00.000Z",
           "start": "2021-05-01T00:00:00.000Z",
           "post_count": 0
       },
       {
           "end": "2021-05-03T00:00:00.000Z",
           "start": "2021-05-02T00:00:00.000Z",
           "post_count": 0
       },
       {
           "end": "2021-05-04T00:00:00.000Z",
           "start": "2021-05-03T00:00:00.000Z",
           "post_count": 0
       },
       {
           "end": "2021-05-05T00:00:00.000Z",
           "start": "2021-05-04T00:00:00.000Z",
           "post_count": 0
       },
       {
           "end": "2021-05-06T00:00:00.000Z",
           "start": "2021-05-05T00:00:00.000Z",
           "post_count": 0
       },
       {
           "end": "2021-05-07T00:00:00.000Z",
           "start": "2021-05-06T00:00:00.000Z",
           "post_count": 0
       },
       {
           "end": "2021-05-08T00:00:00.000Z",
           "start": "2021-05-07T00:00:00.000Z",
           "post_count": 0
       },
       {
           "end": "2021-05-09T00:00:00.000Z",
           "start": "2021-05-08T00:00:00.000Z",
           "post_count": 0
       },
       {
           "end": "2021-05-10T00:00:00.000Z",
           "start": "2021-05-09T00:00:00.000Z",
           "post_count": 0
       },
       {
           "end": "2021-05-11T00:00:00.000Z",
           "start": "2021-05-10T00:00:00.000Z",
           "post_count": 0
       },
       {
           "end": "2021-05-12T00:00:00.000Z",
           "start": "2021-05-11T00:00:00.000Z",
           "post_count": 0
       },
       {
           "end": "2021-05-13T00:00:00.000Z",
           "start": "2021-05-12T00:00:00.000Z",
           "post_count": 6
       },
       {
           "end": "2021-05-14T00:00:00.000Z",
           "start": "2021-05-13T00:00:00.000Z",
           "post_count": 1
       },
       {
           "end": "2021-05-15T00:00:00.000Z",
           "start": "2021-05-14T00:00:00.000Z",
           "post_count": 0
       },
       {
           "end": "2021-05-16T00:00:00.000Z",
           "start": "2021-05-15T00:00:00.000Z",
           "post_count": 0
       },
       {
           "end": "2021-05-17T00:00:00.000Z",
           "start": "2021-05-16T00:00:00.000Z",
           "post_count": 0
       },
       {
           "end": "2021-05-18T00:00:00.000Z",
           "start": "2021-05-17T00:00:00.000Z",
           "post_count": 0
       },
       {
           "end": "2021-05-19T00:00:00.000Z",
           "start": "2021-05-18T00:00:00.000Z",
           "post_count": 1
       },
       {
           "end": "2021-05-20T00:00:00.000Z",
           "start": "2021-05-19T00:00:00.000Z",
           "post_count": 0
       },
       {
           "end": "2021-05-21T00:00:00.000Z",
           "start": "2021-05-20T00:00:00.000Z",
           "post_count": 8
       },
       {
           "end": "2021-05-22T00:00:00.000Z",
           "start": "2021-05-21T00:00:00.000Z",
           "post_count": 1
       },
       {
           "end": "2021-05-23T00:00:00.000Z",
           "start": "2021-05-22T00:00:00.000Z",
           "post_count": 0
       },
       {
           "end": "2021-05-24T00:00:00.000Z",
           "start": "2021-05-23T00:00:00.000Z",
           "post_count": 0
       },
       {
           "end": "2021-05-25T00:00:00.000Z",
           "start": "2021-05-24T00:00:00.000Z",
           "post_count": 0
       },
       {
           "end": "2021-05-26T00:00:00.000Z",
           "start": "2021-05-25T00:00:00.000Z",
           "post_count": 1
       },
       {
           "end": "2021-05-27T00:00:00.000Z",
           "start": "2021-05-26T00:00:00.000Z",
           "post_count": 1
       },
       {
           "end": "2021-05-28T00:00:00.000Z",
           "start": "2021-05-27T00:00:00.000Z",
           "post_count": 1
       },
       {
           "end": "2021-05-29T00:00:00.000Z",
           "start": "2021-05-28T00:00:00.000Z",
           "post_count": 2
       },
       {
           "end": "2021-05-30T00:00:00.000Z",
           "start": "2021-05-29T00:00:00.000Z",
           "post_count": 0
       },
       {
           "end": "2021-05-31T00:00:00.000Z",
           "start": "2021-05-30T00:00:00.000Z",
           "post_count": 0
       },
       {
           "end": "2021-06-01T00:00:00.000Z",
           "start": "2021-05-31T00:00:00.000Z",
           "post_count": 0
       }
   ],
   "meta": {
       "total_post_count": 22
   }
}
```

**ステップ6：結果をページングする**

レスポンス内の `meta` オブジェクトに `next_token` も含まれている場合、その値を `next_token` クエリパラメータに渡すことができます。

| Key | Value | Description |
| :--- | :--- | :--- |
| next&#95;token | 直前のリクエストの `meta` オブジェクトから取得した `next_token` をここに設定します。 | 直近のリクエストで結果がすべて返されなかった場合、`meta` オブジェクト内に `next_token` が含まれます。そのフィールドの値を取得し、次のリクエストで `next_token` パラメータの値として指定します。他のリクエストパラメータはすべて同じ値のままにしておきます。 |

適切な `next_token` の値を設定したら、「Send」ボタンをクリックして、次のページの結果を受け取ります。