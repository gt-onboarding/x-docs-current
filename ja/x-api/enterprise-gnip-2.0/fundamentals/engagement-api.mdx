---
title: エンゲージメント API
keywords: ["エンゲージメント API", "Enterprise エンゲージメント API", "エンゲージメントメトリクス", "エンゲージメントデータ", "Enterprise エンゲージメント", "GNIP エンゲージメント"]
---

<div id="overview">
  ## Overview
</div>

[`Enterprise`](https://developer.x.com/en/products/x-api/enterprise)

*これは、当社が提供するマネージドアクセスレベル内でのみ利用可能な Enterprise API です。この API を利用するには、まず Enterprise 営業チーム経由でアカウントを開設する必要があります。 [詳細はこちら](/ja/x-api/enterprise-gnip-2.0/enterprise-gnip)*

Engagement API は、ポストのインプレッションおよびエンゲージメントメトリクスへのアクセスを提供します。ほとんどのメトリクスおよびエンドポイントでは [OAuth 1.0a User Context](/ja/resources/fundamentals/authentication) を使用して認証する必要がありますが、[OAuth 2.0 Bearer Token](/ja/resources/fundamentals/authentication#oauth-2-0) と /totals エンドポイントを使用することで、公開されている「いいね」、「リポスト」、「返信」、および動画再生回数のメトリクスにアクセスできます。  

**注記:** 一部の X の Web ダッシュボードでレポートされるデータと、Engagement API でレポートされるデータの間に差異が見られる場合があります。これらの差異は、Web ダッシュボードが通常、選択された期間内に発生したエンゲージメントやインプレッションのみを表示することに起因します。たとえば、Web ダッシュボードは暦月の範囲内に行われたポストへのエンゲージメントのみを表示する一方で、Engagement API はその月の範囲外であっても、要求された時間範囲内に含まれるエンゲージメントを表示することがあります。このような場合、Engagement API を正として扱ってください。
 

<div id="request-endpoints">
  ### リクエストエンドポイント
</div>

Engagement API には 3 つのエンドポイントが用意されています。

<div id="current-totals-totals">
  #### 現在の合計値: [/totals]
</div>

* リクエストでは、指定したポストに対するインプレッションの合計メトリクスとエンゲージメントの合計メトリクスが返されます
* 使用できるメトリクスは、Impressions、Engagements、Favorites、Replies、Retweets、Quote Tweets、Video Views に限定されます
* OAuth 1.0a User Context を使用して、**直近 90 日以内** に作成されたポストの **Impressions** および **Engagements** メトリクスを取得できます
* OAuth 2.0 Bearer Token を使用して、**任意のポスト** の **Favorites、Retweets、Quote Tweets、Replies、** および **Video Views** メトリクスを取得できます
* 結果は、リクエスト実行時点におけるインプレッションとエンゲージメントの現在の合計値に基づきます
* ダッシュボードレポートの基盤として、また複数の @handle を対象としたエンゲージメント率の算出に最適です
* 1 回のリクエストで最大 250 件のポストに対するメトリクスの取得をサポートします
   

<div id="last-28-hours-28hr">
  #### 過去28時間: [/28hr]
</div>

* リクエストでは、インプレッションの合計メトリクス、エンゲージメントの合計メトリクス、そして過去28時間に発生した個々のエンゲージメントメトリクスの内訳を返します
* データはポストID単位、または集計された時系列（1日単位または1時間単位）でグループ化できます
* 直近に作成されたコンテンツのパフォーマンスを追跡するのに最適です
* 利用可能なすべてのメトリクスをサポートします
* 1回のリクエストで最大25件のポストのメトリクスを取得できます
   

<div id="historical-historical">
  #### 履歴データ: [/historical]
</div>

* リクエストでは、直近1年間について、ポストの作成時刻ではなくエンゲージメント発生時刻に基づき、インプレッション、エンゲージメント、および個々のエンゲージメントメトリクスの内訳を取得できます。
* リクエストは開始日と終了日のパラメータをサポートしており、最長4週間までの特定の期間に絞り込める柔軟性があります。
* ポストのエンゲージメントデータは、過去365日分までに制限されています。
* データはポストIDごと、または日別・時間別の時系列集計としてグループ化できます。
* 直近のパフォーマンスを過去のベンチマークと比較評価したり、特定の@handleのパフォーマンスの履歴を把握するのに最適です。
* 利用可能なすべてのメトリクスに対応しています。
* 1回のリクエストで最大25件のポストのメトリクスを取得できます。

<div id="available-metrics">
  ### 利用可能なメトリクス
</div>

以下の表では、Engagement API を通じて取得できるメトリクスの種類について説明します。

これらのメトリクスの詳細については、[メトリクスの解釈ページ](/ja/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#interpreting-the-metrics)をご覧ください。

| メトリクス                                                                                                                                              | 利用可能なエンドポイント      | ユーザーコンテキストの要否                                          | 説明                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| :------------------------------------------------------------------------------------------------------------------------------------------------- | :---------------- | :----------------------------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| インプレッション                                                                                                                                           | すべてのエンドポイント       | 必要                                                     | ポストが閲覧された回数です。このメトリックは、過去90日以内に投稿されたポストに対してのみ利用できます。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| エンゲージメント数                                                                                                                                          | すべて               | はい                                                     | ユーザーがポストとやり取りした回数です。この指標は、過去90日以内に投稿されたポストに対してのみ利用できます。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| いいね                                                                                                                                                | すべて               | はい - /28hrs &amp; /Historical<br /><br />いいえ - /totals | ポストに付けられたいいねの回数。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| リポスト                                                                                                                                               | すべて               | はい - /28hrs および /Historical<br /><br />いいえ - /totals   | ポストがリツイートされた回数の合計。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| 引用&#95;ポスト                                                                                                                                         | /totals           | いいえ - /totals                                          | コメント付きリツイート（Quote とも呼ばれます）が行われたポストの回数。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 返信数                                                                                                                                                | すべて               | はい - /28hrs &amp; /Historical<br /><br />いいえ - /totals | ポストに対して行われた返信の件数。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| video&#95;views                                                                                                                                    | すべて               | はい - /28hrs &amp; /Historical<br /><br />いいえ - /totals | 指定されたポスト内の動画が、少なくとも 2 秒間連続して 50% 以上表示された回数。<br /><br />動画再生数は、投稿から 1800 日未満のポストに対してのみ利用できます。1800 日以上前に投稿されたポストについて動画再生数をリクエストした場合、レスポンスには、他にリクエストしたメトリクスを含む別のオブジェクトに加えて、次のオブジェクトが返されます。<br /><br />&quot;unsupported&#95;for&#95;video&#95;views&#95;tweet&#95;ids&quot;: [&quot;TWEET&#95;ID&quot;]<br /><br />**注意:** X が所有および運営するプラットフォーム（モバイルアプリおよびウェブサイト）に表示される動画再生数と、/28hr および /historical エンドポイント経由で取得する数値との間に差異が生じる場合があります。<br /><br />*   X のユーザーインターフェースおよび /totals エンドポイントに表示される動画再生数は、対象の動画が投稿されているすべてのポストを合算した値です。つまり、UI に表示されるメトリクスには、その動画がリポストされたり、別のポストとして再投稿されたすべてのインスタンスからの再生数が合算されています。このメトリクスには、gif の動画再生数は含まれません。<br />*   /28hr および /historical エンドポイントで提供される動画再生数には、メトリクスを取得している特定のポストに起因する再生のみが含まれます。このメトリクスには、gif の動画再生数は含まれません。 |
| media&#95;views                                                                                                                                    | /28hr /historical | はい                                                     | 動画、GIF、画像を対象に、メディアが自動再生またはクリックによって再生されたすべてのビューを合算した件数。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| media&#95;engagements<br /><br />([旧称「Media Clicks」](/ja/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#recent-changes-to-the-engagement-api)) | /28hr /historical | 必要                                                     | ポスト内の画像や動画などのメディアがクリックされた回数。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| url&#95;clicks                                                                                                                                     | /28hr /historical | 必要                                                     | ポスト内のURLがクリックされた回数。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| hashtag&#95;clicks                                                                                                                                 | /28hr /historical | はい                                                     | ポスト内のハッシュタグがクリックされた回数。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| detail&#95;expands                                                                                                                                 | /28hr /historical | はい                                                     | ポストの詳細を表示するために、そのポストがクリックされた回数。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| permalink&#95;clicks                                                                                                                               | /28hr /historical | 必要                                                     | ポストのパーマリンク（そのポスト専用の個別のウェブページ）がクリックされた回数。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| app&#95;install&#95;attempts                                                                                                                       | /28hr /historical | はい                                                     | ポスト経由で発生したアプリインストールイベントの回数                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| app&#95;opens                                                                                                                                      | /28hr /historical | はい                                                     | ポストから発生した App Open イベントの回数。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| email&#95;tweet                                                                                                                                    | /28hr /historical | はい                                                     | ポストがメールで共有された回数を示します。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| user&#95;follows                                                                                                                                   | /28hr /historical | はい                                                     | ユーザー（ポスト作成者）がこのポストからフォローされた回数。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| user&#95;profile&#95;clicks                                                                                                                        | /28hr /historical | はい                                                     | ユーザー（ポストの投稿者）のプロフィールが、このポストからクリックされた回数。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |

<div id="engagement-groupings">
  ### エンゲージメントのグループ化
</div>

グループ化を使用すると、返されるエンゲージメントメトリクスを自由に整理できます。1 回のリクエストで指定できるグループ化は最大 3 つまでです。メトリクスは、次の 1 つ以上の値でグループ化できます。

*3 つすべてのエンドポイントでサポートされている値:*

* tweet.id
* engagement.type
   

`/28hr` および `/historical` は時系列メトリクスを提供できるため、次の値もサポートします:

* engagement.day
* engagement.hour

グループ化の詳細については、「Guides」セクション内の [Engagement API Grouping](/ja/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#engagement-api-groupings) ページをご覧ください。

<div id="guides">
  ## ガイド
</div>

<div id="developer-getting-started-guide">
  ### 開発者向け入門ガイド
</div>

<div id="introduction">
  #### はじめに
</div>

このドキュメントの目的は、開発者向けに Engagement API との連携方法を紹介することです。まずは、なぜ連携するのかという点から説明し、その後で技術的な「どのように」に関する詳細を掘り下げていきます。

<div id="what-does-the-engagement-api-provide">
  ##### **Engagement API は何を提供しますか？**
</div>

* Engagement API は、対象のアカウントが [3-legged OAuth](/ja/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow) によって、あなたのアプリが自分に代わってメトリクスをリクエストすることを承認している場合、過去 90 日間にその X アカウントが所有するポストのインプレッションおよびエンゲージメントデータを提供します。この強力でありながら実装が容易なソリューションにより、インプレッションや URL クリック、#ハッシュタグクリックなどの詳細なエンゲージメントに即座にアクセスできます。
* Engagement API は、任意のポストについて、いいね、Retweets、Quote Tweets、返信、動画再生数の合計値（集計メトリクス）を提供します。これは、任意のポストまたはポストの集合に関する基本的なエンゲージメントデータを取得する強力な方法として利用できます。
* Engagement API は、15 を超えるパフォーマンスメトリクスを使ってコンテンツのパフォーマンスを効果的に測定することで、X 上での ROI を測定できるようにし、ソーシャルリスニング、マーケティング、パブリッシングプラットフォームに新たな価値をもたらします。
* Engagement API はリクエスト／レスポンス方式の API であり、アプリ開発者はポスト ID、取得したいメトリクス、および期間を含むリクエストを送信でき、その条件に対するデータが即座に返されます。
   

<div id="why-integrate-example-use-cases">
  ##### **なぜ連携するのか？ユースケース例**
</div>

* 自分のコンテンツの総リーチを把握し、どれだけの人が閲覧しているかを確認します。動画の再生数、リンクのクリック数、ハッシュタグのクリック数、アプリのインストール数を確認できます。
* 総量と時系列の両方のエンゲージメントメトリクスを生成します。
* 任意の公開ポストに関する基本的なエンゲージメントメトリクス（いいね、Retweet、Quote Tweet、返信）を把握します。
* これらのメトリクスを使って、どのタイプのポストが効果的かを判断し、それらをより頻繁に投稿して、インプレッションとエンゲージメントを増やします。
* 自分のポストの「いいね」が100件、または別のしきい値に達するたびに、別の自社アカウントからそのポストをRetweetするといったマーケティング施策を自動化します。
* A/Bテストのためのツールとして、キャンペーン同士をベンチマークし、相互に比較します。
* カスタマーサービス部門でどのタイプのコンテンツが共感を得ているかを分析し、どのように、いつ対応するかを決定します。
* 自分のプラットフォームから公開されたコンテンツに関するアナリティクスを表示します。
   

[Engagement API は 2016 年にローンチされ](https://blog.x.com/official/en_us/a/2016/gnip-s-engagement-api-is-now-generally-available.html)、このような詳細なエンゲージメントメトリクスを大規模に提供した初の X API でした。Engagement API は使いやすく、お客様によるこのプロセスの自動化を可能にします。以下は、統合事例を紹介するケーススタディです。

* [Measuring campaign success with the Red Cross](https://blog.x.com/developer/en_us/topics/spotlight/2016/measuring-campaign-success-with-the-red-cross.html)[](https://simplymeasured.com/blog/true-twitter-impressions-and-url-clicks-new-from-simply-measured/#sm.0007werel134td8zqf02m2mduumr6)

Engagement API を導入する「理由」を見てきたので、次は技術的な詳細を掘り下げていきましょう。

<div id="integrating-the-engagement-api">
  #### Engagement API を統合する
</div>

<div id="introduction-to-api">
  ##### **API の概要**
</div>

Engagement API は、JSON でエンコードされたリクエストを受け取り、JSON でエンコードされたエンゲージメントメトリクスで応答する、シンプルな RESTful API です。リクエストは主に 3 つの要素から構成されます（詳細なドキュメントへのリンクは各項目を参照してください）。

* ***Post IDs*** の配列。
* 関心のある [metric types](https://developer.x.com/en/docs/x-api/v1/metrics/get-tweet-engagement/overview#EngagementTypes) を指定する配列。タイプには「impressions」「retweets」「hashtag&#95;clicks」「user&#95;follows」などが含まれます。
* API レスポンス内でエンゲージメントデータをどのような形で構造化したいかを示す JSON 構造である [Engagement groupings](/ja/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#engagement-api-groupings)。

多くの場合、Engagement Types と Groupings はリクエストごとにほぼ固定で、更新されるのはポストの ID のみです。

Engagement API には、[3 つのエンドポイント](https://developer.x.com/en/docs/x-api/v1/metrics/get-tweet-engagement/overview#RequestEndpoints) があります。

* **Totals** - ポストに対するエンゲージメントの合計値を提供します。一部のメトリクスはすべてのポストに対して利用可能ですが、その他のメトリクスは過去 90 日分のみ利用可能です。
* **28 hour** - 直近 28 時間の時系列エンゲージメントメトリクスを提供します。
* **Historical** - 2014 年 9 月 1 日以降に投稿されたポストについて、最大 4 週間連続した期間の時系列エンゲージメントメトリクスを提供します。

**/totals** エンドポイントでは、1 回のリクエストで最大 **250 件のポスト** のメトリクスを取得できます。**/28hour** と **/historical** エンドポイントでは、**1 回のリクエストで 25 件** までサポートしています。

Engagement API へのアクセス方法について説明した後、API リクエストの実行手順を順を追って説明し、OAuth の概要を示し、その他の技術リソースへのリンクを提供します。

<div id="getting-api-access">
  ##### **API アクセスの取得**
</div>

このドキュメントを読んでいる場合、すでに Engagement API へのアクセスを取得済みである可能性が高いです。まだ取得していない場合は、Enterprise アカウントマネージャーに連絡するか、[こちら](/ja/x-api/enterprise-gnip-2.0/enterprise-gnip)から Enterprise アクセスを申請してください。

まずは、承認済みの開発者アカウントを使用し、[developer portal](/ja/resources/fundamentals/developer-portal) 経由で [X アプリ](/ja/resources/fundamentals/developer-apps) を作成します。アカウントマネージャーがアクセスを付与するには、このアプリケーションに関連付けられた数値の App ID が必要になります。開発者アカウントを申請する必要がある場合は、[こちら](/ja/resources/fundamentals/developer-apps)から申請できます。

<div id="making-a-request">
  ##### **リクエストの送信**
</div>

嬉しいことに、Engagement API へのリクエストは簡単です。ここでは、次の 2 つの [@XDevelopers](https://x.com/XDevelopers) のポストについて、合計のリツイート数、引用リツイート数、いいね数、および返信数を取得してみます。

> 1/ Today we’re sharing our vision for the future of the X API platform![https://t.co/XweGngmxlP](https://t.co/XweGngmxlP)
>
> — Twitter Dev (@TwitterDev) [April 6, 2017](https://x.com/TwitterDev/status/850006245121695744)

> Don’t miss the Posts about your Post.
>
> Now on iOS, you can see Retweets with comments all in one place. [pic.x.com/oanjZfzC6y](https://t.co/oanjZfzC6y)
>
> — X (@X) [May 12, 2020](https://x.com/status/1260294888811347969?ref_src=twsrc%5Etfw)

最初のステップは、JSON 形式で API リクエストを組み立てることです。この JSON は、配列にまとめた 2 つのポスト ID、関心のあるエンゲージメント種別の配列、そしてレスポンス内でメトリクスをどのように整理したいかを示す、任意の名前を付けられる「groupings」JSON オブジェクトで構成されます。リクエストは次のようになります。

```json
{
  "tweet_ids": [
    1260294888811347969, 850006245121695744
  ],
  "engagement_types": [
    "retweets", "quote_tweets", "favorites", "replies"
  ],
  "groupings": {
    "engagement-types-by-id": {
      "group_by": [
        "Tweet.id", "engagement.type"
      ]
    }
  }
}
```

これらの合計メトリクスを取得するために、[https://data-api.x.com/insights/engagement/totals](https://data-api.x.com/insights/engagement/totals) エンドポイントにこの JSON リクエストを POST します。

リクエストが JSON でエンコードされており、かつ Gzip 圧縮されていることを示すために、次のヘッダーを含めます（リクエストボディが大きくなる場合があります）。

* Content-Type: application/json
* Accept-Encoding: gzip
   

リクエストを送信する際は OAuth を使って認証します。これについては次のセクションで詳しく説明します。

API からは次のペイロードが返されます。

```json
{
  "grouping name": {
    "1260294888811347969": {
      "favorites": "17111",
      "quote_tweets": "3254",
      "replies": "1828",
      "retweets": "5218"
    },
    "850006245121695744": {
      "favorites": "492",
      "quote_tweets": "66",
      "replies": "42",
      "retweets": "324"
    }
  }
}
```

レスポンスでは、リクエストしたメトリクスが「groupings」の定義で説明されている構造で返されます。最上位ではポストIDごとに、その下の階層ではエンゲージメントタイプごとにメトリクスが並んでいることに注意してください。

ここまでは比較的シンプルです。OAuth を使った認証が初めての場合は、次のセクションを参照してください。

<div id="authenticating-with-oauth">
  #### OAuth での認証
</div>

OAuth はテクノロジー業界で非常によく使われている認証標準です。すでに OAuth（他の X API など）を利用している場合は、言語ごとの OAuth パッケージを使い、面倒な詳細をすべて抽象化している可能性が高いでしょう。OAuth が初めての場合は、まず [Oauth with the X API](/ja/resources/fundamentals/authentication) ページをご覧いただくか、直接 [https://oauth.net](https://oauth.net/) にアクセスして詳細を学んでください。そのうえで、ご利用の実装言語向けの OAuth パッケージを探し、そこから始めることを推奨します。これらのパッケージを使う場合、認証までの一般的な流れは、キーとトークンを設定し、何らかの HTTP オブジェクトを作成し、そのオブジェクトを使ってリクエストを送信する、という手順になります。

たとえば Ruby の世界では、次の擬似コードは、Ruby の gem である「oauth」を使って OAuth 対応アプリを構築し、POST リクエストを行うための手順例を表しています。

```js
require 'oauth'

#JSON リクエストを組み立てる（上記参照）。
request = make_json_request()

#アプリのコンシューマーキーとシークレットを使用してアプリコンシューマーオブジェクトを構築する。
consumer = OAuth::Consumer.new(keys['consumer_key'], keys['consumer_secret'], {:site => ‘https://data-api.x.com’})
#権限を付与するアカウントから提供されたトークンを使用してユーザートークンを構築する。アプリのみのリクエストを行う場合（/totals エンドポイントで権限を必要としないポストを確認する場合）、このステップはスキップできる。
token = {:oauth_token => keys['access_token'], :oauth_token_secret => keys['access_token_secret']}

#OAuth 対応アプリオブジェクトを作成する。
app = OAuth::AccessToken.from_hash(consumer, token)
#POST リクエストを実行する。
result = app.post(“/insights/engagement/totals", request, {"content-type" => "application/json", "Accept-Encoding" => "gzip"})
```

Engagement API は、アプリケーションのみ認証とユーザーコンテキスト認証の両方をサポートしています。/totals エンドポイントで、あなたが所有していない公開ポストのエンゲージメントメトリクスを収集する場合は、ユーザーの許可は不要であり、アプリケーションのみ認証を使用できます。この場合、認証にはアプリキーとアプリシークレットのみを使用します。

OAuth では、ユーザーに紐づくトークンを用いて、アプリが「別のユーザーに代わって」API リクエストを行うこともできます。所有ポスト、つまりユーザートークンを保持しているユーザーが投稿したポストのエンゲージメントメトリクスを生成する場合は、ユーザーコンテキストでリクエストを行うことになります。これは、アプリキーとユーザー固有のアクセストークンの両方で認証することを意味します。これらのユーザーアクセストークンは通常、&#39;[Sign-in with X](/ja/resources/fundamentals/authentication#log-in-with-x)&#39; プロセスで提供されるか、ユーザーから直接取得されます（ユーザーからトークンを直接取得する場合は、必ず [twurl](https://github.com/xdevplatform/xurl) を使用する必要があることに注意してください）。ユーザーが一度トークンを提供すると、それらは有効期限切れにはならず、ユーザーがトークンをリセットしたりパスワードを変更したりしない限り、Engagement API でそのユーザーに代わってリクエストを行うために使用できます。その場合は、新しいトークンをユーザーから提供してもらう必要があります。

どのメトリクスにどの認証が必要かは、[この表](/ja/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#engagement-api-groupings)で確認できます。

<div id="selecting-an-engagement-api-endpoint">
  ### Engagement API エンドポイントの選択
</div>

Engagement API には、次の 3 つの明確に役割の異なるエンドポイントがあります。

* **[Totals](/ja/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#post-insights-engagement)** - 所有する（「owned」）ポストまたは所有していない（「unowned」）ポストから、選択したメトリクスの合計値を提供します。一部のメトリクスはすべてのポストに対して利用できますが、その他は直近 90 日以内に公開されたポストに対してのみ利用可能です。1 リクエストあたり 250 件のポストをサポートします。
* **[28 hour](/ja/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#post-insights-engagement)** - 直近 28 時間における、所有する（「owned」）ポストの時系列 Engagement メトリクスを提供します。1 リクエストあたり 25 件のポストをサポートします。
* **[Historical](/ja/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#post-insights-engagement-historical)** - 2014 年 9 月 1 日以降に投稿された、所有する（「owned」）ポストについて、最大 4 週分の連続した期間にわたる時系列 Engagement メトリクスを提供します。1 リクエストあたり 25 件のポストをサポートします。
   

各エンドポイントにはそれぞれ固有の特性があります。3 つすべてを利用する計画であっても、ユースケースに最も適したものを 1 つ選ぼうとしている場合であっても、それらの違いを理解することが重要です。

以下では、いくつかの主要な概念を紹介し、そのうえで 3 つのエンドポイントをさらに詳しく説明し、最後に一般的に特定のエンドポイントに対応づけられるサンプルユースケースを示します。この情報が、3 つすべてをより効率的に統合する際、またはあなたの目的に最も適した単一のエンドポイントを選択する際の一助となれば幸いです。
 

<div id="key-concepts">
  #### 重要な概念
</div>

3 つの Engagement API エンドポイントが提供する機能やデータの違いを理解するうえで役立つ、いくつかの重要な概念があります。
 

<div id="impressions-and-engagement-metrics">
  ##### インプレッションとエンゲージメントメトリクス
</div>

インプレッションは、特定のポストが X プラットフォーム上でオーガニックなコンテキストにおいて閲覧された回数を表します。プロモーション（広告）や有料のコンテキストで表示されたポストから生成されたインプレッションは含まれません。Engagement API 以前は、ポストのインプレッションは潜在的な閲覧回数の指標にすぎませんでした。これは、投稿者のアカウントおよびコンテンツをリポストしたアカウントのフォロワー数をカウントすることに基づいており、特定のユーザーが実際にはそのポストを見ていないという一般的な状況を考慮していませんでした。

Engagement API によって生成されるインプレッションメトリクスは、ポストが表示のために実際にレンダリングされた回数を測定した実測値です。あなたのアカウントのフォロワーがあなたのポストを見逃した場合、それはインプレッションとしてカウントされません。

Engagement API は、ポストが表示されたときにユーザーが取り得る 14 種類の固有のエンゲージメント[メトリクスタイプ](/ja/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#available-metrics)に関するメトリクスを提供します。それぞれが個別のアクションを表しており、リポスト、いいね、返信、#hashtags・リンク・メディアといったエンティティのクリック、投稿者のフォロー、投稿者のプロフィール閲覧などが含まれます。これらすべての個別アクションは、単一の Engagements メトリクスに集約されます。

<div id="owned-and-unowned-x-content">
  ##### 所有コンテンツと非所有コンテンツ
</div>

Engagement API では、owned ポストと unowned ポストを明確に区別します。owned ポストとは、自分のアカウントから投稿されたポスト、または Engagement データをリクエストする許可を取得しているポストを指します。他の X API と同様に、この許可は、他の X ユーザー／アカウントに、自分に代わって API リクエストを行うことを可能にするアクセストークンを共有してもらうことで取得します。これらのトークンを取得する一般的な方法の 1 つは、[「Sign in with X」のプロセス](/ja/resources/fundamentals/authentication#log-in-with-x)を利用することです。

`/totals` エンドポイントは、owned ポストと unowned ポストの両方についてエンゲージメントデータを提供します。unowned ポストについては、ポストの表示画面で公開されているエンゲージメントメトリクス（Favorite、Retweet、Reply）をリクエストできます。これらのメトリクスについて Engagement API が提供する価値は、これらのメトリクスを自動的かつ大規模に取得できる点にあります。owned ポストについては、`/totals` エンドポイントは Impression と（合計）Engagement メトリクスも提供します。

`/28hr` および `/historical` エンドポイントは owned ポストに対するメトリクスのみを提供します。つまり、これらのエンドポイントに対してリクエストを行う際は、ユーザーコンテキストを渡す必要があります。

<div id="total-and-time-series-engagement-data">
  ##### 合計エンゲージメントと時系列エンゲージメントデータ
</div>

`/totals` エンドポイントは、その名前が示すとおり、各エンゲージメント種別の合計値のみを提供します。これらの数値は、ポストの投稿以降、現在までの累計値を常に最新の状態で表します。ポストが投稿された直後にメトリクスを繰り返しリクエストすると、通常はリクエストのたびにこの合計値が変化します。

`/28hr` と `/historical` エンドポイントでは、合計値と時系列データの両方を取得できます。時系列データをリクエストする場合、エンゲージメントメトリクスは日次または時間別のデータに集約できます。   

`/28hr` と `/historical` エンドポイントで時系列データをリクエストする方法については、[エンゲージメントのグルーピング](/ja/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#engagement-api-groupings) に関するドキュメントを参照してください。

<div id="endpoints-and-example-use-cases">
  #### エンドポイントとユースケース例
</div>

前述した特性や違いを踏まえると、各エンドポイントは一般的に異なる種類のユースケースに対応します。特定のユースケースに最適なエンドポイントを選択する際の参考として、以下に想定されるユーザーの要望例と、それぞれを最も満たすエンドポイントを示します。

<div id="totals">
  ##### **/totals**
</div>

* 特定の指標タイプ（Impressions、Engagements、Favorites、Retweets、Quote Tweets、Replies、Video Views）だけ取得できればよい。
* 自分が所有しているポストだけでなく、任意のポストの基本的なエンゲージメントデータにアクセスする必要がある。
* 競合他社とのパフォーマンスを比較したい。
* 自分が所有していないポストも含めたハッシュタグやキャンペーンの基本的なエンゲージメント指標を追跡したい。
* 日別や時間別に分解されたデータは不要で、リクエスト時点での最新の合計値だけが必要である。
* レポートやダッシュボードに表示する単一の指標が必要で、データを保存したくない。
* ページの読み込み時にデータを表示したいので、リクエストを1回送ってレスポンスを受け取るだけでよい。
* 1日に数十万件から数百万件規模のポストデータにアクセスする必要がある。
   

<div id="28hr">
  ##### **/28hr**
</div>

* 17種類すべてのメトリクスにアクセスする必要がある。
* 直近28時間以内にポストされたポストのデータを表示したい。
* 1日1回ジョブを実行して必要なデータを取得しており、直近1日分のデータだけ取れればよい。
* メトリクスを日別または時間別に分解して取得する必要がある。
* ダッシュボードで、アクティビティを時間別に分解した時系列グラフを表示したい。
* 1日あたり数十万件規模のポストに対して高いアクセス上限が必要である。
* ストレージ容量があり、データを1日1回更新して累積値を保持できる。
   

<div id="historical">
  ##### **/historical**
</div>

* 17種類すべてのメトリクスへアクセスする必要がある。
* 2014年9月までさかのぼって作成されたポストの履歴データを取得する必要がある。
* キャンペーン同士を比較する詳細な履歴分析を行いたい。
* メトリクスを日別または時間別に分解して取得する必要がある。
* Engagement API への高いアクセスレベルは不要で、1日に数百から数千件程度のポストのデータを取得できればよい。

<div id="engagement-api-key-characteristics">
  ### Engagement API の主要な特性
</div>

* **RESTful API** で JSON データを提供し、JSON データボディを含む POST リクエストをサポートします。
* **リクエストの種類:** クライアントアプリは次の種類のリクエストを行うことができます:
  * **Total engagements** -- /totals エンドポイントへの HTTP POST リクエスト
  * **Last 28-hour engagements** -- /28hr エンドポイントへの HTTP POST リクエスト
  * **Historical engagements** -- /historical エンドポイントへの HTTP POST リクエスト
* **OAuth 認証:**
  * [OAuth 1.0 User Context](/ja/resources/fundamentals/authentication): [3-legged OAuth](https://developer.x.com/resources/fundamentals/authentication/obtaining-user-access-tokens) を使用してあなたのアプリを認可したユーザーが所有するポストについて、すべての利用可能なメトリクスにアクセスできます。リクエストを行う際には、そのユーザーのアクセストークンを使用する必要があります。[](/ja/resources/fundamentals/authentication)
  * [OAuth 2.0 Bearer Token](/ja/resources/fundamentals/authentication#oauth-2-0): 特定のメトリクス (Retweets, Quote Tweets, Replies, Favorites, Video Views) は、任意の公開ポストに対して利用できます。 
* **リクエストのメタデータと構造:** リクエストデータは、Post ID の配列、エンゲージメントタイプの配列、およびエンゲージメントのグルーピング構造から成る JSON オブジェクトです。
* **リクエストごとのポスト数:**
  * /totals エンドポイント: 250 Post IDs
  * /28hr エンドポイント: 25 Post IDs
  * /historical エンドポイント: 25 Post IDs
* **エンゲージメントメトリクスの提供範囲:**
  * **/totals** -- ポストが投稿されてから現在までのメトリクス合計。Impressions と Engagements は直近 90 日以内に投稿されたポストについて利用でき、Retweets, Quote Tweets, Replies, Favorites, Video Views はすべてのポストについて利用できます。
  * **/28hr** -- リクエスト時刻から直近 28 時間。
  * **/historical** -- 2014 年 9 月 1 日以降の任意の 28 日間。
* **メトリクスタイプ:** 各リクエストには [Metric Types](http://support.gnip.com/apis/engagement_api/overview.html#EngagementTypes) の配列が含まれます。利用可能なタイプはエンドポイントに依存し、/totals エンドポイントからリクエストする場合には、ポストがユーザーによる許可付きかどうかにも依存します。
  * /totals エンドポイント:
    * すべてのポスト: Favorites, Retweets, Quote Tweets, Replies, Video Views
    * OAuth 1.0a User Context が必要: Impressions, Engagements, Favorites, Replies, Retweets
  * /28hr および /historical エンドポイント (Post 所有者のアクセストークンを用いた OAuth 1.0a User Context が必要): Impressions, Engagements, Favorites, Replies, Retweets, URL Clicks, Hashtag Clicks, Detail Click, Permalink Clicks, Media Clicks, App Install Attempts, App Opens, Post Emails, Video Views, Media Views
* **エンゲージメントグルーピング:** 各リクエストには [Engagement Groupings](/ja/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#engagement-api-groupings) の配列が含まれます。これらのグルーピングにより、返されるメトリクスの整理方法をカスタマイズできます。1 つのリクエストに含められるグルーピングは最大 3 つです。メトリクスは次の値で整理できます:
  * すべてのエンドポイント: Post ID, Engagement Type
  * /28hr および /historical エンドポイント: 次の追加グルーピングを指定した場合、これらのエンドポイントは時系列データを提供します: Engagement Day, Engagement Hour
* **インテグレーションに関する前提条件:** あなたのチームは次の事項に責任を持ちます。
  * Engagement API に HTTP リクエストを送信し、リクエストに含まれる Post ID に対するエンゲージメントメトリクスを返すクライアントアプリを作成および維持すること。
* **制限事項**
* Video Views は、ポストの投稿から 1,800 日以内のものに対してのみ利用可能です。

<div id="authenticating-with-the-engagement-api">
  ### Engagement API での認証
</div>

> **注意**: 
>
> Engagement API を使い始める前に、X 側であなたの開発者アプリに対して Engagement API へのアクセスを有効化する必要があります。そのため、認証に利用する予定の App ID をアカウントマネージャーまたはテクニカルサポートチームに必ず共有してください。

Engagement API では、2 つの認証方法が利用できます: [OAuth 1.0a](/ja/resources/fundamentals/authentication#oauth-1-0a-2) と [OAuth 2.0 Bearer Token](/ja/resources/fundamentals/authentication#bearer-token-also-known-as-app-only) です。 

**OAuth 2.0 Bearer Token**（「application-only」とも呼ばれます）は、公開されているエンゲージメントメトリクスへアクセスするためのものです。この認証方法を使用すると、[/totals エンドポイント](/ja/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#post-insights-engagement-totals) へのリクエスト時に、公開されている任意のポストに対する Favorites（別名 Likes）、Retweets、Quote Tweets、Replies、および動画再生数の合計件数を取得できます。 

**OAuth 1.0a**（「user context」とも呼ばれます）は、ユーザーを代理してリクエストを送信し、そのユーザーに属する非公開のエンゲージメントメトリクスへアクセスするためのものです。 

この認証方法が必須となるのは、次の場合です:

* [/28hr エンドポイント](/ja/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#post-insights-engagement-28hr) および [/historical エンドポイント](/ja/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#post-insights-engagement-historical) に送信されるすべてのリクエスト
* 次のいずれかの非公開メトリクスへアクセスする場合: Impressions、Engagements、Media Views、Media Engagements、URL Clicks、Hashtag Clicks、Detail Expands、Permalink Clicks、App Install Attempts、App Opens、Email Post、User Follows、User Profile Clicks

OAuth 1.0a でリクエストを送信する場合は、対象のポストまたは保護対象リソースの所有者であるユーザーのアクセストークン（Access Token と Secret）を含める必要があります。保護されたユーザーデータをリクエストする際に正しいユーザーアクセストークンを指定しない場合、Engagement API は `403 Forbidden` エラーを返します。

Engagement API では、たとえそれらのポストの所有者であるユーザーを代理して認証している場合でも、[保護されたポスト](https://help.x.com/en/safety-and-security/public-and-protected-tweets) のエンゲージメントデータを取得することはできません。このようなリクエストを行うと、`400 Bad Request` エラーが返され、メッセージとして `"Tweet ID(s) are unavailable"` が返されます。

自分自身の X アカウント（つまり、開発者アプリを所有しているアカウント）を代理してリクエストを送信する場合は、その開発者アプリの “Keys and tokens” タブから、[developer portal](https://developer.x.com/en/portal/projects-and-apps) 内で必要なアクセストークンを直接生成できます。

他のユーザーを代理してリクエストを送信する場合は、必要なアクセストークンを取得するために 3-legged OAuth フローを使用する必要があります。これを行う方法の詳細については、次のドキュメントを参照してください: [OAuth 1.0a: how to obtain a user’s access tokens](/ja/resources/fundamentals/authentication#oauth-1-0a-2)。

追加のサンプル（OAuth 1.0a を使った認証方法を含む）については、[X Developers による Engagement API 向けの Python サンプルコード](https://github.com/xdevplatform/enterprise-scripts-python/tree/master/Engagement-API) を参照してください。

<div id="recent-changes-to-the-engagement-api">
  ### Engagement API の最近の変更
</div>

Engagement API は、X 上でのアクティビティのパフォーマンスをモニタリングするために不可欠なインプレッションおよびエンゲージメントのメトリクスを提供します。X 全体でメトリクスの一貫性を高め、データに基づくマーケティング上の意思決定を可能にし続けるための継続的な取り組みの一環として、Engagement API に最近加えられた変更点をご紹介します。  

最近、Engagement API を最新化し、X アナリティクスダッシュボード（analytics.x.com）で使用されているものと同じメトリクス集計手法を利用するように変更をリリースしました。これらの新しいメトリクスを導入するにあたり、API の破壊的な変更を最小限に抑えるべく慎重に検討を行い、最初の変更セットを 2017 年 10 月 9 日にデプロイしました。これらの変更により、開発者やその顧客が X 上のパフォーマンスを確認するあらゆる場所で一貫性が向上します。以下に、変更点の詳細な概要を示します。

|     |     |
| :--- | :--- |
| **Metric** | **Change** |
| engagements | 全体の engagements に集約されるメトリクスを更新し、Post のアナリティクスダッシュボードとの一貫性を持たせました。Engagements は「人々がこのポストに対して行ったインタラクションの回数」を測定します。<br /><br />動画や GIF などのメディアを含むポストについては、engagements メトリクスにメディアビューは今後含まれません。メディアビューは新しいメトリクス *media&#95;views* から取得できるようになりました。 |
| media&#95;clicks* | このメトリクスは “*media&#95;engagements*” という新しいメトリクスに置き換えられました。 |
| video&#95;views | 2018 年 7 月 6 日以降、このメトリクスは「自分が所有していない」ポストに対しても [/totals](/ja/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#post-insights-engagement) エンドポイント経由で利用可能になりました。これは、アプリのみ認証を使用することで、**すべての**ポストの動画再生数にアクセスできることを意味します。 <br /><br />要求できる動画再生数は、1800 日より新しいものに限られます。1800 日より古いポストの動画再生数をリクエストしようとした場合、次のレスポンスを受け取ります。<br /><br />&quot;unsupported&#95;for&#95;video&#95;views&#95;tweet&#95;ids&quot;: [&quot;TWEET&#95;ID&quot;]<br /><br />**注意:** video&#95;views は、media&#95;views とは異なり、動画の 50% が少なくとも 2 秒間表示されているという MRC 標準に基づいています。  <br /><br />**また、** X が運営するプラットフォーム（モバイルアプリおよびウェブサイト）上に表示される動画再生数メトリクスと、/28hr および /historical エンドポイント経由で取得する数値との間に差異が生じる場合がある点にも注意してください。<br /><br />* X のユーザーインターフェイスに表示され、/totals エンドポイントから返される動画再生数は、該当動画が投稿されたすべてのポストを合算した動画再生数を表示します。つまり、UI に表示されるメトリクスには、その動画が別のポストでリポストやリツイートされたすべてのインスタンスからの再生数が合算されます。<br />* /28hr および /historical エンドポイントで提供される動画再生数は、メトリクスを取得している特定のポストによって生成された再生数のみを含みます。 |
| media&#95;views | これは、動画、Vine、GIF、画像全体を通じてカウントされた、メディアのすべてのビュー（自動再生およびクリックによる再生）を含みます。<br /><br />**注意:** 画像付きポストはアナリティクスダッシュボード上では media&#95;views メトリクスを表示しませんが、Engagement API では返されます。 |
| media&#95;engagements* | これは、動画、Vine、GIF、画像全体を通じてメディアに対して行われたクリック数を含みます。このメトリクスは *media&#95;clicks* を置き換えるものです。 |
| quote&#95;tweets | 2020 年 7 月 7 日以降、このメトリクスは /totals エンドポイント経由で「自分が所有していない」ポストに対しても利用可能になりました。これは、アプリのみ認証を使用することで、すべてのポストの引用ポスト件数にアクセスできることを意味します。 |

<div id="interpreting-the-metrics">
  ### メトリクスの解釈
</div>

**注:** 一部の X のウェブダッシュボードで報告されるデータと、Engagement API で報告されるデータとの間に差異が見られる場合があります。これらの差異は、ウェブダッシュボードが通常、選択した期間内に発生したエンゲージメントやインプレッションのみを表示するために生じます。たとえば、ウェブダッシュボードではある暦月の期間内に行われたポストへのエンゲージメントのみが表示される一方で、Engagement API では、その月の範囲を超えていても、リクエストした時間範囲内に含まれるエンゲージメントが表示されることがあります。このような場合、Engagement API を正とするデータソースとして扱ってください。
 

<div id="impressions-and-engagement-data">
  #### インプレッションとエンゲージメントデータ
</div>

Engagement API は、**オーガニック**なインプレッションおよびエンゲージメントのデータを提供します。

インプレッションは、特定のポストがオーガニックなコンテキストで X プラットフォーム上に表示された回数を表します。プロモーション（Promoted）または有料（Paid）のコンテキストで表示されたポストによって生成されたインプレッションは、**含まれません**。

エンゲージメントは、特定のポストに対して視聴者が **オーガニック** および **プロモーション** の両方のコンテキストで行った反応の回数を表します。エンゲージメントには、リツイート、いいね、返信、URL クリック、ハッシュタグクリック、メンションのクリック、メディア再生などが含まれますが、これらに限定されません。含まれるエンゲージメントアクションの完全な一覧については、「Engagement データ」セクションを参照してください。 

基準となるエンゲージメント率を算出するには、分析対象期間における特定のポストのエンゲージメント総数を、そのポストのインプレッション総数で割ってください。

インプレッションおよびエンゲージメントデータは、所有している @ハンドルのポスト、または自分のアプリケーションによるポスト詳細の閲覧を承認している @ハンドルのポストに対してのみ取得できます。内部的には、Engagement API は、契約上の @ハンドル上限に対してリクエストされた一意の @ハンドル数を追跡します。クライアント側でも、月を通して @ハンドルのリクエスト利用状況を追跡することを推奨します。  

<div id="video-metrics">
  #### 動画メトリクス
</div>

X 内のメディアのインプレッションを表すメトリクスには、いくつかの種類があります。1 つ目は video views メトリクスで、少なくとも 2 秒間、動画の 50% が画面内に表示されているという MRC 標準に基づいています。2 つ目は Media Views で、動画、Vine、GIF、画像にわたってカウントされた、メディアのすべての再生（自動再生およびクリック再生）を含みます。

video views メトリクスは、/28hour および /historical エンドポイントを通じて自分が所有するポストに対して利用できるほか、/totals エンドポイントを通じて、所有していないすべてのポストに対しても利用できます。 

X のユーザーインターフェース内の video views メトリクスも同じ MRC 標準を使用していますが、X が所有・運営するプラットフォーム（モバイルアプリおよびウェブサイト）に表示される video views メトリクスと、さまざまな Engagement API エンドポイント経由で取得する数値の間に差異が生じる場合があることに注意してください。

* /totals エンドポイントおよび X のユーザーインターフェースで提供される video views は、該当動画が投稿されているすべてのポストを対象に集計された動画再生数を表示します。つまり、/totals 経由で提供され、X の UI に表示されるメトリクスには、その動画が別のポストでリポストまたはリツイートされたすべてのインスタンスからの再生数が合算されています。
* /28hour および /historical Engagement API エンドポイントで提供される video views には、メトリクスを取得している特定のポストによって生成されたビューのみが含まれます。 
   

1800 日より古いポストについては、video views を提供していない点に注意してください。その代わりに、1800 日より古いポストを列挙したオブジェクトを返します。リクエストしたポストに関するその他のすべてのメトリクスは、別のオブジェクトとして引き続き受け取ることができます。以下はレスポンスの例です。

```json
{
  "unsupported_for_video_views_tweet_ids": [
    "479311209565413376",
    "477139122520219648"
  ],
  "grouping name": {
    "479311209565413376": {
      "favorites": "69",
      "impressions": "1692",
      "retweets": "142",
      "video_views": "0"
    },
    "477139122520219648": {
      "favorites": "10",
      "impressions": "1023",
      "retweets": "6",
      "video_views": "0"
    },
    "1397568983931392004": {
      "favorites": "268",
      "impressions": "26803",
      "retweets": "56",
      "video_views": "17902"
    }
  }
}
```

Media Views 指標は、自社所有のポストに対してのみ、/28hour および /historical エンドポイントで利用できます。

<div id="engagement-api-groupings">
  ### Engagement API のグルーピング
</div>

グルーピングを使用すると、返されるエンゲージメントメトリクスを任意の方法で整理できます。1 回のリクエストに含められるグルーピングは最大 3 つです。メトリクスは、次の値のいずれか、または複数の値でグループ化できます。

*3 つすべてのエンドポイントでサポートされている値:*

* tweet.id
* engagement.type
   

*`/28hr` および `/historical` は時系列メトリクスを提供できるため、次の値もサポートします:*

* engagement.day
* engagement.hour

グルーピングは指定した順序で適用されるため、`group_by` の値の順序を変更することで、望ましい結果フォーマットに変更できます。4 つの `group_by` 値を含むグルーピングは、次の 2 つのいずれかの形式でのみサポートされます。

```bash
"group_by": [
    "tweet.id",
    "engagement.type",
    "engagement.day",
    "engagement.hour"
  ]
```

または

```bash
"group_by": [
    "engagement.type",
    "tweet.id",
    "engagement.day",
    "engagement.hour"
]
```

たとえば、メトリックタイプごとの総計を生成したい場合は、リクエストの一部として次の「groupings」指定を含めます（リクエストの組み立て方法について詳しくは、[API Reference](/ja/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#post-insights-engagement) ページを参照してください）：

```json
{
  "engagement_types": [
    "favorites",
    "replies",
    "retweets"
  ],
  "groupings": {
    "Grand Totals": {
      "group_by": [
        "engagement.type"
      ]
    }
  }
}
```

このようにグループ化すると、Engagement API の JSON レスポンスには、メトリクスタイプごとの総計を含むルートレベルの `"Grand Totals"` 属性が含まれるようになります。

```json
{
  "総計": {
    "favorites": "12",
    "replies": "2",
    "retweets": "2"
  }
}
```

単一のポストについて、ポストIDごとにグループ化された4時間分のメトリクスの時系列データを生成するには、リクエストに次の Grouping 指定を含めます。

```json
{
  "start": "2016-02-10T17:00:00Z",
  "end": "2016-02-10T21:00:00Z",
  "tweet_ids": [
    "697506383516729344"
  ],
  "engagement_types": [
    "impressions",
    "engagements"
  ],
  "groupings": {
    "Tweets_MetricType_TimeSeries": {
      "group_by": [
        "tweet.id",
        "engagement.type",
        "engagement.hour"
      ]
    }
  }
}
```

このグルーピングを使用すると、Engagement API の JSON レスポンスには、ポスト ID、メトリクスタイプごとに分解されたメトリクスと、それに対応する 1 時間ごとの時系列データを格納した、ルートレベルの `"Tweets_MetricType_TimeSeries"` 属性が含まれます。

```json
{
  "Tweets_MetricType_TimeSeries": {
    "697506383516729344": {
      "impressions": {
        "2016-02-10": {
          "17": "551",
          "18": "412",
          "19": "371",
          "20": "280"
        }
      },
      "engagements": {
        "2016-02-10": {
          "17": "8",
          "18": "6",
          "19": "3",
          "20": "0"
        }
      }
    }
  }
}
```

<div id="frequently-asked-questions">
  ## よくある質問
</div>

`Enterprise`

<div id="engagement-api">
  ### Engagement API
</div>

<AccordionGroup>
  <Accordion title="Engagement API にはどのようにアクセスできますか？">
    Engagement API へのアクセスは、Enterprise サブスクリプションを通じて提供されます。営業担当までご連絡いただくには、[このフォーム](/ja/x-api/enterprise-gnip-2.0/enterprise-gnip) にご記入ください。
  </Accordion>

  <Accordion title="@handle ごとの利用状況はどのようにトラッキングされますか？">
    契約に Engagement API と併用できるユニークな handle 数の上限が含まれている場合、X の内部システムは、Engagement API でクエリされたポストを所有する認証済みユーザー数を追跡します。お客様側でも、このユニークな数をクライアント側で管理しておく必要があります。現在、Engagement API の @handle 利用状況を確認するための Usage API や UI はありません。契約で定められた数より多くの @handle がリクエストされたとしても、システム側で自動的にブロックされることはありません。請求月の終わりに、クエリされたユニークな @handle の数が契約数量と比較され、契約条件に従って超過分が請求されます。
  </Accordion>

  <Accordion title="Engagement API の @handle 利用状況を確認できますか？">
    現在、Engagement API の @handle 利用状況を確認するための Usage API や UI はありません。契約で定められた数より多くの @handle がリクエストされたとしても、システム側で自動的にブロックされることはありません。請求月の終わりに、クエリされたユニークな @handle の数が契約数量と比較され、契約条件に従って超過分が請求されます。

    **ペイロードで返される `engagements` メタデータフィールドが、各種エンゲージメントメトリクス合計の総和と一致しません。なぜですか？**

    これは想定どおりの動作です。`engagements` メタデータフィールドは、API から返される個々のエンゲージメントメトリクスの合計値と必ずしも一致しない場合があります。これは、`engagements` メタデータフィールドに、ペイロード内で個別のメトリクスとして分解されていない追加のエンゲージメントが含まれている可能性があるためです。言い換えると、さまざまなエンゲージメントメトリクスの合計値をすべて足し合わせても、ペイロード内で返される `engagements` メトリクスフィールドの値と一致しない場合があります。

    `engagements` メタデータフィールドは、そのポスト上で行われたあらゆるクリックやインタラクションを表すものと考えてください。
     

    **ペイロードレスポンスの `url_clicks` フィールドに数値が返されていますが、実際にはポストに URL が含まれていません。これはなぜですか？**

    ハッシュタグのように、別のページへのリンクを生成する要素を含むポストの場合、ユーザーがそれをクリックすると URL クリックとしてカウントされることがあるためです。
     
  </Accordion>

  <Accordion title="特定のポストのエンゲージメントデータを取得できないのはなぜですか？">
    特定のポストについてエンゲージメントデータを取得できない理由はいくつか考えられます。たとえば次のようなケースです。

    * リクエストしたポスト ID が、第三者の代わりにデータを取得するために使用している認証トークンでは利用できない。
    * /totals エンドポイント向けにリクエストしたポスト ID が 90 日より前のものであり、そのためインプレッションまたはエンゲージメントメトリクスを返す対象外になっている。
    * リクエストしたポスト ID がもはや利用できない（通常は、削除されたか、その他の理由で公開されなくなっていることを示します）。

    上記のいずれかの場合に受け取る可能性が高い、さまざまな[エラーメッセージ](/ja/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#error-messages)をご確認ください。
  </Accordion>

  <Accordion title="Engagement API のレート制限はどのように処理できますか？">
    Engagement API へのリクエスト時にレスポンスヘッダーで返される `x-per-minute-limit` と `x-per-minute-remaining` の情報を使用して、利用状況を監視できます。

    `x-per-minute-limit` は許可されている上限を示し、`x-per-minute-remaining` は残りの呼び出し回数を示します。
  </Accordion>
</AccordionGroup>

<div id="error-troubleshooting-guide">
  ### エラーのトラブルシューティングガイド
</div>

<AccordionGroup>
  <Accordion title="認証で問題が発生しています">
    Engagement API での認証については、必ず [認証に関するガイドライン](/ja/x-api/enterprise-gnip-2.0/fundamentals/engagement-api#authentication) を確認してください。
  </Accordion>

  <Accordion title="正しい consumer key と secret に加えて、access token と access token secret も渡していますが、次のエラーが返されます。どうすればよいですか？">
    ```bash
    [
        Your account could not be authenticated. Reason: Unknown Authorization Type;
    ]
    ```

    /totals エンドポイントで認証を試すときには、アクセストークンやシークレットを一切使用しないようにしてください。これらのトークンを含めて、それらのトークンに関連付けられていないポストからコンテンツを取得しようとすると、次のようなエラーが発生する可能性があります。

    ```bash
    [
        Forbidden to access tweets: 1054424731825229824;
    ]
    ```
  </Accordion>
</AccordionGroup>

<div id="still-cant-find-what-youre-looking-for">
  ### それでもお探しの情報が見つかりませんか？
</div>

<AccordionGroup>
  <Accordion title="まだ解決していないご質問があります">
    テクニカルサポートまでお問い合わせください。速やかにご連絡いたします。
  </Accordion>
</AccordionGroup>

<div id="api-reference">
  ## API リファレンス
</div>

<div id="post-insightsengagement">
  ### **POST insights/engagement**
</div>

<div id="methods">
  #### **Methods**
</div>

| Method | Description |
| :--- | :--- |
| [POST /insights/engagement/totals](#Totals) | 一連のポストに対する合計インプレッション数とエンゲージメント数を取得します。 |
| [POST /insights/engagement/historical](#Historical) | 一連のポストに対するインプレッション数とエンゲージメント数を、2014年9月1日まで遡り、最長4週間の期間にわたって取得します。 |
| [POST /insights/engagement/28hr](#api-28hr) | 過去28時間における一連のポストに対するインプレッション数とエンゲージメント数を取得します。 |

<div id="authentication">
  #### **認証**
</div>

Engagement API を利用するには HTTPS が必須であり、User Context と Application-Only OAuth の両方をサポートしています。Engagement API へのほとんどのリクエストでは 3-Legged OAuth（User Context の一種）の利用が必要です。これは、Engagement API へのアクセス用にあなたの Twitter アカウントマネージャーによって登録・承認されたアプリの consumer key と consumer secret に加え、ポストの所有者のアクセストークンとアクセストークンシークレットを使用してエンドポイントを呼び出すことを意味します。次のリクエストには、この種類の OAuth が必要です。

* /totals への、Impressions および Engagements メトリクス種別を取得するための任意のリクエスト（これらは所有しているポストに限定されます）
* /28hr への任意のリクエスト
* /historical への任意のリクエスト

Engagement API への一部のリクエストは Application-Only OAuth を使用して実行できます。この場合、consumer key と consumer secret、または bearer token のいずれかを提供するだけで済みます。次のリクエストは、この種類の OAuth で実行できます。

* /totals への、Favorites、Replies、Retweets、または Video Views メトリクス種別を取得するための任意のリクエスト（任意のポストを対象に取得できます）

いずれのリクエストでも、まず Twitter アプリを作成し、[developer.x.com](https://developer.x.com/en/portal/dashboard) で利用可能なアプリ管理コンソールを使用して、対応する API key を設定する必要があります。

注意: developer.x.com 上で Twitter アカウントにログインしている場合は、既存の [Twitter apps](/ja/resources/fundamentals/developer-apps) を [Twitter app dashboard](https://developer.x.com/en/apps) から表示および編集できます。

アプリを設定したら、その app ID は Engagement API へのリクエストをアプリから行えるようにするため、担当のアカウント代表者の承認を受ける必要があります。アクセストークンは「現在のユーザー」を表すために使用され、別のユーザーに代わって行われるリクエストは、有効なトークンで署名されていなければなりません。OAuth の署名ベース文字列を作成する前に、URL や POST 本文内で[予約文字をエンコード](https://tools.ietf.org/html/rfc3986)していることを確認してください。

OAuth の利用を開始する方法の詳細については、次のリンクを参照してください。

* [OAuth の概要](/ja/resources/fundamentals/authentication)
* [User Context としても知られる 3-Legged OAuth の使用](/ja/resources/fundamentals/authentication#obtaining-access-tokens-using-3-legged-oauth-flow)
* [Application-Only OAuth の使用](/ja/resources/fundamentals/authentication#bearer-token-also-known-as-app-only)

<div id="post-insightsengagementtotals">
  #### **POST /insights/engagement/totals**
</div>

この totals エンドポイントを使用すると、最大 250 件までのポストのコレクションについて、現在の合計インプレッション数およびエンゲージメント数を取得できます。

|                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| :--------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **リクエストメソッド**          | HTTP POST                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **URL**                | `https://data-api.x.com/insights/engagement/totals`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **Content-Type**       | `application/json`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **圧縮方式**               | Gzip。Gzip 圧縮を使用してリクエストを行うには、接続リクエストで Accept-Encoding ヘッダーを送信します。  <br />ヘッダーは次のように指定します。  <br />  <br />`Accept-Encoding: gzip`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **POST の形式**           | リクエストは、本文にポストIDのコレクションと目的のグルーピングを含む JSON オブジェクトを指定した POST リクエストとして送信できます。POST 本文は、`tweets`、`engagements`、`groupings` オブジェクトを含む配列としてフォーマットされます。1 回のリクエストで指定できるポストIDは最大 250 個です。  <br />  <br />POST 本文の例は次のとおりです:  <br />  <br /><br />  &#123;<br />    &quot;tweet&#95;ids&quot;: [<br />        &quot;Tweet ID 1&quot;,<br />        &quot;Tweet ID 2&quot;,<br />        &quot;Tweet ID 3&quot;<br />    ],<br />      &quot;engagement&#95;types&quot;: [<br />        &quot;impressions&quot;,<br />        &quot;engagements&quot;,<br />        &quot;favorites&quot;,<br />        &quot;quote&#95;tweets&quot;<br />    ],<br />    &quot;groupings&quot;: &#123;<br />      &quot;grouping name&quot;: &#123;<br />        &quot;group&#95;by&quot;: [<br />          &quot;tweet.id&quot;,<br />          &quot;engagement.type&quot;<br />        ]<br />      &#125;<br />    &#125;<br />  &#125;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **ポストID**              | エンゲージメントデータを取得する対象となるポストのポストIDを含む配列です。認証に使用している @handle が作成したポストに対してのみデータをリクエストできる点に注意してください。1 回のリクエストに含められるポストは最大 250 件で、ポストIDは文字列として指定する必要があります。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **エンゲージメント種別**         | クエリ対象とするエンゲージメントメトリクスの種類を含む配列です。Totals エンドポイントでサポートされるエンゲージメントタイプは、次のもののみです：`impressions`, `engagements`, `favorites`, `retweets`, `quote_tweets`, `replies`, `video_views`。  <br />`/totals` エンドポイントでは、過去 90 日以内に作成されたポストについては `impressions` と `engagements` を取得でき、すべてのポストについては `favorites`, `retweets`, `quote_tweets`, `replies`, `video_views` を取得できます。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **グループ化**              | Engagement API の結果は、ニーズに最も適した形になるよう、さまざまなグループ分けで返すことができます。1 回のリクエストに含められるグルーピングは最大 3 つです。  <br />  <br />各グルーピングごとに、アプリケーション内でこのグルーピングタイプを参照しやすくするためのカスタムのグルーピング名を定義できます。  <br />  <br />グルーピング名を定義したら、`tweet.id` および/または `engagement.type` でグループ化することができます。  <br />  <br />グルーピングは指定した順序で適用されるため、group&#95;by の値の順序を変更することで、取得したい結果の形式を変えることができます。ポスト ID とメトリクス種別ごとに分割されたメトリクスを表示するグルーピングの例は次のとおりです。  <br />  <br /><br />  &quot;groupings&quot;: &#123;<br />      &quot;my grouping name&quot;: &#123;<br />        &quot;group&#95;by&quot;: [<br />          &quot;tweet.id&quot;,<br />          &quot;engagement.type&quot;<br />        ]<br />      &#125;<br />    &#125;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **POST バッチサイズ上限**      | 1回のリクエストで指定できるポストIDは最大で250件です。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **レスポンス形式**            | JSON。レスポンス形式として JSON を指定するよう、リクエストヘッダーを設定する必要があります。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **レート制限**              | アクセスレベルに応じて、ご契約で定められた 1 分あたりのレート制限が適用されます。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **リクエスト例（パブリックメトリクス）** | curl --request POST <br />  --url [https://data-api.x.com/insights/engagement/totals](https://data-api.x.com/insights/engagement/totals) <br />  --header &#39;accept-encoding: gzip&#39; <br />  --header &#39;authorization: Bearer &#39; <br />  --header &#39;content-type: application/json&#39; <br />  --data &#39;&#123;<br />                &quot;tweet&#95;ids&quot;: [<br />                    &quot;1070059276213702656&quot;,&quot;1021817816134156288&quot;,&quot;1067094924124872705&quot;<br />                ],<br />                &quot;engagement&#95;types&quot;: [<br />                    &quot;favorites&quot;,&quot;retweets&quot;,&quot;replies&quot;,&quot;quote&#95;tweets&quot;,&quot;video&#95;views&quot;<br />                ],<br />                &quot;groupings&quot;: &#123;<br />                    &quot;perTweetMetricsUnowned&quot;: &#123;<br />                        &quot;group&#95;by&quot;: [<br />                            &quot;tweet.id&quot;,<br />                            &quot;engagement.type&quot;<br />                        ]<br />                    &#125;<br />                &#125;<br />            &#125; <br />  --verbose <br />  --compressed                                                                                                                                                                                                                                                                                                                                                       |
| **リクエスト例**             | curl --request POST <br />  --url [https://data-api.x.com/insights/engagement/totals](https://data-api.x.com/insights/engagement/totals) <br />  --header &#39;accept-encoding: gzip&#39; <br />  --header &#39;authorization: OAuth oauth&#95;consumer&#95;key=&quot;consumer-key-for-app&quot;,oauth&#95;nonce=&quot;generated-nonce&quot;,oauth&#95;signature=&quot;generated-signature&quot;,oauth&#95;signature&#95;method=&quot;HMAC-SHA1&quot;, oauth&#95;timestamp=&quot;generated-timestamp&quot;,oauth&#95;token=&quot;access-token-for-authed-user&quot;, oauth&#95;version=&quot;1.0&quot;&#39; <br />  --header &#39;content-type: application/json&#39; <br />  --data &#39;&#123;<br />                &quot;tweet&#95;ids&quot;: [<br />                    &quot;1060976163948904448&quot;,&quot;1045709644067471360&quot;<br />                ],<br />                &quot;engagement&#95;types&quot;: [<br />                    &quot;favorites&quot;,&quot;replies&quot;,&quot;retweets&quot;,&quot;video&#95;views&quot;,&quot;impressions&quot;,&quot;engagements&quot;<br />                ],<br />                &quot;groupings&quot;: &#123;<br />                    &quot;perTweetMetricsOwned&quot;: &#123;<br />                        &quot;group&#95;by&quot;: [<br />                            &quot;tweet.id&quot;,<br />                            &quot;engagement.type&quot;<br />                        ]<br />                    &#125;<br />                &#125;<br />            &#125;&#39; <br />  --verbose <br />  --compressed |
| **レスポンス例（公開メトリクス）**    | &#123;<br />  &quot;perTweetMetricsUnowned&quot;: &#123;<br />    &quot;1021817816134156288&quot;: &#123;<br />      &quot;favorites&quot;: &quot;530&quot;,<br />      &quot;quote&#95;tweets&quot;: &quot;79&quot;,<br />      &quot;replies&quot;: &quot;147&quot;,<br />      &quot;retweets&quot;: &quot;323&quot;,<br />      &quot;video&#95;views&quot;: &quot;0&quot;<br />    &#125;,<br />    &quot;1067094924124872705&quot;: &#123;<br />      &quot;favorites&quot;: &quot;1360&quot;,<br />      &quot;quote&#95;tweets&quot;: &quot;29&quot;,<br />      &quot;replies&quot;: &quot;56&quot;,<br />      &quot;retweets&quot;: &quot;178&quot;,<br />      &quot;video&#95;views&quot;: &quot;5754512&quot;<br />    &#125;,<br />    &quot;1070059276213702656&quot;: &#123;<br />      &quot;favorites&quot;: &quot;69&quot;,<br />      &quot;quote&#95;tweets&quot;: &quot;5&quot;,<br />      &quot;replies&quot;: &quot;7&quot;,<br />      &quot;retweets&quot;: &quot;26&quot;,<br />      &quot;video&#95;views&quot;: &quot;0&quot;<br />    &#125;<br />  &#125;<br />&#125;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **レスポンス例**             | &#123;<br />  &quot;perTweetMetricsOwned&quot;: &#123;<br />    &quot;1045709644067471360&quot;: &#123;<br />      &quot;engagements&quot;: &quot;2&quot;,<br />      &quot;favorites&quot;: &quot;0&quot;,<br />      &quot;impressions&quot;: &quot;47&quot;,<br />      &quot;replies&quot;: &quot;0&quot;,<br />      &quot;retweets&quot;: &quot;8&quot;,<br />      &quot;quote&#95;tweets&quot;: &quot;5&quot;,<br />      &quot;video&#95;views&quot;: &quot;0&quot;<br />    &#125;,<br />    &quot;1060976163948904448&quot;: &#123;<br />      &quot;engagements&quot;: &quot;4&quot;,<br />      &quot;favorites&quot;: &quot;0&quot;,<br />      &quot;impressions&quot;: &quot;148&quot;,<br />      &quot;replies&quot;: &quot;1&quot;,<br />      &quot;retweets&quot;: &quot;9&quot;,<br />      &quot;quote&#95;tweets&quot;: &quot;2&quot;,<br />      &quot;video&#95;views&quot;: &quot;0&quot;<br />    &#125;<br />  &#125;<br />&#125;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **利用できなくなったポストID**     | 利用できなくなったポストID（削除済みなど）がクエリに含まれている場合でも、利用可能なすべてのポストIDについては適切なデータが返され、利用できないポストIDは `unavailable_tweet_ids` という配列で示されます。例:  <br /><br />  &#123;<br />    &quot;start&quot;: &quot;2015-11-17T22:00:00Z&quot;,<br />    &quot;end&quot;: &quot;2015-11-19T02:00:00Z&quot;,<br />    &quot;unavailable&#95;tweet&#95;ids&quot;: [<br />        &quot;323456789&quot;<br />    ],<br />    &quot;group1&quot;: &#123;<br />     &quot;423456789&quot;: &#123;<br />      &quot;favorites&quot;: &quot;67&quot;,<br />      &quot;replies&quot;: &quot;8&quot;,<br />      &quot;retweets&quot;: &quot;26&quot;,<br />      &quot;quote&#95;tweets&quot;: &quot;2&quot;<br />     &#125;<br />    &#125;<br />  &#125;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |

<div id="post-insightsengagement28hr">
  #### **POST /insights/engagement/28hr**
</div>

28 時間エンドポイントでは、直近 28 時間における最大 25 件のポストのインプレッション数およびエンゲージメント数を取得できます。また、この 28 時間エンドポイントでは、サポートされているすべての個別メトリクスをリクエストすることも可能です。サポートされているメトリクスの一覧については、[Metric Availability](https://developer.x.com/en/docs/x-api/v1/metrics/get-tweet-engagement/overview#EngagementTypes) を参照してください。

|                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| :--------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **HTTPメソッド**     | HTTP POST                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **URL**          | `https://data-api.x.com/insights/engagement/28hr`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **Content-Type** | `application/json`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **圧縮方式**         | Gzip。Gzip 圧縮を使用してリクエストを送信するには、接続リクエストに Accept-Encoding ヘッダーを指定してください。  <br />ヘッダーは次のようになります。  <br />  <br />`Accept-Encoding: gzip`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **POST リクエスト形式** | リクエストは、ボディとして複数のポスト ID と希望するグルーピングを含む JSON オブジェクトを持つ POST リクエストとして送信できます。POST は、`tweets`、`engagements`、`groupings` オブジェクトを持つ配列として構成されます。各リクエストで指定できるポスト ID は最大 25 件です。  <br />  <br />POST ボディの例は次のとおりです。  <br />  <br /><br />  &#123;<br />    &quot;tweet&#95;ids&quot;: [<br />       &quot;Tweet ID 1&quot;,<br />       &quot;Tweet ID 2&quot;,<br />       &quot;Tweet ID 3&quot;<br />    ],<br />      &quot;engagement&#95;types&quot;: [<br />        &quot;impressions&quot;,<br />        &quot;engagements&quot;,<br />        &quot;url&#95;clicks&quot;,<br />        &quot;detail&#95;expands&quot;<br />    ],<br />    &quot;groupings&quot;: &#123;<br />      &quot;grouping name&quot;: &#123;<br />        &quot;group&#95;by&quot;: [<br />          &quot;tweet.id&quot;,<br />          &quot;engagement.type&quot;,<br />          &quot;engagement.hour&quot;<br />        ]<br />      &#125;<br />    &#125;<br />  &#125;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **ポストID**        | エンゲージメントデータを取得する対象ポストのポストIDを含む配列です。認証を行っている @handle が作成したポストについてのみデータをリクエストできる点に注意してください。28時間エンドポイントでは、1 回のリクエストにつき最大 25 件のポストIDまでサポートされており、ポストIDは文字列として指定する必要があります。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **エンゲージメント種別**   | 照会するエンゲージメントメトリクスの種類を含む配列です。  <br />  <br />28 時間エンドポイントでは、`impressions`、`engagements`、およびすべての個別のエンゲージメントタイプをメトリクスとして利用できます。サポートされているエンゲージメントメトリクスの全リストについては、[Engagement Data](https://developer.x.com/en/docs/x-api/v1/metrics/get-tweet-engagement/overview#AvailableData) を参照してください。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **グループ化**        | Engagement API の結果は、ニーズに最も適した形式になるよう、異なるグループで返すことができます。1 回のリクエストに含められるグルーピングは最大 3 つまでです。  <br />  <br />各グルーピングごとに、アプリケーション内でこのグルーピング種別を参照しやすくするためのカスタムグルーピング名を定義できます。グルーピング名を定義したら、次の値の 1 つ以上でグループ化することを選択できます。  <br />`tweet.id`  <br />`engagement.type`  <br />`engagement.day`  <br />`engagement.hour`  <br />グルーピングは指定した順番どおりに適用されるため、`group_by` の値の順序を変更することで、望む結果フォーマットに変更できます。ポスト ID、メトリクスタイプ、日別にメトリクスを分けて表示するグルーピングの例は次のようになります。<br /><br />  &quot;groupings&quot;: &#123;<br />    &quot;my grouping name&quot;: &#123;<br />      &quot;group&#95;by&quot;: [<br />        &quot;tweet.id&quot;,<br />        &quot;engagement.type&quot;,<br />        &quot;engagement.day&quot;<br />      ]<br />    &#125;<br />  &#125;<br /><br />  <br />4 つの `group_by` 要素を持つグルーピングは、次の 2 とおりの順序のいずれかを使用する場合にのみ有効です。1 つのグルーピング内で 4 つの `group_by` 要素を使用しながら、次のいずれにも当てはまらないリクエストはエラーを返します。さらに、1 回のリクエストで許可される 4 つの `group_by` 要素を持つグルーピングは 1 つだけです。  <br /><br />&quot;group&#95;by&quot;: [<br />    &quot;tweet.id&quot;,<br />    &quot;engagement.type&quot;,<br />    &quot;engagement.day&quot;,<br />    &quot;engagement.hour&quot;<br />  ]<br /><br />&quot;group&#95;by&quot;: [<br />    &quot;engagement.type&quot;,<br />    &quot;tweet.id&quot;,<br />    &quot;engagement.day&quot;,<br />    &quot;engagement.hour&quot;<br />  ]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **POST サイズ制限**   | 1 回のリクエストで指定できるポスト ID は最大 25 件です。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **レスポンスフォーマット**  | JSON。レスポンス形式として JSON を指定するよう、リクエストヘッダーを設定してください。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **レート制限**        | アクセスレベルに応じて、契約で定められた1分あたりのレート制限が適用されます。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **リクエスト例**       | curl -X POST &quot;[https://data-api.x.com/insights/engagement/28hr](https://data-api.x.com/insights/engagement/28hr)&quot; <br />  -H &#39;Accept-Encoding: gzip&#39; <br />  -H &#39;Authorization OAuth oauth&#95;consumer&#95;key=&quot;consumer-key-for-app&quot;,oauth&#95;nonce=&quot;generated-nonce&quot;,oauth&#95;signature=&quot;generated-signature&quot;,oauth&#95;signature&#95;method=&quot;HMAC-SHA1&quot;, oauth&#95;timestamp=&quot;generated-timestamp&quot;,oauth&#95;token=&quot;access-token-for-authed-user&quot;, oauth&#95;version=&quot;1.0&quot;&#39; <br />  -d &#39;&#123;<br />    &quot;tweet&#95;ids&quot;: [<br />       &quot;123456789&quot;<br />    ],<br />      &quot;engagement&#95;types&quot;: [<br />        &quot;impressions&quot;,<br />        &quot;engagements&quot;<br />    ],<br />    &quot;groupings&quot;: &#123;<br />      &quot;hourly-time-series&quot;: &#123;<br />        &quot;group&#95;by&quot;: [<br />          &quot;tweet.id&quot;,<br />          &quot;engagement.type&quot;,<br />          &quot;engagement.day&quot;,<br />          &quot;engagement.hour&quot;<br />        ]<br />      &#125;<br />    &#125;<br />  &#125;&#39;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **レスポンス例**       | &#123;<br />&quot;start&quot;:&quot;2015-09-14T17:00:00Z&quot;,<br />&quot;end&quot;:&quot;2015-09-15T22:00:00Z&quot;,<br />&quot;hourly-time-series&quot;:&#123;<br />&quot;123456789&quot;:&#123;<br />&quot;インプレッション&quot;:&#123;<br />&quot;2015-09-14&quot;:&#123;<br />&quot;17&quot;:&quot;551&quot;,<br />&quot;18&quot;:&quot;412&quot;,<br />&quot;19&quot;:&quot;371&quot;,<br />&quot;20&quot;:&quot;280&quot;,<br />&quot;21&quot;:&quot;100&quot;,<br />&quot;22&quot;:&quot;19&quot;,<br />&quot;23&quot;:&quot;6&quot;<br />&#125;,<br />&quot;2015-09-15&quot;:&#123;<br />&quot;00&quot;:&quot;5&quot;,<br />&quot;01&quot;:&quot;2&quot;,<br />&quot;02&quot;:&quot;7&quot;,<br />&quot;03&quot;:&quot;3&quot;,<br />&quot;04&quot;:&quot;1&quot;,<br />&quot;05&quot;:&quot;0&quot;,<br />&quot;06&quot;:&quot;0&quot;,<br />&quot;07&quot;:&quot;0&quot;,<br />&quot;08&quot;:&quot;0&quot;,<br />&quot;09&quot;:&quot;0&quot;,<br />&quot;10&quot;:&quot;0&quot;,<br />&quot;11&quot;:&quot;0&quot;,<br />&quot;12&quot;:&quot;0&quot;,<br />&quot;13&quot;:&quot;0&quot;,<br />&quot;14&quot;:&quot;0&quot;,<br />&quot;15&quot;:&quot;0&quot;,<br />&quot;16&quot;:&quot;0&quot;,<br />&quot;17&quot;:&quot;0&quot;,<br />&quot;18&quot;:&quot;0&quot;,<br />&quot;19&quot;:&quot;0&quot;,<br />&quot;20&quot;:&quot;0&quot;,<br />&quot;21&quot;:&quot;0&quot;<br />&#125;<br />&#125;,<br />&quot;エンゲージメント&quot;:&#123;<br />&quot;2015-09-14&quot;:&#123;<br />&quot;17&quot;:&quot;0&quot;,<br />&quot;18&quot;:&quot;0&quot;,<br />&quot;19&quot;:&quot;0&quot;,<br />&quot;20&quot;:&quot;0&quot;,<br />&quot;21&quot;:&quot;0&quot;,<br />&quot;22&quot;:&quot;0&quot;,<br />&quot;23&quot;:&quot;0&quot;<br />&#125;,<br />&quot;2015-09-15&quot;:&#123;<br />&quot;00&quot;:&quot;0&quot;,<br />&quot;01&quot;:&quot;0&quot;,<br />&quot;02&quot;:&quot;0&quot;,<br />&quot;03&quot;:&quot;0&quot;,<br />&quot;04&quot;:&quot;0&quot;,<br />&quot;05&quot;:&quot;0&quot;,<br />&quot;06&quot;:&quot;0&quot;,<br />&quot;07&quot;:&quot;0&quot;,<br />&quot;08&quot;:&quot;0&quot;,<br />&quot;09&quot;:&quot;0&quot;,<br />&quot;10&quot;:&quot;0&quot;,<br />&quot;11&quot;:&quot;0&quot;,<br />&quot;12&quot;:&quot;0&quot;,<br />&quot;13&quot;:&quot;0&quot;,<br />&quot;14&quot;:&quot;0&quot;,<br />&quot;15&quot;:&quot;0&quot;,<br />&quot;16&quot;:&quot;0&quot;,<br />&quot;17&quot;:&quot;0&quot;,<br />&quot;18&quot;:&quot;0&quot;,<br />&quot;19&quot;:&quot;0&quot;,<br />&quot;20&quot;:&quot;0&quot;,<br />&quot;21&quot;:&quot;0&quot;<br />&#125;<br />&#125;<br />&#125;<br />&#125;<br />&#125; |
| **取得できないポストID**  | 利用できなくなったポストID（例：削除されたもの）を含むクエリの場合、利用可能なすべてのポストIDに対しては適切なデータが返され、利用不可のポストIDは `unavailable_tweet_ids` という配列内で示されます。例えば：  <br /><br />  &#123;<br />    &quot;start&quot;: &quot;2015-11-17T22:00:00Z&quot;,<br />    &quot;end&quot;: &quot;2015-11-19T02:00:00Z&quot;,<br />    &quot;unavailable&#95;tweet&#95;ids&quot;: [<br />        &quot;323456789&quot;<br />    ],<br />    &quot;group1&quot;: &#123;<br />     &quot;423456789&quot;: &#123;<br />      &quot;favorites&quot;: &quot;67&quot;,<br />      &quot;replies&quot;: &quot;8&quot;,<br />      &quot;retweets&quot;: 26<br />     &#125;<br />    &#125;<br />  &#125;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |

<div id="post-insightsengagementhistorical">
  #### **POST /insights/engagement/historical**
</div>

historical エンドポイントでは、最大 25 件のポストのコレクションについて、最長 4 週間分の任意の期間におけるインプレッションおよびエンゲージメントを取得できます。現在、2014 年 9 月 1 日より前のデータは API からリクエストできません。historical エンドポイントでは、サポートされているすべての個別メトリクスについてメトリクスをリクエストすることもできます。サポートされているメトリクスの完全な一覧については、[Metric Availability](https://developer.x.com/en/docs/x-api/v1/metrics/get-tweet-engagement/overview#EngagementTypes) を参照してください。

|                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| :------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **リクエストメソッド**        | HTTP POST                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **URL**              | `https://data-api.x.com/insights/engagement/historical`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **Content-Type**     | `application/json`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **圧縮形式**             | Gzip。Gzip 圧縮を使用してリクエストを行うには、接続リクエストで Accept-Encoding ヘッダーを送信します。  <br />ヘッダーは次のように指定します。  <br />  <br />`Accept-Encoding: gzip`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **POST の形式**         | リクエストは、本文がポスト ID のコレクションと目的のグループ化条件を含む JSON オブジェクトである POST リクエストとして送信できます。POST の本文は、`tweets`、`engagements`、`groupings` オブジェクトを要素に持つ配列としてフォーマットされます。各リクエストには最大 25 個のポスト ID を含めることができます。各リクエストごとに、最長 4 週間の期間となるようカスタムの開始日と終了日を指定できます。  <br />  <br /><br />  &#123;<br />    &quot;tweet&#95;ids&quot;: [<br />       &quot;Tweet ID 1&quot;,<br />       &quot;Tweet ID 2&quot;,<br />       &quot;Tweet ID 3&quot;<br />    ],<br />      &quot;engagement&#95;types&quot;: [<br />        &quot;impressions&quot;,<br />        &quot;engagements&quot;,<br />        &quot;url&#95;clicks&quot;,<br />        &quot;detail&#95;expands&quot;<br />    ],<br />    &quot;groupings&quot;: &#123;<br />      &quot;grouping name&quot;: &#123;<br />        &quot;group&#95;by&quot;: [<br />          &quot;tweet.id&quot;,<br />          &quot;engagement.type&quot;,<br />          &quot;engagement.hour&quot;<br />        ]<br />      &#125;<br />    &#125;<br />  &#125;                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **開始日時と終了日時**        | リクエストの一部として、`start` と `end` の値を使用して、カスタムの開始日と終了日を指定できます。開始日と終了日は、期間が 4 週間を超えないように指定する必要があります。現時点で指定可能な最も古い開始日は 2014 年 9 月 1 日です。将来日時の終了日はサポートされていません。start と end の日付が指定されていない場合、API は直近の過去 4 週間をデフォルトとして使用します。  <br />  <br />Engagement API からデータを返す際の最小粒度は 1 時間単位です。start または end の値がちょうど 1 時間単位の境界になっていないリクエストでは、最も近い 1 時間単位の境界（開始は切り下げ、終了は切り上げ）に丸められます。たとえば、&quot;start&quot;:&quot;2015-07-01T12:24:00Z&quot; および &quot;end&quot;:&quot;2015-07-10T08:37:00Z&quot; というリクエストは、&quot;start&quot;:&quot;2015-07-01T12:00:00Z&quot;、&quot;end&quot;:&quot;2015-07-10T09:00:00Z&quot; に丸められます。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **ポストID**            | エンゲージメントデータを取得する対象となるポストのIDを含む配列です。認証を行っている @handle によって作成されたポストについてのみデータをリクエストできる点に注意してください。4 週間の履歴エンドポイントでは、1 回のリクエストにつき最大 25 件のポストがサポートされており、ポストIDは文字列として指定する必要があります。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **エンゲージメントの種類**      | エンゲージメントメトリクスの種類を指定する配列です。  <br />  <br />4週間履歴エンドポイントでは、`impressions`、`engagements`、およびすべての個別のエンゲージメントタイプがサポートされるメトリクスです。サポートされているエンゲージメントメトリクスの全リストについては、[Engagement Data（エンゲージメントデータ）](https://developer.x.com/en/docs/x-api/v1/metrics/get-tweet-engagement/overview#AvailableData) を参照してください。  <br />  <br />**注:** 現在、2015年9月15日より前を対象とするクエリでは、`favorites`、`replies`、`retweets` の 3 つのメトリクスは 0 として表示されます。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **グルーピング**           | Engagement API の結果は、ニーズに最適な形になるように、さまざまなグループ分けで取得できます。1 回のリクエストに含めることができるグルーピングは最大 3 つです。  <br />  <br />各グルーピングごとにカスタムのグルーピング名を定義でき、アプリケーション内でこのグルーピングタイプを参照しやすくできます。グルーピング名を定義したら、次の値のうち 1 つ以上でグループ化できます。  <br />`tweet.id`  <br />`engagement.type`  <br />`engagement.day`  <br />`engagement.hour`  <br />グルーピングは配列内の順序どおりに適用されるため、`group&#95;by` の値の順序を変更することで、望ましい結果フォーマットを変更できます。ポスト ID、メトリクスタイプ、日別にメトリクスを区分して表示するグルーピングの例は次のとおりです。<br /><br />  &quot;groupings&quot;: &#123;<br />    &quot;my grouping name&quot;: &#123;<br />      &quot;group&#95;by&quot;: [<br />        &quot;tweet.id&quot;,<br />        &quot;engagement.type&quot;,<br />        &quot;engagement.day&quot;<br />      ]<br />    &#125;<br />  &#125;<br /><br />  <br />4 つの `group_by` 項目を持つグルーピングは、次の 2 通りのいずれかの順序で指定されている場合にのみ有効です。1 つのグルーピングの中で 4 つの `group_by` 項目を持ち、かつ次のいずれにも当てはまらないリクエストはエラーを返します。さらに、1 回のリクエストで許可される 4 つの `group_by` 項目を持つグルーピングは 1 つだけです。  <br /><br />&quot;group&#95;by&quot;: [<br />    &quot;tweet.id&quot;,<br />    &quot;engagement.type&quot;,<br />    &quot;engagement.day&quot;,<br />    &quot;engagement.hour&quot;<br />  ]<br /><br />&quot;group&#95;by&quot;: [<br />    &quot;engagement.type&quot;,<br />    &quot;tweet.id&quot;,<br />    &quot;engagement.day&quot;,<br />    &quot;engagement.hour&quot;<br />  ]                                            |
| **POST リクエストサイズの上限** | 一度にリクエストできるポスト ID は最大 25 件です。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **レスポンス形式**          | JSON。レスポンスが JSON 形式となるよう、リクエストヘッダーで JSON を指定してください。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **レート制限**            | アクセスレベルに応じて契約で定められたとおり、1分単位のレート制限が適用されます。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **リクエスト例**           | curl -XPOST &quot;[https://data-api.x.com/insights/engagement/historical](https://data-api.x.com/insights/engagement/historical)&quot; <br />  -H &#39;Accept-Encoding: gzip&#39; <br />  -H &#39;Authorization OAuth oauth&#95;consumer&#95;key=&quot;consumer-key-for-app&quot;,oauth&#95;nonce=&quot;generated-nonce&quot;,oauth&#95;signature=&quot;generated-signature&quot;,oauth&#95;signature&#95;method=&quot;HMAC-SHA1&quot;, oauth&#95;timestamp=&quot;generated-timestamp&quot;,oauth&#95;token=&quot;access-token-for-authed-user&quot;, oauth&#95;version=&quot;1.0&quot;&#39; <br />  -d &#39;&#123;<br />    &quot;start&quot;: &quot;2015-08-01&quot;,<br />    &quot;end&quot;: &quot;2015-08-15&quot;,<br />    &quot;tweet&#95;ids&quot;: [<br />       &quot;123456789&quot;,<br />       &quot;223456789&quot;,<br />       &quot;323456789&quot;<br />    ],<br />      &quot;engagement&#95;types&quot;: [<br />        &quot;impressions&quot;,<br />        &quot;engagements&quot;,<br />        &quot;url&#95;clicks&quot;,<br />        &quot;detail&#95;expands&quot;<br />    ],<br />    &quot;groupings&quot;: &#123;<br />      &quot;types-by-tweet-id&quot;: &#123;<br />        &quot;group&#95;by&quot;: [<br />          &quot;tweet.id&quot;,<br />          &quot;engagement.type&quot;<br />        ]<br />      &#125;<br />    &#125;<br />  &#125;&#39; |
| **レスポンス例**           | &#123;<br />    &quot;start&quot;: &quot;2015-08-01T00:00:00Z&quot;,<br />    &quot;end&quot;: &quot;2015-08-15T00:00:00Z&quot;,<br />    &quot;types-by-tweet-id&quot;: &#123;<br />      &quot;123456789&quot;: &#123;<br />        &quot;impressions&quot;: &quot;0&quot;,<br />        &quot;engagements&quot;: &quot;0&quot;,<br />        &quot;url&#95;clicks&quot;: &quot;0&quot;,<br />        &quot;detail&#95;expands&quot;: &quot;0&quot;<br />      &#125;,<br />      &quot;223456789&quot;: &#123;<br />        &quot;impressions&quot;: &quot;788&quot;,<br />        &quot;engagements&quot;: &quot;134&quot;,<br />        &quot;url&#95;clicks&quot;: &quot;30&quot;,<br />        &quot;detail&#95;expands&quot;: &quot;1323&quot;<br />      &#125;,<br />      &quot;323456789&quot;: &#123;<br />        &quot;impressions&quot;: &quot;4&quot;,<br />        &quot;engagements&quot;: &quot;0&quot;,<br />        &quot;url&#95;clicks&quot;: &quot;2&quot;,<br />        &quot;detail&#95;expands&quot;: &quot;0&quot;<br />      &#125;<br />    &#125;<br />  &#125;                                                                                                                                                                                                                                                                                                      |
| **利用不可のポストID**       | 利用できなくなったポストID（例: 削除されたものなど）を含むクエリの場合、利用可能なすべてのポストIDについては適切なデータが返され、利用できないポストIDは `unavailable_tweet_ids` という配列で示されます。例:<br /><br />&#123;<br />    &quot;start&quot;: &quot;2015-11-17T22:00:00Z&quot;,<br />    &quot;end&quot;: &quot;2015-11-19T02:27:50Z&quot;,<br />    &quot;unavailable&#95;tweet&#95;ids&quot;: [<br />        &quot;323456789&quot;<br />    ],<br />    &quot;group1&quot;: &#123;<br />     &quot;423456789&quot;: &#123;<br />      &quot;favorites&quot;: &quot;67&quot;,<br />      &quot;replies&quot;: &quot;8&quot;,<br />      &quot;retweets&quot;: 26<br />     &#125;<br />    &#125;<br />  &#125;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |

<div id="response-codes">
  #### **レスポンスコード**
</div>

| Status | Text | Description |
| :--- | :--- | :--- |
| 200 | OK  | リクエストは正常に処理されました。 |
| 400 | Bad Request | 一般的に、このレスポンスは、リクエスト内に無効な JSON が含まれている場合、または JSON ペイロードがまったく送信されなかった場合に返されます。 |
| 401 | Unauthorized | 無効な認証情報により HTTP 認証に失敗しました。OAuth のキーとトークンを確認してください。 |
| 404 | Not Found | リクエストが送信された URL にリソースが存在しません。誤った URL を使用した可能性があります。 |
| 429 | Too Many Requests | アプリが API リクエストの上限を超えました。 |
| 500 | Internal Server Error | Gnip 側でエラーが発生しました。指数バックオフ方式でリクエストを再試行してください。 |
| 502 | Proxy Error | Gnip 側でエラーが発生しました。指数バックオフ方式でリクエストを再試行してください。 |
| 503 | Service Unavailable | Gnip 側でエラーが発生しました。指数バックオフ方式でリクエストを再試行してください。 |

<div id="error-messages">
  #### **エラーメッセージ**
</div>

さまざまな状況において、Engagement API は状況に応じたエラーメッセージを返します。アプリケーション側では、これらに適切に対応できるようにしておく必要があります。以下の表では、代表的なエラーメッセージの例と、その解釈方法を示します。多くの場合、Engagement API は 200 OK レスポンスの一部として、利用可能なデータの部分的な結果と、より詳しい情報を含む特定のエラーメッセージを同時に返す点に注意してください。

| Error Message | 説明 |
| :--- | :--- |
| `"errors":["Your account could not be authenticated. Reason: Access token not found"]` | リクエストの認証部分で発生したエラーです。“Reason” フィールドに、トラブルシューティングに役立つ情報が含まれます。ご自身で解決できない場合は、“Reason” を含むエラー全体をサポートチームまでお送りください。 |
| `"errors":["1 Tweet ID(s) are unavailable"],"unavailable_tweet_ids": ["TWEET_IDS"]` | リクエストした Tweet ID が 1 つ以上利用できない状態です。通常は、削除されたか、別の理由により公開されていないことを示します。 |
| `"errors":["Impressions & engagements for tweets older than 90 days (*TIME_PERIOD*) are not supported"],"unsupported_for_impressions_engagements_tweet_ids":[*TWEET_IDS*]` | /totals エンドポイント向けにリクエストした Tweet ID が、90 日よりも前に投稿されたポストであるため、そのポストのインプレッションまたはエンゲージメントのメトリクスを返すことができません。 |
| `"errors":["Forbidden to access tweets: *TWEET_IDS*"]` | 第三者に代わってデータを取得する際に使用しているアクセストークンの権限に基づき、リクエストした Tweet ID のポストにはアクセスできません。 |