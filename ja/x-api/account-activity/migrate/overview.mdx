---
title: v2 Account Activity API マイグレーションガイド
keywords: ["Account Activity API マイグレーション", "AAA マイグレーション", "v2 マイグレーション", "API マイグレーションガイド", "v2 へ移行する", "Account Activity API v2"]
---

このガイドでは、従来の Enterprise Account Activity API から v2 Account Activity API への移行方法を説明します。コアとなる機能は同じですが、エンドポイント構造と認証方法は、X API v2 と整合性を保つように更新されています。

<div id="summary-of-changes">
  ### 変更内容の概要
</div>

* **API Format**: エンドポイントのベースパスは /1.1/account\_activity/ から /2/account\_activity/ に変更されています。  
* **Webhook Management**: webhook の作成、一覧取得、検証（CRC）、削除は [V2 Webhooks API](https://github.com/m-rosinsky/XWebhookTest/blob/main/app.py) で行われます。  
* **Authentication**: V2 エンドポイントには次のいずれかが必要です。  
  * ユーザー単位の操作（例: ユーザーの購読）には **OAuthUser**（3-legged OAuth）。  
  * アプリレベルの操作（例: 購読の一覧取得/削除）には **OAuth2 App Only**（Bearer Token）。  
  * V1.1 では要件がさまざまで、多くの場合 OAuth 1.0a が使用されていました。  
* **Endpoint Mapping**:

| V1.1 Endpoint | V2 の対応エンドポイント / アクション | 注記 |
| ----- | ----- | ----- |
| POST /1.1/account\_activity/webhooks.json?url=\<URL\> | POST /2/webhooks | [Docs](https://docs.x.com/x-api/webhooks/introduction)。OAuth2AppOnly が必要です。 |
| GET /1.1/account\_activity/webhooks.json | GET /2/webhooks | [Docs](https://docs.x.com/x-api/webhooks/introduction)。OAuth2AppOnly が必要です。 |
| PUT /1.1/account\_activity/webhooks/:webhook\_id.json | PUT /2/webhooks/:webhook\_id | CRC をトリガーします。[Docs](https://docs.x.com/x-api/webhooks/introduction)。OAuth2AppOnly が必要です。 |
| DELETE /1.1/account\_activity/webhooks/:webhook\_id.json | DELETE /2/webhooks/:webhook\_id | [Docs](https://docs.x.com/x-api/webhooks/introduction)。OAuth2AppOnly が必要です。 |
| POST /1.1/account\_activity/webhooks/:webhook\_id/subscriptions/all.json | POST /2/account\_activity/webhooks/:webhook\_id/subscriptions/all | OAuthUser が必要です。 |
| GET /1.1/account\_activity/subscriptions/count.json | GET /2/account\_activity/subscriptions/count | OAuth2AppOnly が必要です。 |
| GET /1.1/account\_activity/webhooks/:webhook\_id/subscriptions/all.json | GET /2/account\_activity/webhooks/:webhook\_id/subscriptions/all | OAuthUser が必要です。 |
| GET /1.1/account\_activity/webhooks/:webhook\_id/subscriptions/all/list.json | GET /2/account\_activity/webhooks/:webhook\_id/subscriptions/all/list | OAuth2AppOnly が必要です。 |
| DELETE /1.1/account\_activity/webhooks/:webhook\_id/subscriptions/:user\_id/all | DELETE /2/account\_activity/webhooks/:webhook\_id/subscriptions/:user\_id/all | OAuth2AppOnly が必要です。 |
| DELETE /1.1/account\_activity/webhooks/:webhook\_id/subscriptions/all | 廃止 / 直接対応するものはありません | 個別削除を使用するか、DELETE /2/webhooks/:webhook\_id によって webhook を削除してください。 |

* **Response Formats**: 成功およびエラー時のレスポンス構造については、AAAPI ドキュメントを確認してください。

移行時には、新しいベースパスを使用するようコードを更新し、認証フローを調整し、[V2 Webhooks API](https://docs.x.com/x-api/webhooks/introduction) を使用して webhook を管理してください。

<div id="how-to-migrate">
  ### 移行方法
</div>

* **パッケージを決定する**:  
  * Account Activity API へのアクセス用に Enterprise または Pro パッケージを選択し、次の点を考慮します:  
    * 必要な webhook の数。  
    * 現在および将来を見込んだサブスクリプション数または認可ユーザー数。  
    * X クライアントアプリの数。  
    * 希望するサポートレベル（フォーラム vs. マネージドな Enterprise 向け 1:1 サポート）。  
    * 価格の詳細（Enterprise については営業担当にお問い合わせください）。  
* **認証を OAuth 2.0 に更新する**:  
  * X アプリに「読み取り、書き込み、ダイレクトメッセージへのアクセス」の権限が付与されていることを確認します。  
  * V2 エンドポイント用に OAuth 2.0 認証へ更新します。スコープが変更された場合は、ユーザーを再認可してください。  
  * Developer Portal を使用して次を管理します:  
    * OAuth 2.0 アクセストークン。  
    * Client ID と Client Secret。  
* **Webhook を検証または再設定する**:  
  * 既存の webhook URL を使用するか、新しい URL（例: https://your\_domain.com/webhook/twitter）を設定します。  
  * [V2 Webhooks API ドキュメント](https://docs.x.com/x-api/webhooks/introduction)に従って、webhook を登録および管理します。  
* **サンプルアプリ**:  
  * [Simple webhook server](https://github.com/m-rosinsky/XWebhookTest/blob/main/app.py)  
    * CRC チェックへの応答方法と POST イベントを受け付ける方法を示す、単一の Python スクリプトです。  
  * [Account Activity API sample dashboard](https://github.com/xdevplatform/account-activity-dashboard-enterprise/tree/master)  
    * webhook とサブスクリプションを管理し、アプリ内で直接ライブイベントを受信できる、[bun.sh](http://bun.sh) で記述された Web アプリです。