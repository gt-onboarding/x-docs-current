---
keywords: ["Account Activity API", "AAA", "webhooks", "アカウントイベント", "ユーザーアクティビティ", "リアルタイムイベント", "アクティビティサブスクリプション", "webhook events"]
---

<div id="v2-account-activity-api">
  # V2 Account Activity API
</div>

<Note>
  Account Activity API v2 は、[**Pro**](https://developer.x.com/en/portal/products) で利用可能です。
</Note>

<div id="overview">
  ## 概要
</div>

Account Activity API (AAA) は、webhook を通じて X ユーザーアカウントに関連するイベントをリアルタイムで受信できるようにします。特定のユーザーアカウントを事前に設定した webhook にサブスクライブすることで、1 つの接続から、自分が所有またはサブスクライブしているアカウントの 1 つ以上について、ポスト、ダイレクトメッセージ、いいね、フォロー、ブロックなど、さまざまなアクティビティの通知をアプリケーションで受け取ることができます。\
この API は、ユーザーアクションに即座に反応する必要があるアプリケーションや、ユーザーのアクティビティに基づいて常に最新の状態を維持する必要があるアプリケーションを構築する際によく利用されます。webhook の登録ごとに、各ユーザーサブスクリプションについて、以下に示すすべての関連アクティビティを受信します。

<div id="activity-types">
  ## アクティビティの種類
</div>

* **ポスト**（ユーザーによる）
* **ポストの削除**（ユーザーによる）
* **@メンション**（ユーザーへの）
* **返信**（ユーザーから／ユーザーへの）
* **リポスト**（ユーザーによる／ユーザーに対する）
* **引用ポスト**（ユーザーによる／ユーザーに対する）
* **引用ポストのリポスト**（ユーザーによる／ユーザーに対する）
* **いいね**（ユーザーによる／ユーザーに対する）
* **フォロー**（ユーザーによる／ユーザーに対する）
* **フォロー解除**（ユーザーによる／ユーザーに対する）
* **ブロック**（ユーザーによる／ユーザーに対する）
* **ブロック解除**（ユーザーによる／ユーザーに対する）
* **ミュート**（ユーザーによる／ユーザーに対する）
* **ミュート解除**（ユーザーによる／ユーザーに対する）
* **ダイレクトメッセージ送信**（ユーザーが送信）
* **ダイレクトメッセージ受信**（ユーザーが受信）
* **入力中インジケーター**（ユーザー宛）
* **既読通知**（ユーザー宛）
* **サブスクリプションの解除**（ユーザーによる）

**注記**: Account Activity API ではホームタイムラインのデータは配信していません。このデータを取得するには、User Posts timeline by User ID エンドポイントを使用してください。

<div id="feature-summary">
  ## 機能概要
</div>

| Tier | 料金 | ユニークなサブスクリプション数 | Webhook 数 |
| :----- | :----- | :----- | :----- |
| Pro | $5,000/月 | 3 | 1 |
| Enterprise | [営業担当にお問い合わせ](/ja/enterprise/forms/enterprise-api-interest) | 5000+ | 5+ |

このドキュメントでは、v2 Account Activity API のエンドポイントを使用して、webhook に関連付けられたユーザーサブスクリプションを管理する方法について説明します。

<div id="manage-subscriptions">
  ## サブスクリプションを管理する
</div>

Account Activity API は、あなたのサービスにサブスクライブしている X アカウントでイベントが発生するたびに、webhook ベースの JSON メッセージを送信します。X はそれらのアクティビティを登録済みの webhook に配信します。以下の手順では、ユーザーアカウントのサブスクリプションを設定および管理する方法を説明します。

<Warning>
  Account Activity API v2 は現在、User Auth 2.0 をサポートしていません。現在この対応を進めており、OAuth 2.0 がサポートされ次第、本ドキュメントを更新します。
</Warning>

<div id="1-create-an-x-app">
  ### 1. Xアプリを作成する
</div>

[developer portal](https://developer.x.com/en/portal/products/enterprise) で承認済みの開発者アカウントを使って、Xアプリを作成します。自社を代表してアプリを作成する場合は、企業のXアカウントを使用してください。

* アプリページの「Permissions」タブで「Read, Write, and Access direct messages」を有効にします。
* 「Keys and Access Tokens」タブで、アプリの **Consumer Key (API Key)**、**Consumer Token (API Secret)**、および **Bearer Token** をメモしておきます。
* アプリの **Access Token** と **Access Token Secret** を生成します。これらはユーザーアカウントのサブスクリプションを作成する際に必要です。
* Xへのサインインやユーザーコンテキストに不慣れな場合は、[Obtaining Access Tokens](https://developer.x.com/en/docs/authentication) を参照してください。
* developer portal の「Apps」ページで、アプリの数値の id をメモしておきます。これは Account Activity API アクセスを申請する際に必要です。

<div id="2-get-account-activity-api-access">
  ### 2. Account Activity API へのアクセスを取得する
</div>

Account Activity API は Enterprise ティアでのみ利用可能です。Enterprise へのアクセスを希望する場合は、[developer portal](https://developer.x.com/en/portal/products/enterprise) から申請してください。

<div id="3-register-a-webhook">
  ### 3. Webhook を登録する
</div>

Account Activity イベントを受信するには、インターネットからアクセス可能な HTTPS URL を持つ webhook を登録する必要があります。webhook コンシューマーアプリケーションの開発、webhook の登録、セキュリティ保護、Challenge-Response チェック (CRC) の処理に関する詳細は、V2 Webhooks API ドキュメントを参照してください。

* webhook が、イベントペイロードが JSON でエンコードされた POST リクエストを処理できるように設定されていることを確認してください。
* サブスクリプションを管理する際に必要になるため、webhook 登録レスポンスから **webhook&#95;id** を取得してください。

<div id="4-validate-setup">
  ### 4. セットアップの検証
</div>

アプリと webhook が正しく設定されていることを確認するには、次の手順を実行します。

* ユーザーアカウントを webhook にサブスクライブします（下記の「サブスクリプションの追加」を参照）。
* アプリがサブスクライブしている X アカウントのいずれかが投稿したポストを「いいね」します。
* webhook の URL に対して、POST リクエストとして `favorite_events` ペイロードが届くはずです。
* **注**: サブスクリプションを追加してからイベントの配信が開始されるまで、最大 10 秒かかる場合があります。

<div id="important-notes">
  ### 重要な注意事項
</div>

* **認証**: ユーザーを購読ユーザーとして追加する際は、そのユーザーのアカウントに対する consumer key、consumer secret、access token、access token secret を使用します。
* **ダイレクトメッセージ**: すべての受信および送信ダイレクトメッセージ（POST /2/dm&#95;conversations/with/:participant&#95;id/messages 経由で送信されるもの）は、アプリがすべてのDMアクティビティを把握できるよう、webhook を通じて配信されます。
* **イベントの重複**:
  * 2人の購読済みユーザーが同じDM会話にいる場合、webhook にはイベントが重複して届きます（ユーザーごとに1件）。for&#95;user&#95;id フィールドを使って区別してください。
  * 複数のアプリが同じ webhook URL とユーザーを共有している場合、イベントは複数回（アプリごとに1回）送信されます。
  * アプリ側では、イベント ID を使って重複排除を行い、まれに発生する重複イベントを処理できるようにしてください。
* **サンプルコード**: webhook イベントを表示する Web アプリについては、[Account Activity API Setup](https://github.com/xdevplatform/account-activity-dashboard-enterprise/tree/master) を参照してください。

<div id="managing-subscribed-users-v2-api">
  ## サブスクライブしているユーザーの管理 (v2 API)
</div>

有効な webhook&#95;id を持つ登録済みの webhook があれば、ユーザーのアカウントアクティビティを受信するためのユーザーサブスクリプションを管理できます。サブスクリプションの追加、表示、削除には、次のエンドポイントを使用してください。

<div id="adding-a-subscription">
  ### [サブスクリプションの追加](https://docs.x.com/x-api/account-activity/subscribes-the-provided-application-to-all-events-for-the-provided-user-context-for-all-message-types)
</div>

**Endpoint**: POST /2/account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all
**Description**: 認証ユーザーを、指定した webhook 経由でイベントを受信するようにサブスクライブします。
**Authentication**: OAuthUser（サブスクライブ対象のユーザーを表す 3-legged OAuth フローが必須）。

* **Consumer Key**: 例: xvz1evFS...
* **Access Token**: 例: 370773112-GmHxMAgYyLbN...

**Path Parameters**:

| Parameter      | Description                   |
| :------------- | :---------------------------- |
| webhook&#95;id | サブスクリプションを関連付ける webhook の ID。 |

**Request**:
bash

```
curl --request POST --url 'https://api.twitter.com/2/account_activity/webhooks/:WEBHOOK_ID/subscriptions/all' \
--header 'authorization: OAuth oauth_consumer_key="<CONSUMER_KEY>", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="<ACCESS_TOKEN>", oauth_version="1.0"'
```

**レスポンス**:

* **成功 (200 OK)**:
* JSON

```
{
  "data": {
    "subscribed": true
  }
}
```

* **失敗 (400 Bad Request)**:

| 理由                          | 説明                                                 |
| :-------------------------- | :------------------------------------------------- |
| WebhookIdInvalid            | 指定された webhook&#95;id が見つからないか、そのアプリに関連付けられていません。   |
| DuplicateSubscriptionFailed | 指定された webhook&#95;id には、このユーザーのサブスクリプションがすでに存在します。 |
| SubscriptionLimitExceeded   | このアプリは、すべての webhook を合わせたサブスクリプション数の上限に達しています。     |

###

<div id="checking-a-subscription">
  ### [サブスクリプションの確認](https://docs.x.com/x-api/account-activity/check-if-a-subscription-exists-for-a-given-webhook-and-user)
</div>

**エンドポイント**: GET /2/account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all
**説明**: 認証中のユーザーが指定された webhook を購読しているかどうかを確認します。
**認証方式**: OAuthUser（3-legged OAuth フローが必須）。
**パスパラメータ**:

| パラメータ          | 説明                  |
| :------------- | :------------------ |
| webhook&#95;id | 確認対象の webhook の ID。 |

**リクエスト**:
bash

```
curl --request GET --url 'https://api.twitter.com/2/account_activity/webhooks/:WEBHOOK_ID/subscriptions/all' \
--header 'authorization: OAuth oauth_consumer_key="<CONSUMER_KEY>", oauth_nonce="GENERATED", oauth_signature="GENERATED", oauth_signature_method="HMAC-SHA1", oauth_timestamp="GENERATED", oauth_token="<ACCESS_TOKEN>", oauth_version="1.0"'
```

**レスポンス**:

* **成功時 (200 OK)**:
* JSON

```
{
  "data": {
    "subscribed": true // または false
  }
}
```

* **失敗 (400 Bad Request)**:

| 理由               | 説明                                             |
| :--------------- | :--------------------------------------------- |
| WebhookIdInvalid | 指定された webhook&#95;id が見つからないか、アプリに関連付けられていません。 |

###

<div id="removing-subscriptions">
  ### [Removing Subscriptions](https://docs.x.com/x-api/account-activity/deactivates-a-subscription-for-the-specified-webhook-and-user-id)
</div>

**エンドポイント**: DELETE /2/account&#95;activity/webhooks/:webhook&#95;id/subscriptions/:user&#95;id/all
**説明**: 特定のユーザー ID のサブスクリプションを解除し、その webhook へのイベント配信を停止します。
**認証**: OAuth2 アプリ専用 Bearer Token。

* **Bearer Token**: 例: AAAAAAAAAAAA0%2EUifi76ZC9Ub0wn...

**パスパラメータ**:

| パラメータ          | 説明                         |
| :------------- | :------------------------- |
| webhook&#95;id | サブスクリプションを含む webhook の ID。 |
| user&#95;id    | 購読解除する対象ユーザーの数値 ID。        |

**リクエスト**:
bash

```
curl --request DELETE --url 'https://api.twitter.com/2/account_activity/webhooks/:WEBHOOK_ID/subscriptions/:USER_ID/all' \
--header 'authorization: Bearer <BEARER_TOKEN>'
```

**レスポンス**:

* **成功時 (200 OK)**:
* JSON

```
{
  "data": {
    "subscribed": false
  }
}
```

* **失敗 (400 Bad Request)**:

| 理由                   | 説明                                                              |
| :------------------- | :-------------------------------------------------------------- |
| SubscriptionNotFound | 指定された user&#95;id について、指定の webhook&#95;id に対するサブスクリプションが存在しません。 |
| WebhookIdInvalid     | 指定された webhook&#95;id が見つからないか、アプリに関連付けられていません。                  |

<div id="viewing-all-subscriptions">
  ### [すべてのサブスクリプションの表示](https://docs.x.com/x-api/account-activity/get-a-list-of-the-current-all-activity-type-subscriptions-for-the-specified-webhook)
</div>

**Endpoint**: GET /2/account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all/list
**Description**: 指定された webhook に現在登録されているすべてのユーザー ID の一覧を取得します。
**Authentication**: OAuth2 アプリ専用 Bearer Token。
**Path Parameters**:

| Parameter      | Description                       |
| :------------- | :-------------------------------- |
| webhook&#95;id | サブスクリプションを一覧表示する対象の webhook の ID。 |

**Request**:
bash

```
curl --request GET --url 'https://api.twitter.com/2/account_activity/webhooks/:WEBHOOK_ID/subscriptions/all/list' \
--header 'authorization: Bearer <BEARER_TOKEN>'
```

**レスポンス**:

* **成功 (200 OK)**:
* JSON

```
{
  "data": {
    "application_id": "<your app id>",
    "webhook_id": "<webhook id>",
    "webhook_url": "<the webhook's callback url>",
    "subscriptions": [
      { "user_id": "<user_id_1>" },
      { "user_id": "<user_id_2>" }
    ]
  }
}
```

* **失敗 (400 Bad Request)**:

| 理由               | 説明                                             |
| :--------------- | :--------------------------------------------- |
| WebhookIdInvalid | 指定された webhook&#95;id が見つからないか、アプリに関連付けられていません。 |

###

<div id="subscriptions-count">
  ### [Subscriptions Count](https://docs.x.com/x-api/account-activity/get-a-count-of-subscriptions-that-are-currently-active-on-your-account)
</div>

**Endpoint**: GET /2/account&#95;activity/subscriptions/count
**Description**: 有効なサブスクリプションの合計件数と、認証中のアプリケーションに対してプロビジョニングされている上限値を返します。
**Authentication**: OAuth2 アプリ専用 Bearer Token。
**Request**:
bash

```
curl --request GET --url 'https://api.twitter.com/2/account_activity/subscriptions/count' \
--header 'authorization: Bearer <BEARER_TOKEN>'
```

**レスポンス**:

* **成功 (200 OK)**:
* JSON

```
{
  "data": {
    "account_name": "<your application name>",
    "provisioned_count": "<subscription limit allocated>",
    "subscriptions_count_all": "<current active subscription count>",
    "subscriptions_count_direct_messages": "0" // DM専用サブスクリプションはサポート対象外になりました
  }
}
```

<div id="replay">
  ## [Replay](https://docs.x.com/x-api/account-activity/request-activity-replay)
</div>

AAAv2 には、指定した時間範囲内の過去のイベントを取得し、それらを自分の webhook に再配信できるリプレイ機能があります。これはダウンタイム中に取り逃したイベントを復旧するのに役立ちます。

**Endpoint**: POST /2/account&#95;activity/replay/webhooks/:webhook&#95;id/subscriptions/all

**Description**: リプレイジョブを開始します

**Authentication**: OAuth2 App Only Bearer Token

**Path Parameters**:

| Parameter      | Description               |
| :------------- | :------------------------ |
| webhook&#95;id | リプレイを開始する対象の webhook の ID |

**Query Parameters**:

| Parameter     | Description                                                                                                                                                                                                          |
| :------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| from&#95;date | イベントが提供される最も古い（開始）UTC タイムスタンプ。‘yyyymmddhhmm’ 形式で指定する必要があります。タイムスタンプは分単位で、開始時刻を含みます（例: 12:00 は 00 分を含みます）。有効な時刻は、UTC で過去 24 時間以内、かつ現在時刻より 31 分以上前である必要があります。from&#95;date と to&#95;date は約 2 時間以内に収まるように指定することを推奨します。 |
| to&#95;date   | イベントが提供される最新の（終了）UTC タイムスタンプ。‘yyyymmddhhmm’ 形式で指定する必要があります。タイムスタンプは分単位で、終了時刻は含みません（例: 12:30 はその時間の 30 分目を含みません）。有効な時刻は、UTC で過去 24 時間以内、かつ現在時刻より 10 分以上前である必要があります。                                                   |

**Responses**:

Success:

```
200

{
  "for_user_id": "<USER_ID>"
  "replay_event": {
    "job_id": <REPLAY_JOB_ID>",
    "created_at: "yyyy-mm-ddThh:mm:ss.000Z"
  }
}
```

Failures:

| Reason              | Description                                   |
| :------------------ | :-------------------------------------------- |
| QueryParamInvalid   | from&#95;date が現在時刻から 24 時間より前の日時です。          |
| QueryParamInvalid   | from&#95;date が to&#95;date よりも新しい日時です。       |
| QueryParamInvalid   | from&#95;date が未来の日時です。                       |
| QueryParamInvalid   | to&#95;date が未来の日時です。                         |
| QueryParamInvalid   | from&#95;date または to&#95;date が正しい形式ではありません。  |
| CrcValidationFailed | CRC 検証時に webhook URL から受信したレスポンスが正しくありません。    |
| ReplayConflictError | 指定された webhook ですでに replay ジョブが実行中です。          |
| WebhookIdInvalid    | 指定された webhook&#95;id が無効であるか、アプリに関連付けられていません。 |

<div id="job-completed-messages">
  ### ジョブ完了メッセージ
</div>

リプレイジョブが正常に完了すると、X から次のジョブ完了イベントが配信されます。このイベントを受信した時点で、そのジョブの実行は終了しており、別のジョブを送信できます。

```
{
  "replay_job_status": {
    "webhook_id": "<WEBHOOK_ID>",
    "job_state": "Complete",
    "job_state_description": "Job completed successfully",
    "job_id": "<JOB_ID>"
  }
}
```

ジョブが正常に完了しなかった場合には、リプレイジョブの再試行を促すために、次のメッセージを返します。このイベントを受信した時点で、そのジョブの実行は終了しており、別のジョブを送信できます。

```
{
  "replay_job_status": {
    "webhook_id": "<WEBHOOK_ID>",
    "job_state": "Incomplete",
    "job_state_description": "すべてのイベントの配信に失敗しました。リプレイジョブを再試行してください",
    "job_id": "<JOB_ID>"
  }
}
```

<div id="account-activity-data-object-structure">
  ## アカウントアクティビティデータオブジェクトの構造
</div>

| Object | 詳細 |
| :----- | :----- |
| for&#95;user&#95;id | イベントが関連付けられているユーザーサブスクリプションを識別します。 |
| is&#95;blocked&#95;by | （条件付き）メンションしているユーザーが、サブスクリプション対象のユーザーにブロックされている場合にのみ、ポストのメンションイベントで表示されます。 |
| source | アクティビティを行っているユーザー（例：フォロー、ブロック、ミュートしているユーザー）。 |
| target | アクティビティの対象となるユーザー（例：フォローされている、ブロックされている、ミュートされているユーザー）。 |

<div id="available-activities">
  ### 利用可能なアクティビティ
</div>

| Message Type | 詳細 |
| :----- | :----- |
| tweet&#95;create&#95;events | ポスト、リポスト、返信、@メンション、引用ポスト、または引用ポストのリポストの作成イベント。 |
| favorite&#95;events | ユーザーと対象を含む「いいね」イベント。 |
| follow&#95;events | ユーザーと対象を含むフォローイベント。 |
| unfollow&#95;events | ユーザーと対象を含むフォロー解除イベント。 |
| block&#95;events | ユーザーと対象を含むブロックイベント。 |
| unblock&#95;events | ユーザーと対象を含むブロック解除イベント。 |
| mute&#95;events | ユーザーと対象を含むミュートイベント。 |
| unmute&#95;events | ユーザーと対象を含むミュート解除イベント。 |
| user&#95;event | ユーザーがアプリの認可を取り消したときの取り消しイベント（サブスクリプションは自動削除）。 |
| direct&#95;message&#95;events | 送信または受信メッセージに対するDMステータスイベント。 |
| direct&#95;message&#95;indicate&#95;typing&#95;events | ユーザーと対象を含むDM入力中イベント。 |
| direct&#95;message&#95;mark&#95;read&#95;events | ユーザーと対象を含むDM既読イベント。 |
| tweet&#95;delete&#95;events | コンプライアンス目的の削除されたポストの通知。 |
| spaces&#95;events | 現在はサポートされていません。近日対応予定です。 |

<div id="payload-examples">
  ## ペイロードの例
</div>

以下に各 Account Activity イベントのペイロード例を示します。

<div id="tweet_create_events-posts-retweets-replies-quotetweets">
  ### tweet&#95;create&#95;events (ポスト、リツイート、返信、引用ポスト)
</div>

```json
{
  "for_user_id": "2244994945",
  "tweet_create_events": [
    {
      <Tweet Object>
    }
  ]
}
```

###

<div id="tweet_create_events-mentions">
  ### tweet&#95;create&#95;events (@メンション)
</div>

```json
{
  "for_user_id": "2244994945",
  "user_has_blocked": "false",
  "tweet_create_events": [
    {
      <Tweet Object>
    }
  ]
}
```

<div id="favorite_events">
  ### favorite&#95;events
</div>

```json
{
  "for_user_id": "2244994945",
  "favorite_events": [{
    "id": "a7ba59eab0bfcba386f7acedac279542",
    "created_at": "Mon Mar 26 16:33:26 +0000 2018",
    "timestamp_ms": 1522082006140,
    "favorited_status": {
      <Tweet Object>
    },
    "user": {
      <User Object>
    }
  }]
}
```

<div id="follow_events">
  ### follow&#95;events
</div>

```json
{
  "for_user_id": "2244994945",
  "follow_events": [{
    "type": "follow",
    "created_timestamp": "1517588749178",
    "target": {
      <User Object>
    },
    "source": {
      <User Object>
    }
  }]
}
```

<div id="unfollow_events">
  ### unfollow&#95;events
</div>

```json
{
  "for_user_id": "2244994945",
  "follow_events": [{
    "type": "unfollow",
    "created_timestamp": "1517588749178",
    "target": {
      <User Object>
    },
    "source": {
      <User Object>
    }
  }]
}
```

<div id="block_events">
  ### block&#95;events
</div>

```json
{
  "for_user_id": "2244994945",
  "block_events": [{
    "type": "block",
    "created_timestamp": "1518127020304",
    "source": {
      <User Object>
    },
    "target": {
      <User Object>
    }
  }]
}
```

<div id="unblock_events">
  ### unblock&#95;events
</div>

```json
{
  "for_user_id": "2244994945",
  "block_events": [{
    "type": "unblock",
    "created_timestamp": "1518127020304",
    "source": {
      <User Object>
    },
    "target": {
      <User Object>
    }
  }]
}
```

<div id="mute_events">
  ### mute&#95;events
</div>

```json
{
  "for_user_id": "2244994945",
  "mute_events": [
    {
      "type": "mute",
      "created_timestamp": "1518127020304",
      "source": {
        <User Object>
      },
      "target": {
        <User Object>
      }
    }
  ]
}
```

<div id="unmute_events">
  ### unmute&#95;events
</div>

```json
{
  "for_user_id": "2244994945",
  "mute_events": [
    {
      "type": "unmute",
      "created_timestamp": "1518127020304",
      "source": {
        <User Object>
      },
      "target": {
        <User Object>
      }
    }
  ]
}
```

<div id="user_event">
  ### user&#95;event
</div>

```json
{
  "user_event": {
    "revoke": {
      "date_time": "2018-05-24T09:48:12+00:00",
      "target": {
        "app_id": "13090192"
      },
      "source": {
        "user_id": "63046977"
      }
    }
  }
}
```

<div id="direct_message_events">
  ### direct&#95;message&#95;events
</div>

```json
{
  "for_user_id": "4337869213",
  "direct_message_events": [{
    "type": "message_create",
    "id": "954491830116155396",
    "created_timestamp": "1516403560557",
    "message_create": {
      "target": {
        "recipient_id": "4337869213"
      },
      "sender_id": "3001969357",
      "source_app_id": "13090192",
      "message_data": {
        "text": "Hello World!",
        "entities": {
          "hashtags": [],
          "symbols": [],
          "user_mentions": [],
          "urls": []
        }
      }
    }
  }],
  "apps": {
    "13090192": {
      "id": "13090192",
      "name": "FuriousCamperTestApp1",
      "url": "https://x.com/furiouscamper"
    }
  },
  "users": {
    "3001969357": {
      "id": "3001969357",
      "created_timestamp": "1422556069340",
      "name": "Jordan Brinks",
      "screen_name": "furiouscamper",
      "location": "Boulder, CO",
      "description": "別人格 - X PE 意見は私個人のものです",
      "url": "https://t.co/SnxaA15ZuY",
      "protected": false,
      "verified": false,
      "followers_count": 22,
      "friends_count": 45,
      "statuses_count": 494,
      "profile_image_url_https": "https://pbs.twimg.com/profile_images/851526626785480705/cW4WTi7C_normal.jpg"
    },
    "4337869213": {
      "id": "4337869213",
      "created_timestamp": "1448312972328",
      "name": "Harrison Test",
      "screen_name": "Harris_0ff",
      "location": "Burlington, MA",
      "protected": false,
      "verified": false,
      "followers_count": 8,
      "friends_count": 8,
      "statuses_count": 240,
      "profile_image_url_https": "https://abs.twimg.com/sticky/default_profile_images/default_profile_normal.png"
    }
  }
}
```

<div id="direct_message_indicate_typing_events">
  ### direct&#95;message&#95;indicate&#95;typing&#95;events
</div>

```json
{
  "for_user_id": "4337869213",
  "direct_message_indicate_typing_events": [{
    "created_timestamp": "1518127183443",
    "sender_id": "3284025577",
    "target": {
      "recipient_id": "3001969357"
    }
  }],
  "users": {
    "3001969357": {
      "id": "3001969357",
      "created_timestamp": "1422556069340",
      "name": "Jordan Brinks",
      "screen_name": "furiouscamper",
      "location": "Boulder, CO",
      "description": "Alter Ego - X PE opinions-are-my-own",
      "url": "https://t.co/SnxaA15ZuY",
      "protected": false,
      "verified": false,
      "followers_count": 23,
      "friends_count": 47,
      "statuses_count": 509,
      "profile_image_url_https": "https://pbs.twimg.com/profile_images/851526626785480705/cW4WTi7C_normal.jpg"
    },
    "3284025577": {
      "id": "3284025577",
      "created_timestamp": "1437281176085",
      "name": "Bogus Bogart",
      "screen_name": "bogusbogart",
      "protected": true,
      "verified": false,
      "followers_count": 1,
      "friends_count": 4,
      "statuses_count": 35,
      "profile_image_url_https": "https://pbs.twimg.com/profile_images/763383202857779200/ndvZ96mE_normal.jpg"
    }
  }
}
```

<div id="direct_message_mark_read_events">
  ### direct&#95;message&#95;mark&#95;read&#95;events
</div>

```json
{
  "for_user_id": "4337869213",
  "direct_message_mark_read_events": [{
    "created_timestamp": "1518452444662",
    "sender_id": "199566737",
    "target": {
      "recipient_id": "3001969357"
    },
    "last_read_event_id": "963085315333238788"
  }],
  "users": {
    "199566737": {
      "id": "199566737",
      "created_timestamp": "1286429788000",
      "name": "Le Braat",
      "screen_name": "LeBraat",
      "location": "Denver, CO",
      "description": "data by day @X, design by dusk",
      "protected": false,
      "verified": false,
      "followers_count": 299,
      "friends_count": 336,
      "statuses_count": 752,
      "profile_image_url_https": "https://pbs.twimg.com/profile_images/936652894371119105/YHEozVAg_normal.jpg"
    },
    "3001969357": {
      "id": "3001969357",
      "created_timestamp": "1422556069340",
      "name": "Jordan Brinks",
      "screen_name": "furiouscamper",
      "location": "Boulder, CO",
      "description": "Alter Ego - X PE opinions-are-my-own",
      "url": "https://t.co/SnxaA15ZuY",
      "protected": false,
      "verified": false,
      "followers_count": 23,
      "friends_count": 48,
      "statuses_count": 510,
      "profile_image_url_https": "https://pbs.twimg.com/profile_images/851526626785480705/cW4WTi7C_normal.jpg"
    }
  }
}
```

<div id="tweet_delete_events">
  ### tweet&#95;delete&#95;events
</div>

```json
{
  "for_user_id": "930524282358325248",
  "tweet_delete_events": [
    {
      "status": {
        "id": "1045405559317569537",
        "user_id": "930524282358325248"
      },
      "timestamp_ms": "1432228155593"
    }
  ]
}
```

<div id="support-for-longform-posts">
  ## 長文ポストのサポート
</div>

V2 Account Activity API は、280文字を超えるポストである **長文** ポストをサポートするようになりました。longform ポストが tweet&#95;create&#95;events ペイロードに含まれている場合、`text` フィールドには先頭の140文字（もしくはそれ未満）が含まれ、`truncated` フィールドは true に設定されます。ポストの全文は extended&#95;tweet オブジェクトで配信され、そこには次の情報が含まれます。

* full&#95;text: 280文字の上限を超える分も含めた、ポストの完全なテキスト。
* entities: full&#95;text 内に出現するすべてのエンティティ（例: ハッシュタグ、URL、ユーザーへのメンション、シンボル）。280文字目以降に出現するものも含みます。
* display&#95;text&#95;range: full&#95;text 全体を考慮した、表示すべき文字範囲。

これにより、アプリケーションは長文ポストの内容全体を処理でき、テキストの後半に出現するメンションやその他のエンティティも漏れなく扱うことができます。以下は、長文ポストが含まれる tweet&#95;create&#95;events ペイロードの例です。

```json
{
  "for_user_id": "1603419180975409153",
  "tweet_create_events": [
    {
      "created_at": "Mon May 19 14:01:46 +0000 2025",
      "id": 1924465506158879000,
      "id_str": "1924465506158878979",
      "text": "The Antikythera Mechanism: A Window into Ancient Ingenuity Discovered in 1901 among the wreckage of a Roman ship of… https://t.co/bzbEKj8cd8",
      "display_text_range": [
        0,
        140
      ],
      ...
      "user": {
        ...
      },
      ...
      "extended_tweet": {
        "full_text": "The Antikythera Mechanism: A Window into Ancient Ingenuity Discovered in 1901 among the wreckage of a Roman ship off the Greek island of Antikythera, the Antikythera Mechanism is often hailed as the world's first analog computer. This intricate bronze device, dating back to around 100 BCE, has captivated historians, archaeologists, and scientists with its sophisticated design and mysterious purpose. The mechanism consists of a complex system of gears, meticulously crafted to perform calculations that remain astonishingly advanced for its time. Its discovery challenged long-held assumptions about the technological capabilities of the ancient world. The primary function of the Antikythera Mechanism appears to have been astronomical. It could predict the positions of the sun, moon, and possibly planets, track lunar and solar eclipses, and even calculate the dates of the Olympic Games. The device’s dials and pointers, coupled with inscriptions in ancient Greek, suggest it was a tool for both scientific inquiry and cultural events. Its level of precision, comparable to that of 19th-century clockmaking, underscores the remarkable ingenuity of its creators, likely from the Hellenistic world. Despite decades of study, many questions remain. Who built it, and for whom? Was it a singular masterpiece or part of a broader tradition of mechanical devices lost to history? X-ray imaging and modern computational techniques have revealed much about its inner workings, yet the full scope of its capabilities is still debated. Some propose it was used for astrological predictions, while others see it as a teaching tool for astronomers. The Antikythera Mechanism stands as a testament to human curiosity and innovation, bridging the ancient and modern worlds. It reminds us that even in antiquity, people sought to understand the cosmos with tools that rival the complexity of today’s technology. Its enduring mystery continues to inspire awe and investigation, making it one of the most remarkable artifacts ever unearthed.\n@xai\n@HistoryInPics",
        "display_text_range": [
          0,
          2051
        ],
        "entities": {
          "hashtags": [],
          "urls": [],
          "user_mentions": [
            {
              "screen_name": "xai",
              "name": "xAI",
              "id": 1661523610111193000,
              "id_str": "1661523610111193088",
              "indices": [
                2032,
                2036
              ]
            },
            {
              "screen_name": "HistoryInPics",
              "name": "History Photographed",
              "id": 1582853809,
              "id_str": "1582853809",
              "indices": [
                2037,
                2051
              ]
            }
          ],
          "symbols": []
        }
      },
      ...
      "entities": {
        "hashtags": [],
        "urls": [
          {
            "url": "https://t.co/bzbEKj8cd8",
            "expanded_url": "https://twitter.com/i/web/status/1924465506158878979",
            "display_url": "twitter.com/i/web/status/1…",
            "indices": [
              117,
              140
            ]
          }
        ],
        "user_mentions": [],
        "symbols": []
      },
      ...
    }
  ]
}
```

<div id="account-activity-api-migrating-from-legacy-enterprise-to-v2">
  ## Account Activity API Legacy Enterprise 版から v2 への移行
</div>

[移行ガイド](https://docs.x.com/x-api/account-activity/migrate/overview)をご覧ください。

<div id="frequently-asked-questions">
  ## よくある質問
</div>

**Account Activity API を使用する利点は何ですか？**

Account Activity API は webhook を使用し、オープンな接続（ストリーミング API と異なり）や頻繁なポーリング（REST API と異なり）を必要とせずに、リアルタイムでデータを配信します。主な利点は次のとおりです。

* **速度**: X と同じスピードでデータを配信します。
* **シンプルさ**: 単一の webhook 接続を通じて、ポスト、@メンション、返信、リポスト、引用ポスト、いいね、DM、フォロー、ブロック、ミュートなど、すべてのアカウントイベントを受け取れます。
* **スケール**: Enterprise ティアでは、レート制限やイベント数の上限なしに、管理対象アカウントのすべてのアクティビティをサポートします。

**Account Activity API 用に開発・ステージング・本番環境が必要です。これは可能ですか？**

はい。複数の webhook URL を登録し、[V2 Webhooks API](https://docs.x.com/x-api/webhooks/introduction) を通じてサブスクリプションを環境ごとに個別管理できます。

**Account Activity API のセットアップ方法について、ステップバイステップのガイドはありますか？**

はい。[Getting Started with Webhooks ガイド](https://docs.x.com/x-api/webhooks/introduction) と [Account Activity API Sample Application](https://github.com/m-rosinsky/XWebhookTest/blob/main/app.py) を参照してください。

**Account Activity API では、どの認証方式を使用する必要がありますか？**

認証要件はエンドポイントごとに定義されています。詳細は [Authentication セクション](https://developer.x.com/en/docs/authentication) を参照してください。

**相互にやり取りしているユーザーに対してサブスクリプションしている場合、重複したアクティビティを受け取ることになりますか？**

はい。アプリがユーザー A とユーザー B のサブスクリプションを持っていて、ユーザー A がポスト内でユーザー B にメンションした場合、webhook は 2 つのイベント（ユーザーごとに 1 つ）を受信します。`for_user_id` フィールドを使用して、どのサブスクリプション宛てのイベントかを判別してください。

**自分の webhook へのサブスクリプションを行う際に、配信されるアクティビティを制限するために、エンドポイントの** /all/ **の部分を他の account activity データオブジェクトに置き換えることはできますか？**

いいえ。利用可能なのは /all/ プロダクトのみで、サポートされているすべてのイベントタイプを配信します。

**3 つの webhook へのアクセス権がある場合、Enterprise 利用として登録したそれぞれのアプリに対して、3 つの webhook を使用できますか？**

webhook の上限はアカウント単位で設定されており、アプリ単位ではありません。たとえば、3 つの webhook と 2 つのアプリがある場合、1 つのアプリには 2 つ、もう 1 つのアプリには 1 つの webhook を使用することはできますが、各アプリで 3 つずつ使用することはできません。

<div id="account-activity-api-reference-index">
  ## Account Activity API リファレンスインデックス
</div>

| 目的 | V2 エンドポイント |
| :----- | :----- |
| アプリケーションをアカウントのイベントに購読登録します | POST /2/account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all |
| 現在アクティブなサブスクリプションの件数を返します | GET /2/account&#95;activity/subscriptions/count |
| webhook がアカウントを購読しているかどうかを確認します | GET /2/account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all |
| 現在アクティブなサブスクリプションの一覧を返します | GET /2/account&#95;activity/webhooks/:webhook&#95;id/subscriptions/all/list |
| アプリ専用 OAuth（app-only OAuth）を使用してサブスクリプションを無効化します | DELETE /2/account&#95;activity/webhooks/:webhook&#95;id/subscriptions/:user&#95;id/all |
| リプレイ・ジョブを作成します | POST /2/account&#95;activity/replay/webhooks/:webhook&#95;id/subscriptions/all |

Webhook 管理用エンドポイント（登録、表示、検証、削除）については、[V2 Webhooks API ドキュメント](https://docs.x.com/x-api/webhooks/introduction)を参照してください。