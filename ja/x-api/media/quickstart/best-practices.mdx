---
title: ベストプラクティス
sidebarTitle: ベストプラクティス
keywords: ["メディアアップロード ベストプラクティス", "メディアをアップロード", "メディア ベストプラクティス", "画像アップロード", "動画アップロード", "メディアアップロード ガイド"]
---

[`POST /2/media/upload`](/ja/x-api/media/media-upload) エンドポイントを使用する際には、理解しておくべき重要な概念がいくつかあります。OAuth を使用したメディアのアップロードはやや複雑になり得るため、ここでは、このエンドポイントを利用するうえでの注意点と、実際の利用方法を示す動作確認済みのサンプルを紹介します。

<div id="keep-in-mind">
  ## 留意事項
</div>

* 1つのポストには、最大4枚の写真、1つのアニメーションGIF、または1つの動画を添付できます。
* 送信する画像は、生のバイナリデータか base64 エンコードされたバイナリデータである必要があります。`Content-Type` が適切に設定されている限り、その他のエンコードやエスケープは不要です（迷った場合は `application/octet-stream` を使用してください）。
* base64 エンコードされた画像を送信する場合は、メッセージ内の画像パートに「Content-Transfer-Encoding: base64」を必ず設定してください。
* マルチパートメッセージの境界は、それぞれ独立した行に置き、CRLF で終端する必要があります。
* このエンドポイントを使用して POST する実用的な例としては、[xurl](https://github.com/xdevplatform/xurl) でテストすることをおすすめします。また、利用可能な [X Libraries](/ja/resources/tools-and-libraries) も確認してください。
* JavaScript や、長整数を正確に表現できないその他の言語では、API レスポンスで提供される `media_id_string` を使用してください。

<div id="media-categories">
  ## メディアカテゴリ
</div>

Media Category パラメータは、アップロードするメディアファイルの利用目的を定義し、アップロード時に適用されるファイルサイズ上限やその他の制約に影響する場合があります。メディアを利用する際の問題を避けるため、メディアをアップロードする際には正しいメディアカテゴリを指定することが重要です。これはアップロードフローにおいて、INIT リクエストで渡す任意の値です。メディアカテゴリが指定されていない場合、アップロードされたメディアはコンテンツタイプに応じて、ポスト用のメディア（`tweet_image`、`tweet_video`、`tweet_gif`）であるとみなされます。

最も一般的なメディアカテゴリは次のとおりです。

* `tweet_image`
* `tweet_video`
* `tweet_gif`
* `dm_image`
* `dm_video`
* `dm_gif`
* `subtitles`

Ads API パートナーの方は、プロモーション動画に使用する際に推奨されるメディアカテゴリの詳細について、[こちらのドキュメント](/ja/x-ads-api/creatives#promoted-video) を参照してください。

<div id="image-specifications-and-recommendations">
  ## 画像の仕様と推奨事項
</div>

画像ファイルは、次のすべての条件を満たしている必要があります。

* **サポートされている画像メディアの種類**: `JPG`, `PNG`, `GIF`, `WEBP`
* **画像サイズ**: `<= 5 MB`
* **アニメーション GIF のサイズ**: `<= 15 MB`

上記のファイルサイズ制限は、メディアアップロードエンドポイントによって適用されます。加えて、`media_id` を指定してポスト作成（または同様の）エンドポイントを呼び出す際には、プロダクトエンティティごとに固有のファイルサイズ上限が別途適用されます。ファイルサイズの上限やその他の制約は、`media_category` パラメータによって異なる場合があります。

<div id="animated-gif-recommendations">
  ## アニメーションGIFに関する推奨事項
</div>

ファイルサイズの上限内であっても、ポスト作成時にGIFの処理に失敗する場合があります。成功率を高めるため、次の制約を守ってください。

* **解像度**: `<= 1280x1080` (`width` x `height`)
* **フレーム数**: `<= 350`
* **ピクセル数**: `<= 300 million` (`width` * `height` * `num_frames`)
* **ファイルサイズ**: `<= 15Mb`

より大きなGIFを処理するには、`media_category` パラメータを指定して [chunked upload](/ja/x-api/media/quickstart/media-upload-chunked) エンドポイントを使用します。これにより、サーバー側でGIFファイルを非同期で処理できるようになり、大きなファイルを処理するための必須要件を満たせます。アニメーションGIF付きのポストで非同期アップロード動作を有効にするには、`media_category=tweet_gif` を指定してください。

<div id="video-specifications-and-recommendations">
  ## 動画の仕様と推奨事項
</div>

メディアのアップロードには、Async Path を使用してください。

<div id="recommended">
  ### 推奨設定
</div>

* **動画コーデック**: `H264 High Profile`
* **フレームレート**: `30 FPS`, `60 FPS`
* **動画解像度**: `1280x720`（横向き）、`720x1280`（縦向き）、`720x720`（正方形）。サブスクリプション登録ユーザーは 1080p の動画をアップロードして 1080p で再生されます。サブスクリプション未登録ユーザーは 720p の動画をアップロードして 720p で再生されます。
* **最小動画ビットレート**: `5,000 kbps`
* **最小音声ビットレート**: `128 kbps`
* **音声コーデック**: `AAC LC`
* **アスペクト比**: `16:9`（横向きまたは縦向き）、`1:1`（正方形）

<div id="advanced">
  ### 高度な仕様
</div>

* **フレームレート**: `60 FPS` 以下である必要があります
* **解像度**: `32x32` 以上 `1280x1024` 以下である必要があります
* **ファイルサイズ**: `512 MB` を超えてはいけません
* **再生時間**: `0.5秒` 以上 `140秒` 以下である必要があります
* **アスペクト比**: `1:3` から `3:1` の範囲内である必要があります
* **[ピクセルアスペクト比](https://en.wikipedia.org/wiki/Pixel_aspect_ratio)**: `1:1` である必要があります
* **ピクセルフォーマット**: [YUV](https://en.wikipedia.org/wiki/YUV) 4:2:0 のみサポートされます
* 音声は [`Low Complexity` プロファイルの `AAC`](https://en.wikipedia.org/wiki/Advanced_Audio_Coding#Modular_encoding) である必要があります（`High-Efficiency AAC` はサポートされていません）
* 音声は `mono` または `stereo` である必要があり、5.1 以上は使用できません
* [`open GOP`](https://en.wikipedia.org/wiki/Group_of_pictures) を使用してはいけません
* [`progressive scan`](https://en.wikipedia.org/wiki/Progressive_scan) を使用する必要があります

<div id="additional-information">
  ### 追加情報
</div>

下記の表では、各行が推奨されるアップロード設定を示していますが、必須ではありません。すべてのアップロードは、複数のプラットフォーム向けに最適化されるよう処理されます。

| Orientation | Width | Height | Video Bitrate | Audio Bitrate |
| :--- | :--- | :--- | :--- | :--- |
| Landscape | 1280 | 720 | 2048K | 128K |
| Landscape | 640 | 360 | 768K | 64K |
| Landscape | 320 | 180 | 256K | 64K |
| Portrait | 720 | 1280 | 2048K | 128K |
| Portrait | 360 | 640 | 768K | 64K |
| Portrait | 180 | 320 | 256K | 64K |
| Square | 720 | 720 | 2048K | 128K |
| Square | 480 | 480 | 768K | 64K |
| Square | 240 | 240 | 256K | 32K |

メディアのアップロード方法の例については、[chunked media upload ドキュメント](/ja/x-api/media/quickstart/media-upload-chunked)を参照してください。

<div id="troubleshooting">
  ### トラブルシューティング
</div>

Media API に関する問題が発生した場合は、開発者フォーラムの [Media API カテゴリ](https://devcommunity.x.com/c/x-api/media-apis) を参照して解決策を探してください。