---
title: アナリティクス
keywords: ["広告アナリティクス", "広告分析", "キャンペーンアナリティクス", "広告メトリクス", "広告指標", "キャンペーンパフォーマンス"]
---

import { Button } from '/snippets/ja/button.mdx';

## はじめに

アナリティクスのメトリクスは、パートナーや広告主が、X 上でプロモーションしているコンテンツのパフォーマンスを把握するのに役立ちます。これには、インプレッション、クリック数、動画再生数、消化金額などの情報が含まれます。さらに、パートナーや広告主は、リーチしたオーディエンスをさまざまなセグメントに分けて、詳細なメトリクスを取得できます。

Ads API では、キャンペーンの詳細なパフォーマンスメトリクスを取得する方法として、同期処理と非同期処理の 2 種類をサポートしています。同期型のアナリティクス呼び出しでは、リクエストしたメトリクスがレスポンス内で返されます。非同期型のアナリティクスエンドポイントでは、関連する「ジョブ」の処理が完了した後に、ダウンロード可能な結果ファイルとしてリクエストしたメトリクスを取得できます。同期エンドポイントは短い期間の取得をサポートしており、リアルタイムでのキャンペーン最適化に適しています。非同期エンドポイントは、はるかに長い期間をサポートしており、より多くのデータを取得できるため、レポート作成や過去データのバックフィルに最適です。

<div id="details">
  ## 詳細
</div>

<div id="synchronous-vs-asynchronous">
  ### 同期処理と非同期処理
</div>

同期処理および非同期処理のアナリティクスエンドポイントの違いを、次の表にまとめます。この情報は、開発者がどちらのエンドポイント群を使用するか選択する際の参考とすることを目的としています。

| 機能 | 同期処理 | 非同期処理 |
|:---------|:------------|:--------------|
| レート制限 | ユーザーレベル: 15分あたり 250 リクエスト | アカウントレベル: 同時実行ジョブ数* 最大 100 件 |
| 取得可能な期間 | 7日間 | 90日間（セグメントなし）<br />45日間（セグメントあり） |
| セグメンテーション | なし | あり |
| レスポンスの内容 | メトリクスのデータ | ジョブ**の処理状態 |
| 推奨されるユースケース | リアルタイム最適化<br />ユーザーインターフェースからのリクエスト | 定期的な同期処理<br />過去データのバックフィル |

<Note>
  * これは、任意の時点で処理中にできるジョブの最大数を指します。

  ** ジョブが正常に処理完了すると、URL が返されます。圧縮（gzip）された結果ファイルは、その URL からダウンロードできます。

  それ以外の点では、両方のエンドポイントは同じ機能を提供します。
</Note>

<div id="use-cases">
  ### ユースケース
</div>

主な分析ユースケースは 3 つあります。

1. リアルタイム最適化：パフォーマンスメトリクスを使用してアクティブなキャンペーンを更新する
2. 同期：定期的にスケジュールされたバックグラウンド同期
3. 新規アカウントのオンボーディング：履歴データのバックフィル

同期型の分析エンドポイントは、直近 5〜15 分以内のメトリクスの変化に基づいてキャンペーンを更新するためのリアルタイム最適化に使用できます。分析データの同期には、どちらのエンドポイントも使用できます。必要な時間範囲と、セグメンテーションが必要かどうかによって、どのエンドポイントを使用すべきかが決まる点に注意してください。新規アカウントのオンボーディングは、非同期分析エンドポイントのみを使用して行う必要があります（同期型の分析エンドポイントは、大量のデータを取得する目的では決して使用しないでください）。

非同期分析エンドポイントは、メトリクスをバックエンドプロセスで同期することで、ダッシュボードやその他の UI 要素に活用できます。実装では、ユーザーインターフェースのリクエストを処理するために非同期分析エンドポイントを呼び出すことは避けてください。

<div id="request-options">
  ### リクエストオプション
</div>

Analytics リクエストは広告アカウントを対象としており、そのためリソースパスにアカウント ID が必要です。以下に挙げるリクエストオプションは、クエリパラメータとして指定します。次の種類の値が必須です。

* Entities: 分析を取得したいエンティティ種別と、最大 20 件までのエンティティ ID
* Time range: ISO 8601 形式で表現された開始時刻と終了時刻
  * **Note:** 時刻は 1 時間単位（端数のない時刻）で指定する必要があります
* Metric groups: 関連するメトリクスの 1 つ以上のセット（各メトリクスグループに含まれるメトリクス一覧は「Metrics and Segmentation」を参照）
* Granularity: メトリクスをどの集計レベルで返すかを指定します
* Placement: X 上で配信された広告のメトリクスを取得するか、X 以外で配信された広告のメトリクスを取得するかを指定します
  * **Note:** リクエストごとに指定できる placement の値は 1 つだけです

`start_time` および `end_time` リクエストパラメータを使用して、時間範囲を指定します。これらの値は、以下のとおり指定した granularity に合わせる必要があります。

1. `TOTAL`: 任意の時間範囲を指定できます（エンドポイントの制限内）
2. `DAY`: 開始時刻と終了時刻の両方を、アカウントのタイムゾーンでの真夜中に揃える必要があります
3. `HOUR`: 任意の時間範囲を指定できます（エンドポイントの制限内）

終了時刻は排他的です。たとえば、`start_time=2019-01-01T00:00:00Z` と `end_time=2019-01-02T00:00:00Z` を指定したリクエストは、この時間範囲が 24 時間分のみをカバーするため、2 日分ではなく 1 日分の analytics メトリクスのみが返されます。

**Segmentation**

Segmentation は非同期 analytics エンドポイントでのみ利用可能で、パートナーや広告主が特定のターゲティング値ごとに分割されたメトリクスを取得できるようにします。セグメント化されたメトリクスをリクエストするには、`segmentation_type` リクエストパラメータを使用します。セグメンテーションオプションの詳細については、[Metrics and Segmentation](/ja/x-ads-api/analytics#metrics-and-segmentation) を参照してください。

<div id="faqs">
  ## よくある質問
</div>

なぜ Ads API の数値は、X Ads UI に表示される数値と一致しないのですか？

* `ALL_ON_TWITTER`、`PUBLISHER_NETWORK`、`SPOTLIGHT`、`TREND` のすべてのプレースメントについてデータをリクエストしていることを確認してください。
* Ads API では終了時刻は終端を含まない（排他的）一方で、Ads UI では終端を含む（包括的）ことに注意してください。

なぜ、データをリクエストするタイミングによって数値が変わるのですか？

* レポート用メトリクスが利用可能になり次第、取得できるようになります。メトリクスはほぼリアルタイムで利用可能です。ただし、これらの初期結果は推定値であり、そのため変動することが想定されています。支出データを除き、メトリクスは 24 時間後に確定します。
* 支出メトリクスは通常、イベント発生から 3 日以内に確定します。ただし、請求データは（スパムフィルタリングなどのため）イベント発生日から最大 14 日間処理されます。

特定の期間について、どのエンティティ ID をリクエストすればよいかを判断するにはどうすればよいですか？

* [Active Entities エンドポイント](/ja/x-ads-api/analytics#active-entities-2)を使用してください。

なぜ analytics レスポンス内の値がすべて `null` なのですか？

* リクエストされた期間中にキャンペーンが配信されなかった可能性が高いです。
* どのエンティティについて、またどの期間について analytics を取得すべきかを判断するために、[Active Entities エンドポイント](/ja/x-ads-api/analytics#active-entities-2)を使用してください。

なぜ API では `null` が表示されるのに、UI では 0 と表示されるのですか？

* UI はこれらの値を 0 として表示する仕様ですが、値としては同等です。

X のタイムラインのような、より細かいプレースメントに紐づくメトリクスは、どのようにリクエストすればよいですか？

* analytics では、次のプレースメント値をサポートしています: `ALL_ON_TWITTER`、`PUBLISHER_NETWORK`、`SPOTLIGHT`、`TREND`（すなわち、[X Audience Platform](/ja/x-ads-api/audiences)）。

削除済みまたは一時停止中のエンティティに対するメトリクスを取得することは可能ですか？

* 可能です。エンティティのステータスは analytics メトリクスの利用可否に影響しません。

なぜセグメント化された値は、非セグメント化の値と一致しないのですか？

* セグメント化されたデータは、この情報の導出方法により、非セグメント化データと 100% 一致して集計されることは想定されていません。

複数のディメンションでセグメント化されたデータをリクエストすることは可能ですか？

* 複数ディメンションでのセグメント化はサポートしていません。

<div id="best-practices">
  ## ベストプラクティス
</div>

Ads API から[アナリティクス](/ja/x-ads-api/analytics)データを収集する際の推奨事項を以下に示します。

<div id="rate-limiting-and-retries">
  ### レート制限と再試行
</div>

* レート制限されたクエリ（`HTTP 429` ステータスコードを返すもの）の場合、`x-rate-limit-reset` ヘッダーを確認し、示された時刻以降にのみ再試行する必要があります。
* HTTP 503 Service Unavailable ステータスコードとなったクエリの場合、`retry-after` ヘッダーを確認し、示された時間が経過した後にのみ再試行する必要があります。
* 指定された再試行時刻を順守しないアプリケーションは、予告なく Ads API へのアクセス権を取り消されたり、レート制限を強化されたりする可能性があります。

<div id="analytics-metrics-in-a-nutshell">
  ### アナリティクスメトリクスの概要
</div>

* すべてのアナリティクスメトリクスは、`billed_charge_local_micro` を除き、24時間後に確定し、それ以降は変動しません。
* `billed_charge_local_micro` メトリクスは、データが返された後、最大3日間は推定値として扱われます。
* 24時間経過後、このメトリクスは、予算超過（指定された `end_time` 以降に配信された広告）に対するクレジットや、ジャンクと判断された課金対象イベントに対するクレジットにより減少する可能性があります。このメトリクスは24時間以降はごくわずかしか変化しません。
* 詳細については [Analytics](/ja/x-ads-api/analytics) を参照してください。

<div id="fetching-real-time-non-segmented-data">
  ### リアルタイムの非セグメント化データの取得
</div>

* 必ず `start_time` と `end_time` の両方を指定してください。
* 7日以上前のエンティティに関するデータは取得しないでください。
* 可能であれば `HOUR` 単位でデータをリクエストしてください。`DAY` や `TOTAL` 単位の粒度は、いつでも集計してメトリクスをロールアップすることで取得できます。
* 可能であれば `line_items` レベルおよび `promoted_tweets` レベルでデータをリクエストしてください。キャンペーン、funding instrument、アカウントなど、広告エンティティ階層全体にわたる合計値は、いつでもこれらのメトリクスを集計してロールアップすることで取得できます。
* 分析用メトリクスの値は、自社側（ローカル）で保存・保管してください。
* 30日以上前のデータを繰り返しクエリしないでください。このデータは変化せず、ローカルに保存しておく必要があります。
* すべての非セグメント化データはリアルタイムであり、イベント発生から数秒以内にデータが利用可能になるはずです。
* コンバージョンメトリクスと非コンバージョンメトリクスは、別々のリクエストに分けて送信してください。

<div id="fetching-segmented-data">
  ### セグメント別データの取得
</div>

* 上記の「リアルタイムの非セグメント別データの取得」に関するガイドラインを参照してください。以下に追加の注意点を記載します。
* ほとんどのセグメント別データタイプでは、状況によっては最大 1 時間、データが出揃わない場合があります。`INTERESTS` でセグメントされたデータは、最大 12 時間まで遅延する可能性があります。
* セグメント別データは、その算出方法により、非セグメント別データと 100% 一致する形で集計されることは想定されていません。

<div id="fetching-historical-data">
  ### 過去データの取得
</div>

* データを補完する場合（例: 新しい広告主アカウントを追加する場合）、`start_time` と `end_time` をより細かい時間範囲に分割して、複数回リクエストを行う必要がある場合があります。
* 取得する期間は 30 日間のウィンドウに制限してください。
* これらのリクエストは頻度を抑え、時間的に分散させて実行し、この取得処理のためのレート制限枠を使い切らないようにしてください。

<div id="sample">
  ### サンプル
</div>

これらのベストプラクティスの一部を示すサンプルスクリプト（`fetch_stats`）は、[ads-platform-tools GitHub](https://github.com/xdevplatform/ads-platform-tools)リポジトリにあります。

<div id="metrics-by-objective">
  ## 目的別メトリクス
</div>

どのメトリクスが各エンティティに適用されるかは、[キャンペーン目的](/ja/x-ads-api/campaign-management) によって異なります。このガイドを参考に、各目的タイプごとに取得すべき関連メトリクスグループと、追加の派生メトリクスの算出方法を確認してください。

<div id="engagements">
  ### `ENGAGEMENTS`
</div>

**該当するメトリクスグループ：**`ENGAGEMENT` と `BILLING`。クリエイティブでメディアが使用されている場合は、`MEDIA` も適用されます。

|     |     |
| :--- | :--- |
| 派生指標 | 公開指標の計算式 |
| エンゲージメント率 | `engagements/impressions` |
| CPE | `billed_charge_local_micro/engagements` |
| メディア視聴率 | `media_views/impressions` |

<div id="website_clicks-and-website_conversions">
  ### `WEBSITE_CLICKS` と `WEBSITE_CONVERSIONS`
</div>

**関連するメトリックグループ：**`ENGAGEMENT`、`BILLING`、`WEB_CONVERSION`。クリエイティブでメディアが使用されている場合は `MEDIA` も適用されます。

|     |     |
| :--- | :--- |
| 派生メトリック | 公開メトリックからの算出方法 |
| CPM | `billed_charge_local_micro/impressions/1000` |
| クリック率 | `clicks/impressions` |
| CPLC | `billed_charge_local_micro/clicks` |
| 総コンバージョン数 | `conversion_custom` + `conversion_site_visits` + `conversion_sign_ups` + `conversion_downloads` + `conversion_purchases` |
| コンバージョン率 | 総コンバージョン数 / `impressions` |
| CPA | `billed_charge_local_micro` / 総コンバージョン数 |

### `APP_INSTALLS` と `APP_ENGAGEMENTS`

**関連するメトリックグループ:** `ENGAGEMENT`、`BILLING`、`MOBILE_CONVERSION`、`LIFE_TIME_VALUE_MOBILE_CONVERSION`。クリエイティブでメディアまたは Video App Card が使用されている場合は、`MEDIA` および `VIDEO` も適用されます。

|     |     |
| :--- | :--- |
| 派生メトリック | 公開指標の計算式 |
| CPM | `billed_charge_local_micro/impressions/1000` |
| アプリクリック率 | `app_clicks/impressions` |
| CPAC | `billed_charge_local_micro/app_clicks` |
| CPI | `billed_charge_local_micro/mobile_conversion_installs` |

<div id="followers">
  ### `FOLLOWERS`
</div>

**該当するメトリクスグループ:** `ENGAGEMENT` と `BILLING`。クリエイティブでメディアを使用する場合は `MEDIA` も該当します。

|     |     |
| :--- | :--- |
| 派生指標 | 公開指標の算出式 |
| CPM | `billed_charge_local_micro/impressions/1000` |
| Follow Rate | `follows/impressions` |
| CPF | `billed_charge_local_micro/follows` |
| Media View Rate | `media_views/impressions` |

<div id="lead_generation">
  ### `LEAD_GENERATION`
</div>

**関連するメトリクスグループ：**`ENGAGEMENT` と `BILLING`。クリエイティブにメディアが使用されている場合は `MEDIA` も適用されます。

|     |     |
| :--- | :--- |
| 派生メトリクス | 公開メトリクスを用いた計算式 |
| CPM | `billed_charge_local_micro/impressions/1000` |
| リード数 | `card_engagements` |
| リード率 | `card_engagements/impressions` |
| リード単価 | `billed_charge_local_micro/card_engagements` |

<div id="video_views">
  ### `VIDEO_VIEWS`
</div>

**関連メトリックグループ:** `ENGAGEMENT`、`BILLING`、`VIDEO`

|     |     |
| :--- | :--- |
| 派生指標 | 表示指標の計算式 |
| CPM | `billed_charge_local_micro/impressions/1000` |
| 動画再生率 | `video_total_views/impressions` |
| 視聴あたりのコスト（CPV） | `billed_charge_local_micro/video_total_views` |

<div id="video_views_preroll">
  ### `VIDEO_VIEWS_PREROLL`
</div>

**関連するメトリックグループ：**`ENGAGEMENT`、`BILLING`、`VIDEO`

|     |     |
| :--- | :--- |
| 派生メトリック | 公開メトリックに基づく計算式 |
| CPM | `billed_charge_local_micro/impressions/1000` |
| Video Rate | `video_total_views/impressions` |
| Cost Per View | `billed_charge_local_micro/video_total_views` |

<div id="metrics-and-segmentation">
  ## メトリクスとセグメンテーション
</div>

このドキュメントでは、各エンティティタイプごとに [Analytics](/ja/x-ads-api/analytics) から取得できるメトリクスの概要と、それぞれのメトリクスで利用可能なセグメンテーションについて説明します。

|     |     |     |     |     |     |     |     |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
|     | メトリクスグループ |     |     |     |     |     |     |
| エンティティ | [`ENGAGEMENT`](#engagement) | [`BILLING`](#BILLING) | [`VIDEO`](#VIDEO) | [`MEDIA`](#MEDIA) | [`WEB_CONVERSION`](#WEB_CONVERSION) | [`MOBILE_CONVERSION`](#MOBILE_CONVERSION) | [`LIFE_TIME_VALUE_MOBILE_CONVERSION`](#LIFE_TIME_VALUE_MOBILE_CONVERSION) |
| `ACCOUNT` | ✔*  |     |     |     |     |     |     |
| `FUNDING_INSTRUMENT` | ✔*  | ✔   |     |     |     |     |     |
| `CAMPAIGN` | ✔   | ✔   | ✔   | ✔   | ✔   | ✔   | ✔   |
| `LINE_ITEM` | ✔   | ✔   | ✔   | ✔   | ✔   | ✔   | ✔   |
| `PROMOTED_TWEET` | ✔   | ✔   | ✔   | ✔   | ✔   | ✔   | ✔   |
| `MEDIA_CREATIVE` | ✔   | ✔   | ✔   | ✔   | ✔   | ✔   | ✔   |
| `ORGANIC_TWEET` | ✔   |     | ✔   |     |     |     |     |

*`ENGAGEMENT` メトリクスファミリーに含まれる一部のメトリクスは、アカウントレベルおよび資金決済手段レベルでは利用できません。詳細は `ENGAGEMENT` セクションを参照してください。

<div id="available-metrics-by-metrics-group">
  ### メトリクスグループ別の利用可能なメトリクス
</div>

<div id="engagement">
  #### `ENGAGEMENT`
</div>

|     |     |     |     |     |
| :--- | :--- | :--- | :--- | :--- |
| 指標 | 説明 | セグメンテーション利用可否 | データ型 | アカウント / Funding Instrument で利用可能 |
| `engagements` | エンゲージメントの合計数 | ✔   | int の配列 | ✔   |
| `impressions` | インプレッションの合計数 | ✔   | int の配列 | ✔   |
| `retweets` | リポストの合計数 | ✔   | int の配列 | ✔   |
| `replies` | 返信の合計数 | ✔   | int の配列 | ✔   |
| `likes` | いいねの合計数 | ✔   | int の配列 | ✔   |
| `follows` | フォローの合計数 | ✔   | int の配列 | ✔   |
| `card_engagements` | カードへのエンゲージメントの合計数 | ✔   | int の配列 |     |
| `clicks` | いいねなど他のエンゲージメントを含むクリックの合計数 | ✔   | int の配列 |     |
| `app_clicks` | アプリインストールまたはアプリ起動の試行回数 | ✔   | int の配列 |     |
| url&#95;clicks | 広告内のリンクまたは Website Card への、アーンド分も含むクリックの合計数 | ✔   | int の配列 |     |
| `qualified_impressions` | 有効インプレッションの合計数 | ✔   | int の配列 |     |
| `carousel_swipes` | カルーセル画像または動画のスワイプの合計数 | ✔   | int の配列 |     |

<div id="billing">
  #### `BILLING`
</div>

|     |     |     |     |
| :--- | :--- | :--- | :--- |
| Metric | 説明 | セグメンテーション可否 | データ型 |
| `billed_engagements` | 課金対象エンゲージメントの合計数 | ✔   | 整数の配列 |
| `billed_charge_local_micro` | マイクロ単位での合計費用 | ✔   | 整数の配列 |

<div id="video">
  #### `VIDEO`
</div>

動画メトリクス定義の変更に関するお知らせ:

`VIDEO` メトリクスグループ内の `video_total_views` メトリクスは、MRC 標準に従い、少なくとも 2 秒間、画面上で 50% 以上が表示されているビューをカウントします。

元の動画ビュー定義である「少なくとも 3 秒間、100% が画面上に表示されている状態」を表すメトリクスは、`VIDEO` メトリクスグループ内の新しい `video_3s100pct_views` として引き続き利用できます。元のビュー定義に基づいて入札および課金を継続するには、新たに利用可能な `VIEW_3S_100PCT` bid&#95;unit を使用してください。

|     |     |     |     |
| :--- | :--- | :--- | :--- |
| Metric | 説明 | セグメンテーション対応 | データ型 |
| `video_total_views` | 動画ビューの総数 | ✔   | int の配列 |
| `video_views_25` | 動画の少なくとも 25% が再生されたビューの総数 | ✔   | int の配列 |
| `video_views_50` | 動画の少なくとも 50% が再生されたビューの総数 | ✔   | int の配列 |
| `video_views_75` | 動画の少なくとも 75% が再生されたビューの総数 | ✔   | int の配列 |
| `video_views_100` | 動画全体が再生されたビューの総数 | ✔   | int の配列 |
| `video_cta_clicks` | CTA（Call to action）へのクリック総数 | ✔   | int の配列 |
| `video_content_starts` | 動画再生開始の総数 | ✔   | int の配列 |
| `video_3s100pct_views` | 100% が画面上に表示された状態で少なくとも 3 秒間再生されたビューの総数（従来の `video_total_views`） | ✔   | int の配列 |
| `video_6s_views` | 動画の少なくとも 6 秒間が再生されたビューの総数 | ✔   | int の配列 |
| `video_15s_views` | 動画の少なくとも 15 秒間、または総再生時間の 95% が再生されたビューの総数 | ✔   | int の配列 |

<div id="media">
  #### `MEDIA`
</div>

|     |     |     |     |
| :--- | :--- | :--- | :--- |
| 指標 | 説明 | セグメンテーションの可否 | データ型 |
| `media_views` | Videos、Vines、GIF、Images におけるメディアの総視聴数（自動再生およびクリック再生を含む）。 | ✔   | int の配列 |
| `media_engagements` | Videos、Vines、GIF、Images におけるメディアのクリック数の総数。 | ✔   | int の配列 |

<div id="web_conversion">
  #### `WEB_CONVERSION`
</div>

|     |     |     |     |
| :--- | :--- | :--- | :--- |
| Metric | 説明 | セグメンテーション可否 | データ型 |
| `conversion_purchases` | タイプ PURCHASE のコンバージョン数と、それに対応する売上額および注文数 | `PLATFORMS` のみ | JSON オブジェクト |
| `conversion_sign_ups` | タイプ SIGN&#95;UP のコンバージョン数と、それに対応する売上額および注文数 | `PLATFORMS` のみ | JSON オブジェクト |
| `conversion_site_visits` | タイプ SITE&#95;VISIT のコンバージョン数と、それに対応する売上額および注文数 | `PLATFORMS` のみ | JSON オブジェクト |
| `conversion_downloads` | タイプ DOWNLOAD のコンバージョン数と、それに対応する売上額および注文数 | `PLATFORMS` のみ | JSON オブジェクト |
| `conversion_custom` | タイプ CUSTOM のコンバージョン数と、それに対応する売上額および注文数 | `PLATFORMS` のみ | JSON オブジェクト |

<div id="mobile_conversion">
  #### `MOBILE_CONVERSION`
</div>

モバイルコンバージョン指標は、MACT が有効になっている広告主アカウントでのみ利用できます。

|                                            |                                                                                                                                    |           |             |
| :----------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------- | :-------- | :---------- |
| 指標                                         | 説明                                                                                                                                 | セグメント別集計可 | データ型        |
| `mobile_conversion_spent_credits`          | SPENT&#95;CREDIT タイプのモバイルコンバージョンを post&#95;view、post&#95;engagement、assisted、order&#95;quantity、sale&#95;amount ごとに分類した内訳          | ✔         | JSON オブジェクト |
| `mobile_conversion_installs`               | INSTALL タイプのモバイルコンバージョンの内訳（post&#95;view、post&#95;engagement、assisted、order&#95;quantity、sale&#95;amount ごと）                       | ✔         | JSON オブジェクト |
| `mobile_conversion_content_views`          | CONTENT&#95;VIEW タイプのモバイルコンバージョンを post&#95;view、post&#95;engagement、assisted、order&#95;quantity、sale&#95;amount 別に分類した内訳           | ✔         | JSONオブジェクト  |
| `mobile_conversion_add_to_wishlists`       | ADD&#95;TO&#95;WISHLIST タイプのモバイルコンバージョンを、post&#95;view、post&#95;engagement、assisted、order&#95;quantity、sale&#95;amount ごとの内訳       | ✔         | JSON オブジェクト |
| `mobile_conversion_checkouts_initiated`    | CHECKOUT&#95;INITIATED タイプのモバイルコンバージョンを、post&#95;view、post&#95;engagement、assisted、order&#95;quantity、sale&#95;amount 別に示した内訳      | ✔         | JSON オブジェクト |
| `mobile_conversion_reservations`           | RESERVATION タイプのモバイルコンバージョンを、post&#95;view、post&#95;engagement、assisted、order&#95;quantity、sale&#95;amount 別に示した内訳                 | ✔         | JSONオブジェクト  |
| `mobile_conversion_tutorials_completed`    | TUTORIAL&#95;COMPLETEDタイプのモバイルコンバージョンの内訳（post&#95;view、post&#95;engagement、assisted、order&#95;quantity、sale&#95;amount ごと）         | ✔         | JSON オブジェクト |
| `mobile_conversion_achievements_unlocked`  | ACHIEVEMENT&#95;UNLOCKED タイプのモバイルコンバージョンを、post&#95;view、post&#95;engagement、assisted、order&#95;quantity、sale&#95;amount 別に内訳表示     | ✔         | JSONオブジェクト  |
| `mobile_conversion_searches`               | SEARCH タイプのモバイルコンバージョンの、post&#95;view、post&#95;engagement、assisted、order&#95;quantity、sale&#95;amount 別内訳                          | ✔         | JSON オブジェクト |
| `mobile_conversion_add_to_carts`           | ADD&#95;TO&#95;CART タイプのモバイルコンバージョンの post&#95;view、post&#95;engagement、assisted、order&#95;quantity、sale&#95;amount ごとの内訳           | ✔         | JSON オブジェクト |
| `mobile_conversion_payment_info_additions` | PAYMENT&#95;INFO&#95;ADDITION タイプのモバイルコンバージョンの、post&#95;view、post&#95;engagement、assisted、order&#95;quantity、sale&#95;amount ごとの内訳 | ✔         | JSON オブジェクト |
| `mobile_conversion_re_engages`             | RE&#95;ENGAGE タイプのモバイルコンバージョンの post&#95;view、post&#95;engagement、assisted、order&#95;quantity、sale&#95;amount 別内訳                   | ✔         | JSON オブジェクト |
| `mobile_conversion_shares`                 | SHARE タイプのモバイルコンバージョンの、post&#95;view、post&#95;engagement、assisted、order&#95;quantity、sale&#95;amount 別の内訳                          | ✔         | JSON オブジェクト |
| `mobile_conversion_rates`                  | RATE タイプのモバイルコンバージョンの post&#95;view、post&#95;engagement、assisted、order&#95;quantity、sale&#95;amount ごとの内訳                          | ✔         | JSON オブジェクト |
| `mobile_conversion_logins`                 | LOGIN タイプのモバイルコンバージョンの post&#95;view、post&#95;engagement、assisted、order&#95;quantity、sale&#95;amount 別内訳                           | ✔         | JSON オブジェクト |
| `mobile_conversion_updates`                | UPDATE タイプのモバイルコンバージョンの post&#95;view、post&#95;engagement、assisted、order&#95;quantity、sale&#95;amount 別の内訳                         | ✔         | JSON オブジェクト |
| `mobile_conversion_levels_achieved`        | LEVEL&#95;ACHIEVED タイプのモバイルコンバージョンの、post&#95;view、post&#95;engagement、assisted、order&#95;quantity、sale&#95;amount 別内訳              | ✔         | JSON オブジェクト |
| `mobile_conversion_invites`                | INVITE タイプのモバイルコンバージョンの post&#95;view、post&#95;engagement、assisted、order&#95;quantity、sale&#95;amount 別内訳                          | ✔         | JSON オブジェクト |
| `mobile_conversion_key_page_views`         | KEY&#95;PAGE&#95;VIEW タイプのモバイルコンバージョンを post&#95;view と post&#95;engagement 別に集計した内訳                                                | ✔         | JSON オブジェクト |
| mobile&#95;conversion&#95;downloads        | DOWNLOAD タイプのモバイルコンバージョンの、ポストビュー、ポストエンゲージメント、アシスト、注文数量、売上金額別の内訳                                                                    | ✔         | JSON オブジェクト |
| mobile&#95;conversion&#95;purchases        | post&#95;view、post&#95;engagement、assisted、order&#95;quantity、sale&#95;amount ごとの PURCHASE タイプのモバイルコンバージョンの内訳                      | ✔         | JSON オブジェクト |
| mobile&#95;conversion&#95;sign&#95;ups     | SIGN&#95;UP タイプのモバイルコンバージョンを、post&#95;view、post&#95;engagement、assisted、order&#95;quantity、sale&#95;amount ごとの内訳                   | ✔         | JSON オブジェクト |
| mobile&#95;conversion&#95;site&#95;visits  | SITE&#95;VISIT タイプのモバイルコンバージョンを、post&#95;view、post&#95;engagement、assisted、order&#95;quantity、sale&#95;amount ごとの内訳                | ✔         | JSON オブジェクト |

<div id="life_time_value_mobile_conversion">
  #### `LIFE_TIME_VALUE_MOBILE_CONVERSION`
</div>

モバイルコンバージョンのライフタイム値に関する統計は、MACT が有効になっている広告主アカウントでのみ利用できます。

|     |     |     |     |
| :--- | :--- | :--- | :--- |
| Metric | 説明 | セグメンテーション可否 | データ型 |
| `mobile_conversion_lifetime_value_purchases` | タイプ PURCHASE のモバイルコンバージョンの内訳 |     | JSON オブジェクト |
| `mobile_conversion_lifetime_value_sign_ups` | タイプ SIGN&#95;UP のモバイルコンバージョンの内訳 |     | JSON オブジェクト |
| `mobile_conversion_lifetime_value_updates` | タイプ UPDATE のモバイルコンバージョンの内訳 |     | JSON オブジェクト |
| `mobile_conversion_lifetime_value_tutorials_completed` | タイプ TUTORIAL&#95;COMPLETED のモバイルコンバージョンの内訳 |     | JSON オブジェクト |
| `mobile_conversion_lifetime_value_reservations` | タイプ RESERVATION のモバイルコンバージョンの内訳 |     | JSON オブジェクト |
| `mobile_conversion_lifetime_value_add_to_carts` | タイプ ADD&#95;TO&#95;CART のモバイルコンバージョンの内訳 |     | JSON オブジェクト |
| `mobile_conversion_lifetime_value_add_to_wishlists` | タイプ ADD&#95;TO&#95;WISHLIST のモバイルコンバージョンの内訳 |     | JSON オブジェクト |
| `mobile_conversion_lifetime_value_checkouts_initiated` | タイプ CHECKOUT&#95;INITIATED のモバイルコンバージョンの内訳 |     | JSON オブジェクト |
| `mobile_conversion_lifetime_value_levels_achieved` | タイプ LEVEL&#95;ACHIEVED のモバイルコンバージョンの内訳 |     | JSON オブジェクト |
| `mobile_conversion_lifetime_value_achievements_unlocked` | タイプ ACHIEVEMENT&#95;UNLOCKED のモバイルコンバージョンの内訳 |     | JSON オブジェクト |
| `mobile_conversion_lifetime_value_shares` | タイプ SHARE のモバイルコンバージョンの内訳 |     | JSON オブジェクト |
| `mobile_conversion_lifetime_value_invites` | タイプ INVITE のモバイルコンバージョンの内訳 |     | JSON オブジェクト |
| `mobile_conversion_lifetime_value_payment_info_additions` | タイプ PAYMENT&#95;INFO&#95;ADDITION のモバイルコンバージョンの内訳 |     | JSON オブジェクト |
| `mobile_conversion_lifetime_value_spent_credits` | タイプ SPENT&#95;CREDIT のモバイルコンバージョンの内訳 |     | JSON オブジェクト |
| `mobile_conversion_lifetime_value_rates` | タイプ RATE のモバイルコンバージョンの内訳 |     | JSON オブジェクト |

<div id="segmentation">
  ### セグメンテーション
</div>

セグメンテーションレポートでは、指定したターゲティングタイプの値ごとに分割されたメトリクスを取得できます。セグメンテーションは処理が大幅に複雑になるため、[非同期アナリティクスクエリ](/ja/x-ads-api/analytics#asynchronous-analytics) でのみ利用可能です。

セグメンテーションは、`MEDIA_CREATIVE` または `ORGANIC_TWEET` エンティティでは **サポートされていません**。

一部のセグメンテーションタイプでは、追加のパラメーターを指定する必要があります。これらについては以下に記載しています。

`CITIES` または `POSTAL_CODES` でセグメント化する場合、API はターゲティング対象のロケーション **のみ** を返します。`REGIONS` および `METROS` のセグメンテーションでは、ターゲティング対象とターゲティング対象外のロケーションの両方が返されます。

|     |     |     |
| :--- | :--- | :--- |
| セグメンテーションタイプ | `country` パラメーター必須 | `platform` パラメーター必須 |
| `AGE` |     |     |
| `APP_STORE_CATEGORY` |     |     |
| `AUDIENCES` |     |     |
| `CITIES` | ✔   |     |
| `CONVERSATIONS` |     |     |
| `CONVERSION_TAGS` |     |     |
| `DEVICES` |     | ✔   |
| `EVENTS` |     |     |
| `GENDER` |     |     |
| `INTERESTS` |     |     |
| `KEYWORDS` |     |     |
| `LANGUAGES` |     |     |
| `LOCATIONS` |     |     |
| `METROS` | ✔   |     |
| `PLATFORMS` |     |     |
| `PLATFORM_VERSIONS` |     | ✔   |
| `POSTAL_CODES` | ✔   |     |
| `REGIONS` | ✔   |     |
| `SLIDES` |     |     |
| `SIMILAR_TO_FOLLOWERS_OF_USER` |     |     |
| `TV_SHOWS` |     |     |

<div id="derived-metrics">
  ## 派生メトリクス
</div>

キャンペーンメトリクスは、[キャンペーン目的](/ja/x-ads-api/campaign-management)によって決まります。このガイドを参考にして、設定されている目的に基づいて利用する派生メトリクスの算出方法を確認してください。

波括弧のない `metric` は、Ads API の[分析](/ja/x-ads-api/analytics#synchronous-analytics)エンドポイントから返されるメトリクスです。名前が &#123;波括弧&#125; で囲まれているものは、そのカテゴリにおける派生メトリクスを表します。

### エンゲージメント

|     |     |
| :--- | :--- |
| 派生指標 | 公開指標の算出式 |
| {Impressions} | `promoted_tweet_search_impressions + promoted_tweet_timeline_impressions + promoted_tweet_profile_impressions` |
| {CPM} | `billed_charge_local_micro / {Impressions} / 1000` |
| &#123;Total Engagements&#125; | `promoted_account_follows + promoted_tweet_search_engagements + promoted_tweet_timeline_engagements + promoted_tweet_profile_engagements` or `promoted_account_follows + promoted_tweet_search_clicks + promoted_tweet_search_replies + promoted_tweet_search_retweets + promoted_tweet_search_follows + promoted_tweet_timeline_clicks + promoted_tweet_timeline_replies + promoted_tweet_timeline_retweets + promoted_tweet_timeline_follows + promoted_tweet_profile_clicks + promoted_tweet_profile_replies + promoted_tweet_profile_retweets + promoted_tweet_profile_follows` |
| &#123;Engagement Rate&#125; | `{Total Engagements} / {Impressions}` |
| {CPE} | `billed_charge_local_micro / {Total Engagements}` |
| &#123;Media Views&#125; | `promoted_tweet_timeline_media_views + promoted_tweet_search_media_views + promoted_tweet_profile_media_views` |
| &#123;Media View Rate&#125; | `{Media Views} / {Impressions}` |

<div id="website_clicks">
  ### WEBSITE&#95;CLICKS
</div>

|     |     |
| :--- | :--- |
| 派生メトリクス | 公開メトリクスからの算出式 |
| {Impressions} | `promoted_tweet_search_impressions + promoted_tweet_timeline_impressions + promoted_tweet_profile_impressions` |
| {CPM} | `billed_charge_local_micro / {Impressions} / 1000` |
| &#123;Link Clicks&#125; | `promoted_tweet_search_url_clicks + promoted_tweet_timeline_url_clicks + promoted_tweet_profile_url_clicks` |
| &#123;Click Rate&#125; | `{Link Clicks} / {Impressions}` |
| {CPLC} | `billed_charge_local_micro / {Link Clicks}` |
| {Conversion} | `conversion_site_visits` |
| &#123;Conversion Rate&#125; | `conversion_site_visits / {Impressions}` |
| {CPA} | `billed_charge_local_micro / conversion_site_visits` |

<div id="app_installs-and-app_engagements">
  ### APP&#95;INSTALLS および APP&#95;ENGAGEMENTS
</div>

|     |     |
| :--- | :--- |
| 派生メトリック | 公開メトリックの算出方法 |
| {Impressions} | `promoted_tweet_search_impressions + promoted_tweet_timeline_impressions` |
| {CPM} | `billed_charge_local_micro / {Impressions} / 1000` |
| &#123;App Clicks&#125; | `promoted_tweet_app_install_attempts + promoted_tweet_app_open_attempts + promoted_tweet_timeline_url_clicks + promoted_tweet_search_url_clicks` |
| &#123;App Click Rate&#125; | `{App Clicks} / {Impressions}` |
| {CPAC} | `billed_charge_local_micro / {App Clicks}` |
| {CPI} | `billed_charge_local_micro / mobile_conversion_installs` |

### フォロワー

|     |     |
| :--- | :--- |
| 派生指標 | 公開指標の計算方法 |
| {Impressions} | `promoted_account_impressions` |
| {CPM} | `billed_charge_local_micro / {Impressions} / 1000` |
| {Followers} | `promoted_account_follows` |
| &#123;Follow Rate&#125; | `promoted_account_follow_rate` |
| {CPF} | `billed_charge_local_micro / promoted_account_follows` |
| &#123;Media Views&#125; | `promoted_tweet_timeline_media_views + promoted_tweet_search_media_views + promoted_tweet_profile_media_views` |
| &#123;Media View Rate&#125; | `{Media Views} / {Impressions}` |

### LEAD&#95;GENERATION

|     |     |
| :--- | :--- |
| 派生メトリクス | 公開メトリクスの計算方法 |
| {Impressions} | `promoted_tweet_search_impressions + promoted_tweet_timeline_impressions + promoted_tweet_profile_impressions` |
| {CPM} | `billed_charge_local_micro / {Impressions} / 1000` |
| {Leads} | `promoted_tweet_search_card_engagements + promoted_tweet_timeline_card_engagements + promoted_tweet_profile_card_engagements` |
| &#123;リード率&#125; | `{Leads} / {Impressions}` |
| &#123;リード単価&#125; | `billed_charge_local_micro / {Leads}` |

### VIDEO&#95;VIEWS

|     |     |
| :--- | :--- |
| 派生メトリクス | 公開メトリクスの計算方法 |
| {Impressions} | `promoted_tweet_search_impressions + promoted_tweet_timeline_impressions + promoted_tweet_profile_impressions` |
| {CPM} | `billed_charge_local_micro / {Impressions} / 1000` |
| &#123;動画再生数&#125; | `promoted_video_total_views` |
| &#123;動画再生率&#125; | `promoted_video_total_views / {Impressions}` |
| &#123;視聴単価&#125; | `billed_charge_local_micro / promoted_video_total_views` |

<div id="qualified_impressions">
  ### QUALIFIED&#95;IMPRESSIONS
</div>

|     |     |
| :--- | :--- |
| 派生指標 | 公開指標の計算式 |
| {Impressions} | `promoted_tweet_search_impressions + promoted_tweet_timeline_impressions + promoted_tweet_profile_impressions` |
| {CPM} | `billed_charge_local_micro / {Impressions} / 1000` |
| &#123;有効インプレッション&#125; | `promoted_tweet_timeline_qualified_impressions + promoted_tweet_search_qualified_impressions + promoted_tweet_profile_qualified_impressions` |
| &#123;有効インプレッション率&#125; | `{Qualified Impressions} / {Impressions}` |
| &#123;有効インプレッション単価（1000件あたり）&#125; | `billed_charge_local_micro / {Qualified Impressions} / 1000` |

<div id="custom">
  ### CUSTOM
</div>

`placement_type` が `PROMOTED_ACCOUNT` の場合は、上記の `FOLLOWERS` の目的を参照してください。その他のすべてのプレースメントでこの目的を使用する場合は、対応する派生メトリクスについて `ENGAGEMENTS` を参照してください。

<div id="guides">
  ## ガイド
</div>

<div id="active-entities">
  ### アクティブなエンティティ
</div>

<div id="introduction">
  #### はじめに
</div>

[Active Entities エンドポイント](/ja/x-ads-api/analytics#get-stats-accounts-account-id-active-entities) は、どのキャンペーンについてアナリティクスをリクエストすべきかに関する情報を提供するため、[同期](/ja/x-ads-api/analytics#get-stats-accounts-account-id) および [非同期](/ja/x-ads-api/analytics#asynchronous-analytics) のアナリティクスエンドポイントと組み合わせて使用することを目的としています。このエンドポイントは、広告エンティティの詳細と、そのメトリクスがいつ変化したかを返すことでそれを実現します。このエンドポイントを使用することで、コードおよびアナリティクス取得ロジックを大幅に簡素化できます。

このガイドでは、当該エンドポイントとそのデータソースに関する情報およびコンテキストを説明します。また、Active Entities をアナリティクスエンドポイントと組み合わせてどのように使用するかを示す [利用ガイドライン](#usage) と一連の [リクエスト例](#example) も提供します。[サマリーセクション](#summary) では、推奨アプローチの全体像を高いレベルで示します。

<div id="data">
  #### データ
</div>

広告エンティティの指標が変更されるたびに、その変更に関する情報が記録されます。これらの変更イベントは 1 時間単位のバケットに保存され、エンティティの詳細と、その変更が適用される時刻の両方を含みます。後者が必要なのは、変更イベントが必ずしも記録された時刻と一致するとは限らないためです。請求調整がその代表的な理由ですが、ほかにも理由があります。

<div id="endpoint">
  #### エンドポイント
</div>

<div id="request">
  ### リクエスト
</div>

Active Entities リクエストは広告アカウント単位で行われ、`entity`、`start_time`、`end_time` の 3 つのクエリパラメータが必須です。

`twurl -H ads-api.x.com "/11/stats/accounts/18ce54d4x5t/active_entities?entity=PROMOTED_TWEET&start_time=2019-03-05T00:00:00Z&end_time=2019-03-06T00:00:00Z"`

サポートされている `entity` の値は、`CAMPAIGN`、`FUNDING_INSTRUMENT`、`LINE_ITEM`、`MEDIA_CREATIVE`、`PROMOTED_ACCOUNT`、`PROMOTED_TWEET` です。これは、分析エンドポイントがサポートしているエンティティタイプを反映しています。

`start_time` と `end_time` の値は [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601) 形式で指定し、どの 1 時間単位のバケットをクエリするかを示す必要があります。これらは必ず端数のない 1 時間単位で指定しなければなりません。

このエンドポイントは、結果をフィルタリングするために使用できる 3 つのオプションパラメータ `funding_instrument_ids`、`campaign_ids`、`line_item_ids` にも対応しています。これらは広告階層のすべてのレベルおよび任意の `entity` 値で機能します。

<div id="response">
  ### レスポンス
</div>

上記のリクエストに対する Active Entities レスポンスを以下に示します。

```json
    {
      "request": {
        "params": {
          "account_id": "18ce54d4x5t",
          "entity": "PROMOTED_TWEET",
          "start_time": "2019-03-05T00:00:00Z",
          "end_time": "2019-03-06T00:00:00Z"
        }
      },
      "data": [
        {
          "entity_id": "2r0wxw",
          "activity_start_time": "2019-03-04T20:55:20Z",
          "activity_end_time": "2019-03-05T03:43:56Z",
          "placements": [
            "ALL_ON_TWITTER"
          ]
        },
        {
          "entity_id": "2r30fn",
          "activity_start_time": "2019-03-05T08:11:08Z",
          "activity_end_time": "2019-03-05T14:40:59Z",
          "placements": [
            "ALL_ON_TWITTER",
            "PUBLISHER_NETWORK"
          ]
        }
      ]
    }
```

`data` 配列には、後続のアナリティクスリクエストに含める必要がある各エンティティごとに 1 つのオブジェクトが含まれます。このセットに含まれていない ID についてアナリティクスをリクエストしてはいけません。

各オブジェクトには 4 つのフィールドが含まれます: `entity_id`, `activity_start_time`, `activity_end_time`, `placements`。アクティビティの開始時刻と終了時刻は、関連付けられたエンティティの変更イベントが適用される時間範囲を表しており、その結果、後続のアナリティクスリクエストで指定すべき日付を決定します。`placements` 配列には、`ALL_ON_TWITTER`, `PUBLISHER_NETWORK`, `SPOTLIGHT`, `TREND` という値を含めることができます。これは、指定されたエンティティ ID について、どのプレースメントをリクエストすべきかを示します。

<div id="usage">
  #### 使用方法
</div>

Active Entities エンドポイントは、アナリティクスリクエストの実行方法を規定します。以下の使用ガイドラインは、アナリティクスの同期をサポートし、パートナーが自分のデータストアを Twitter と同期した状態に保てるようにするために記載されています。言い換えると、定期的にスケジュールされたバックグラウンド同期をどのように実行するかを説明しています。

開発者は 2 つの決定を行う必要があります。

1. アクティブエンティティ情報をどの頻度でリクエストするか、ひいてはアナリティクスをどの頻度で取得するか。
2. アクティビティの開始時刻と終了時刻をどのように使用して、アナリティクスリクエストの `start_time` と `end_time` の値を決定するか。

これらについては、以下の 2 つのサブセクションで、概要の後にそれぞれより詳細に説明します。

<div id="summary">
  ### 概要
</div>

Active Entities エンドポイントを次の方法で使用して、分析リクエストの実行方法を決定します。アクティブなエンティティ情報をどの程度の頻度でリクエストするか、つまり分析をどの頻度で取得するかを決めた後に、以下に従ってください。

1. Active Entities リクエストを行います。
2. レスポンスをプレースメントごとに分割します。`ALL_ON_TWITTER` 用に1つ、`PUBLISHER_NETWORK` 用に1つ、`SPOTLIGHT` 用に1つ、`TREND` 用に1つのグループを作成します。
3. 各プレースメントグループに対して、以下を実行します。
   1. エンティティ ID を抽出します。
   2. 分析用の `start_time` および `end_time` の値を決定します。
      * 最小の `activity_start_time` を見つけ、この値を切り下げます。
      * 最大の `activity_end_time` を見つけ、この値を切り上げます。
   3. 分析リクエストを行います。
      * エンティティ ID を20件ずつのバッチにまとめます。
      * `start_time` と `end_time` には #3b で決定した値を使用します。
      * 適切な `placement` の値を指定します。
   4. データストアに書き込みます。

Python SDK を使用した例として、[active&#95;entities.py](https://github.com/xdevplatform/twitter-python-ads-sdk/blob/master/examples/active_entities.py) を参照してください。

<div id="frequency">
  ### 頻度
</div>

最初の質問への回答によって、Active Entities リクエストで使用すべき時間範囲が決まります。たとえば、アクティブエンティティ情報を毎時リクエストする場合、時間範囲は 1 時間にする必要があります。アクティブエンティティ情報を 1 日に 1 回リクエストする場合、時間範囲は 1 日にする必要があります。言い換えると、現在のリクエストの `start_time` が前回のリクエストの `end_time` と等しくなるように時間範囲を選択する必要があります。

<Note>
  **Note**: 1 つの時間ウィンドウは 1 回だけリクエストしてください。同じ時間ウィンドウを複数回リクエストすると、不必要なアナリティクスのリクエストが発生します（下記の例外を除く）。
</Note>

パートナーが「現在の」1 時間について、その 1 時間のあいだに複数回アナリティクスをリクエストしたい場合でも、同じパターンが適用されます。頻度によって時間範囲が決まります。以下の表は、このシナリオにおける Active Entities の開始および終了タイムスタンプの例を示しています。

|     |     |     |
| :--- | :--- | :--- |
| **Request time** | **`start_time` timestamp** | **`end_time` timestamp** |
| 00:15:00 | 00:00:00 | 00:15:00 |
| 00:30:00 | 00:15:00 | 00:30:00 |
| 00:45:00 | 00:30:00 | 00:45:00 |
| 01:00:00 | 00:45:00 | 01:00:00 |

変更イベントの保存方法により、上記の 4 つの Active Entities リクエストはすべて同じ 1 時間のバケットをクエリしますが、このユースケースではそれが必要です。ただし、現在の 1 時間が経過した後は、この 1 時間バケットを再度クエリすべきではありません。

<div id="activity-times">
  ### アクティビティ時間
</div>

アクティビティの開始時刻と終了時刻を扱う際には、次の方法を推奨します。Active Entities のレスポンス内のすべてのオブジェクトを対象に、最小の `activity_start_time` と最大の `activity_end_time` を探します。これらの値について、最小のアクティビティ開始時刻は切り下げ、最大のアクティビティ終了時刻は切り上げる形で調整します。具体的には、どちらのタイムスタンプも時刻部分をゼロに設定し、終了時刻に 1 日を加えます。以下の表で示されているとおりです。これらが、後続の analytics リクエストで指定するべき開始時刻と終了時刻になります。

|     |     |
| :--- | :--- |
| **最小・最大アクティビティ時間** | **導出された時間** |
| 2019-03-04T20:55:20Z  <br />  <br />2019-03-05T14:40:59Z | 2019-03-04T00:00:00Z  <br />  <br />2019-03-06T00:00:00Z |

**注**: 時・分・秒をゼロに設定したタイムスタンプを含めることが重要です。そうしない場合、日付のみが渡されると、広告アカウントのタイムゾーンにおける午前 0 時から午前 0 時までの analytics をリクエストしているとみなされるため、望ましくない可能性があります。たとえば、最小のアクティビティ開始時刻が 2019-02-28T01:30:07Z で、オフセット -08:00:00 の広告アカウントに対して時刻部分が省略された場合、その analytics リクエストでは 01:30 から 08:00 の間に発生した変更が取得されません。

別の方法として、1 日単位に拡張せずに、返されたアクティビティの時間ウィンドウだけについて analytics をリクエストすることも可能です。この方法では、導出される開始時刻と終了時刻は、それぞれ 2019-03-04T20:00:00Z と 2019-03-05T15:00:00Z になります。（なお、analytics リクエストで `DAY` 粒度を指定した場合、このような範囲は受け付けられない点に注意してください。）

<div id="example">
  #### 例
</div>

このセクションでは、Active Entities を同期型アナリティクス エンドポイントと組み合わせて使用する方法を説明します。（読みやすさのために、レスポンスは一部変更されています。）この例では、Active Entities エンドポイントは毎正時に呼び出され、各リクエストでは直前の 1 時間を対象とします。レスポンスによって、同期型アナリティクス エンドポイントをどのように使用するかが決まります。

最初の Active Entities リクエストは 03:00:00 に行われます。レスポンスは、ラインアイテム dvcz7 のメトリクスに変更があり、その変更イベントが 02:02:55 から 02:28:12 までの時間ウィンドウに適用されることを示しています。

```
`twurl -H ads-api.x.com "/11/stats/accounts/18ce54d4x5t/active_entities?entity=LINE_ITEM&start_time=2019-02-11T02:00:00Z&end_time=2019-02-11T03:00:00Z"`
```

```json
    {
      "request": {},
      "data": [
        {
          "entity_id": "dvcz7",
          "activity_start_time": "2019-02-11T02:02:55Z",
          "activity_end_time": "2019-02-11T02:58:12Z",
          "placements": [
            "ALL_ON_TWITTER"
          ]
        }
      ]
    }
```

これらのアクティビティの開始時刻と終了時刻に基づき、上で説明した方法を用いると、アナリティクスの `start_time` と `end_time` の値は、それぞれ 2019-02-11T00:00:00Z と 2019-02-12T00:00:00Z に設定されます。以下のメトリクス配列では、各 3 番目の要素がゼロ以外になっていることがわかります。これは、アクティブなエンティティ情報に基づけば想定どおりの結果です。

```
`twurl -H ads-api.x.com "/11/stats/accounts/18ce54d4x5t?entity=LINE_ITEM&entity_ids=dvcz7&start_time=2019-02-11T00:00:00Z&end_time=2019-02-12T00:00:00Z&granularity=HOUR&metric_groups=ENGAGEMENT,VIDEO&placement=ALL_ON_TWITTER"`
```

```json
    {
      "data_type": "stats",
      "time_series_length": 24,
      "data": [
        {
          "id": "dvcz7",
          "id_data": [
            {
              "segment": null,
              "metrics": {
                "impressions": [
                  0,0,2792,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
                ],
                "engagements": [
                  0,0,60,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
                ],
                "video_total_views": [
                  0,0,1326,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
                ]
              }
            }
          ]
        }
      ],
      "request": {}
    }
```

次の Active Entities リクエストは 04:00:00 に行われ、直前の 1 時間分だけを参照します。前述のとおり、同じ時間ウィンドウは 1 回だけリクエストする必要があります。レスポンスに基づくと、このラインアイテムの変更イベントは 02:00:00 と 03:00:00 の *両方* に適用されることが分かります。続くアナリティクスリクエストでは、両方の時間に対する変更が反映されているはずです。

```
`twurl -H ads-api.x.com "/11/stats/accounts/18ce54d4x5t/active_entities?entity= LINE_ITEM&start_time=2019-02-11T03:00:00Z&end_time=2019-02-11T04:00:00Z"`
```

```json
    {
      "request": {},
      "data": [
        {
          "entity_id": "dvcz7",
          "activity_start_time": "2019-02-11T02:07:17Z",
          "activity_end_time": "2019-02-11T03:49:22Z",
          "placements": [
            "ALL_ON_TWITTER"
          ]
        }
      ]
    }
```

03:00:00 に非ゼロのメトリクスが表示されていることに加え、impressions、spend、MRC video views の値も以前の値から更新されていることがわかります。たとえば impressions は、02:00:00 の時間帯において以前の 2,792 から 2,995 に増加しています。これは、03:00:00 の時間帯に記録された変更イベントが、02:00:00 の時間帯に適用されることを示しています。

```
`twurl -H ads-api.x.com "/11/stats/accounts/18ce54d4x5t?entity=LINE_ITEM&entity_ids=dvcz7&start_time=2019-02-11T00:00:00Z&end_time=2019-02-12T00:00:00Z&granularity=HOUR&metric_groups=ENGAGEMENT,VIDEO&placement=ALL_ON_TWITTER"`
```

```json
    {
      "data_type": "stats",
      "time_series_length": 24,
      "data": [
        {
          "id": "dvcz7",
          "id_data": [
            {
              "segment": null,
              "metrics": {
                "impressions": [
                  0,0,2995,734,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
                ],
                "engagements": [
                  0,0,65,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
                ],
                "video_total_views": [
                  0,0,1449,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
                ]
              }
            }
          ]
        }
      ],
      "request": {}
    }
```

05:00:00 の Active Entities リクエストでは、再び直前の 1 時間分のみを確認すると、変更イベントは 03:00:00 の 1 時間分にのみ適用されていることが示されています。続くリクエストでのアナリティクス メトリクスの変化は、このことを反映したものになっています。

```
`twurl -H ads-api.x.com "/11/stats/accounts/18ce54d4x5t/active_entities?entity=LINE_ITEM&start_time=2019-02-11T04:00:00Z&end_time=2019-02-11T05:00:00Z"`
```

```json
    {
      "request": {},
      "data": [
        {
          "entity_id": "dvcz7",
          "activity_start_time": "2019-02-11T03:42:39Z",
          "activity_end_time": "2019-02-11T03:48:48Z",
          "placements": [
            "ALL_ON_TWITTER"
          ]
        }
      ]
    }
```

分析レスポンスからわかるように、変化しているメトリクスは 03:00:00 の時間帯のものだけで、02:00:00 の時間帯の値は前回の分析リクエスト時と同じままです。

```
`twurl -H ads-api.x.com "/11/stats/accounts/18ce54d4x5t?entity=LINE_ITEM&entity_ids= dvcz7&start_time=2019-02-11T00:00:00Z&end_time=2019-02-12T00:00:00Z&granularity=HOUR&metric_groups=ENGAGEMENT,VIDEO&placement=ALL_ON_TWITTER"`
```

```json
    {
      "data_type": "stats",
      "time_series_length": 24,
      "data": [
        {
          "id": "dvcz7",
          "id_data": [
            {
              "segment": null,
              "metrics": {
                "impressions": [
                  0,0,2995,753,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
                ],
                "engagements": [
                  0,0,65,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
                ],
                "video_total_views": [
                  0,0,1449,351,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
                ]
              }
            }
          ]
        }
      ],
      "request": {}
    }
```

最後に、06:00:00 時点では、これ以上の変更イベントが存在しないことがわかります。**注記**：ただし、これはこのラインアイテムのメトリクスが将来一切変化しないことを意味するものではありません。

```
`twurl -H ads-api.x.com "/11/stats/accounts/18ce54d4x5t/active_entities?entity=LINE_ITEM&start_time=2019-02-11T05:00:00Z&end_time=2019-02-11T06:00:00Z"`
```

```json
    {
      "request": {},
      "data": []
    }
```

<div id="asynchronous-guide">
  ### 非同期ガイド
</div>

<div id="api-reference">
  ## API リファレンス
</div>

<div id="asynchronous-analytics">
  ### 非同期アナリティクス
</div>

<div id="introduction">
  #### はじめに
</div>

非同期アナリティクスエンドポイントを使用すると、パートナーおよび広告主は、サーバーが非同期で処理するジョブ作成リクエストを送信してメトリクスを取得できます（これらを非同期アナリティクスの「ジョブ」と呼びます）。このアプローチでは、リクエストが完了するまでクライアントの接続を開いたままにしておく必要はありません。

これらのエンドポイントは、同期エンドポイントと同様に、パートナーおよび広告主がキャンペーンのパフォーマンスに関する詳細な統計情報を取得できるようにします。アカウント、資金手段（funding instruments）、キャンペーン、ラインアイテム、プロモポスト、およびメディアクリエイティブに対するデータの取得をサポートします。同期エンドポイントとの違いは、非同期アナリティクスエンドポイントでは、最長 90 日までのより長い日付範囲に加え、セグメンテーションもサポートしている点です。両者の違いの詳細については、[Analytics Overview](/ja/x-ads-api/analytics) ページを参照してください。

同期エンドポイントとは異なり、レート制限は特定アカウントの同時ジョブ数に基づきます。言い換えると、ある時点で処理中状態となっていられるジョブの数に基づきます。これは広告アカウントレベルでカウントされます。

<div id="usage">
  #### 使用方法
</div>

非同期アナリティクスのエンドポイントを使ってキャンペーンのメトリクスを取得するには、いくつかの段階を踏む必要があります。ジョブを作成し、そのジョブの処理が完了したかどうかを確認し、最後にデータをダウンロードします。データファイルは解凍する必要があります。具体的な 4 つの手順は以下のとおりです。

1. [POST stats/jobs/accounts/:account&#95;id](/ja/x-ads-api/analytics#asynchronous-analytics) エンドポイントを使用してジョブを作成します。
2. ジョブの処理が完了したかどうかを判定するため、[GET stats/jobs/accounts/:account&#95;id](/ja/x-ads-api/analytics#asynchronous-analytics) エンドポイントに一定間隔でリクエストを送信します。
3. ジョブの処理が完了したら、データファイルをダウンロードします。
4. データファイルを解凍します。

データファイル内で返されるレスポンスオブジェクトは、同期アナリティクスエンドポイントのレスポンスと同じ JSON スキーマになります。

セグメント化されたキャンペーンメトリクスは、非同期アナリティクスエンドポイントでのみ取得できます。キャンペーンメトリクスは、地域、性別、興味関心、キーワードなどで分割できます。利用可能なオプションの一覧は、[Metrics and Segmentation](/ja/x-ads-api/analytics#metrics-and-segmentation) ページを参照してください。セグメント化されたメトリクスをリクエストするには、ジョブを作成する際に `segmentation_type` リクエストパラメータを使用します。

<div id="example">
  #### 例
</div>

このセクションでは、非同期アナリティクスエンドポイントの使用方法を示します。

まず、[POST stats/jobs/accounts/:account&#95;id](/ja/x-ads-api/analytics#asynchronous-analytics) エンドポイントを使ってジョブを作成します。以下の例では、特定のラインアイテムについて、1 週間分のインプレッション、いいね、クリックなどのエンゲージメントメトリクスをリクエストしています。（指定したタイムスタンプが真夜中に設定されているため、リクエストされた時間範囲は 3 月 20 日直前までであり、3 月 20 日自体は含まれない点に注意してください。）

```
$ twurl -X POST -H ads-api.x.com "/9/stats/jobs/accounts/18ce54d4x5t?entity=LINE_ITEM&entity_ids=el32n&start_time=2019-03-12T00:00:00Z&end_time=2019-03-20T00:00:00Z&granularity=TOTAL&placement=ALL_ON_TWITTER&metric_groups=ENGAGEMENT"
```

```json
    {
      "request": {
        "params": {
          "start_time": "2019-03-12T00:00:00Z",
          "entity_ids": [
            "el32n"
          ],
          "end_time": "2019-03-20T00:00:00Z",
          "placement": "ALL_ON_TWITTER",
          "granularity": "TOTAL",
          "entity": "LINE_ITEM",
          "metric_groups": [
            "ENGAGEMENT"
          ]
        }
      },
      "data": {
        "start_time": "2019-03-12T00:00:00Z",
        "segmentation_type": null,
        "url": null,
        "id_str": "1120829647711653888",
        "entity_ids": [
          "el32n"
        ],
        "end_time": "2019-03-20T00:00:00Z",
        "country": null,
        "placement": "ALL_ON_TWITTER",
        "id": 1120829647711653888,
        "expires_at": null,
        "account_id": "18ce54d4x5t",
        "status": "PROCESSING",
        "granularity": "TOTAL",
        "entity": "LINE_ITEM",
        "created_at": "2019-04-23T23:19:46Z",
        "platform": null,
        "updated_at": "2019-04-23T23:19:46Z",
        "metric_groups": [
          "ENGAGEMENT"
        ]
      }
    }
```

このレスポンスはラインアイテムのメトリクスを返しません。作成したばかりのジョブに関する情報のみを提供します。ジョブのステータスを確認するにはジョブ ID が必要です。これはレスポンスの `id` と `id_str` の両方の属性に含まれます。

次に、直前のレスポンスで返された `id_str` を使用して作成したジョブについて、レスポンス内の `"status": "SUCCESS"` という値から処理が完了しているかどうかを確認します。これは、データをダウンロードできる状態になっていることを意味します。`url` フィールドにはダウンロードリンクが含まれます。

```
$ twurl -H ads-api.x.com "/9/stats/jobs/accounts/18ce54d4x5t?job_ids=1120829647711653888"
```

```json
    {
      "request": {
        "params": {
          "job_ids": [
            1120829647711653888
          ]
        }
      },
      "next_cursor": "1120828505715920896",
      "data": [
        {
          "start_time": "2019-03-12T00:00:00Z",
          "segmentation_type": null,
          "url": "https://ton.twimg.com/advertiser-api-async-analytics/zBkuuPeEVx-5OygDVcZpqNtwt51Z5X9d-_AXNRcyhBlhBOgOfi6UDmGBvUFJAKnHY9ABN8z9f9V3Wn4l3OmF4KzJDmTUjNCikq9JwBUYm2AP8pRRoV-kPUgR0PaIqAb4.json.gz",
          "id_str": "1120829647711653888",
          "entity_ids": [
            "el32n"
          ],
          "end_time": "2019-03-20T00:00:00Z",
          "country": null,
          "placement": "ALL_ON_TWITTER",
          "id": 1120829647711653900,
          "expires_at": "2019-04-25T23:19:48Z",
          "account_id": "18ce54d4x5t",
          "status": "SUCCESS",
          "granularity": "TOTAL",
          "entity": "LINE_ITEM",
          "created_at": "2019-04-23T23:19:46Z",
          "platform": null,
          "updated_at": "2019-04-23T23:19:48Z",
          "metric_groups": [
            "ENGAGEMENT"
          ]
        }
      ]
    }
```

上記の例では単一のジョブ ID を渡していますが、実際には `job_ids` パラメーターを使用して最大 200 個のジョブ ID を指定し、同時に複数のジョブのステータスを確認します。

次に、表示されている `url` の値を使用してデータファイルをダウンロードします。

```
    $ wget https://ton.twimg.com/advertiser-api-async-analytics/zBkuuPeEVx-5OygDVcZpqNtwt51Z5X9d-_AXNRcyhBlhBOgOfi6UDmGBvUFJAKnHY9ABN8z9f9V3Wn4l3OmF4KzJDmTUjNCikq9JwBUYm2AP8pRRoV-kPUgR0PaIqAb4.json.gz
    --2019-04-23 17:52:12--  https://ton.twimg.com/advertiser-api-async-analytics/zBkuuPeEVx-5OygDVcZpqNtwt51Z5X9d-_AXNRcyhBlhBOgOfi6UDmGBvUFJAKnHY9ABN8z9f9V3Wn4l3OmF4KzJDmTUjNCikq9JwBUYm2AP8pRRoV-kPUgR0PaIqAb4.json.gz
    Resolving ton.twimg.com (ton.twimg.com)... 72.21.91.70
    Connecting to ton.twimg.com (ton.twimg.com)|72.21.91.70|:443... connected.
    HTTP request sent, awaiting response... 200 OK
    Length: 381 [application/gzip]
    Saving to: 'zBkuuPeEVx-5OygDVcZpqNtwt51Z5X9d-_AXNRcyhBlhBOgOfi6UDmGBvUFJAKnHY9ABN8z9f9V3Wn4l3OmF4KzJDmTUjNCikq9JwBUYm2AP8pRRoV-kPUgR0PaIqAb4.json.gz'

    zBkuuPeEVx-5OygDVcZpqNtwt51Z5 100%[=================================================>]     381  --.-KB/s    in 0s

    2019-04-23 17:52:12 (5.27 MB/s) - 'zBkuuPeEVx-5OygDVcZpqNtwt51Z5X9d-_AXNRcyhBlhBOgOfi6UDmGBvUFJAKnHY9ABN8z9f9V3Wn4l3OmF4KzJDmTUjNCikq9JwBUYm2AP8pRRoV-kPUgR0PaIqAb4.json.gz' saved [381/381]
```

最後に、ファイルを解凍します。

```
`$ gunzip zBkuuPeEVx-5OygDVcZpqNtwt51Z5X9d-_AXNRcyhBlhBOgOfi6UDmGBvUFJAKnHY9ABN8z9f9V3Wn4l3OmF4KzJDmTUjNCikq9JwBUYm2AP8pRRoV-kPUgR0PaIqAb4.json.gz`
```

ファイルの内容は以下のとおりです。

```json
`$ cat zBkuuPeEVx-5OygDVcZpqNtwt51Z5X9d-_AXNRcyhBlhBOgOfi6UDmGBvUFJAKnHY9ABN8z9f9V3Wn4l3OmF4KzJDmTUjNCikq9JwBUYm2AP8pRRoV-kPUgR0PaIqAb4.json`
```

```json
    {
      "data_type": "stats",
      "time_series_length": 1,
      "data": [
        {
          "id": "el32n",
          "id_data": [
            {
              "segment": null,
              "metrics": {
                "impressions": [
                  3482
                ],
                "tweets_send": null,
                "qualified_impressions": null,
                "follows": null,
                "app_clicks": null,
                "retweets": [
                  102
                ],
                "unfollows": null,
                "likes": [
                  15
                ],
                "engagements": [
                  171
                ],
                "clicks": [
                  30
                ],
                "card_engagements": null,
                "poll_card_vote": null,
                "replies": null,
                "carousel_swipes": null
              }
            }
          ]
        }
      ],
      "request": {
        "params": {
          "start_time": "2019-03-12T00:00:00Z",
          "segmentation_type": null,
          "entity_ids": [
            "el32n"
          ],
          "end_time": "2019-03-20T00:00:00Z",
          "country": null,
          "placement": "ALL_ON_TWITTER",
          "granularity": "TOTAL",
          "entity": "LINE_ITEM",
          "platform": null,
          "metric_groups": [
            "ENGAGEMENT"
          ]
        }
      }
    }
```

<div id="reach-and-average-frequency">
  ### リーチと平均フリークエンシー
</div>

<Button href="https://app.getpostman.com/run-collection/1d12b9fc623b8e149f87">
  Postman で実行
</Button>

<div id="get-statsaccountsaccount_idreachcampaigns">
  #### GET stats/accounts/:account&#95;id/reach/campaigns[](#get-stats-accounts-account-id-reach-campaigns "Permalink to this headline")
</div>

指定したキャンペーンのリーチおよび平均フリークエンシーに関する分析情報を取得します。

### リソースURL[](#resource-url "Permalink to this headline")

`https://ads-api.x.com/stats/accounts/:account_id/reach/campaigns`

<div id="parameters">
  ### パラメーター[](#parameters "Permalink to this headline")
</div>

| Name | Description |
| :--- | :--- |
| account&#95;id  <br />*required* | 利用するアカウントの識別子です。リソースのパスの一部として指定され、[GET accounts](/ja/x-ads-api/campaign-management#accounts) を除くすべての Advertiser API リクエストで通常必須のパラメーターです。指定されたアカウントは認証済みユーザーに関連付けられている必要があります。<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| campaign&#95;ids  <br />*required* | カンマ区切りの識別子リストを指定することで、レスポンスを対象のキャンペーンのみに絞り込みます。最大 20 個までの ID を指定できます。<br /><br />**Note**: campaign ID は最大 20 個まで指定できます。<br /><br />Type: string<br /><br />Example: `8fgzf` |
| end&#95;time  <br />*required* | 取得されるデータの範囲を、[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601) 形式で指定した終了時刻までに限定します。<br /><br />**Note**: 時刻は 1 時間単位（分と秒が 0）で指定する必要があります。<br /><br />Type: string<br /><br />Example: `2017-05-26T07:00:00Z` |
| start&#95;time  <br />*required* | 取得されるデータの範囲を、[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601) 形式で指定した開始時刻からに限定します。<br /><br />**Note**: 時刻は 1 時間単位（分と秒が 0）で指定する必要があります。<br /><br />Type: string<br /><br />Example: `2017-05-19T07:00:00Z` |

<div id="example-request">
  ### リクエスト例[](#example-request "この見出しへのパーマリンク")
</div>

`GET https://ads-api.x.com/12/stats/accounts/18ce54d4x5t/reach/campaigns?campaign_ids=8fgzf&start_time=2017-05-19&end_time=2017-05-26`

<div id="example-response">
  ### レスポンス例[](#example-response "Permalink to this headline")
</div>

```json
    {
      "request": {
        "params": {
          "campaign_ids": [
            "8fgzf"
          ],
          "start_time": "2017-05-19T00:00:00Z",
          "end_time": "2017-05-26T00:00:00Z",
          "account_id": "18ce54d4x5t"
        }
      },
      "data_type": "reach",
      "data": [
        {
          "id": "8fgzf",
          "total_audience_reach": 1217,
          "average_frequency": 1.01
        }
      ]
    }
```

<div id="get-statsaccountsaccount_idreachfunding_instruments">
  #### GET stats/accounts/:account&#95;id/reach/funding&#95;instruments[](#get-stats-accounts-account-id-reach-funding-instruments "Permalink to this headline")
</div>

指定した funding instrument のリーチおよび平均配信頻度に関する分析情報を取得します。

<div id="resource-url">
  ### リソース URL[](#resource-url "Permalink to this headline")
</div>

`https://ads-api.x.com/stats/accounts/:account_id/reach/funding_instruments`

### パラメータ[](#parameters "Permalink to this headline")

| Name | Description |
| :--- | :--- |
| account&#95;id  <br />*required* | レバレッジドアカウントを示す識別子です。リソースのパス内に含まれ、[GET accounts](/ja/x-ads-api/campaign-management#accounts) を除くすべての Advertiser API リクエストで通常は必須パラメータです。指定されたアカウントは認証済みユーザーに関連付けられている必要があります。<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| funding&#95;instrument&#95;ids  <br />*required* | カンマ区切りの ID リストを指定して、レスポンスの対象を目的のファンディングインストゥルメントのみに絞ります。最大 20 個の ID を指定できます。<br /><br />**Note**: 最大 20 個のファンディングインストゥルメント ID を指定できます。<br /><br />Type: string<br /><br />Example: `lygyi` |
| end&#95;time  <br />*required* | 取得するデータの範囲を、[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601) 形式で指定された終了時刻までに制限します。<br /><br />**Note**: 分・秒がいずれも 0 の、1 時間単位 (ちょうどの時刻) で指定する必要があります。<br /><br />Type: string<br /><br />Example: `2017-05-26T07:00:00Z` |
| start&#95;time  <br />*required* | 取得するデータの範囲を、[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601) 形式で指定された開始時刻からに制限します。<br /><br />**Note**: 分・秒がいずれも 0 の、1 時間単位 (ちょうどの時刻) で指定する必要があります。<br /><br />Type: string<br /><br />Example: `2017-05-19T07:00:00Z` |

<div id="example-request">
  ### リクエスト例[](#example-request "この見出しへのパーマリンク")
</div>

```
GET https://ads-api.x.com/12/stats/accounts/18ce54d4x5t/reach/funding_instruments?funding_instrument_ids=lygyi&start_time=2017-05-19&end_time=2017-05-26
```

### レスポンス例[](#example-response "この見出しへの固定リンク")

```json
    {
      "request": {
        "params": {
          "funding_instrument_ids": [
            "lygyi"
          ],
          "start_time": "2017-05-19T00:00:00Z",
          "end_time": "2017-05-26T00:00:00Z",
          "account_id": "18ce54d4x5t"
        }
      },
      "data_type": "reach",
      "data": [
        {
          "id": "lygyi",
          "total_audience_reach": 1217,
          "average_frequency": 1.01
        }
      ]
    }
```

<div id="synchronous-analytics">
  ### 同期型アナリティクス
</div>

<Button href="https://app.getpostman.com/run-collection/1d12b9fc623b8e149f87">
  Postman で実行
</Button>

<div id="get-statsaccountsaccount_id">
  #### GET stats/accounts/:account&#95;id[](#get-stats-accounts-account-id "Permalink to this headline")
</div>

現在のアカウントに対する同期型の分析データを取得します。指定できる最大の時間範囲（`end_time` - `start_time`）は 7 日間です。

<div id="resource-url">
  ### リソース URL[](#resource-url "Permalink to this headline")
</div>

`https://ads-api.x.com/12/stats/accounts/:account_id`

<div id="parameters">
  ### パラメーター[](#parameters "Permalink to this headline")
</div>

| Name | Description |
| :--- | :--- |
| account&#95;id  <br />*required* | 対象アカウントを識別するための ID です。リソースのパス内に含まれ、[GET accounts](/ja/x-ads-api/campaign-management#accounts) を除くすべての Advertiser API リクエストで一般的に必須パラメーターです。指定したアカウントは認証済みユーザーに関連付けられている必要があります。<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| end&#95;time  <br />*required* | 取得されるデータを、指定した終了時刻までに絞り込みます。[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601) 形式で指定します。<br /><br />**Note**: 分および秒が 0 の「1 時間単位」で指定する必要があります。<br /><br />Type: string<br /><br />Example: `2017-05-26T07:00:00Z` |
| entity  <br />*required* | データを取得する対象のエンティティタイプです。<br /><br />Type: enum<br /><br />Possible values: `ACCOUNT`, `CAMPAIGN`, `FUNDING_INSTRUMENT`, `LINE_ITEM`, `ORGANIC_TWEET`, `PROMOTED_ACCOUNT`, `PROMOTED_TWEET`, `MEDIA_CREATIVE` |
| entity&#95;ids  <br />*required* | データを取得する特定のエンティティを指定します。カンマ区切りのエンティティ ID のリストを指定します。<br /><br />**Note**: 最大 20 個のエンティティ ID を指定できます。<br /><br />Type: string<br /><br />Example: `8u94t` |
| granularity  <br />*required* | 取得されるデータの粒度を指定します。<br /><br />Type: enum<br /><br />Possible values: `DAY`, `HOUR`, `TOTAL` |
| metric&#95;groups  <br />*required* | 返却する特定のメトリクス群を指定します。カンマ区切りのメトリクスグループのリストを指定します。詳細は [Metrics and Segmentation](/ja/x-ads-api/analytics#metrics-and-segmentation) を参照してください。<br /><br />**Note**: `MOBILE_CONVERSION` データは個別にリクエストする必要があります。<br /><br />Type: enum<br /><br />Possible values: `BILLING`, `ENGAGEMENT`, `LIFE_TIME_VALUE_MOBILE_CONVERSION`, `MEDIA`, `MOBILE_CONVERSION`, `VIDEO`, `WEB_CONVERSION` |
| placement  <br />*required* | 取得されるデータを特定のプレースメントに絞り込みます。<br /><br />**Note**: リクエストごとに受け付けられる値は 1 つのみです。X と X Audience Platform の両方のプレースメントを持つエンティティの場合、各プレースメント値ごとに個別のリクエストが必要です。<br /><br />Type: enum<br /><br />Possible values: `ALL_ON_TWITTER`, `PUBLISHER_NETWORK`, `SPOTLIGHT`, `TREND` |
| start&#95;time  <br />*required* | 取得されるデータを、指定した開始時刻以降に絞り込みます。[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601) 形式で指定します。<br /><br />**Note**: 分および秒が 0 の「1 時間単位」で指定する必要があります。<br /><br />Type: string<br /><br />Example: `2017-05-19T07:00:00Z` |

### リクエストの例[](#example-request "この見出しへの固定リンク")

```
GET https://ads-api.x.com/12/stats/accounts/18ce54d4x5t?entity=LINE_ITEM&entity_ids=8u94t&start_time=2017-05-19&end_time=2017-05-26&granularity=TOTAL&placement=ALL_ON_TWITTER&metric_groups=ENGAGEMENT
```

### レスポンスの例[](#example-response "この見出しへのパーマリンク")

```json
    {
      "data_type": "stats",
      "time_series_length": 1,
      "data": [
        {
          "id": "8u94t",
          "id_data": [
            {
              "segment": null,
              "metrics": {
                "impressions": [
                  1233
                ],
                "tweets_send": null,
                "qualified_impressions": null,
                "follows": null,
                "app_clicks": null,
                "retweets": null,
                "likes": [
                  1
                ],
                "engagements": [
                  58
                ],
                "clicks": [
                  58
                ],
                "card_engagements": null,
                "poll_card_vote": null,
                "replies": null,
                "carousel_swipes": null
              }
            }
          ]
        }
      ],
      "request": {
        "params": {
          "start_time": "2017-05-19T07:00:00Z",
          "segmentation_type": null,
          "entity_ids": [
            "8u94t"
          ],
          "end_time": "2017-05-26T07:00:00Z",
          "country": null,
          "placement": "ALL_ON_TWITTER",
          "granularity": "TOTAL",
          "entity": "LINE_ITEM",
          "platform": null,
          "metric_groups": [
            "ENGAGEMENT"
          ]
        }
      }
    }
```

### アクティブエンティティ

<Button href="https://app.getpostman.com/run-collection/1d12b9fc623b8e149f87">
  Postman で実行
</Button>

<div id="get-statsaccountsaccount_idactive_entities">
  #### GET stats/accounts/:account&#95;id/active&#95;entities[](#get-stats-accounts-account-id-active-entities "Permalink to this headline")
</div>

指定した期間内に、どのエンティティのアナリティクスメトリクスに変更があったかの詳細を取得します。

このエンドポイントは、アナリティクス関連のエンドポイントと併せて使用してください。このエンドポイントの結果は、どの広告エンティティについてアナリティクスをリクエストすべきかを示します。利用ガイドラインについては、[Active Entities Guide](/ja/x-ads-api/analytics#active-entities) を参照してください。

変更イベントは 1 時間ごとのバケットで提供されます。

* `start_time` と `end_time` の値は、クエリ対象とする 1 時間ごとのバケットを指定します。
* 返される `data` 配列には、後続のアナリティクスリクエストに含めるべき各エンティティごとに 1 つのオブジェクトが含まれます。
* **重要**: 後続のアナリティクスリクエストで指定すべき日付は、`activity_start_time` と `activity_end_time` の値に基づいて決定する必要があります。
  * これらの値は、保存されている変更イベントが *適用される* 時間範囲を表します。これはエンティティごとに返されます。

**注記**: 許可される最大の時間範囲（`end_time` - `start_time`）は 90 日です。

<div id="resource-url">
  ### リソース URL[](#resource-url "Permalink to this headline")
</div>

`https://ads-api.x.com/12/stats/accounts/:account_id/active_entities`

<div id="parameters">
  ### パラメーター[](#parameters "Permalink to this headline")
</div>

| Name | Description |
| :--- | :--- |
| account&#95;id  <br />*必須* | レバレッジド・アカウントの識別子です。リソースのパス内に含まれ、[GET accounts](/ja/x-ads-api/campaign-management#accounts) を除くすべての Advertiser API リクエストで一般的に必須パラメーターです。指定したアカウントは、認証済みユーザーに関連付けられている必要があります。<br /><br />Type: string<br /><br />Example: `18ce54d4x5t` |
| end&#95;time  <br />*必須* | 取得されるデータを、指定した終了時刻までに絞り込みます。[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601) で表現します。<br /><br />**Note**: 分および秒が 0 の、1 時間単位で指定する必要があります。<br /><br />Type: string<br /><br />Example: `2017-05-26T07:00:00Z` |
| entity  <br />*必須* | データを取得する対象のエンティティタイプです。<br /><br />Type: enum<br /><br />Possible values: `CAMPAIGN`, `FUNDING_INSTRUMENT`, `LINE_ITEM`, `MEDIA_CREATIVE`, `PROMOTED_ACCOUNT`, `PROMOTED_TWEET` |
| start&#95;time  <br />*必須* | 取得されるデータを、指定した開始時刻以降に絞り込みます。[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601) で表現します。<br /><br />**Note**: 分および秒が 0 の、1 時間単位で指定する必要があります。<br /><br />Type: string<br /><br />Example: `2017-05-19T07:00:00Z` |
| campaign&#95;ids  <br />*任意* | カンマ区切りの識別子リストを指定することで、レスポンスを対象のキャンペーンに関連付けられたエンティティのみに絞り込みます。最大 200 個の ID を指定できます。<br /><br />**Note**: `funding_instrument_ids` および `line_item_ids` とは同時に指定できません。<br /><br />Type: string<br /><br />Example: `8wku2` |
| funding&#95;instrument&#95;ids  <br />*任意* | カンマ区切りの識別子リストを指定することで、レスポンスを対象のファンディングインストルメントに関連付けられたエンティティのみに絞り込みます。最大 200 個の ID を指定できます。<br /><br />**Note**: `campaign_ids` および `line_item_ids` とは同時に指定できません。<br /><br />Type: string<br /><br />Example: `lygyi` |
| line&#95;item&#95;ids  <br />*任意* | カンマ区切りの識別子リストを指定することで、レスポンスを対象のラインアイテムに関連付けられたエンティティのみに絞り込みます。最大 200 個の ID を指定できます。<br /><br />**Note**: `campaign_ids` および `line_item_ids` とは同時に指定できません。<br /><br />Type: string<br /><br />Example: `8v7jo` |

<div id="example-request">
  ### リクエスト例[](#example-request "この見出しへのパーマリンク")
</div>

`GET https://ads-api.x.com/12/stats/accounts/18ce54d4x5t/active_entities?entity=PROMOTED_TWEET&start_time=2019-02-28&end_time=2019-03-01`

### レスポンス例[](#example-response "この見出しへの固定リンク")

```json
    {
      "request": {
        "params": {
          "account_id": "18ce54d4x5t",
          "entity": "PROMOTED_TWEET",
          "start_time": "2019-02-28T08:00:00Z",
          "end_time": "2019-03-01T08:00:00Z"
        }
      },
      "data": [
        {
          "entity_id": "2mvb28",
          "activity_start_time": "2019-02-28T01:30:07Z",
          "activity_end_time": "2019-03-01T07:42:55Z",
          "placements": [
            "ALL_ON_TWITTER"
          ]
        },
        {
          "entity_id": "2mvb29",
          "activity_start_time": "2019-02-27T11:30:07Z",
          "activity_end_time": "2019-03-01T07:42:50Z",
          "placements": [
            "ALL_ON_TWITTER",
            "PUBLISHER_NETWORK"
          ]
        },
        {
          "entity_id": "2mvfan",
          "activity_start_time": "2019-02-27T09:00:05Z",
          "activity_end_time": "2019-03-01T06:06:36Z",
          "placements": [
            "PUBLISHER_NETWORK"
          ]
        },
        {
          "entity_id": "2n17dx",
          "activity_start_time": "2019-02-28T02:02:26Z",
          "activity_end_time": "2019-03-01T07:52:44Z",
          "placements": [
            "ALL_ON_TWITTER",
            "PUBLISHER_NETWORK"
          ]
        }
      ]
    }
```
