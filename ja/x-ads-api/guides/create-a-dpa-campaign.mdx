---
title: 'DPAキャンペーンを作成する - ステップバイステップ'
keywords: ["DPA campaign", "dynamic product ads", "DPA", "create DPA campaign", "product ads", "dynamic ads"]
---

次の例では、`twurl` を使用して、アプリとユーザーの設定および認可が完了していることを前提とします。`twurl` は、X の OAuth 認証を適切に処理する、cURL と同様のコマンドラインツールです。`twurl` は Ads API（および REST API）の機能を迅速にテストしたりデバッグしたりするのに非常に便利なツールです。リクエストとレスポンスのすべてのヘッダーを確認するには、`-t` を使用して呼び出しをトレースします。これは cURL の `-v` オプションとほぼ同等です。

この例では、Dynamic Product Ads (DPA) キャンペーンを作成します。

アカウント id を取得します。

```bash
twurl -H ads-api.x.com /12/accounts/
```

```json
{
  "request": {
    "params": {}
  },
  "data": [
    {
      "name": "@AdsAPIのテストアカウント",
      "timezone": "America/Los_Angeles",
      "timezone_switch_at": null,
      "id": "xxxxxx",
      "created_at": "2014-03-09T00:41:49Z",
      "salt": "f9f9d5a5f23075c618da5eb1d1a9df57",
      "updated_at": "2015-01-29T00:41:49Z",
      "approval_status": "ACCEPTED",
      "deleted": false
    }
  ],
  "data_type": "account",
  "total_count": 1,
  "next_cursor": null
}
```

funding instrument の id を取得します。
前のコマンドで取得した account id を使って、GET accounts/:account&#95;id/funding&#95;instruments API を実行します。

```bash
twurl -H ads-api.x.com /12/accounts/xxxxxx/funding_instruments
```

```json
{
  "data": [
    {
      "cancelled": true,
      "created_at": "2014-03-09T00:41:49Z",
      "credit_limit_local_micro": null,
      "currency": "USD",
      "deleted": false,
      "description": null,
      "end_time": null,
      "funded_amount_local_micro": null,
      "id": "yyyy",
      "type": null,
      "updated_at": "2014-05-29T00:41:49Z"
    }
  ],
  "data_type": "funding_instrument",
  "next_cursor": null,
  "request": {
    "params": {
      "account_id": "xxxxxx"
    }
  },
  "total_count": 1
}
```


<div id="step-1-create-campaign">
  ## ステップ 1: キャンペーンを作成
</div>

キャンペーンを作成し、ファンディングインストルメントに関連付けます。
キャンペーンの開始時間と予算を設定します。

* 必須項目: ファンディングインストルメント、キャンペーン名、予算（合計/日次）、開始時間、AdsアカウントID

```bash
twurl -H ads-api.x.com -d "funding_instrument_id={FUNDING_INSTRUMENT_ID}&name={CAMPAIGN_NAME}&total_budget_amount_local_micro={TOTAL_BUDGET}&daily_budget_amount_local_micro={DAILY_BUDGET}&start_time={START_TIME}" /12/accounts/{ADS_ACCOUNT_ID}/campaigns | jq
```


<div id="step-2-create-line-item-with-sales-objective">
  ## ステップ 2: Sales 目的のラインアイテムを作成する
</div>

キャンペーンに関連付けられたラインアイテムを作成します。

* 必須フィールド: campaign id（ステップ 1 で取得したもの）, product type, placements, objective, goal, entity status, primary web event tag, catalog id, product set id, creative&#95;source, ads&#95;account&#95;id
* catalog&#95;id と product&#95;set&#95;id は Shopping Manager で確認できます
* creative&#95;source は常に DYNAMIC&#95;PRODUCT&#95;CREATIVE にする必要があります
* objective は常に WEBSITE&#95;CLICKS にする必要があります
* goal は常に WEBSITE&#95;CONVERSIONS にする必要があります

```bash
twurl -H ads-api.x.com -d "campaign_id={CAMPAIGN_ID}&product_type={product_type}&placements={PLACEMENTS}&objective=WEBSITE_CLICKS&goal=WEBSITE_CONVERSIONS&entity_status={entity_status}&primary_web_event_tag={WEB_EVENT_TAG}&catalog_id={catalog_id}&product_set_id={product_set_id}&creative_source=DYNAMIC_PRODUCT_CREATIVE" /12/accounts/{ADS_ACCOUNT_ID}/line_items | jq
```

* このステップが完了すると、キャンペーンは X の Ads Manager で確認できるようになります。


<div id="step-3-create-dpa-card">
  ## ステップ 3: DPA カードを作成する
</div>

DPA カードを作成します。

* 必須パラメータ：広告アカウント ID と URL
* URL は [https://twitter.com](https://twitter.com) で始まる必要があります。以下の例のように、それ以降に任意の UTM を付与できます。
  * `https://twitter.com?utm_source=%7B%7Bsite_source%7D%7D`
* オプションで、`creative_type` に次のいずれかの値を指定することで、カードのフォーマットを選択できます：&quot;CAROUSEL&quot;, &quot;SINGLE&quot;, &quot;COLLECTION&quot;。指定しない場合は、カードはカルーセルカードとして作成されます。

```bash
twurl -X POST -H ads-api.twitter.com -A "Content-Type: application/json" "/12/accounts/{ADS_ACCOUNT_ID}/dynamic_product_cards" -d '{"url": "{URL}", "creative_type": "{CREATIVE_TYPE}"}' | jq
```


<div id="step-4-create-post">
  ## ステップ4: ポストを作成する
</div>

ポストを作成します。

* 必須パラメータ：広告アカウントID、ユーザーID、カードURI（ステップ3で取得）、text、name、dynamic&#95;product&#95;ad
* dynamic&#95;product&#95;ad は常に true に設定する必要があります

```bash
twurl -X POST -H "https://ads-api.twitter.com" "/12/accounts/{ADS_ACCOUNT_ID}/tweet?as_user_id={USER_ID}1&card_uri=card%3A%2F%2F{CARD_URI}&text={POST_TEXT}&name={POST_NAME}%201&dynamic_product_ad=true" | jq
```


<div id="step-5-associate-post-with-line-item">
  ## 手順 5: ポストをラインアイテムに関連付ける
</div>

ポストをラインアイテムに関連付けます。

* 必須パラメータ: 広告アカウントID、ラインアイテムID（手順 2 で取得したもの）、ポストID（手順 4 の id&#95;str）

```bash
twurl -X POST -H "https://ads-api.twitter.com" "/12/accounts/{ADS_ACCOUNT_ID}/promoted_tweets?line_item_id={line_item_id}&tweet_ids={tweet_id}" | jq
```

広告主が UI 上でカードを確認したい場合は、UI 上でも表示されます。
